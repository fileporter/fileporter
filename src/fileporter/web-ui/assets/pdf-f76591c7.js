var $t=Object.defineProperty;var zt=(b,n,_)=>n in b?$t(b,n,{enumerable:!0,configurable:!0,writable:!0,value:_}):b[n]=_;var Me=(b,n,_)=>(zt(b,typeof n!="symbol"?n+"":n,_),_),at=(b,n,_)=>{if(!n.has(b))throw TypeError("Cannot "+_)};var I=(b,n,_)=>(at(b,n,"read from private field"),_?_.call(b):n.get(b)),oe=(b,n,_)=>{if(n.has(b))throw TypeError("Cannot add the same private member more than once");n instanceof WeakSet?n.add(b):n.set(b,_)},ye=(b,n,_,e)=>(at(b,n,"write to private field"),e?e.call(b,_):n.set(b,_),_);var ot=(b,n,_,e)=>({set _(a){ye(b,n,a,_)},get _(){return I(b,n,e)}}),ue=(b,n,_)=>(at(b,n,"access private method"),_);import{g as getAugmentedNamespace,_ as _setPrototypeOf,a as getDefaultExportFromCjs,r as reactExports,R as React,b as _extends,j as jsxRuntimeExports,s as serverUrl,L as Loading}from"./index-a2926ad4.js";function commonjsRequire(b){throw new Error('Could not dynamically require "'+b+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(n,_){module.exports=_()})(globalThis,()=>(()=>{var __webpack_modules__=[,(b,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.VerbosityLevel=n.Util=n.UnknownErrorException=n.UnexpectedResponseException=n.UNSUPPORTED_FEATURES=n.TextRenderingMode=n.StreamType=n.RenderingIntentFlag=n.PermissionFlag=n.PasswordResponses=n.PasswordException=n.PageActionEventType=n.OPS=n.MissingPDFException=n.LINE_FACTOR=n.LINE_DESCENT_FACTOR=n.InvalidPDFException=n.ImageKind=n.IDENTITY_MATRIX=n.FormatError=n.FontType=n.FeatureTest=n.FONT_IDENTITY_MATRIX=n.DocumentActionEventType=n.CMapCompressionType=n.BaseException=n.AnnotationType=n.AnnotationStateModelType=n.AnnotationReviewState=n.AnnotationReplyType=n.AnnotationMode=n.AnnotationMarkedState=n.AnnotationFlag=n.AnnotationFieldFlag=n.AnnotationEditorType=n.AnnotationEditorPrefix=n.AnnotationEditorParamsType=n.AnnotationBorderStyleType=n.AnnotationActionEventType=n.AbortException=void 0,n.arrayByteLength=ie,n.arraysToBytes=de,n.assert=f,n.bytesToString=L,n.createPromiseCapability=ge,n.createValidAbsoluteUrl=F,n.escapeString=xe,n.getModificationDate=ae,n.getVerbosityLevel=re,n.info=he,n.isArrayBuffer=De,n.isArrayEqual=et,n.isAscii=Oe,n.objectFromMap=ne,n.objectSize=le,n.setVerbosityLevel=K,n.shadow=U,n.string32=ee,n.stringToBytes=H,n.stringToPDFString=Pe,n.stringToUTF16BEString=Fe,n.stringToUTF8String=ze,n.unreachable=q,n.utf8StringToString=Te,n.warn=be,_(2);const e=[1,0,0,1,0,0];n.IDENTITY_MATRIX=e;const a=[.001,0,0,.001,0,0];n.FONT_IDENTITY_MATRIX=a;const k=1.35;n.LINE_FACTOR=k;const M=.35;n.LINE_DESCENT_FACTOR=M;const C={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};n.RenderingIntentFlag=C;const S={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};n.AnnotationMode=S;const p="pdfjs_internal_editor_";n.AnnotationEditorPrefix=p;const R={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};n.AnnotationEditorType=R;const N={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};n.AnnotationEditorParamsType=N;const x={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};n.PermissionFlag=x;const P={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};n.TextRenderingMode=P;const u={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};n.ImageKind=u;const t={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};n.AnnotationType=t;const s={MARKED:"Marked",REVIEW:"Review"};n.AnnotationStateModelType=s;const c={MARKED:"Marked",UNMARKED:"Unmarked"};n.AnnotationMarkedState=c;const A={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};n.AnnotationReviewState=A;const E={GROUP:"Group",REPLY:"R"};n.AnnotationReplyType=E;const h={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};n.AnnotationFlag=h;const i={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};n.AnnotationFieldFlag=i;const o={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};n.AnnotationBorderStyleType=o;const m={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};n.AnnotationActionEventType=m;const O={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};n.DocumentActionEventType=O;const T={O:"PageOpen",C:"PageClose"};n.PageActionEventType=T;const y={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"};n.StreamType=y;const D={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};n.FontType=D;const te={ERRORS:0,WARNINGS:1,INFOS:5};n.VerbosityLevel=te;const se={NONE:0,BINARY:1,STREAM:2};n.CMapCompressionType=se;const Z={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};n.OPS=Z;const J={unknown:"unknown",forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"};n.UNSUPPORTED_FEATURES=J;const G={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};n.PasswordResponses=G;let V=te.WARNINGS;function K(Q){Number.isInteger(Q)&&(V=Q)}function re(){return V}function he(Q){V>=te.INFOS&&console.log(`Info: ${Q}`)}function be(Q){V>=te.WARNINGS&&console.log(`Warning: ${Q}`)}function q(Q){throw new Error(Q)}function f(Q,$){Q||q($)}function d(Q){if(!Q)return!1;switch(Q.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function F(Q,$=null,z=null){if(!Q)return null;try{if(z&&typeof Q=="string"){if(z.addDefaultProtocol&&Q.startsWith("www.")){const _e=Q.match(/\./g);_e&&_e.length>=2&&(Q=`http://${Q}`)}if(z.tryConvertEncoding)try{Q=ze(Q)}catch{}}const me=$?new URL(Q,$):new URL(Q);if(d(me))return me}catch{}return null}function U(Q,$,z){return Object.defineProperty(Q,$,{value:z,enumerable:!0,configurable:!0,writable:!1}),z}const B=function(){function $(z,me){this.constructor===$&&q("Cannot initialize BaseException."),this.message=z,this.name=me}return $.prototype=new Error,$.constructor=$,$}();n.BaseException=B;class W extends B{constructor($,z){super($,"PasswordException"),this.code=z}}n.PasswordException=W;class X extends B{constructor($,z){super($,"UnknownErrorException"),this.details=z}}n.UnknownErrorException=X;class Y extends B{constructor($){super($,"InvalidPDFException")}}n.InvalidPDFException=Y;class l extends B{constructor($){super($,"MissingPDFException")}}n.MissingPDFException=l;class g extends B{constructor($,z){super($,"UnexpectedResponseException"),this.status=z}}n.UnexpectedResponseException=g;class v extends B{constructor($){super($,"FormatError")}}n.FormatError=v;class w extends B{constructor($){super($,"AbortException")}}n.AbortException=w;function L(Q){(typeof Q!="object"||Q===null||Q.length===void 0)&&q("Invalid argument for bytesToString");const $=Q.length,z=8192;if($<z)return String.fromCharCode.apply(null,Q);const me=[];for(let _e=0;_e<$;_e+=z){const Ae=Math.min(_e+z,$),Ee=Q.subarray(_e,Ae);me.push(String.fromCharCode.apply(null,Ee))}return me.join("")}function H(Q){typeof Q!="string"&&q("Invalid argument for stringToBytes");const $=Q.length,z=new Uint8Array($);for(let me=0;me<$;++me)z[me]=Q.charCodeAt(me)&255;return z}function ie(Q){if(Q.length!==void 0)return Q.length;if(Q.byteLength!==void 0)return Q.byteLength;q("Invalid argument for arrayByteLength")}function de(Q){const $=Q.length;if($===1&&Q[0]instanceof Uint8Array)return Q[0];let z=0;for(let Ae=0;Ae<$;Ae++)z+=ie(Q[Ae]);let me=0;const _e=new Uint8Array(z);for(let Ae=0;Ae<$;Ae++){let Ee=Q[Ae];Ee instanceof Uint8Array||(typeof Ee=="string"?Ee=H(Ee):Ee=new Uint8Array(Ee));const we=Ee.byteLength;_e.set(Ee,me),me+=we}return _e}function ee(Q){return String.fromCharCode(Q>>24&255,Q>>16&255,Q>>8&255,Q&255)}function le(Q){return Object.keys(Q).length}function ne(Q){const $=Object.create(null);for(const[z,me]of Q)$[z]=me;return $}function ce(){const Q=new Uint8Array(4);return Q[0]=1,new Uint32Array(Q.buffer,0,1)[0]===1}function pe(){try{return new Function(""),!0}catch{return!1}}class j{static get isLittleEndian(){return U(this,"isLittleEndian",ce())}static get isEvalSupported(){return U(this,"isEvalSupported",pe())}static get isOffscreenCanvasSupported(){return U(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}}n.FeatureTest=j;const fe=[...Array(256).keys()].map(Q=>Q.toString(16).padStart(2,"0"));class ve{static makeHexColor($,z,me){return`#${fe[$]}${fe[z]}${fe[me]}`}static scaleMinMax($,z){let me;$[0]?($[0]<0&&(me=z[0],z[0]=z[1],z[1]=me),z[0]*=$[0],z[1]*=$[0],$[3]<0&&(me=z[2],z[2]=z[3],z[3]=me),z[2]*=$[3],z[3]*=$[3]):(me=z[0],z[0]=z[2],z[2]=me,me=z[1],z[1]=z[3],z[3]=me,$[1]<0&&(me=z[2],z[2]=z[3],z[3]=me),z[2]*=$[1],z[3]*=$[1],$[2]<0&&(me=z[0],z[0]=z[1],z[1]=me),z[0]*=$[2],z[1]*=$[2]),z[0]+=$[4],z[1]+=$[4],z[2]+=$[5],z[3]+=$[5]}static transform($,z){return[$[0]*z[0]+$[2]*z[1],$[1]*z[0]+$[3]*z[1],$[0]*z[2]+$[2]*z[3],$[1]*z[2]+$[3]*z[3],$[0]*z[4]+$[2]*z[5]+$[4],$[1]*z[4]+$[3]*z[5]+$[5]]}static applyTransform($,z){const me=$[0]*z[0]+$[1]*z[2]+z[4],_e=$[0]*z[1]+$[1]*z[3]+z[5];return[me,_e]}static applyInverseTransform($,z){const me=z[0]*z[3]-z[1]*z[2],_e=($[0]*z[3]-$[1]*z[2]+z[2]*z[5]-z[4]*z[3])/me,Ae=(-$[0]*z[1]+$[1]*z[0]+z[4]*z[1]-z[5]*z[0])/me;return[_e,Ae]}static getAxialAlignedBoundingBox($,z){const me=ve.applyTransform($,z),_e=ve.applyTransform($.slice(2,4),z),Ae=ve.applyTransform([$[0],$[3]],z),Ee=ve.applyTransform([$[2],$[1]],z);return[Math.min(me[0],_e[0],Ae[0],Ee[0]),Math.min(me[1],_e[1],Ae[1],Ee[1]),Math.max(me[0],_e[0],Ae[0],Ee[0]),Math.max(me[1],_e[1],Ae[1],Ee[1])]}static inverseTransform($){const z=$[0]*$[3]-$[1]*$[2];return[$[3]/z,-$[1]/z,-$[2]/z,$[0]/z,($[2]*$[5]-$[4]*$[3])/z,($[4]*$[1]-$[5]*$[0])/z]}static apply3dTransform($,z){return[$[0]*z[0]+$[1]*z[1]+$[2]*z[2],$[3]*z[0]+$[4]*z[1]+$[5]*z[2],$[6]*z[0]+$[7]*z[1]+$[8]*z[2]]}static singularValueDecompose2dScale($){const z=[$[0],$[2],$[1],$[3]],me=$[0]*z[0]+$[1]*z[2],_e=$[0]*z[1]+$[1]*z[3],Ae=$[2]*z[0]+$[3]*z[2],Ee=$[2]*z[1]+$[3]*z[3],we=(me+Ee)/2,Ie=Math.sqrt((me+Ee)**2-4*(me*Ee-Ae*_e))/2,ke=we+Ie||1,Ce=we-Ie||1;return[Math.sqrt(ke),Math.sqrt(Ce)]}static normalizeRect($){const z=$.slice(0);return $[0]>$[2]&&(z[0]=$[2],z[2]=$[0]),$[1]>$[3]&&(z[1]=$[3],z[3]=$[1]),z}static intersect($,z){const me=Math.max(Math.min($[0],$[2]),Math.min(z[0],z[2])),_e=Math.min(Math.max($[0],$[2]),Math.max(z[0],z[2]));if(me>_e)return null;const Ae=Math.max(Math.min($[1],$[3]),Math.min(z[1],z[3])),Ee=Math.min(Math.max($[1],$[3]),Math.max(z[1],z[3]));return Ae>Ee?null:[me,Ae,_e,Ee]}static bezierBoundingBox($,z,me,_e,Ae,Ee,we,Ie){const ke=[],Ce=[[],[]];let Ne,Le,Be,Re,je,qe,Ve,Xe;for(let Ye=0;Ye<2;++Ye){if(Ye===0?(Le=6*$-12*me+6*Ae,Ne=-3*$+9*me-9*Ae+3*we,Be=3*me-3*$):(Le=6*z-12*_e+6*Ee,Ne=-3*z+9*_e-9*Ee+3*Ie,Be=3*_e-3*z),Math.abs(Ne)<1e-12){if(Math.abs(Le)<1e-12)continue;Re=-Be/Le,0<Re&&Re<1&&ke.push(Re);continue}Ve=Le*Le-4*Be*Ne,Xe=Math.sqrt(Ve),!(Ve<0)&&(je=(-Le+Xe)/(2*Ne),0<je&&je<1&&ke.push(je),qe=(-Le-Xe)/(2*Ne),0<qe&&qe<1&&ke.push(qe))}let Ge=ke.length,Ue;const He=Ge;for(;Ge--;)Re=ke[Ge],Ue=1-Re,Ce[0][Ge]=Ue*Ue*Ue*$+3*Ue*Ue*Re*me+3*Ue*Re*Re*Ae+Re*Re*Re*we,Ce[1][Ge]=Ue*Ue*Ue*z+3*Ue*Ue*Re*_e+3*Ue*Re*Re*Ee+Re*Re*Re*Ie;return Ce[0][He]=$,Ce[1][He]=z,Ce[0][He+1]=we,Ce[1][He+1]=Ie,Ce[0].length=Ce[1].length=He+2,[Math.min(...Ce[0]),Math.min(...Ce[1]),Math.max(...Ce[0]),Math.max(...Ce[1])]}}n.Util=ve;const Se=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Pe(Q){if(Q[0]>="ï"){let z;if(Q[0]==="þ"&&Q[1]==="ÿ"?z="utf-16be":Q[0]==="ÿ"&&Q[1]==="þ"?z="utf-16le":Q[0]==="ï"&&Q[1]==="»"&&Q[2]==="¿"&&(z="utf-8"),z)try{const me=new TextDecoder(z,{fatal:!0}),_e=H(Q);return me.decode(_e)}catch(me){be(`stringToPDFString: "${me}".`)}}const $=[];for(let z=0,me=Q.length;z<me;z++){const _e=Se[Q.charCodeAt(z)];$.push(_e?String.fromCharCode(_e):Q.charAt(z))}return $.join("")}function xe(Q){return Q.replace(/([()\\\n\r])/g,$=>$===`
`?"\\n":$==="\r"?"\\r":`\\${$}`)}function Oe(Q){return/^[\x00-\x7F]*$/.test(Q)}function Fe(Q){const $=["þÿ"];for(let z=0,me=Q.length;z<me;z++){const _e=Q.charCodeAt(z);$.push(String.fromCharCode(_e>>8&255),String.fromCharCode(_e&255))}return $.join("")}function ze(Q){return decodeURIComponent(escape(Q))}function Te(Q){return unescape(encodeURIComponent(Q))}function De(Q){return typeof Q=="object"&&Q!==null&&Q.byteLength!==void 0}function et(Q,$){if(Q.length!==$.length)return!1;for(let z=0,me=Q.length;z<me;z++)if(Q[z]!==$[z])return!1;return!0}function ae(Q=new Date){return[Q.getUTCFullYear().toString(),(Q.getUTCMonth()+1).toString().padStart(2,"0"),Q.getUTCDate().toString().padStart(2,"0"),Q.getUTCHours().toString().padStart(2,"0"),Q.getUTCMinutes().toString().padStart(2,"0"),Q.getUTCSeconds().toString().padStart(2,"0")].join("")}function ge(){const Q=Object.create(null);let $=!1;return Object.defineProperty(Q,"settled",{get(){return $}}),Q.promise=new Promise(function(z,me){Q.resolve=function(_e){$=!0,z(_e)},Q.reject=function(_e){$=!0,me(_e)}}),Q}},(b,n,_)=>{_(3)},(b,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.isNodeJS=void 0;const _=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");n.isNodeJS=_},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var b,_,e,a,k,M,C,S,p,lt,N,x;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(5),_display_utils=__w_pdfjs_require__(8),_font_loader=__w_pdfjs_require__(11),_canvas=__w_pdfjs_require__(12),_worker_options=__w_pdfjs_require__(15),_is_node=__w_pdfjs_require__(3),_message_handler=__w_pdfjs_require__(16),_metadata=__w_pdfjs_require__(17),_optional_content_config=__w_pdfjs_require__(18),_transport_stream=__w_pdfjs_require__(19),_xfa_text=__w_pdfjs_require__(20);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:u,NodeCMapReaderFactory:t,NodeStandardFontDataFactory:s}=__w_pdfjs_require__(21);exports.DefaultCanvasFactory=DefaultCanvasFactory=u,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=t,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=s}let createPDFNetworkStream;function setPDFNetworkStreamFactory(u){createPDFNetworkStream=u}function getDocument(u){const t=new PDFDocumentLoadingTask;let s;if(typeof u=="string"||u instanceof URL)s={url:u};else if((0,_util.isArrayBuffer)(u))s={data:u};else if(u instanceof PDFDataRangeTransport)s={range:u};else{if(typeof u!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, TypedArray, or parameter object.");if(!u.url&&!u.data&&!u.range)throw new Error("Invalid parameter object: need either .data, .range or .url");s=u}const c=Object.create(null);let A=null,E=null;for(const i in s){const o=s[i];switch(i){case"url":if(typeof window<"u")try{c[i]=new URL(o,window.location).href;continue}catch(m){(0,_util.warn)(`Cannot create valid URL: "${m}".`)}else if(typeof o=="string"||o instanceof URL){c[i]=o.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":A=o;continue;case"worker":E=o;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&o instanceof Buffer)c[i]=new Uint8Array(o);else{if(o instanceof Uint8Array)break;if(typeof o=="string")c[i]=(0,_util.stringToBytes)(o);else if(typeof o=="object"&&o!==null&&!isNaN(o.length))c[i]=new Uint8Array(o);else if((0,_util.isArrayBuffer)(o))c[i]=new Uint8Array(o);else throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}continue}c[i]=o}if(c.CMapReaderFactory=c.CMapReaderFactory||DefaultCMapReaderFactory,c.StandardFontDataFactory=c.StandardFontDataFactory||DefaultStandardFontDataFactory,c.ignoreErrors=c.stopAtErrors!==!0,c.fontExtraProperties=c.fontExtraProperties===!0,c.pdfBug=c.pdfBug===!0,c.enableXfa=c.enableXfa===!0,(!Number.isInteger(c.rangeChunkSize)||c.rangeChunkSize<1)&&(c.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),(typeof c.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(c.docBaseUrl))&&(c.docBaseUrl=null),(!Number.isInteger(c.maxImageSize)||c.maxImageSize<-1)&&(c.maxImageSize=-1),typeof c.cMapUrl!="string"&&(c.cMapUrl=null),typeof c.standardFontDataUrl!="string"&&(c.standardFontDataUrl=null),typeof c.useWorkerFetch!="boolean"&&(c.useWorkerFetch=c.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&c.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),typeof c.isEvalSupported!="boolean"&&(c.isEvalSupported=!0),typeof c.disableFontFace!="boolean"&&(c.disableFontFace=_is_node.isNodeJS),typeof c.useSystemFonts!="boolean"&&(c.useSystemFonts=!_is_node.isNodeJS&&!c.disableFontFace),(typeof c.ownerDocument!="object"||c.ownerDocument===null)&&(c.ownerDocument=globalThis.document),typeof c.disableRange!="boolean"&&(c.disableRange=!1),typeof c.disableStream!="boolean"&&(c.disableStream=!1),typeof c.disableAutoFetch!="boolean"&&(c.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(c.verbosity),!E){const i={verbosity:c.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};E=i.port?PDFWorker.fromPort(i):new PDFWorker(i),t._worker=E}const h=t.docId;return E.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");const i=_fetchDocument(E,c,A,h),o=new Promise(function(m){let O;A?O=new _transport_stream.PDFDataTransportStream({length:c.length,initialData:c.initialData,progressiveDone:c.progressiveDone,contentDispositionFilename:c.contentDispositionFilename,disableRange:c.disableRange,disableStream:c.disableStream},A):c.data||(O=createPDFNetworkStream({url:c.url,length:c.length,httpHeaders:c.httpHeaders,withCredentials:c.withCredentials,rangeChunkSize:c.rangeChunkSize,disableRange:c.disableRange,disableStream:c.disableStream})),m(O)});return Promise.all([i,o]).then(function([m,O]){if(t.destroyed)throw new Error("Loading aborted");const T=new _message_handler.MessageHandler(h,m,E.port),y=new WorkerTransport(T,t,O,c);t._transport=y,T.send("Ready",null)})}).catch(t._capability.reject),t}async function _fetchDocument(u,t,s,c){if(u.destroyed)throw new Error("Worker was destroyed");s&&(t.length=s.length,t.initialData=s.initialData,t.progressiveDone=s.progressiveDone,t.contentDispositionFilename=s.contentDispositionFilename);const A=await u.messageHandler.sendWithPromise("GetDocRequest",{docId:c,apiVersion:"2.16.105",source:{data:t.data,url:t.url,password:t.password,disableAutoFetch:t.disableAutoFetch,rangeChunkSize:t.rangeChunkSize,length:t.length},maxImageSize:t.maxImageSize,disableFontFace:t.disableFontFace,docBaseUrl:t.docBaseUrl,ignoreErrors:t.ignoreErrors,isEvalSupported:t.isEvalSupported,fontExtraProperties:t.fontExtraProperties,enableXfa:t.enableXfa,useSystemFonts:t.useSystemFonts,cMapUrl:t.useWorkerFetch?t.cMapUrl:null,standardFontDataUrl:t.useWorkerFetch?t.standardFontDataUrl:null});if(t.data&&(t.data=null),u.destroyed)throw new Error("Worker was destroyed");return A}const n=class n{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${ot(n,b)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}async destroy(){var t;this.destroyed=!0,await((t=this._transport)==null?void 0:t.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};b=new WeakMap,oe(n,b,0);let PDFDocumentLoadingTask=n;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(t,s,c=!1,A=null){this.length=t,this.initialData=s,this.progressiveDone=c,this.contentDispositionFilename=A,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,s){for(const c of this._rangeListeners)c(t,s)}onDataProgress(t,s){this._readyCapability.promise.then(()=>{for(const c of this._progressListeners)c(t,s)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const s of this._progressiveReadListeners)s(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,s){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(t,s){this._pdfInfo=t,this._transport=s,Object.defineProperty(this,"fingerprint",{get(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.fingerprint`, please use `PDFDocumentProxy.fingerprints` instead."),this.fingerprints[0]}}),Object.defineProperty(this,"getStats",{value:async()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getStats`, please use the `PDFDocumentProxy.stats`-getter instead."),this.stats||{streamTypes:{},fontTypes:{}})})}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get stats(){return this._transport.stats}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(){return this._transport.annotationStorage.size<=0&&(0,_display_utils.deprecated)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this._transport.saveDocument()}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(t,s,c,A,E=!1){this._pageIndex=t,this._pageInfo=s,this._ownerDocument=A,this._transport=c,this._stats=E?new _display_utils.StatTimer:null,this._pdfBug=E,this.commonObjs=c.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:s=this.rotate,offsetX:c=0,offsetY:A=0,dontFlip:E=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:t,rotation:s,offsetX:c,offsetY:A,dontFlip:E})}getAnnotations({intent:t="display"}={}){const s=this._transport.getRenderingIntent(t);let c=this._annotationPromises.get(s.cacheKey);return c||(c=this._transport.getAnnotations(this._pageIndex,s.renderingIntent),this._annotationPromises.set(s.cacheKey,c),c=c.then(A=>{for(const E of A)E.titleObj!==void 0&&Object.defineProperty(E,"title",{get(){return(0,_display_utils.deprecated)("`title`-property on annotation, please use `titleObj` instead."),E.titleObj.str}}),E.contentsObj!==void 0&&Object.defineProperty(E,"contents",{get(){return(0,_display_utils.deprecated)("`contents`-property on annotation, please use `contentsObj` instead."),E.contentsObj.str}});return A})),c}getJSActions(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}async getXfa(){var t;return((t=this._transport._htmlForXfa)==null?void 0:t.children[this._pageIndex])||null}render({canvasContext:t,viewport:s,intent:c="display",annotationMode:A=_util.AnnotationMode.ENABLE,transform:E=null,imageLayer:h=null,canvasFactory:i=null,background:o=null,optionalContentConfigPromise:m=null,annotationCanvasMap:O=null,pageColors:T=null,printAnnotationStorage:y=null}){var K,re;((K=arguments[0])==null?void 0:K.renderInteractiveForms)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `renderInteractiveForms`-option, please use the `annotationMode`-option instead."),arguments[0].renderInteractiveForms===!0&&A===_util.AnnotationMode.ENABLE&&(A=_util.AnnotationMode.ENABLE_FORMS)),((re=arguments[0])==null?void 0:re.includeAnnotationStorage)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `includeAnnotationStorage`-option, please use the `annotationMode`-option instead."),arguments[0].includeAnnotationStorage===!0&&A===_util.AnnotationMode.ENABLE&&(A=_util.AnnotationMode.ENABLE_STORAGE)),this._stats&&this._stats.time("Overall");const D=this._transport.getRenderingIntent(c,A,y);this.pendingCleanup=!1,m||(m=this._transport.getOptionalContentConfig());let te=this._intentStates.get(D.cacheKey);te||(te=Object.create(null),this._intentStates.set(D.cacheKey,te)),te.streamReaderCancelTimeout&&(clearTimeout(te.streamReaderCancelTimeout),te.streamReaderCancelTimeout=null);const se=i||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),Z=!!(D.renderingIntent&_util.RenderingIntentFlag.PRINT);te.displayReadyCapability||(te.displayReadyCapability=(0,_util.createPromiseCapability)(),te.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(D));const J=he=>{te.renderTasks.delete(G),(this.cleanupAfterRender||Z)&&(this.pendingCleanup=!0),this._tryCleanup(),he?(G.capability.reject(he),this._abortOperatorList({intentState:te,reason:he instanceof Error?he:new Error(he)})):G.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},G=new InternalRenderTask({callback:J,params:{canvasContext:t,viewport:s,transform:E,imageLayer:h,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:O,operatorList:te.operatorList,pageIndex:this._pageIndex,canvasFactory:se,useRequestAnimationFrame:!Z,pdfBug:this._pdfBug,pageColors:T});(te.renderTasks||(te.renderTasks=new Set)).add(G);const V=G.task;return Promise.all([te.displayReadyCapability.promise,m]).then(([he,be])=>{if(this.pendingCleanup){J();return}this._stats&&this._stats.time("Rendering"),G.initializeGraphics({transparency:he,optionalContentConfig:be}),G.operatorListChanged()}).catch(J),V}getOperatorList({intent:t="display",annotationMode:s=_util.AnnotationMode.ENABLE,printAnnotationStorage:c=null}={}){function A(){h.operatorList.lastChunk&&(h.opListReadCapability.resolve(h.operatorList),h.renderTasks.delete(i))}const E=this._transport.getRenderingIntent(t,s,c,!0);let h=this._intentStates.get(E.cacheKey);h||(h=Object.create(null),this._intentStates.set(E.cacheKey,h));let i;return h.opListReadCapability||(i=Object.create(null),i.operatorListChanged=A,h.opListReadCapability=(0,_util.createPromiseCapability)(),(h.renderTasks||(h.renderTasks=new Set)).add(i),h.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(E)),h.opListReadCapability.promise}streamTextContent({disableCombineTextItems:t=!1,includeMarkedContent:s=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:t!==!0,includeMarkedContent:s===!0},{highWaterMark:100,size(A){return A.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(c=>_xfa_text.XfaText.textContent(c));const s=this.streamTextContent(t);return new Promise(function(c,A){function E(){h.read().then(function({value:o,done:m}){if(m){c(i);return}Object.assign(i.styles,o.styles),i.items.push(...o.items),E()},A)}const h=s.getReader(),i={items:[],styles:Object.create(null)};E()})}getStructTree(){return this._structTreePromise||(this._structTreePromise=this._transport.getStructTree(this._pageIndex))}_destroy(){this.destroyed=!0;const t=[];for(const s of this._intentStates.values())if(this._abortOperatorList({intentState:s,reason:new Error("Page was destroyed."),force:!0}),!s.opListReadCapability)for(const c of s.renderTasks)t.push(c.completed),c.cancel();this.objs.clear();for(const s of this._bitmaps)s.close();return this._bitmaps.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(t)}cleanup(t=!1){return this.pendingCleanup=!0,this._tryCleanup(t)}_tryCleanup(t=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:s,operatorList:c}of this._intentStates.values())if(s.size>0||!c.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,t&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const s of this._bitmaps)s.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(t,s){const c=this._intentStates.get(s);c&&(this._stats&&this._stats.timeEnd("Page Request"),c.displayReadyCapability&&c.displayReadyCapability.resolve(t))}_renderPageChunk(t,s){for(let c=0,A=t.length;c<A;c++)s.operatorList.fnArray.push(t.fnArray[c]),s.operatorList.argsArray.push(t.argsArray[c]);s.operatorList.lastChunk=t.lastChunk,s.operatorList.separateAnnots=t.separateAnnots;for(const c of s.renderTasks)c.operatorListChanged();t.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:t,cacheKey:s,annotationStorageMap:c}){const E=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:s,annotationStorage:c}).getReader(),h=this._intentStates.get(s);h.streamReader=E;const i=()=>{E.read().then(({value:o,done:m})=>{if(m){h.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(o,h),i())},o=>{if(h.streamReader=null,!this._transport.destroyed){if(h.operatorList){h.operatorList.lastChunk=!0;for(const m of h.renderTasks)m.operatorListChanged();this._tryCleanup()}if(h.displayReadyCapability)h.displayReadyCapability.reject(o);else if(h.opListReadCapability)h.opListReadCapability.reject(o);else throw o}})};i()}_abortOperatorList({intentState:t,reason:s,force:c=!1}){if(t.streamReader){if(!c){if(t.renderTasks.size>0)return;if(s instanceof _display_utils.RenderingCancelledException){t.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:t,reason:s,force:!0}),t.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT);return}}if(t.streamReader.cancel(new _util.AbortException(s.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[A,E]of this._intentStates)if(E===t){this._intentStates.delete(A);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve()}postMessage(t,s){const c={data:structuredClone(t,s)};this._deferred.then(()=>{for(const A of this._listeners)A.call(this,c)})}addEventListener(t,s){this._listeners.push(s)}removeEventListener(t,s){const c=this._listeners.indexOf(s);this._listeners.splice(c,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const u=(_=document==null?void 0:document.currentScript)==null?void 0:_.src;u&&(PDFWorkerUtil.fallbackWorkerSrc=u.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(u,t){let s;try{if(s=new URL(u),!s.origin||s.origin==="null")return!1}catch{return!1}const c=new URL(t,s);return s.origin===c.origin},PDFWorkerUtil.createCDNWrapper=function(u){const t=`importScripts("${u}");`;return URL.createObjectURL(new Blob([t]))}}const _PDFWorker=class _PDFWorker{constructor({name:u=null,port:t=null,verbosity:s=(0,_util.getVerbosityLevel)()}={}){if(t&&I(_PDFWorker,e).has(t))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=u,this.destroyed=!1,this.verbosity=s,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,t){I(_PDFWorker,e).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(u){this._port=u,this._messageHandler=new _message_handler.MessageHandler("main","worker",u),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:u}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,u)||(u=PDFWorkerUtil.createCDNWrapper(new URL(u,window.location).href));const t=new Worker(u),s=new _message_handler.MessageHandler("main","worker",t),c=()=>{t.removeEventListener("error",A),s.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},A=()=>{this._webWorker||c()};t.addEventListener("error",A),s.on("test",h=>{if(t.removeEventListener("error",A),this.destroyed){c();return}h?(this._messageHandler=s,this._port=t,this._webWorker=t,this._readyCapability.resolve(),s.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),s.destroy(),t.terminate())}),s.on("ready",h=>{if(t.removeEventListener("error",A),this.destroyed){c();return}try{E()}catch{this._setupFakeWorker()}});const E=()=>{const h=new Uint8Array;s.send("test",h,[h.buffer])};E();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(u=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new LoopbackPort;this._port=t;const s=`fake${PDFWorkerUtil.fakeWorkerId++}`,c=new _message_handler.MessageHandler(s+"_worker",s,t);u.setup(c,t);const A=new _message_handler.MessageHandler(s,s+"_worker",t);this._messageHandler=A,this._readyCapability.resolve(),A.send("configure",{verbosity:this.verbosity})}).catch(u=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${u.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),I(_PDFWorker,e).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(u){if(!(u!=null&&u.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return I(this,e).has(u.port)?I(this,e).get(u.port):new _PDFWorker(u)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var u;try{return((u=globalThis.pdfjsWorker)==null?void 0:u.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};e=new WeakMap,oe(_PDFWorker,e,new WeakMap);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker,PDFWorker.getWorkerSrc=function(){return(0,_display_utils.deprecated)("`PDFWorker.getWorkerSrc()`, please use `PDFWorker.workerSrc` instead."),this.workerSrc};class WorkerTransport{constructor(t,s,c,A){oe(this,a,null);oe(this,k,new Map);oe(this,M,new Map);oe(this,C,null);this.messageHandler=t,this.loadingTask=s,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:s.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:A.ownerDocument,styleElement:A.styleElement}),this._params=A,A.useWorkerFetch||(this.CMapReaderFactory=new A.CMapReaderFactory({baseUrl:A.cMapUrl,isCompressed:A.cMapPacked}),this.StandardFontDataFactory=new A.StandardFontDataFactory({baseUrl:A.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=c,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get stats(){return I(this,a)}getRenderingIntent(t,s=_util.AnnotationMode.ENABLE,c=null,A=!1){let E=_util.RenderingIntentFlag.DISPLAY,h=null;switch(t){case"any":E=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":E=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${t}`)}switch(s){case _util.AnnotationMode.DISABLE:E+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:E+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:E+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,h=(E&_util.RenderingIntentFlag.PRINT&&c instanceof _annotation_storage.PrintAnnotationStorage?c:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${s}`)}return A&&(E+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:E,cacheKey:`${E}_${_annotation_storage.AnnotationStorage.getHash(h)}`,annotationStorageMap:h}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const c of I(this,k).values())t.push(c._destroy());I(this,k).clear(),I(this,M).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const s=this.messageHandler.sendWithPromise("Terminate",null);return t.push(s),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),ye(this,C,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:s}=this;t.on("GetReader",(c,A)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=E=>{this._lastProgress={loaded:E.loaded,total:E.total}},A.onPull=()=>{this._fullReader.read().then(function({value:E,done:h}){if(h){A.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(E),"GetReader - expected an ArrayBuffer."),A.enqueue(new Uint8Array(E),1,[E])}).catch(E=>{A.error(E)})},A.onCancel=E=>{this._fullReader.cancel(E),A.ready.catch(h=>{if(!this.destroyed)throw h})}}),t.on("ReaderHeadersReady",c=>{const A=(0,_util.createPromiseCapability)(),E=this._fullReader;return E.headersReady.then(()=>{var h;(!E.isStreamingSupported||!E.isRangeSupported)&&(this._lastProgress&&((h=s.onProgress)==null||h.call(s,this._lastProgress)),E.onProgress=i=>{var o;(o=s.onProgress)==null||o.call(s,{loaded:i.loaded,total:i.total})}),A.resolve({isStreamingSupported:E.isStreamingSupported,isRangeSupported:E.isRangeSupported,contentLength:E.contentLength})},A.reject),A.promise}),t.on("GetRangeReader",(c,A)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const E=this._networkStream.getRangeReader(c.begin,c.end);if(!E){A.close();return}A.onPull=()=>{E.read().then(function({value:h,done:i}){if(i){A.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(h),"GetRangeReader - expected an ArrayBuffer."),A.enqueue(new Uint8Array(h),1,[h])}).catch(h=>{A.error(h)})},A.onCancel=h=>{E.cancel(h),A.ready.catch(i=>{if(!this.destroyed)throw i})}}),t.on("GetDoc",({pdfInfo:c})=>{this._numPages=c.numPages,this._htmlForXfa=c.htmlForXfa,delete c.htmlForXfa,s._capability.resolve(new PDFDocumentProxy(c,this))}),t.on("DocException",function(c){let A;switch(c.name){case"PasswordException":A=new _util.PasswordException(c.message,c.code);break;case"InvalidPDFException":A=new _util.InvalidPDFException(c.message);break;case"MissingPDFException":A=new _util.MissingPDFException(c.message);break;case"UnexpectedResponseException":A=new _util.UnexpectedResponseException(c.message,c.status);break;case"UnknownErrorException":A=new _util.UnknownErrorException(c.message,c.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}s._capability.reject(A)}),t.on("PasswordRequest",c=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),s.onPassword){const A=E=>{E instanceof Error?this._passwordCapability.reject(E):this._passwordCapability.resolve({password:E})};try{s.onPassword(A,c.code)}catch(E){this._passwordCapability.reject(E)}}else this._passwordCapability.reject(new _util.PasswordException(c.message,c.code));return this._passwordCapability.promise}),t.on("DataLoaded",c=>{var A;(A=s.onProgress)==null||A.call(s,{loaded:c.length,total:c.length}),this.downloadInfoCapability.resolve(c)}),t.on("StartRenderPage",c=>{if(this.destroyed)return;I(this,k).get(c.pageIndex)._startRenderPage(c.transparency,c.cacheKey)}),t.on("commonobj",([c,A,E])=>{var h;if(!this.destroyed&&!this.commonObjs.has(c))switch(A){case"Font":const i=this._params;if("error"in E){const O=E.error;(0,_util.warn)(`Error during font loading: ${O}`),this.commonObjs.resolve(c,O);break}let o=null;i.pdfBug&&((h=globalThis.FontInspector)!=null&&h.enabled)&&(o={registerFont(O,T){globalThis.FontInspector.fontAdded(O,T)}});const m=new _font_loader.FontFaceObject(E,{isEvalSupported:i.isEvalSupported,disableFontFace:i.disableFontFace,ignoreErrors:i.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:o});this.fontLoader.bind(m).catch(O=>t.sendWithPromise("FontFallback",{id:c})).finally(()=>{!i.fontExtraProperties&&m.data&&(m.data=null),this.commonObjs.resolve(c,m)});break;case"FontPath":case"Image":this.commonObjs.resolve(c,E);break;default:throw new Error(`Got unknown common object type ${A}`)}}),t.on("obj",([c,A,E,h])=>{var o;if(this.destroyed)return;const i=I(this,k).get(A);if(!i.objs.has(c))switch(E){case"Image":i.objs.resolve(c,h);const m=8e6;if(h){let O;if(h.bitmap){const{bitmap:T,width:y,height:D}=h;O=y*D*4,i._bitmaps.add(T)}else O=((o=h.data)==null?void 0:o.length)||0;O>m&&(i.cleanupAfterRender=!0)}break;case"Pattern":i.objs.resolve(c,h);break;default:throw new Error(`Got unknown object type ${E}`)}}),t.on("DocProgress",c=>{var A;this.destroyed||(A=s.onProgress)==null||A.call(s,{loaded:c.loaded,total:c.total})}),t.on("DocStats",c=>{this.destroyed||ye(this,a,Object.freeze({streamTypes:Object.freeze(c.streamTypes),fontTypes:Object.freeze(c.fontTypes)}))}),t.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),t.on("FetchBuiltInCMap",c=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(c):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),t.on("FetchStandardFontData",c=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(c):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:t}){var s,c;this.destroyed||(c=(s=this.loadingTask).onUnsupportedFeature)==null||c.call(s,t)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const s=t-1,c=I(this,M).get(s);if(c)return c;const A=this.messageHandler.sendWithPromise("GetPage",{pageIndex:s}).then(E=>{if(this.destroyed)throw new Error("Transport destroyed");const h=new PDFPageProxy(s,E,this,this._params.ownerDocument,this._params.pdfBug);return I(this,k).set(s,h),h});return I(this,M).set(s,A),A}getPageIndex(t){return typeof t!="object"||t===null||!Number.isInteger(t.num)||t.num<0||!Number.isInteger(t.gen)||t.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen})}getAnnotations(t,s){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:s})}saveDocument(){var t;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:((t=this._fullReader)==null?void 0:t.filename)??null}).finally(()=>{this.annotationStorage.resetModified()})}getFieldObjects(){return this._getFieldObjectsPromise||(this._getFieldObjectsPromise=this.messageHandler.sendWithPromise("GetFieldObjects",null))}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(t=>new _optional_content_config.OptionalContentConfig(t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return I(this,C)||ye(this,C,this.messageHandler.sendWithPromise("GetMetadata",null).then(t=>{var s,c;return{info:t[0],metadata:t[1]?new _metadata.Metadata(t[1]):null,contentDispositionFilename:((s=this._fullReader)==null?void 0:s.filename)??null,contentLength:((c=this._fullReader)==null?void 0:c.contentLength)??null}}))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(await this.messageHandler.sendWithPromise("Cleanup",null),!this.destroyed){for(const s of I(this,k).values())if(!s.cleanup())throw new Error(`startCleanup: Page ${s.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),ye(this,C,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null}}get loadingParams(){const t=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:t.disableAutoFetch,enableXfa:t.enableXfa})}}a=new WeakMap,k=new WeakMap,M=new WeakMap,C=new WeakMap;class PDFObjects{constructor(){oe(this,p);oe(this,S,Object.create(null))}get(t,s=null){if(s){const A=ue(this,p,lt).call(this,t);return A.capability.promise.then(()=>s(A.data)),null}const c=I(this,S)[t];if(!(c!=null&&c.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${t}.`);return c.data}has(t){const s=I(this,S)[t];return(s==null?void 0:s.capability.settled)||!1}resolve(t,s=null){const c=ue(this,p,lt).call(this,t);c.data=s,c.capability.resolve()}clear(){ye(this,S,Object.create(null))}}S=new WeakMap,p=new WeakSet,lt=function(t){const s=I(this,S)[t];return s||(I(this,S)[t]={capability:(0,_util.createPromiseCapability)(),data:null})};class RenderTask{constructor(t){oe(this,N,null);ye(this,N,t),this.onContinue=null}get promise(){return I(this,N).capability.promise}cancel(){I(this,N).cancel()}get separateAnnots(){const{separateAnnots:t}=I(this,N).operatorList;if(!t)return!1;const{annotationCanvasMap:s}=I(this,N);return t.form||t.canvas&&(s==null?void 0:s.size)>0}}N=new WeakMap,exports.RenderTask=RenderTask;const P=class P{constructor({callback:t,params:s,objs:c,commonObjs:A,annotationCanvasMap:E,operatorList:h,pageIndex:i,canvasFactory:o,useRequestAnimationFrame:m=!1,pdfBug:O=!1,pageColors:T=null}){this.callback=t,this.params=s,this.objs=c,this.commonObjs=A,this.annotationCanvasMap=E,this.operatorListIdx=null,this.operatorList=h,this._pageIndex=i,this.canvasFactory=o,this._pdfBug=O,this.pageColors=T,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=m===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=s.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:s}){var o;if(this.cancelled)return;if(this._canvas){if(I(P,x).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");I(P,x).add(this._canvas)}this._pdfBug&&((o=globalThis.StepperManager)!=null&&o.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:c,viewport:A,transform:E,imageLayer:h,background:i}=this.params;this.gfx=new _canvas.CanvasGraphics(c,this.commonObjs,this.objs,this.canvasFactory,h,s,this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:E,viewport:A,transparency:t,background:i}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(t=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&I(P,x).delete(this._canvas),this.callback(t||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}this.stepper&&this.stepper.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&I(P,x).delete(this._canvas),this.callback())))}};x=new WeakMap,oe(P,x,new WeakSet);let InternalRenderTask=P;const version="2.16.105";exports.version=version;const build="172ccdbe5";exports.build=build},(b,n,_)=>{var S,Tt,R;Object.defineProperty(n,"__esModule",{value:!0}),n.PrintAnnotationStorage=n.AnnotationStorage=void 0;var e=_(1),a=_(6),k=_(10);class M{constructor(){oe(this,S);this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(x,P){const u=this._storage.get(x);return u===void 0?P:Object.assign(P,u)}getRawValue(x){return this._storage.get(x)}remove(x){if(this._storage.delete(x),this._storage.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const P of this._storage.values())if(P instanceof a.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(x,P){const u=this._storage.get(x);let t=!1;if(u!==void 0)for(const[s,c]of Object.entries(P))u[s]!==c&&(t=!0,u[s]=c);else t=!0,this._storage.set(x,P);t&&ue(this,S,Tt).call(this),P instanceof a.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(P.constructor._type)}has(x){return this._storage.has(x)}getAll(){return this._storage.size>0?(0,e.objectFromMap)(this._storage):null}get size(){return this._storage.size}resetModified(){this._modified&&(this._modified=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new C(this)}get serializable(){if(this._storage.size===0)return null;const x=new Map;for(const[P,u]of this._storage){const t=u instanceof a.AnnotationEditor?u.serialize():u;t&&x.set(P,t)}return x}static getHash(x){if(!x)return"";const P=new k.MurmurHash3_64;for(const[u,t]of x)P.update(`${u}:${JSON.stringify(t)}`);return P.hexdigest()}}S=new WeakSet,Tt=function(){this._modified||(this._modified=!0,typeof this.onSetModified=="function"&&this.onSetModified())},n.AnnotationStorage=M;class C extends M{constructor(P){super();oe(this,R,null);ye(this,R,structuredClone(P.serializable))}get print(){(0,e.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return I(this,R)}}R=new WeakMap,n.PrintAnnotationStorage=C},(b,n,_)=>{var M,C,S,p,R,N;Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationEditor=void 0;var e=_(7),a=_(1);const x=class x{constructor(u){oe(this,M,this.focusin.bind(this));oe(this,C,this.focusout.bind(this));oe(this,S,!1);oe(this,p,!1);oe(this,R,!1);oe(this,N,x._zIndex++);this.constructor===x&&(0,a.unreachable)("Cannot initialize AnnotationEditor."),this.parent=u.parent,this.id=u.id,this.width=this.height=null,this.pageIndex=u.parent.pageIndex,this.name=u.name,this.div=null;const[t,s]=this.parent.viewportBaseDimensions;this.x=u.x/t,this.y=u.y/s,this.rotation=this.parent.viewport.rotation,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,a.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=I(this,N)}focusin(u){I(this,S)?ye(this,S,!1):this.parent.setSelected(this)}focusout(u){if(!this.isAttachedToDOM)return;const t=u.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(u.preventDefault(),this.parent.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.parent.addToAnnotationStorage(this)}dragstart(u){const t=this.parent.div.getBoundingClientRect();this.startX=u.clientX-t.x,this.startY=u.clientY-t.y,u.dataTransfer.setData("text/plain",this.id),u.dataTransfer.effectAllowed="move"}setAt(u,t,s,c){const[A,E]=this.parent.viewportBaseDimensions;[s,c]=this.screenToPageTranslation(s,c),this.x=(u+s)/A,this.y=(t+c)/E,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(u,t){const[s,c]=this.parent.viewportBaseDimensions;[u,t]=this.screenToPageTranslation(u,t),this.x+=u/s,this.y+=t/c,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(u,t){const{rotation:s}=this.parent.viewport;switch(s){case 90:return[t,-u];case 180:return[-u,-t];case 270:return[-t,u];default:return[u,t]}}setDims(u,t){const[s,c]=this.parent.viewportBaseDimensions;this.div.style.width=`${100*u/s}%`,this.div.style.height=`${100*t/c}%`}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",I(this,M)),this.div.addEventListener("focusout",I(this,C));const[u,t]=this.getInitialTranslation();return this.translate(u,t),(0,e.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(u){const t=e.KeyboardManager.platform.isMac;if(u.button!==0||u.ctrlKey&&t){u.preventDefault();return}u.ctrlKey&&!t||u.shiftKey||u.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this),ye(this,S,!0)}getRect(u,t){const[s,c]=this.parent.viewportBaseDimensions,[A,E]=this.parent.pageDimensions,h=A*u/s,i=E*t/c,o=this.x*A,m=this.y*E,O=this.width*A,T=this.height*E;switch(this.rotation){case 0:return[o+h,E-m-i-T,o+h+O,E-m-i];case 90:return[o+i,E-m+h,o+i+T,E-m+h+O];case 180:return[o-h-O,E-m+i,o-h,E-m+i+T];case 270:return[o-i-T,E-m-h-O,o-i,E-m-h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(u,t){const[s,c,A,E]=u,h=A-s,i=E-c;switch(this.rotation){case 0:return[s,t-E,h,i];case 90:return[s,t-c,i,h];case 180:return[A,t-c,h,i];case 270:return[A,t-E,i,h];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){ye(this,R,!0)}disableEditMode(){ye(this,R,!1)}isInEditMode(){return I(this,R)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var u;(u=this.div)==null||u.addEventListener("focusin",I(this,M))}serialize(){(0,a.unreachable)("An editor must be serializable")}static deserialize(u,t){const s=new this.prototype.constructor({parent:t,id:t.getNextId()});s.rotation=u.rotation;const[c,A]=t.pageDimensions,[E,h,i,o]=s.getRectInCurrentCoords(u.rect,A);return s.x=E/c,s.y=h/A,s.width=i/c,s.height=o/A,s}remove(){this.div.removeEventListener("focusin",I(this,M)),this.div.removeEventListener("focusout",I(this,C)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var u;(u=this.div)==null||u.classList.add("selectedEditor")}unselect(){var u;(u=this.div)==null||u.classList.remove("selectedEditor")}updateParams(u,t){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return I(this,p)}set isEditing(u){ye(this,p,u),u?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};M=new WeakMap,C=new WeakMap,S=new WeakMap,p=new WeakMap,R=new WeakMap,N=new WeakMap,Me(x,"_colorManager",new e.ColorManager),Me(x,"_zIndex",1);let k=x;n.AnnotationEditor=k},(b,n,_)=>{var P,u,t,s,c,A,Ct,i,m,O,T,y,D,te,se,Z,J,G,V,K,re,he,be,q,f,d,xt,U,ct,W,We,Y,Qe,g,wt,w,Rt,H,ht,de,Ze,le,tt;Object.defineProperty(n,"__esModule",{value:!0}),n.KeyboardManager=n.CommandManager=n.ColorManager=n.AnnotationEditorUIManager=void 0,n.bindEvents=k,n.opacityToHex=M;var e=_(1),a=_(8);function k(pe,j,fe){for(const ve of fe)j.addEventListener(ve,pe[ve].bind(pe))}function M(pe){return Math.round(Math.min(255,Math.max(1,255*pe))).toString(16).padStart(2,"0")}class C{constructor(){oe(this,P,0)}getId(){return`${e.AnnotationEditorPrefix}${ot(this,P)._++}`}}P=new WeakMap;class S{constructor(j=128){oe(this,u,[]);oe(this,t,!1);oe(this,s,void 0);oe(this,c,-1);ye(this,s,j)}add({cmd:j,undo:fe,mustExec:ve,type:Se=NaN,overwriteIfSameType:Pe=!1,keepUndo:xe=!1}){if(ve&&j(),I(this,t))return;const Oe={cmd:j,undo:fe,type:Se};if(I(this,c)===-1){I(this,u).length>0&&(I(this,u).length=0),ye(this,c,0),I(this,u).push(Oe);return}if(Pe&&I(this,u)[I(this,c)].type===Se){xe&&(Oe.undo=I(this,u)[I(this,c)].undo),I(this,u)[I(this,c)]=Oe;return}const Fe=I(this,c)+1;Fe===I(this,s)?I(this,u).splice(0,1):(ye(this,c,Fe),Fe<I(this,u).length&&I(this,u).splice(Fe)),I(this,u).push(Oe)}undo(){I(this,c)!==-1&&(ye(this,t,!0),I(this,u)[I(this,c)].undo(),ye(this,t,!1),ye(this,c,I(this,c)-1))}redo(){I(this,c)<I(this,u).length-1&&(ye(this,c,I(this,c)+1),ye(this,t,!0),I(this,u)[I(this,c)].cmd(),ye(this,t,!1))}hasSomethingToUndo(){return I(this,c)!==-1}hasSomethingToRedo(){return I(this,c)<I(this,u).length-1}destroy(){ye(this,u,null)}}u=new WeakMap,t=new WeakMap,s=new WeakMap,c=new WeakMap,n.CommandManager=S;const h=class h{constructor(j){oe(this,A);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const fe=h.platform.isMac;for(const[ve,Se]of j)for(const Pe of ve){const xe=Pe.startsWith("mac+");fe&&xe?(this.callbacks.set(Pe.slice(4),Se),this.allKeys.add(Pe.split("+").at(-1))):!fe&&!xe&&(this.callbacks.set(Pe,Se),this.allKeys.add(Pe.split("+").at(-1)))}}static get platform(){const j=typeof navigator<"u"?navigator.platform:"";return(0,e.shadow)(this,"platform",{isWin:j.includes("Win"),isMac:j.includes("Mac")})}exec(j,fe){if(!this.allKeys.has(fe.key))return;const ve=this.callbacks.get(ue(this,A,Ct).call(this,fe));ve&&(ve.bind(j)(),fe.stopPropagation(),fe.preventDefault())}};A=new WeakSet,Ct=function(j){j.altKey&&this.buffer.push("alt"),j.ctrlKey&&this.buffer.push("ctrl"),j.metaKey&&this.buffer.push("meta"),j.shiftKey&&this.buffer.push("shift"),this.buffer.push(j.key);const fe=this.buffer.join("+");return this.buffer.length=0,fe};let p=h;n.KeyboardManager=p;class R{constructor(){oe(this,i,null)}copy(j){j&&(Array.isArray(j)?ye(this,i,j.map(fe=>fe.serialize())):ye(this,i,[j.serialize()]),ye(this,i,I(this,i).filter(fe=>!!fe)),I(this,i).length===0&&ye(this,i,null))}paste(){return I(this,i)}isEmpty(){return I(this,i)===null}destroy(){ye(this,i,null)}}i=new WeakMap;const o=class o{get _colors(){const j=new Map([["CanvasText",null],["Canvas",null]]);return(0,a.getColorValues)(j),(0,e.shadow)(this,"_colors",j)}convert(j){const fe=(0,a.getRGB)(j);if(!window.matchMedia("(forced-colors: active)").matches)return fe;for(const[ve,Se]of this._colors)if(Se.every((Pe,xe)=>Pe===fe[xe]))return o._colorsMapping.get(ve);return fe}getHexCode(j){const fe=this._colors.get(j);return fe?e.Util.makeHexColor(...fe):j}};Me(o,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let N=o;n.ColorManager=N;const ce=class ce{constructor(j,fe){oe(this,d);oe(this,U);oe(this,W);oe(this,Y);oe(this,g);oe(this,w);oe(this,H);oe(this,de);oe(this,le);oe(this,m,null);oe(this,O,new Map);oe(this,T,new Map);oe(this,y,new R);oe(this,D,new S);oe(this,te,0);oe(this,se,null);oe(this,Z,null);oe(this,J,new C);oe(this,G,!1);oe(this,V,e.AnnotationEditorType.NONE);oe(this,K,new Set);oe(this,re,this.keydown.bind(this));oe(this,he,this.onEditingAction.bind(this));oe(this,be,this.onPageChanging.bind(this));oe(this,q,{isEditing:!1,isEmpty:!0,hasEmptyClipboard:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});oe(this,f,null);ye(this,f,j),ye(this,Z,fe),I(this,Z)._on("editingaction",I(this,he)),I(this,Z)._on("pagechanging",I(this,be))}destroy(){ue(this,U,ct).call(this),I(this,Z)._off("editingaction",I(this,he)),I(this,Z)._off("pagechanging",I(this,be));for(const j of I(this,T).values())j.destroy();I(this,T).clear(),I(this,O).clear(),ye(this,m,null),I(this,K).clear(),I(this,y).destroy(),I(this,D).destroy()}onPageChanging({pageNumber:j}){ye(this,te,j-1)}focusMainContainer(){I(this,f).focus()}keydown(j){var fe;(fe=this.getActive())!=null&&fe.shouldGetKeyboardEvents()||ce._keyboardManager.exec(this,j)}onEditingAction(j){["undo","redo","cut","copy","paste","delete","selectAll"].includes(j.name)&&this[j.name]()}setEditingState(j){j?(ue(this,d,xt).call(this),ue(this,W,We).call(this,{isEditing:I(this,V)!==e.AnnotationEditorType.NONE,isEmpty:ue(this,de,Ze).call(this),hasSomethingToUndo:I(this,D).hasSomethingToUndo(),hasSomethingToRedo:I(this,D).hasSomethingToRedo(),hasSelectedEditor:!1,hasEmptyClipboard:I(this,y).isEmpty()})):(ue(this,U,ct).call(this),ue(this,W,We).call(this,{isEditing:!1}))}registerEditorTypes(j){ye(this,se,j);for(const fe of I(this,se))ue(this,Y,Qe).call(this,fe.defaultPropertiesToUpdate)}getId(){return I(this,J).getId()}addLayer(j){I(this,T).set(j.pageIndex,j),I(this,G)?j.enable():j.disable()}removeLayer(j){I(this,T).delete(j.pageIndex)}updateMode(j){if(ye(this,V,j),j===e.AnnotationEditorType.NONE)this.setEditingState(!1),ue(this,w,Rt).call(this);else{this.setEditingState(!0),ue(this,g,wt).call(this);for(const fe of I(this,T).values())fe.updateMode(j)}}updateToolbar(j){j!==I(this,V)&&I(this,Z).dispatch("switchannotationeditormode",{source:this,mode:j})}updateParams(j,fe){for(const ve of I(this,K))ve.updateParams(j,fe);for(const ve of I(this,se))ve.updateDefaultParams(j,fe)}getEditors(j){const fe=[];for(const ve of I(this,O).values())ve.pageIndex===j&&fe.push(ve);return fe}getEditor(j){return I(this,O).get(j)}addEditor(j){I(this,O).set(j.id,j)}removeEditor(j){I(this,O).delete(j.id),this.unselect(j)}setActiveEditor(j){I(this,m)!==j&&(ye(this,m,j),j&&ue(this,Y,Qe).call(this,j.propertiesToUpdate))}toggleSelected(j){if(I(this,K).has(j)){I(this,K).delete(j),j.unselect(),ue(this,W,We).call(this,{hasSelectedEditor:this.hasSelection});return}I(this,K).add(j),j.select(),ue(this,Y,Qe).call(this,j.propertiesToUpdate),ue(this,W,We).call(this,{hasSelectedEditor:!0})}setSelected(j){for(const fe of I(this,K))fe!==j&&fe.unselect();I(this,K).clear(),I(this,K).add(j),j.select(),ue(this,Y,Qe).call(this,j.propertiesToUpdate),ue(this,W,We).call(this,{hasSelectedEditor:!0})}isSelected(j){return I(this,K).has(j)}unselect(j){j.unselect(),I(this,K).delete(j),ue(this,W,We).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return I(this,K).size!==0}undo(){I(this,D).undo(),ue(this,W,We).call(this,{hasSomethingToUndo:I(this,D).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:ue(this,de,Ze).call(this)})}redo(){I(this,D).redo(),ue(this,W,We).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:I(this,D).hasSomethingToRedo(),isEmpty:ue(this,de,Ze).call(this)})}addCommands(j){I(this,D).add(j),ue(this,W,We).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:ue(this,de,Ze).call(this)})}delete(){if(I(this,m)&&I(this,m).commitOrRemove(),!this.hasSelection)return;const j=[...I(this,K)],fe=()=>{for(const Se of j)Se.remove()},ve=()=>{for(const Se of j)ue(this,H,ht).call(this,Se)};this.addCommands({cmd:fe,undo:ve,mustExec:!0})}copy(){if(I(this,m)&&I(this,m).commitOrRemove(),this.hasSelection){const j=[];for(const fe of I(this,K))fe.isEmpty()||j.push(fe);if(j.length===0)return;I(this,y).copy(j),ue(this,W,We).call(this,{hasEmptyClipboard:!1})}}cut(){this.copy(),this.delete()}paste(){if(I(this,y).isEmpty())return;this.unselectAll();const j=I(this,T).get(I(this,te)),fe=I(this,y).paste().map(Pe=>j.deserialize(Pe)),ve=()=>{for(const Pe of fe)ue(this,H,ht).call(this,Pe);ue(this,le,tt).call(this,fe)},Se=()=>{for(const Pe of fe)Pe.remove()};this.addCommands({cmd:ve,undo:Se,mustExec:!0})}selectAll(){for(const j of I(this,K))j.commit();ue(this,le,tt).call(this,I(this,O).values())}unselectAll(){if(I(this,m)){I(this,m).commitOrRemove();return}if(ue(this,le,tt).size!==0){for(const j of I(this,K))j.unselect();I(this,K).clear(),ue(this,W,We).call(this,{hasSelectedEditor:!1})}}isActive(j){return I(this,m)===j}getActive(){return I(this,m)}getMode(){return I(this,V)}};m=new WeakMap,O=new WeakMap,T=new WeakMap,y=new WeakMap,D=new WeakMap,te=new WeakMap,se=new WeakMap,Z=new WeakMap,J=new WeakMap,G=new WeakMap,V=new WeakMap,K=new WeakMap,re=new WeakMap,he=new WeakMap,be=new WeakMap,q=new WeakMap,f=new WeakMap,d=new WeakSet,xt=function(){I(this,f).addEventListener("keydown",I(this,re))},U=new WeakSet,ct=function(){I(this,f).removeEventListener("keydown",I(this,re))},W=new WeakSet,We=function(j){Object.entries(j).some(([ve,Se])=>I(this,q)[ve]!==Se)&&I(this,Z).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(I(this,q),j)})},Y=new WeakSet,Qe=function(j){I(this,Z).dispatch("annotationeditorparamschanged",{source:this,details:j})},g=new WeakSet,wt=function(){if(!I(this,G)){ye(this,G,!0);for(const j of I(this,T).values())j.enable()}},w=new WeakSet,Rt=function(){if(this.unselectAll(),I(this,G)){ye(this,G,!1);for(const j of I(this,T).values())j.disable()}},H=new WeakSet,ht=function(j){const fe=I(this,T).get(j.pageIndex);fe?fe.addOrRebuild(j):this.addEditor(j)},de=new WeakSet,Ze=function(){if(I(this,O).size===0)return!0;if(I(this,O).size===1)for(const j of I(this,O).values())return j.isEmpty();return!1},le=new WeakSet,tt=function(j){I(this,K).clear();for(const fe of j)fe.isEmpty()||(I(this,K).add(fe),fe.select());ue(this,W,We).call(this,{hasSelectedEditor:!0})},Me(ce,"_keyboardManager",new p([[["ctrl+a","mac+meta+a"],ce.prototype.selectAll],[["ctrl+c","mac+meta+c"],ce.prototype.copy],[["ctrl+v","mac+meta+v"],ce.prototype.paste],[["ctrl+x","mac+meta+x"],ce.prototype.cut],[["ctrl+z","mac+meta+z"],ce.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],ce.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],ce.prototype.delete],[["Escape","mac+Escape"],ce.prototype.unselectAll]]));let x=ce;n.AnnotationEditorUIManager=x},(b,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.StatTimer=n.RenderingCancelledException=n.PixelsPerInch=n.PageViewport=n.PDFDateString=n.DOMStandardFontDataFactory=n.DOMSVGFactory=n.DOMCanvasFactory=n.DOMCMapReaderFactory=n.AnnotationPrefix=void 0,n.deprecated=o,n.getColorValues=D,n.getCurrentTransform=te,n.getCurrentTransformInverse=se,n.getFilenameFromUrl=c,n.getPdfFilenameFromUrl=A,n.getRGB=y,n.getXfaPageViewport=T,n.isDataScheme=t,n.isPdfFile=s,n.isValidFetchUrl=h,n.loadScript=i;var e=_(9),a=_(1);const k="http://www.w3.org/2000/svg",M="pdfjs_internal_id_";n.AnnotationPrefix=M;const Z=class Z{};Me(Z,"CSS",96),Me(Z,"PDF",72),Me(Z,"PDF_TO_CSS_UNITS",Z.CSS/Z.PDF);let C=Z;n.PixelsPerInch=C;class S extends e.BaseCanvasFactory{constructor({ownerDocument:G=globalThis.document}={}){super(),this._document=G}_createCanvas(G,V){const K=this._document.createElement("canvas");return K.width=G,K.height=V,K}}n.DOMCanvasFactory=S;async function p(J,G=!1){if(h(J,document.baseURI)){const V=await fetch(J);if(!V.ok)throw new Error(V.statusText);return G?new Uint8Array(await V.arrayBuffer()):(0,a.stringToBytes)(await V.text())}return new Promise((V,K)=>{const re=new XMLHttpRequest;re.open("GET",J,!0),G&&(re.responseType="arraybuffer"),re.onreadystatechange=()=>{if(re.readyState===XMLHttpRequest.DONE){if(re.status===200||re.status===0){let he;if(G&&re.response?he=new Uint8Array(re.response):!G&&re.responseText&&(he=(0,a.stringToBytes)(re.responseText)),he){V(he);return}}K(new Error(re.statusText))}},re.send(null)})}class R extends e.BaseCMapReaderFactory{_fetchData(G,V){return p(G,this.isCompressed).then(K=>({cMapData:K,compressionType:V}))}}n.DOMCMapReaderFactory=R;class N extends e.BaseStandardFontDataFactory{_fetchData(G){return p(G,!0)}}n.DOMStandardFontDataFactory=N;class x extends e.BaseSVGFactory{_createSVG(G){return document.createElementNS(k,G)}}n.DOMSVGFactory=x;class P{constructor({viewBox:G,scale:V,rotation:K,offsetX:re=0,offsetY:he=0,dontFlip:be=!1}){this.viewBox=G,this.scale=V,this.rotation=K,this.offsetX=re,this.offsetY=he;const q=(G[2]+G[0])/2,f=(G[3]+G[1])/2;let d,F,U,B;switch(K%=360,K<0&&(K+=360),K){case 180:d=-1,F=0,U=0,B=1;break;case 90:d=0,F=1,U=1,B=0;break;case 270:d=0,F=-1,U=-1,B=0;break;case 0:d=1,F=0,U=0,B=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}be&&(U=-U,B=-B);let W,X,Y,l;d===0?(W=Math.abs(f-G[1])*V+re,X=Math.abs(q-G[0])*V+he,Y=Math.abs(G[3]-G[1])*V,l=Math.abs(G[2]-G[0])*V):(W=Math.abs(q-G[0])*V+re,X=Math.abs(f-G[1])*V+he,Y=Math.abs(G[2]-G[0])*V,l=Math.abs(G[3]-G[1])*V),this.transform=[d*V,F*V,U*V,B*V,W-d*V*q-U*V*f,X-F*V*q-B*V*f],this.width=Y,this.height=l}clone({scale:G=this.scale,rotation:V=this.rotation,offsetX:K=this.offsetX,offsetY:re=this.offsetY,dontFlip:he=!1}={}){return new P({viewBox:this.viewBox.slice(),scale:G,rotation:V,offsetX:K,offsetY:re,dontFlip:he})}convertToViewportPoint(G,V){return a.Util.applyTransform([G,V],this.transform)}convertToViewportRectangle(G){const V=a.Util.applyTransform([G[0],G[1]],this.transform),K=a.Util.applyTransform([G[2],G[3]],this.transform);return[V[0],V[1],K[0],K[1]]}convertToPdfPoint(G,V){return a.Util.applyInverseTransform([G,V],this.transform)}}n.PageViewport=P;class u extends a.BaseException{constructor(G,V){super(G,"RenderingCancelledException"),this.type=V}}n.RenderingCancelledException=u;function t(J){const G=J.length;let V=0;for(;V<G&&J[V].trim()==="";)V++;return J.substring(V,V+5).toLowerCase()==="data:"}function s(J){return typeof J=="string"&&/\.pdf$/i.test(J)}function c(J){const G=J.indexOf("#"),V=J.indexOf("?"),K=Math.min(G>0?G:J.length,V>0?V:J.length);return J.substring(J.lastIndexOf("/",K)+1,K)}function A(J,G="document.pdf"){if(typeof J!="string")return G;if(t(J))return(0,a.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),G;const V=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,K=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,re=V.exec(J);let he=K.exec(re[1])||K.exec(re[2])||K.exec(re[3]);if(he&&(he=he[0],he.includes("%")))try{he=K.exec(decodeURIComponent(he))[0]}catch{}return he||G}class E{constructor(){this.started=Object.create(null),this.times=[]}time(G){G in this.started&&(0,a.warn)(`Timer is already running for ${G}`),this.started[G]=Date.now()}timeEnd(G){G in this.started||(0,a.warn)(`Timer has not been started for ${G}`),this.times.push({name:G,start:this.started[G],end:Date.now()}),delete this.started[G]}toString(){const G=[];let V=0;for(const K of this.times){const re=K.name;re.length>V&&(V=re.length)}for(const K of this.times){const re=K.end-K.start;G.push(`${K.name.padEnd(V)} ${re}ms
`)}return G.join("")}}n.StatTimer=E;function h(J,G){try{const{protocol:V}=G?new URL(J,G):new URL(J);return V==="http:"||V==="https:"}catch{return!1}}function i(J,G=!1){return new Promise((V,K)=>{const re=document.createElement("script");re.src=J,re.onload=function(he){G&&re.remove(),V(he)},re.onerror=function(){K(new Error(`Cannot load script at: ${re.src}`))},(document.head||document.documentElement).append(re)})}function o(J){console.log("Deprecated API usage: "+J)}let m;class O{static toDateObject(G){if(!G||typeof G!="string")return null;m||(m=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const V=m.exec(G);if(!V)return null;const K=parseInt(V[1],10);let re=parseInt(V[2],10);re=re>=1&&re<=12?re-1:0;let he=parseInt(V[3],10);he=he>=1&&he<=31?he:1;let be=parseInt(V[4],10);be=be>=0&&be<=23?be:0;let q=parseInt(V[5],10);q=q>=0&&q<=59?q:0;let f=parseInt(V[6],10);f=f>=0&&f<=59?f:0;const d=V[7]||"Z";let F=parseInt(V[8],10);F=F>=0&&F<=23?F:0;let U=parseInt(V[9],10)||0;return U=U>=0&&U<=59?U:0,d==="-"?(be+=F,q+=U):d==="+"&&(be-=F,q-=U),new Date(Date.UTC(K,re,he,be,q,f))}}n.PDFDateString=O;function T(J,{scale:G=1,rotation:V=0}){const{width:K,height:re}=J.attributes.style,he=[0,0,parseInt(K),parseInt(re)];return new P({viewBox:he,scale:G,rotation:V})}function y(J){if(J.startsWith("#")){const G=parseInt(J.slice(1),16);return[(G&16711680)>>16,(G&65280)>>8,G&255]}return J.startsWith("rgb(")?J.slice(4,-1).split(",").map(G=>parseInt(G)):J.startsWith("rgba(")?J.slice(5,-1).split(",").map(G=>parseInt(G)).slice(0,3):((0,a.warn)(`Not a valid color format: "${J}"`),[0,0,0])}function D(J){const G=document.createElement("span");G.style.visibility="hidden",document.body.append(G);for(const V of J.keys()){G.style.color=V;const K=window.getComputedStyle(G).color;J.set(V,y(K))}G.remove()}function te(J){const{a:G,b:V,c:K,d:re,e:he,f:be}=J.getTransform();return[G,V,K,re,he,be]}function se(J){const{a:G,b:V,c:K,d:re,e:he,f:be}=J.getTransform().invertSelf();return[G,V,K,re,he,be]}},(b,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BaseStandardFontDataFactory=n.BaseSVGFactory=n.BaseCanvasFactory=n.BaseCMapReaderFactory=void 0;var e=_(1);class a{constructor(){this.constructor===a&&(0,e.unreachable)("Cannot initialize BaseCanvasFactory.")}create(p,R){if(p<=0||R<=0)throw new Error("Invalid canvas size");const N=this._createCanvas(p,R);return{canvas:N,context:N.getContext("2d")}}reset(p,R,N){if(!p.canvas)throw new Error("Canvas is not specified");if(R<=0||N<=0)throw new Error("Invalid canvas size");p.canvas.width=R,p.canvas.height=N}destroy(p){if(!p.canvas)throw new Error("Canvas is not specified");p.canvas.width=0,p.canvas.height=0,p.canvas=null,p.context=null}_createCanvas(p,R){(0,e.unreachable)("Abstract method `_createCanvas` called.")}}n.BaseCanvasFactory=a;class k{constructor({baseUrl:p=null,isCompressed:R=!1}){this.constructor===k&&(0,e.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=p,this.isCompressed=R}async fetch({name:p}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!p)throw new Error("CMap name must be specified.");const R=this.baseUrl+p+(this.isCompressed?".bcmap":""),N=this.isCompressed?e.CMapCompressionType.BINARY:e.CMapCompressionType.NONE;return this._fetchData(R,N).catch(x=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${R}`)})}_fetchData(p,R){(0,e.unreachable)("Abstract method `_fetchData` called.")}}n.BaseCMapReaderFactory=k;class M{constructor({baseUrl:p=null}){this.constructor===M&&(0,e.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=p}async fetch({filename:p}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!p)throw new Error("Font filename must be specified.");const R=`${this.baseUrl}${p}`;return this._fetchData(R).catch(N=>{throw new Error(`Unable to load font data at: ${R}`)})}_fetchData(p){(0,e.unreachable)("Abstract method `_fetchData` called.")}}n.BaseStandardFontDataFactory=M;class C{constructor(){this.constructor===C&&(0,e.unreachable)("Cannot initialize BaseSVGFactory.")}create(p,R,N=!1){if(p<=0||R<=0)throw new Error("Invalid SVG dimensions");const x=this._createSVG("svg:svg");return x.setAttribute("version","1.1"),N||(x.setAttribute("width",`${p}px`),x.setAttribute("height",`${R}px`)),x.setAttribute("preserveAspectRatio","none"),x.setAttribute("viewBox",`0 0 ${p} ${R}`),x}createElement(p){if(typeof p!="string")throw new Error("Invalid SVG element type");return this._createSVG(p)}_createSVG(p){(0,e.unreachable)("Abstract method `_createSVG` called.")}}n.BaseSVGFactory=C},(b,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.MurmurHash3_64=void 0;var e=_(1);const a=3285377520,k=4294901760,M=65535;class C{constructor(p){this.h1=p?p&4294967295:a,this.h2=p?p&4294967295:a}update(p){let R,N;if(typeof p=="string"){R=new Uint8Array(p.length*2),N=0;for(let m=0,O=p.length;m<O;m++){const T=p.charCodeAt(m);T<=255?R[N++]=T:(R[N++]=T>>>8,R[N++]=T&255)}}else if((0,e.isArrayBuffer)(p))R=p.slice(),N=R.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const x=N>>2,P=N-x*4,u=new Uint32Array(R.buffer,0,x);let t=0,s=0,c=this.h1,A=this.h2;const E=3432918353,h=461845907,i=E&M,o=h&M;for(let m=0;m<x;m++)m&1?(t=u[m],t=t*E&k|t*i&M,t=t<<15|t>>>17,t=t*h&k|t*o&M,c^=t,c=c<<13|c>>>19,c=c*5+3864292196):(s=u[m],s=s*E&k|s*i&M,s=s<<15|s>>>17,s=s*h&k|s*o&M,A^=s,A=A<<13|A>>>19,A=A*5+3864292196);switch(t=0,P){case 3:t^=R[x*4+2]<<16;case 2:t^=R[x*4+1]<<8;case 1:t^=R[x*4],t=t*E&k|t*i&M,t=t<<15|t>>>17,t=t*h&k|t*o&M,x&1?c^=t:A^=t}this.h1=c,this.h2=A}hexdigest(){let p=this.h1,R=this.h2;p^=R>>>1,p=p*3981806797&k|p*36045&M,R=R*4283543511&k|((R<<16|p>>>16)*2950163797&k)>>>16,p^=R>>>1,p=p*444984403&k|p*60499&M,R=R*3301882366&k|((R<<16|p>>>16)*3120437893&k)>>>16,p^=R>>>1;const N=(p>>>0).toString(16),x=(R>>>0).toString(16);return N.padStart(8,"0")+x.padStart(8,"0")}}n.MurmurHash3_64=C},(b,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.FontLoader=n.FontFaceObject=void 0;var e=_(1);class a{constructor({docId:S,onUnsupportedFeature:p,ownerDocument:R=globalThis.document,styleElement:N=null}){this.constructor===a&&(0,e.unreachable)("Cannot initialize BaseFontLoader."),this.docId=S,this._onUnsupportedFeature=p,this._document=R,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(S){this.nativeFontFaces.push(S),this._document.fonts.add(S)}insertRule(S){let p=this.styleElement;p||(p=this.styleElement=this._document.createElement("style"),p.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].append(p));const R=p.sheet;R.insertRule(S,R.cssRules.length)}clear(){for(const S of this.nativeFontFaces)this._document.fonts.delete(S);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(S){if(S.attached||S.missingFile)return;if(S.attached=!0,this.isFontLoadingAPISupported){const R=S.createNativeFontFace();if(R){this.addNativeFontFace(R);try{await R.loaded}catch(N){throw this._onUnsupportedFeature({featureId:e.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,e.warn)(`Failed to load font '${R.family}': '${N}'.`),S.disableFontFace=!0,N}}return}const p=S.createFontFaceRule();if(p){if(this.insertRule(p),this.isSyncFontLoadingSupported)return;await new Promise(R=>{const N=this._queueLoadingCallback(R);this._prepareFontLoadEvent([p],[S],N)})}}_queueLoadingCallback(S){(0,e.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){var p;const S=!!((p=this._document)!=null&&p.fonts);return(0,e.shadow)(this,"isFontLoadingAPISupported",S)}get isSyncFontLoadingSupported(){(0,e.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,e.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(S,p,R){(0,e.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let k;n.FontLoader=k,n.FontLoader=k=class extends a{constructor(S){super(S),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let S=!1;if(typeof navigator>"u")S=!0;else{const p=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);(p==null?void 0:p[1])>=14&&(S=!0)}return(0,e.shadow)(this,"isSyncFontLoadingSupported",S)}_queueLoadingCallback(S){function p(){for((0,e.assert)(!N.done,"completeRequest() cannot be called twice."),N.done=!0;R.requests.length>0&&R.requests[0].done;){const x=R.requests.shift();setTimeout(x.callback,0)}}const R=this.loadingContext,N={id:`pdfjs-font-loading-${R.nextRequestId++}`,done:!1,complete:p,callback:S};return R.requests.push(N),N}get _loadTestFont(){const S=function(){return atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==")};return(0,e.shadow)(this,"_loadTestFont",S())}_prepareFontLoadEvent(S,p,R){function N(se,Z){return se.charCodeAt(Z)<<24|se.charCodeAt(Z+1)<<16|se.charCodeAt(Z+2)<<8|se.charCodeAt(Z+3)&255}function x(se,Z,J,G){const V=se.substring(0,Z),K=se.substring(Z+J);return V+G+K}let P,u;const t=this._document.createElement("canvas");t.width=1,t.height=1;const s=t.getContext("2d");let c=0;function A(se,Z){if(c++,c>30){(0,e.warn)("Load test font never loaded."),Z();return}if(s.font="30px "+se,s.fillText(".",0,20),s.getImageData(0,0,1,1).data[3]>0){Z();return}setTimeout(A.bind(null,se,Z))}const E=`lt${Date.now()}${this.loadTestFontId++}`;let h=this._loadTestFont;h=x(h,976,E.length,E);const o=16,m=1482184792;let O=N(h,o);for(P=0,u=E.length-3;P<u;P+=4)O=O-m+N(E,P)|0;P<E.length&&(O=O-m+N(E+"XXX",P)|0),h=x(h,o,4,(0,e.string32)(O));const T=`url(data:font/opentype;base64,${btoa(h)});`,y=`@font-face {font-family:"${E}";src:${T}}`;this.insertRule(y);const D=[];for(const se of p)D.push(se.loadedName);D.push(E);const te=this._document.createElement("div");te.style.visibility="hidden",te.style.width=te.style.height="10px",te.style.position="absolute",te.style.top=te.style.left="0px";for(const se of D){const Z=this._document.createElement("span");Z.textContent="Hi",Z.style.fontFamily=se,te.append(Z)}this._document.body.append(te),A(E,()=>{te.remove(),R.complete()})}};class M{constructor(S,{isEvalSupported:p=!0,disableFontFace:R=!1,ignoreErrors:N=!1,onUnsupportedFeature:x,fontRegistry:P=null}){this.compiledGlyphs=Object.create(null);for(const u in S)this[u]=S[u];this.isEvalSupported=p!==!1,this.disableFontFace=R===!0,this.ignoreErrors=N===!0,this._onUnsupportedFeature=x,this.fontRegistry=P}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let S;if(!this.cssFontInfo)S=new FontFace(this.loadedName,this.data,{});else{const p={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(p.style=`oblique ${this.cssFontInfo.italicAngle}deg`),S=new FontFace(this.cssFontInfo.fontFamily,this.data,p)}return this.fontRegistry&&this.fontRegistry.registerFont(this),S}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const S=(0,e.bytesToString)(this.data),p=`url(data:${this.mimetype};base64,${btoa(S)});`;let R;if(!this.cssFontInfo)R=`@font-face {font-family:"${this.loadedName}";src:${p}}`;else{let N=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(N+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),R=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${N}src:${p}}`}return this.fontRegistry&&this.fontRegistry.registerFont(this,p),R}getPathGenerator(S,p){if(this.compiledGlyphs[p]!==void 0)return this.compiledGlyphs[p];let R;try{R=S.get(this.loadedName+"_path_"+p)}catch(N){if(!this.ignoreErrors)throw N;return this._onUnsupportedFeature({featureId:e.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,e.warn)(`getPathGenerator - ignoring character: "${N}".`),this.compiledGlyphs[p]=function(x,P){}}if(this.isEvalSupported&&e.FeatureTest.isEvalSupported){const N=[];for(const x of R){const P=x.args!==void 0?x.args.join(","):"";N.push("c.",x.cmd,"(",P,`);
`)}return this.compiledGlyphs[p]=new Function("c","size",N.join(""))}return this.compiledGlyphs[p]=function(N,x){for(const P of R)P.cmd==="scale"&&(P.args=[x,-x]),N[P.cmd].apply(N,P.args)}}}n.FontFaceObject=M},(b,n,_)=>{var re,ut;Object.defineProperty(n,"__esModule",{value:!0}),n.CanvasGraphics=void 0;var e=_(8),a=_(1),k=_(13),M=_(14),C=_(3);const S=16,p=100,R=4096,N=15,x=10,P=C.isNodeJS&&typeof Path2D>"u"?-1:1e3,u=16;function t(q,f){if(q._removeMirroring)throw new Error("Context is already forwarding operations.");q.__originalSave=q.save,q.__originalRestore=q.restore,q.__originalRotate=q.rotate,q.__originalScale=q.scale,q.__originalTranslate=q.translate,q.__originalTransform=q.transform,q.__originalSetTransform=q.setTransform,q.__originalResetTransform=q.resetTransform,q.__originalClip=q.clip,q.__originalMoveTo=q.moveTo,q.__originalLineTo=q.lineTo,q.__originalBezierCurveTo=q.bezierCurveTo,q.__originalRect=q.rect,q.__originalClosePath=q.closePath,q.__originalBeginPath=q.beginPath,q._removeMirroring=()=>{q.save=q.__originalSave,q.restore=q.__originalRestore,q.rotate=q.__originalRotate,q.scale=q.__originalScale,q.translate=q.__originalTranslate,q.transform=q.__originalTransform,q.setTransform=q.__originalSetTransform,q.resetTransform=q.__originalResetTransform,q.clip=q.__originalClip,q.moveTo=q.__originalMoveTo,q.lineTo=q.__originalLineTo,q.bezierCurveTo=q.__originalBezierCurveTo,q.rect=q.__originalRect,q.closePath=q.__originalClosePath,q.beginPath=q.__originalBeginPath,delete q._removeMirroring},q.save=function(){f.save(),this.__originalSave()},q.restore=function(){f.restore(),this.__originalRestore()},q.translate=function(F,U){f.translate(F,U),this.__originalTranslate(F,U)},q.scale=function(F,U){f.scale(F,U),this.__originalScale(F,U)},q.transform=function(F,U,B,W,X,Y){f.transform(F,U,B,W,X,Y),this.__originalTransform(F,U,B,W,X,Y)},q.setTransform=function(F,U,B,W,X,Y){f.setTransform(F,U,B,W,X,Y),this.__originalSetTransform(F,U,B,W,X,Y)},q.resetTransform=function(){f.resetTransform(),this.__originalResetTransform()},q.rotate=function(F){f.rotate(F),this.__originalRotate(F)},q.clip=function(F){f.clip(F),this.__originalClip(F)},q.moveTo=function(d,F){f.moveTo(d,F),this.__originalMoveTo(d,F)},q.lineTo=function(d,F){f.lineTo(d,F),this.__originalLineTo(d,F)},q.bezierCurveTo=function(d,F,U,B,W,X){f.bezierCurveTo(d,F,U,B,W,X),this.__originalBezierCurveTo(d,F,U,B,W,X)},q.rect=function(d,F,U,B){f.rect(d,F,U,B),this.__originalRect(d,F,U,B)},q.closePath=function(){f.closePath(),this.__originalClosePath()},q.beginPath=function(){f.beginPath(),this.__originalBeginPath()}}class s{constructor(f){this.canvasFactory=f,this.cache=Object.create(null)}getCanvas(f,d,F){let U;return this.cache[f]!==void 0?(U=this.cache[f],this.canvasFactory.reset(U,d,F)):(U=this.canvasFactory.create(d,F),this.cache[f]=U),U}delete(f){delete this.cache[f]}clear(){for(const f in this.cache){const d=this.cache[f];this.canvasFactory.destroy(d),delete this.cache[f]}}}function c(q,f,d,F,U,B,W,X,Y,l){const[g,v,w,L,H,ie]=(0,e.getCurrentTransform)(q);if(v===0&&w===0){const le=W*g+H,ne=Math.round(le),ce=X*L+ie,pe=Math.round(ce),j=(W+Y)*g+H,fe=Math.abs(Math.round(j)-ne)||1,ve=(X+l)*L+ie,Se=Math.abs(Math.round(ve)-pe)||1;return q.setTransform(Math.sign(g),0,0,Math.sign(L),ne,pe),q.drawImage(f,d,F,U,B,0,0,fe,Se),q.setTransform(g,v,w,L,H,ie),[fe,Se]}if(g===0&&L===0){const le=X*w+H,ne=Math.round(le),ce=W*v+ie,pe=Math.round(ce),j=(X+l)*w+H,fe=Math.abs(Math.round(j)-ne)||1,ve=(W+Y)*v+ie,Se=Math.abs(Math.round(ve)-pe)||1;return q.setTransform(0,Math.sign(v),Math.sign(w),0,ne,pe),q.drawImage(f,d,F,U,B,0,0,Se,fe),q.setTransform(g,v,w,L,H,ie),[Se,fe]}q.drawImage(f,d,F,U,B,W,X,Y,l);const de=Math.hypot(g,v),ee=Math.hypot(w,L);return[de*Y,ee*l]}function A(q){const{width:f,height:d}=q;if(f>P||d>P)return null;const F=1e3,U=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),B=f+1;let W=new Uint8Array(B*(d+1)),X,Y,l;const g=f+7&-8;let v=new Uint8Array(g*d),w=0;for(const ee of q.data){let le=128;for(;le>0;)v[w++]=ee&le?0:255,le>>=1}let L=0;for(w=0,v[w]!==0&&(W[0]=1,++L),Y=1;Y<f;Y++)v[w]!==v[w+1]&&(W[Y]=v[w]?2:1,++L),w++;for(v[w]!==0&&(W[Y]=2,++L),X=1;X<d;X++){w=X*g,l=X*B,v[w-g]!==v[w]&&(W[l]=v[w]?1:8,++L);let ee=(v[w]?4:0)+(v[w-g]?8:0);for(Y=1;Y<f;Y++)ee=(ee>>2)+(v[w+1]?4:0)+(v[w-g+1]?8:0),U[ee]&&(W[l+Y]=U[ee],++L),w++;if(v[w-g]!==v[w]&&(W[l+Y]=v[w]?2:4,++L),L>F)return null}for(w=g*(d-1),l=X*B,v[w]!==0&&(W[l]=8,++L),Y=1;Y<f;Y++)v[w]!==v[w+1]&&(W[l+Y]=v[w]?4:8,++L),w++;if(v[w]!==0&&(W[l+Y]=4,++L),L>F)return null;const H=new Int32Array([0,B,-1,0,-B,0,0,0,1]),ie=new Path2D;for(X=0;L&&X<=d;X++){let ee=X*B;const le=ee+f;for(;ee<le&&!W[ee];)ee++;if(ee===le)continue;ie.moveTo(ee%B,X);const ne=ee;let ce=W[ee];do{const pe=H[ce];do ee+=pe;while(!W[ee]);const j=W[ee];j!==5&&j!==10?(ce=j,W[ee]=0):(ce=j&51*ce>>4,W[ee]&=ce>>2|ce<<2),ie.lineTo(ee%B,ee/B|0),W[ee]||--L}while(ne!==ee);--X}return v=null,W=null,function(ee){ee.save(),ee.scale(1/f,-1/d),ee.translate(0,-d),ee.fill(ie),ee.beginPath(),ee.restore()}}class E{constructor(f,d){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=a.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=a.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=a.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,f,d])}clone(){const f=Object.create(this);return f.clipBox=this.clipBox.slice(),f}setCurrentPoint(f,d){this.x=f,this.y=d}updatePathMinMax(f,d,F){[d,F]=a.Util.applyTransform([d,F],f),this.minX=Math.min(this.minX,d),this.minY=Math.min(this.minY,F),this.maxX=Math.max(this.maxX,d),this.maxY=Math.max(this.maxY,F)}updateRectMinMax(f,d){const F=a.Util.applyTransform(d,f),U=a.Util.applyTransform(d.slice(2),f);this.minX=Math.min(this.minX,F[0],U[0]),this.minY=Math.min(this.minY,F[1],U[1]),this.maxX=Math.max(this.maxX,F[0],U[0]),this.maxY=Math.max(this.maxY,F[1],U[1])}updateScalingPathMinMax(f,d){a.Util.scaleMinMax(f,d),this.minX=Math.min(this.minX,d[0]),this.maxX=Math.max(this.maxX,d[1]),this.minY=Math.min(this.minY,d[2]),this.maxY=Math.max(this.maxY,d[3])}updateCurvePathMinMax(f,d,F,U,B,W,X,Y,l,g){const v=a.Util.bezierBoundingBox(d,F,U,B,W,X,Y,l);if(g){g[0]=Math.min(g[0],v[0],v[2]),g[1]=Math.max(g[1],v[0],v[2]),g[2]=Math.min(g[2],v[1],v[3]),g[3]=Math.max(g[3],v[1],v[3]);return}this.updateRectMinMax(f,v)}getPathBoundingBox(f=k.PathType.FILL,d=null){const F=[this.minX,this.minY,this.maxX,this.maxY];if(f===k.PathType.STROKE){d||(0,a.unreachable)("Stroke bounding box must include transform.");const U=a.Util.singularValueDecompose2dScale(d),B=U[0]*this.lineWidth/2,W=U[1]*this.lineWidth/2;F[0]-=B,F[1]-=W,F[2]+=B,F[3]+=W}return F}updateClipFromPath(){const f=a.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(f||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(f){this.clipBox=f,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(f=k.PathType.FILL,d=null){return a.Util.intersect(this.clipBox,this.getPathBoundingBox(f,d))}}function h(q,f,d=null){if(typeof ImageData<"u"&&f instanceof ImageData){q.putImageData(f,0,0);return}const F=f.height,U=f.width,B=F%u,W=(F-B)/u,X=B===0?W:W+1,Y=q.createImageData(U,u);let l=0,g;const v=f.data,w=Y.data;let L,H,ie,de,ee,le,ne,ce;if(d)switch(d.length){case 1:ee=d[0],le=d[0],ne=d[0],ce=d[0];break;case 4:ee=d[0],le=d[1],ne=d[2],ce=d[3];break}if(f.kind===a.ImageKind.GRAYSCALE_1BPP){const pe=v.byteLength,j=new Uint32Array(w.buffer,0,w.byteLength>>2),fe=j.length,ve=U+7>>3;let Se=4294967295,Pe=a.FeatureTest.isLittleEndian?4278190080:255;for(ce&&ce[0]===255&&ce[255]===0&&([Se,Pe]=[Pe,Se]),L=0;L<X;L++){for(ie=L<W?u:B,g=0,H=0;H<ie;H++){const xe=pe-l;let Oe=0;const Fe=xe>ve?U:xe*8-7,ze=Fe&-8;let Te=0,De=0;for(;Oe<ze;Oe+=8)De=v[l++],j[g++]=De&128?Se:Pe,j[g++]=De&64?Se:Pe,j[g++]=De&32?Se:Pe,j[g++]=De&16?Se:Pe,j[g++]=De&8?Se:Pe,j[g++]=De&4?Se:Pe,j[g++]=De&2?Se:Pe,j[g++]=De&1?Se:Pe;for(;Oe<Fe;Oe++)Te===0&&(De=v[l++],Te=128),j[g++]=De&Te?Se:Pe,Te>>=1}for(;g<fe;)j[g++]=0;q.putImageData(Y,0,L*u)}}else if(f.kind===a.ImageKind.RGBA_32BPP){const pe=!!(ee||le||ne);for(H=0,de=U*u*4,L=0;L<W;L++){if(w.set(v.subarray(l,l+de)),l+=de,pe)for(let j=0;j<de;j+=4)ee&&(w[j+0]=ee[w[j+0]]),le&&(w[j+1]=le[w[j+1]]),ne&&(w[j+2]=ne[w[j+2]]);q.putImageData(Y,0,H),H+=u}if(L<X){if(de=U*B*4,w.set(v.subarray(l,l+de)),pe)for(let j=0;j<de;j+=4)ee&&(w[j+0]=ee[w[j+0]]),le&&(w[j+1]=le[w[j+1]]),ne&&(w[j+2]=ne[w[j+2]]);q.putImageData(Y,0,H)}}else if(f.kind===a.ImageKind.RGB_24BPP){const pe=!!(ee||le||ne);for(ie=u,de=U*ie,L=0;L<X;L++){for(L>=W&&(ie=B,de=U*ie),g=0,H=de;H--;)w[g++]=v[l++],w[g++]=v[l++],w[g++]=v[l++],w[g++]=255;if(pe)for(let j=0;j<g;j+=4)ee&&(w[j+0]=ee[w[j+0]]),le&&(w[j+1]=le[w[j+1]]),ne&&(w[j+2]=ne[w[j+2]]);q.putImageData(Y,0,L*u)}}else throw new Error(`bad image kind: ${f.kind}`)}function i(q,f){if(f.bitmap){q.drawImage(f.bitmap,0,0);return}const d=f.height,F=f.width,U=d%u,B=(d-U)/u,W=U===0?B:B+1,X=q.createImageData(F,u);let Y=0;const l=f.data,g=X.data;for(let v=0;v<W;v++){const w=v<B?u:U;({srcPos:Y}=(0,M.applyMaskImageData)({src:l,srcPos:Y,dest:g,width:F,height:w})),q.putImageData(X,0,v*u)}}function o(q,f){const d=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let F=0,U=d.length;F<U;F++){const B=d[F];q[B]!==void 0&&(f[B]=q[B])}q.setLineDash!==void 0&&(f.setLineDash(q.getLineDash()),f.lineDashOffset=q.lineDashOffset)}function m(q,f){q.strokeStyle=q.fillStyle=f||"#000000",q.fillRule="nonzero",q.globalAlpha=1,q.lineWidth=1,q.lineCap="butt",q.lineJoin="miter",q.miterLimit=10,q.globalCompositeOperation="source-over",q.font="10px sans-serif",q.setLineDash!==void 0&&(q.setLineDash([]),q.lineDashOffset=0)}function O(q,f,d,F){const U=q.length;for(let B=3;B<U;B+=4){const W=q[B];if(W===0)q[B-3]=f,q[B-2]=d,q[B-1]=F;else if(W<255){const X=255-W;q[B-3]=q[B-3]*W+f*X>>8,q[B-2]=q[B-2]*W+d*X>>8,q[B-1]=q[B-1]*W+F*X>>8}}}function T(q,f,d){const F=q.length,U=1/255;for(let B=3;B<F;B+=4){const W=d?d[q[B]]:q[B];f[B]=f[B]*W*U|0}}function y(q,f,d){const F=q.length;for(let U=3;U<F;U+=4){const B=q[U-3]*77+q[U-2]*152+q[U-1]*28;f[U]=d?f[U]*d[B>>8]>>8:f[U]*B>>16}}function D(q,f,d,F,U,B,W,X,Y,l,g){const v=!!B,w=v?B[0]:0,L=v?B[1]:0,H=v?B[2]:0;let ie;U==="Luminosity"?ie=y:ie=T;const ee=Math.min(F,Math.ceil(1048576/d));for(let le=0;le<F;le+=ee){const ne=Math.min(ee,F-le),ce=q.getImageData(X-l,le+(Y-g),d,ne),pe=f.getImageData(X,le+Y,d,ne);v&&O(ce.data,w,L,H),ie(ce.data,pe.data,W),f.putImageData(pe,X,le+Y)}}function te(q,f,d,F){const U=F[0],B=F[1],W=F[2]-U,X=F[3]-B;W===0||X===0||(D(f.context,d,W,X,f.subtype,f.backdrop,f.transferMap,U,B,f.offsetX,f.offsetY),q.save(),q.globalAlpha=1,q.globalCompositeOperation="source-over",q.setTransform(1,0,0,1,0,0),q.drawImage(d.canvas,0,0),q.restore())}function se(q,f){const d=a.Util.singularValueDecompose2dScale(q);d[0]=Math.fround(d[0]),d[1]=Math.fround(d[1]);const F=Math.fround((globalThis.devicePixelRatio||1)*e.PixelsPerInch.PDF_TO_CSS_UNITS);return f!==void 0?f:d[0]<=F||d[1]<=F}const Z=["butt","round","square"],J=["miter","round","bevel"],G={},V={},be=class be{constructor(f,d,F,U,B,W,X,Y){oe(this,re);this.ctx=f,this.current=new E(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=d,this.objs=F,this.canvasFactory=U,this.imageLayer=B,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=W,this.cachedCanvases=new s(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=X,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=(Y==null?void 0:Y.background)||null,this.foregroundColor=(Y==null?void 0:Y.foreground)||null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(f,d=null){return typeof f=="string"?f.startsWith("g_")?this.commonObjs.get(f):this.objs.get(f):d}beginDrawing({transform:f,viewport:d,transparency:F=!1,background:U=null}){const B=this.ctx.canvas.width,W=this.ctx.canvas.height,X=U||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const Y=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const l=this.backgroundColor=this.ctx.fillStyle;let g=!0,v=X;if(this.ctx.fillStyle=X,v=this.ctx.fillStyle,g=typeof v=="string"&&/^#[0-9A-Fa-f]{6}$/.test(v),Y==="#000000"&&l==="#ffffff"||Y===l||!g)this.foregroundColor=this.backgroundColor=null;else{const[w,L,H]=(0,e.getRGB)(v),ie=ee=>(ee/=255,ee<=.03928?ee/12.92:((ee+.055)/1.055)**2.4),de=Math.round(.2126*ie(w)+.7152*ie(L)+.0722*ie(H));this.selectColor=(ee,le,ne)=>{const ce=.2126*ie(ee)+.7152*ie(le)+.0722*ie(ne);return Math.round(ce)===de?l:Y}}}if(this.ctx.fillStyle=this.backgroundColor||X,this.ctx.fillRect(0,0,B,W),this.ctx.restore(),F){const Y=this.cachedCanvases.getCanvas("transparent",B,W);this.compositeCtx=this.ctx,this.transparentCanvas=Y.canvas,this.ctx=Y.context,this.ctx.save(),this.ctx.transform(...(0,e.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),m(this.ctx,this.foregroundColor),f&&(this.ctx.transform(...f),this.outputScaleX=f[0],this.outputScaleY=f[0]),this.ctx.transform(...d.transform),this.viewportScale=d.scale,this.baseTransform=(0,e.getCurrentTransform)(this.ctx),this.imageLayer&&((0,e.deprecated)("The `imageLayer` functionality will be removed in the future."),this.imageLayer.beginLayout())}executeOperatorList(f,d,F,U){const B=f.argsArray,W=f.fnArray;let X=d||0;const Y=B.length;if(Y===X)return X;const l=Y-X>x&&typeof F=="function",g=l?Date.now()+N:0;let v=0;const w=this.commonObjs,L=this.objs;let H;for(;;){if(U!==void 0&&X===U.nextBreakPoint)return U.breakIt(X,F),X;if(H=W[X],H!==a.OPS.dependency)this[H].apply(this,B[X]);else for(const ie of B[X]){const de=ie.startsWith("g_")?w:L;if(!de.has(ie))return de.get(ie,F),X}if(X++,X===Y)return X;if(l&&++v>x){if(Date.now()>g)return F(),X;v=0}}}endDrawing(){ue(this,re,ut).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const f of this._cachedBitmapsMap.values()){for(const d of f.values())typeof HTMLCanvasElement<"u"&&d instanceof HTMLCanvasElement&&(d.width=d.height=0);f.clear()}this._cachedBitmapsMap.clear(),this.imageLayer&&this.imageLayer.endLayout()}_scaleImage(f,d){const F=f.width,U=f.height;let B=Math.max(Math.hypot(d[0],d[1]),1),W=Math.max(Math.hypot(d[2],d[3]),1),X=F,Y=U,l="prescale1",g,v;for(;B>2&&X>1||W>2&&Y>1;){let w=X,L=Y;B>2&&X>1&&(w=Math.ceil(X/2),B/=X/w),W>2&&Y>1&&(L=Math.ceil(Y/2),W/=Y/L),g=this.cachedCanvases.getCanvas(l,w,L),v=g.context,v.clearRect(0,0,w,L),v.drawImage(f,0,0,X,Y,0,0,w,L),f=g.canvas,X=w,Y=L,l=l==="prescale1"?"prescale2":"prescale1"}return{img:f,paintWidth:X,paintHeight:Y}}_createMaskCanvas(f){const d=this.ctx,{width:F,height:U}=f,B=this.current.fillColor,W=this.current.patternFill,X=(0,e.getCurrentTransform)(d);let Y,l,g,v;if((f.bitmap||f.data)&&f.count>1){const fe=f.bitmap||f.data.buffer,ve=X.slice(0,4);l=JSON.stringify(W?ve:[ve,B]),Y=this._cachedBitmapsMap.get(fe),Y||(Y=new Map,this._cachedBitmapsMap.set(fe,Y));const Se=Y.get(l);if(Se&&!W){const Pe=Math.round(Math.min(X[0],X[2])+X[4]),xe=Math.round(Math.min(X[1],X[3])+X[5]);return{canvas:Se,offsetX:Pe,offsetY:xe}}g=Se}g||(v=this.cachedCanvases.getCanvas("maskCanvas",F,U),i(v.context,f));let w=a.Util.transform(X,[1/F,0,0,-1/U,0,0]);w=a.Util.transform(w,[1,0,0,1,0,-U]);const L=a.Util.applyTransform([0,0],w),H=a.Util.applyTransform([F,U],w),ie=a.Util.normalizeRect([L[0],L[1],H[0],H[1]]),de=Math.round(ie[2]-ie[0])||1,ee=Math.round(ie[3]-ie[1])||1,le=this.cachedCanvases.getCanvas("fillCanvas",de,ee),ne=le.context,ce=Math.min(L[0],H[0]),pe=Math.min(L[1],H[1]);ne.translate(-ce,-pe),ne.transform(...w),g||(g=this._scaleImage(v.canvas,(0,e.getCurrentTransformInverse)(ne)),g=g.img,Y&&W&&Y.set(l,g)),ne.imageSmoothingEnabled=se((0,e.getCurrentTransform)(ne),f.interpolate),c(ne,g,0,0,g.width,g.height,0,0,F,U),ne.globalCompositeOperation="source-in";const j=a.Util.transform((0,e.getCurrentTransformInverse)(ne),[1,0,0,1,-ce,-pe]);return ne.fillStyle=W?B.getPattern(d,this,j,k.PathType.FILL):B,ne.fillRect(0,0,F,U),Y&&!W&&(this.cachedCanvases.delete("fillCanvas"),Y.set(l,le.canvas)),{canvas:le.canvas,offsetX:Math.round(ce),offsetY:Math.round(pe)}}setLineWidth(f){f!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=f,this.ctx.lineWidth=f}setLineCap(f){this.ctx.lineCap=Z[f]}setLineJoin(f){this.ctx.lineJoin=J[f]}setMiterLimit(f){this.ctx.miterLimit=f}setDash(f,d){const F=this.ctx;F.setLineDash!==void 0&&(F.setLineDash(f),F.lineDashOffset=d)}setRenderingIntent(f){}setFlatness(f){}setGState(f){for(let d=0,F=f.length;d<F;d++){const U=f[d],B=U[0],W=U[1];switch(B){case"LW":this.setLineWidth(W);break;case"LC":this.setLineCap(W);break;case"LJ":this.setLineJoin(W);break;case"ML":this.setMiterLimit(W);break;case"D":this.setDash(W[0],W[1]);break;case"RI":this.setRenderingIntent(W);break;case"FL":this.setFlatness(W);break;case"Font":this.setFont(W[0],W[1]);break;case"CA":this.current.strokeAlpha=U[1];break;case"ca":this.current.fillAlpha=U[1],this.ctx.globalAlpha=U[1];break;case"BM":this.ctx.globalCompositeOperation=W;break;case"SMask":this.current.activeSMask=W?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=W}}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const f=this.inSMaskMode;this.current.activeSMask&&!f?this.beginSMaskMode():!this.current.activeSMask&&f&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const f=this.ctx.canvas.width,d=this.ctx.canvas.height,F="smaskGroupAt"+this.groupLevel,U=this.cachedCanvases.getCanvas(F,f,d);this.suspendedCtx=this.ctx,this.ctx=U.context;const B=this.ctx;B.setTransform(...(0,e.getCurrentTransform)(this.suspendedCtx)),o(this.suspendedCtx,B),t(B,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),o(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(f){if(!this.current.activeSMask)return;f?(f[0]=Math.floor(f[0]),f[1]=Math.floor(f[1]),f[2]=Math.ceil(f[2]),f[3]=Math.ceil(f[3])):f=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const d=this.current.activeSMask,F=this.suspendedCtx;te(F,d,this.ctx,f),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(o(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const f=this.current;this.stateStack.push(f),this.current=f.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),o(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(f,d,F,U,B,W){this.ctx.transform(f,d,F,U,B,W),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(f,d,F){const U=this.ctx,B=this.current;let W=B.x,X=B.y,Y,l;const g=(0,e.getCurrentTransform)(U),v=g[0]===0&&g[3]===0||g[1]===0&&g[2]===0,w=v?F.slice(0):null;for(let L=0,H=0,ie=f.length;L<ie;L++)switch(f[L]|0){case a.OPS.rectangle:W=d[H++],X=d[H++];const de=d[H++],ee=d[H++],le=W+de,ne=X+ee;U.moveTo(W,X),de===0||ee===0?U.lineTo(le,ne):(U.lineTo(le,X),U.lineTo(le,ne),U.lineTo(W,ne)),v||B.updateRectMinMax(g,[W,X,le,ne]),U.closePath();break;case a.OPS.moveTo:W=d[H++],X=d[H++],U.moveTo(W,X),v||B.updatePathMinMax(g,W,X);break;case a.OPS.lineTo:W=d[H++],X=d[H++],U.lineTo(W,X),v||B.updatePathMinMax(g,W,X);break;case a.OPS.curveTo:Y=W,l=X,W=d[H+4],X=d[H+5],U.bezierCurveTo(d[H],d[H+1],d[H+2],d[H+3],W,X),B.updateCurvePathMinMax(g,Y,l,d[H],d[H+1],d[H+2],d[H+3],W,X,w),H+=6;break;case a.OPS.curveTo2:Y=W,l=X,U.bezierCurveTo(W,X,d[H],d[H+1],d[H+2],d[H+3]),B.updateCurvePathMinMax(g,Y,l,W,X,d[H],d[H+1],d[H+2],d[H+3],w),W=d[H+2],X=d[H+3],H+=4;break;case a.OPS.curveTo3:Y=W,l=X,W=d[H+2],X=d[H+3],U.bezierCurveTo(d[H],d[H+1],W,X,W,X),B.updateCurvePathMinMax(g,Y,l,d[H],d[H+1],W,X,W,X,w),H+=4;break;case a.OPS.closePath:U.closePath();break}v&&B.updateScalingPathMinMax(g,w),B.setCurrentPoint(W,X)}closePath(){this.ctx.closePath()}stroke(f){f=typeof f<"u"?f:!0;const d=this.ctx,F=this.current.strokeColor;d.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof F=="object"&&(F!=null&&F.getPattern)?(d.save(),d.strokeStyle=F.getPattern(d,this,(0,e.getCurrentTransformInverse)(d),k.PathType.STROKE),this.rescaleAndStroke(!1),d.restore()):this.rescaleAndStroke(!0)),f&&this.consumePath(this.current.getClippedPathBoundingBox()),d.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(f){f=typeof f<"u"?f:!0;const d=this.ctx,F=this.current.fillColor,U=this.current.patternFill;let B=!1;U&&(d.save(),d.fillStyle=F.getPattern(d,this,(0,e.getCurrentTransformInverse)(d),k.PathType.FILL),B=!0);const W=this.current.getClippedPathBoundingBox();this.contentVisible&&W!==null&&(this.pendingEOFill?(d.fill("evenodd"),this.pendingEOFill=!1):d.fill()),B&&d.restore(),f&&this.consumePath(W)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=G}eoClip(){this.pendingClip=V}beginText(){this.current.textMatrix=a.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const f=this.pendingTextPaths,d=this.ctx;if(f===void 0){d.beginPath();return}d.save(),d.beginPath();for(const F of f)d.setTransform(...F.transform),d.translate(F.x,F.y),F.addToPath(d,F.fontSize);d.restore(),d.clip(),d.beginPath(),delete this.pendingTextPaths}setCharSpacing(f){this.current.charSpacing=f}setWordSpacing(f){this.current.wordSpacing=f}setHScale(f){this.current.textHScale=f/100}setLeading(f){this.current.leading=-f}setFont(f,d){const F=this.commonObjs.get(f),U=this.current;if(!F)throw new Error(`Can't find font for ${f}`);if(U.fontMatrix=F.fontMatrix||a.FONT_IDENTITY_MATRIX,(U.fontMatrix[0]===0||U.fontMatrix[3]===0)&&(0,a.warn)("Invalid font matrix for font "+f),d<0?(d=-d,U.fontDirection=-1):U.fontDirection=1,this.current.font=F,this.current.fontSize=d,F.isType3Font)return;const B=F.loadedName||"sans-serif";let W="normal";F.black?W="900":F.bold&&(W="bold");const X=F.italic?"italic":"normal",Y=`"${B}", ${F.fallbackName}`;let l=d;d<S?l=S:d>p&&(l=p),this.current.fontSizeScale=d/l,this.ctx.font=`${X} ${W} ${l}px ${Y}`}setTextRenderingMode(f){this.current.textRenderingMode=f}setTextRise(f){this.current.textRise=f}moveText(f,d){this.current.x=this.current.lineX+=f,this.current.y=this.current.lineY+=d}setLeadingMoveText(f,d){this.setLeading(-d),this.moveText(f,d)}setTextMatrix(f,d,F,U,B,W){this.current.textMatrix=[f,d,F,U,B,W],this.current.textMatrixScale=Math.hypot(f,d),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(f,d,F,U){const B=this.ctx,W=this.current,X=W.font,Y=W.textRenderingMode,l=W.fontSize/W.fontSizeScale,g=Y&a.TextRenderingMode.FILL_STROKE_MASK,v=!!(Y&a.TextRenderingMode.ADD_TO_PATH_FLAG),w=W.patternFill&&!X.missingFile;let L;(X.disableFontFace||v||w)&&(L=X.getPathGenerator(this.commonObjs,f)),X.disableFontFace||w?(B.save(),B.translate(d,F),B.beginPath(),L(B,l),U&&B.setTransform(...U),(g===a.TextRenderingMode.FILL||g===a.TextRenderingMode.FILL_STROKE)&&B.fill(),(g===a.TextRenderingMode.STROKE||g===a.TextRenderingMode.FILL_STROKE)&&B.stroke(),B.restore()):((g===a.TextRenderingMode.FILL||g===a.TextRenderingMode.FILL_STROKE)&&B.fillText(f,d,F),(g===a.TextRenderingMode.STROKE||g===a.TextRenderingMode.FILL_STROKE)&&B.strokeText(f,d,F)),v&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,e.getCurrentTransform)(B),x:d,y:F,fontSize:l,addToPath:L})}get isFontSubpixelAAEnabled(){const{context:f}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);f.scale(1.5,1),f.fillText("I",0,10);const d=f.getImageData(0,0,10,10).data;let F=!1;for(let U=3;U<d.length;U+=4)if(d[U]>0&&d[U]<255){F=!0;break}return(0,a.shadow)(this,"isFontSubpixelAAEnabled",F)}showText(f){const d=this.current,F=d.font;if(F.isType3Font)return this.showType3Text(f);const U=d.fontSize;if(U===0)return;const B=this.ctx,W=d.fontSizeScale,X=d.charSpacing,Y=d.wordSpacing,l=d.fontDirection,g=d.textHScale*l,v=f.length,w=F.vertical,L=w?1:-1,H=F.defaultVMetrics,ie=U*d.fontMatrix[0],de=d.textRenderingMode===a.TextRenderingMode.FILL&&!F.disableFontFace&&!d.patternFill;B.save(),B.transform(...d.textMatrix),B.translate(d.x,d.y+d.textRise),l>0?B.scale(g,-1):B.scale(g,1);let ee;if(d.patternFill){B.save();const j=d.fillColor.getPattern(B,this,(0,e.getCurrentTransformInverse)(B),k.PathType.FILL);ee=(0,e.getCurrentTransform)(B),B.restore(),B.fillStyle=j}let le=d.lineWidth;const ne=d.textMatrixScale;if(ne===0||le===0){const j=d.textRenderingMode&a.TextRenderingMode.FILL_STROKE_MASK;(j===a.TextRenderingMode.STROKE||j===a.TextRenderingMode.FILL_STROKE)&&(le=this.getSinglePixelWidth())}else le/=ne;W!==1&&(B.scale(W,W),le/=W),B.lineWidth=le;let ce=0,pe;for(pe=0;pe<v;++pe){const j=f[pe];if(typeof j=="number"){ce+=L*j*U/1e3;continue}let fe=!1;const ve=(j.isSpace?Y:0)+X,Se=j.fontChar,Pe=j.accent;let xe,Oe,Fe=j.width;if(w){const Te=j.vmetric||H,De=-(j.vmetric?Te[1]:Fe*.5)*ie,et=Te[2]*ie;Fe=Te?-Te[0]:Fe,xe=De/W,Oe=(ce+et)/W}else xe=ce/W,Oe=0;if(F.remeasure&&Fe>0){const Te=B.measureText(Se).width*1e3/U*W;if(Fe<Te&&this.isFontSubpixelAAEnabled){const De=Fe/Te;fe=!0,B.save(),B.scale(De,1),xe/=De}else Fe!==Te&&(xe+=(Fe-Te)/2e3*U/W)}if(this.contentVisible&&(j.isInFont||F.missingFile)){if(de&&!Pe)B.fillText(Se,xe,Oe);else if(this.paintChar(Se,xe,Oe,ee),Pe){const Te=xe+U*Pe.offset.x/W,De=Oe-U*Pe.offset.y/W;this.paintChar(Pe.fontChar,Te,De,ee)}}let ze;w?ze=Fe*ie-ve*l:ze=Fe*ie+ve*l,ce+=ze,fe&&B.restore()}w?d.y-=ce:d.x+=ce*g,B.restore(),this.compose()}showType3Text(f){const d=this.ctx,F=this.current,U=F.font,B=F.fontSize,W=F.fontDirection,X=U.vertical?1:-1,Y=F.charSpacing,l=F.wordSpacing,g=F.textHScale*W,v=F.fontMatrix||a.FONT_IDENTITY_MATRIX,w=f.length,L=F.textRenderingMode===a.TextRenderingMode.INVISIBLE;let H,ie,de,ee;if(!(L||B===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,d.save(),d.transform(...F.textMatrix),d.translate(F.x,F.y),d.scale(g,W),H=0;H<w;++H){if(ie=f[H],typeof ie=="number"){ee=X*ie*B/1e3,this.ctx.translate(ee,0),F.x+=ee*g;continue}const le=(ie.isSpace?l:0)+Y,ne=U.charProcOperatorList[ie.operatorListId];if(!ne){(0,a.warn)(`Type3 character "${ie.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=ie,this.save(),d.scale(B,B),d.transform(...v),this.executeOperatorList(ne),this.restore()),de=a.Util.applyTransform([ie.width,0],v)[0]*B+le,d.translate(de,0),F.x+=de*g}d.restore(),this.processingType3=null}}setCharWidth(f,d){}setCharWidthAndBounds(f,d,F,U,B,W){this.ctx.rect(F,U,B-F,W-U),this.ctx.clip(),this.endPath()}getColorN_Pattern(f){let d;if(f[0]==="TilingPattern"){const F=f[1],U=this.baseTransform||(0,e.getCurrentTransform)(this.ctx),B={createCanvasGraphics:W=>new be(W,this.commonObjs,this.objs,this.canvasFactory)};d=new k.TilingPattern(f,F,this.ctx,B,U)}else d=this._getPattern(f[1],f[2]);return d}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(f,d,F){var B;const U=((B=this.selectColor)==null?void 0:B.call(this,f,d,F))||a.Util.makeHexColor(f,d,F);this.ctx.strokeStyle=U,this.current.strokeColor=U}setFillRGBColor(f,d,F){var B;const U=((B=this.selectColor)==null?void 0:B.call(this,f,d,F))||a.Util.makeHexColor(f,d,F);this.ctx.fillStyle=U,this.current.fillColor=U,this.current.patternFill=!1}_getPattern(f,d=null){let F;return this.cachedPatterns.has(f)?F=this.cachedPatterns.get(f):(F=(0,k.getShadingPattern)(this.objs.get(f)),this.cachedPatterns.set(f,F)),d&&(F.matrix=d),F}shadingFill(f){if(!this.contentVisible)return;const d=this.ctx;this.save();const F=this._getPattern(f);d.fillStyle=F.getPattern(d,this,(0,e.getCurrentTransformInverse)(d),k.PathType.SHADING);const U=(0,e.getCurrentTransformInverse)(d);if(U){const B=d.canvas,W=B.width,X=B.height,Y=a.Util.applyTransform([0,0],U),l=a.Util.applyTransform([0,X],U),g=a.Util.applyTransform([W,0],U),v=a.Util.applyTransform([W,X],U),w=Math.min(Y[0],l[0],g[0],v[0]),L=Math.min(Y[1],l[1],g[1],v[1]),H=Math.max(Y[0],l[0],g[0],v[0]),ie=Math.max(Y[1],l[1],g[1],v[1]);this.ctx.fillRect(w,L,H-w,ie-L)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,a.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,a.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(f,d){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(f)&&f.length===6&&this.transform(...f),this.baseTransform=(0,e.getCurrentTransform)(this.ctx),d)){const F=d[2]-d[0],U=d[3]-d[1];this.ctx.rect(d[0],d[1],F,U),this.current.updateRectMinMax((0,e.getCurrentTransform)(this.ctx),d),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(f){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const d=this.ctx;f.isolated||(0,a.info)("TODO: Support non-isolated groups."),f.knockout&&(0,a.warn)("Knockout groups not supported.");const F=(0,e.getCurrentTransform)(d);if(f.matrix&&d.transform(...f.matrix),!f.bbox)throw new Error("Bounding box is required.");let U=a.Util.getAxialAlignedBoundingBox(f.bbox,(0,e.getCurrentTransform)(d));const B=[0,0,d.canvas.width,d.canvas.height];U=a.Util.intersect(U,B)||[0,0,0,0];const W=Math.floor(U[0]),X=Math.floor(U[1]);let Y=Math.max(Math.ceil(U[2])-W,1),l=Math.max(Math.ceil(U[3])-X,1),g=1,v=1;Y>R&&(g=Y/R,Y=R),l>R&&(v=l/R,l=R),this.current.startNewPathAndClipBox([0,0,Y,l]);let w="groupAt"+this.groupLevel;f.smask&&(w+="_smask_"+this.smaskCounter++%2);const L=this.cachedCanvases.getCanvas(w,Y,l),H=L.context;H.scale(1/g,1/v),H.translate(-W,-X),H.transform(...F),f.smask?this.smaskStack.push({canvas:L.canvas,context:H,offsetX:W,offsetY:X,scaleX:g,scaleY:v,subtype:f.smask.subtype,backdrop:f.smask.backdrop,transferMap:f.smask.transferMap||null,startTransformInverse:null}):(d.setTransform(1,0,0,1,0,0),d.translate(W,X),d.scale(g,v),d.save()),o(d,H),this.ctx=H,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(d),this.groupLevel++}endGroup(f){if(!this.contentVisible)return;this.groupLevel--;const d=this.ctx,F=this.groupStack.pop();if(this.ctx=F,this.ctx.imageSmoothingEnabled=!1,f.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const U=(0,e.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...U);const B=a.Util.getAxialAlignedBoundingBox([0,0,d.canvas.width,d.canvas.height],U);this.ctx.drawImage(d.canvas,0,0),this.ctx.restore(),this.compose(B)}}beginAnnotation(f,d,F,U,B){if(ue(this,re,ut).call(this),m(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(d)&&d.length===4){const W=d[2]-d[0],X=d[3]-d[1];if(B&&this.annotationCanvasMap){F=F.slice(),F[4]-=d[0],F[5]-=d[1],d=d.slice(),d[0]=d[1]=0,d[2]=W,d[3]=X;const[Y,l]=a.Util.singularValueDecompose2dScale((0,e.getCurrentTransform)(this.ctx)),{viewportScale:g}=this,v=Math.ceil(W*this.outputScaleX*g),w=Math.ceil(X*this.outputScaleY*g);this.annotationCanvas=this.canvasFactory.create(v,w);const{canvas:L,context:H}=this.annotationCanvas;this.annotationCanvasMap.set(f,L),this.annotationCanvas.savedCtx=this.ctx,this.ctx=H,this.ctx.setTransform(Y,0,0,-l,0,X*l),m(this.ctx,this.foregroundColor)}else m(this.ctx,this.foregroundColor),this.ctx.rect(d[0],d[1],W,X),this.ctx.clip(),this.endPath()}this.current=new E(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...F),this.transform(...U)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(f){if(!this.contentVisible)return;const d=f.count;f=this.getObject(f.data,f),f.count=d;const F=this.ctx,U=this.processingType3;if(U&&(U.compiled===void 0&&(U.compiled=A(f)),U.compiled)){U.compiled(F);return}const B=this._createMaskCanvas(f),W=B.canvas;F.save(),F.setTransform(1,0,0,1,0,0),F.drawImage(W,B.offsetX,B.offsetY),F.restore(),this.compose()}paintImageMaskXObjectRepeat(f,d,F=0,U=0,B,W){if(!this.contentVisible)return;f=this.getObject(f.data,f);const X=this.ctx;X.save();const Y=(0,e.getCurrentTransform)(X);X.transform(d,F,U,B,0,0);const l=this._createMaskCanvas(f);X.setTransform(1,0,0,1,0,0);for(let g=0,v=W.length;g<v;g+=2){const w=a.Util.transform(Y,[d,F,U,B,W[g],W[g+1]]),[L,H]=a.Util.applyTransform([0,0],w);X.drawImage(l.canvas,L,H)}X.restore(),this.compose()}paintImageMaskXObjectGroup(f){if(!this.contentVisible)return;const d=this.ctx,F=this.current.fillColor,U=this.current.patternFill;for(const B of f){const{data:W,width:X,height:Y,transform:l}=B,g=this.cachedCanvases.getCanvas("maskCanvas",X,Y),v=g.context;v.save();const w=this.getObject(W,B);i(v,w),v.globalCompositeOperation="source-in",v.fillStyle=U?F.getPattern(v,this,(0,e.getCurrentTransformInverse)(d),k.PathType.FILL):F,v.fillRect(0,0,X,Y),v.restore(),d.save(),d.transform(...l),d.scale(1,-1),c(d,g.canvas,0,0,X,Y,0,-1,1,1),d.restore()}this.compose()}paintImageXObject(f){if(!this.contentVisible)return;const d=this.getObject(f);if(!d){(0,a.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(d)}paintImageXObjectRepeat(f,d,F,U){if(!this.contentVisible)return;const B=this.getObject(f);if(!B){(0,a.warn)("Dependent image isn't ready yet");return}const W=B.width,X=B.height,Y=[];for(let l=0,g=U.length;l<g;l+=2)Y.push({transform:[d,0,0,F,U[l],U[l+1]],x:0,y:0,w:W,h:X});this.paintInlineImageXObjectGroup(B,Y)}paintInlineImageXObject(f){if(!this.contentVisible)return;const d=f.width,F=f.height,U=this.ctx;this.save(),U.scale(1/d,-1/F);let B;if(typeof HTMLElement=="function"&&f instanceof HTMLElement||!f.data)B=f;else{const l=this.cachedCanvases.getCanvas("inlineImage",d,F),g=l.context;h(g,f,this.current.transferMaps),B=l.canvas}const W=this._scaleImage(B,(0,e.getCurrentTransformInverse)(U));U.imageSmoothingEnabled=se((0,e.getCurrentTransform)(U),f.interpolate);const[X,Y]=c(U,W.img,0,0,W.paintWidth,W.paintHeight,0,-F,d,F);if(this.imageLayer){const[l,g]=a.Util.applyTransform([0,-F],(0,e.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:f,left:l,top:g,width:X,height:Y})}this.compose(),this.restore()}paintInlineImageXObjectGroup(f,d){if(!this.contentVisible)return;const F=this.ctx,U=f.width,B=f.height,W=this.cachedCanvases.getCanvas("inlineImage",U,B),X=W.context;h(X,f,this.current.transferMaps);for(const Y of d){if(F.save(),F.transform(...Y.transform),F.scale(1,-1),c(F,W.canvas,Y.x,Y.y,Y.w,Y.h,0,-1,1,1),this.imageLayer){const[l,g]=a.Util.applyTransform([Y.x,Y.y],(0,e.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:f,left:l,top:g,width:U,height:B})}F.restore()}this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(f){}markPointProps(f,d){}beginMarkedContent(f){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(f,d){f==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(d)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(f){const d=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(f);const F=this.ctx;this.pendingClip&&(d||(this.pendingClip===V?F.clip("evenodd"):F.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),F.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const f=(0,e.getCurrentTransform)(this.ctx);if(f[1]===0&&f[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(f[0]),Math.abs(f[3]));else{const d=Math.abs(f[0]*f[3]-f[2]*f[1]),F=Math.hypot(f[0],f[2]),U=Math.hypot(f[1],f[3]);this._cachedGetSinglePixelWidth=Math.max(F,U)/d}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:f}=this.current,d=(0,e.getCurrentTransform)(this.ctx);let F,U;if(d[1]===0&&d[2]===0){const B=Math.abs(d[0]),W=Math.abs(d[3]);if(f===0)F=1/B,U=1/W;else{const X=B*f,Y=W*f;F=X<1?1/X:1,U=Y<1?1/Y:1}}else{const B=Math.abs(d[0]*d[3]-d[2]*d[1]),W=Math.hypot(d[0],d[1]),X=Math.hypot(d[2],d[3]);if(f===0)F=X/B,U=W/B;else{const Y=f*B;F=X>Y?X/Y:1,U=W>Y?W/Y:1}}this._cachedScaleForStroking=[F,U]}return this._cachedScaleForStroking}rescaleAndStroke(f){const{ctx:d}=this,{lineWidth:F}=this.current,[U,B]=this.getScaleForStroking();if(d.lineWidth=F||1,U===1&&B===1){d.stroke();return}let W,X,Y;f&&(W=(0,e.getCurrentTransform)(d),X=d.getLineDash().slice(),Y=d.lineDashOffset),d.scale(U,B);const l=Math.max(U,B);d.setLineDash(d.getLineDash().map(g=>g/l)),d.lineDashOffset/=l,d.stroke(),f&&(d.setTransform(...W),d.setLineDash(X),d.lineDashOffset=Y)}isContentVisible(){for(let f=this.markedContentStack.length-1;f>=0;f--)if(!this.markedContentStack[f].visible)return!1;return!0}};re=new WeakSet,ut=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)};let K=be;n.CanvasGraphics=K;for(const q in a.OPS)K.prototype[q]!==void 0&&(K.prototype[a.OPS[q]]=K.prototype[q])},(b,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TilingPattern=n.PathType=void 0,n.getShadingPattern=u;var e=_(1),a=_(8),k=_(3);const M={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};n.PathType=M;function C(c,A){if(!A||k.isNodeJS)return;const E=A[2]-A[0],h=A[3]-A[1],i=new Path2D;i.rect(A[0],A[1],E,h),c.clip(i)}class S{constructor(){this.constructor===S&&(0,e.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,e.unreachable)("Abstract method `getPattern` called.")}}class p extends S{constructor(A){super(),this._type=A[1],this._bbox=A[2],this._colorStops=A[3],this._p0=A[4],this._p1=A[5],this._r0=A[6],this._r1=A[7],this.matrix=null}_createGradient(A){let E;this._type==="axial"?E=A.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(E=A.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const h of this._colorStops)E.addColorStop(h[0],h[1]);return E}getPattern(A,E,h,i){let o;if(i===M.STROKE||i===M.FILL){const m=E.current.getClippedPathBoundingBox(i,(0,a.getCurrentTransform)(A))||[0,0,0,0],O=Math.ceil(m[2]-m[0])||1,T=Math.ceil(m[3]-m[1])||1,y=E.cachedCanvases.getCanvas("pattern",O,T,!0),D=y.context;D.clearRect(0,0,D.canvas.width,D.canvas.height),D.beginPath(),D.rect(0,0,D.canvas.width,D.canvas.height),D.translate(-m[0],-m[1]),h=e.Util.transform(h,[1,0,0,1,m[0],m[1]]),D.transform(...E.baseTransform),this.matrix&&D.transform(...this.matrix),C(D,this._bbox),D.fillStyle=this._createGradient(D),D.fill(),o=A.createPattern(y.canvas,"no-repeat");const te=new DOMMatrix(h);try{o.setTransform(te)}catch(se){(0,e.warn)(`RadialAxialShadingPattern.getPattern: "${se==null?void 0:se.message}".`)}}else C(A,this._bbox),o=this._createGradient(A);return o}}function R(c,A,E,h,i,o,m,O){const T=A.coords,y=A.colors,D=c.data,te=c.width*4;let se;T[E+1]>T[h+1]&&(se=E,E=h,h=se,se=o,o=m,m=se),T[h+1]>T[i+1]&&(se=h,h=i,i=se,se=m,m=O,O=se),T[E+1]>T[h+1]&&(se=E,E=h,h=se,se=o,o=m,m=se);const Z=(T[E]+A.offsetX)*A.scaleX,J=(T[E+1]+A.offsetY)*A.scaleY,G=(T[h]+A.offsetX)*A.scaleX,V=(T[h+1]+A.offsetY)*A.scaleY,K=(T[i]+A.offsetX)*A.scaleX,re=(T[i+1]+A.offsetY)*A.scaleY;if(J>=re)return;const he=y[o],be=y[o+1],q=y[o+2],f=y[m],d=y[m+1],F=y[m+2],U=y[O],B=y[O+1],W=y[O+2],X=Math.round(J),Y=Math.round(re);let l,g,v,w,L,H,ie,de;for(let ee=X;ee<=Y;ee++){if(ee<V){let j;ee<J?j=0:j=(J-ee)/(J-V),l=Z-(Z-G)*j,g=he-(he-f)*j,v=be-(be-d)*j,w=q-(q-F)*j}else{let j;ee>re?j=1:V===re?j=0:j=(V-ee)/(V-re),l=G-(G-K)*j,g=f-(f-U)*j,v=d-(d-B)*j,w=F-(F-W)*j}let le;ee<J?le=0:ee>re?le=1:le=(J-ee)/(J-re),L=Z-(Z-K)*le,H=he-(he-U)*le,ie=be-(be-B)*le,de=q-(q-W)*le;const ne=Math.round(Math.min(l,L)),ce=Math.round(Math.max(l,L));let pe=te*ee+ne*4;for(let j=ne;j<=ce;j++)le=(l-j)/(l-L),le<0?le=0:le>1&&(le=1),D[pe++]=g-(g-H)*le|0,D[pe++]=v-(v-ie)*le|0,D[pe++]=w-(w-de)*le|0,D[pe++]=255}}function N(c,A,E){const h=A.coords,i=A.colors;let o,m;switch(A.type){case"lattice":const O=A.verticesPerRow,T=Math.floor(h.length/O)-1,y=O-1;for(o=0;o<T;o++){let D=o*O;for(let te=0;te<y;te++,D++)R(c,E,h[D],h[D+1],h[D+O],i[D],i[D+1],i[D+O]),R(c,E,h[D+O+1],h[D+1],h[D+O],i[D+O+1],i[D+1],i[D+O])}break;case"triangles":for(o=0,m=h.length;o<m;o+=3)R(c,E,h[o],h[o+1],h[o+2],i[o],i[o+1],i[o+2]);break;default:throw new Error("illegal figure")}}class x extends S{constructor(A){super(),this._coords=A[2],this._colors=A[3],this._figures=A[4],this._bounds=A[5],this._bbox=A[7],this._background=A[8],this.matrix=null}_createMeshCanvas(A,E,h){const O=Math.floor(this._bounds[0]),T=Math.floor(this._bounds[1]),y=Math.ceil(this._bounds[2])-O,D=Math.ceil(this._bounds[3])-T,te=Math.min(Math.ceil(Math.abs(y*A[0]*1.1)),3e3),se=Math.min(Math.ceil(Math.abs(D*A[1]*1.1)),3e3),Z=y/te,J=D/se,G={coords:this._coords,colors:this._colors,offsetX:-O,offsetY:-T,scaleX:1/Z,scaleY:1/J},V=te+2*2,K=se+2*2,re=h.getCanvas("mesh",V,K,!1),he=re.context,be=he.createImageData(te,se);if(E){const f=be.data;for(let d=0,F=f.length;d<F;d+=4)f[d]=E[0],f[d+1]=E[1],f[d+2]=E[2],f[d+3]=255}for(const f of this._figures)N(be,f,G);return he.putImageData(be,2,2),{canvas:re.canvas,offsetX:O-2*Z,offsetY:T-2*J,scaleX:Z,scaleY:J}}getPattern(A,E,h,i){C(A,this._bbox);let o;if(i===M.SHADING)o=e.Util.singularValueDecompose2dScale((0,a.getCurrentTransform)(A));else if(o=e.Util.singularValueDecompose2dScale(E.baseTransform),this.matrix){const O=e.Util.singularValueDecompose2dScale(this.matrix);o=[o[0]*O[0],o[1]*O[1]]}const m=this._createMeshCanvas(o,i===M.SHADING?null:this._background,E.cachedCanvases);return i!==M.SHADING&&(A.setTransform(...E.baseTransform),this.matrix&&A.transform(...this.matrix)),A.translate(m.offsetX,m.offsetY),A.scale(m.scaleX,m.scaleY),A.createPattern(m.canvas,"no-repeat")}}class P extends S{getPattern(){return"hotpink"}}function u(c){switch(c[0]){case"RadialAxial":return new p(c);case"Mesh":return new x(c);case"Dummy":return new P}throw new Error(`Unknown IR type: ${c[0]}`)}const t={COLORED:1,UNCOLORED:2};class s{static get MAX_PATTERN_SIZE(){return(0,e.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(A,E,h,i,o){this.operatorList=A[2],this.matrix=A[3]||[1,0,0,1,0,0],this.bbox=A[4],this.xstep=A[5],this.ystep=A[6],this.paintType=A[7],this.tilingType=A[8],this.color=E,this.ctx=h,this.canvasGraphicsFactory=i,this.baseTransform=o}createPatternCanvas(A){const E=this.operatorList,h=this.bbox,i=this.xstep,o=this.ystep,m=this.paintType,O=this.tilingType,T=this.color,y=this.canvasGraphicsFactory;(0,e.info)("TilingType: "+O);const D=h[0],te=h[1],se=h[2],Z=h[3],J=e.Util.singularValueDecompose2dScale(this.matrix),G=e.Util.singularValueDecompose2dScale(this.baseTransform),V=[J[0]*G[0],J[1]*G[1]],K=this.getSizeAndScale(i,this.ctx.canvas.width,V[0]),re=this.getSizeAndScale(o,this.ctx.canvas.height,V[1]),he=A.cachedCanvases.getCanvas("pattern",K.size,re.size,!0),be=he.context,q=y.createCanvasGraphics(be);q.groupLevel=A.groupLevel,this.setFillAndStrokeStyleToContext(q,m,T);let f=D,d=te,F=se,U=Z;return D<0&&(f=0,F+=Math.abs(D)),te<0&&(d=0,U+=Math.abs(te)),be.translate(-(K.scale*f),-(re.scale*d)),q.transform(K.scale,0,0,re.scale,0,0),be.save(),this.clipBbox(q,f,d,F,U),q.baseTransform=(0,a.getCurrentTransform)(q.ctx),q.executeOperatorList(E),q.endDrawing(),{canvas:he.canvas,scaleX:K.scale,scaleY:re.scale,offsetX:f,offsetY:d}}getSizeAndScale(A,E,h){A=Math.abs(A);const i=Math.max(s.MAX_PATTERN_SIZE,E);let o=Math.ceil(A*h);return o>=i?o=i:h=o/A,{scale:h,size:o}}clipBbox(A,E,h,i,o){const m=i-E,O=o-h;A.ctx.rect(E,h,m,O),A.current.updateRectMinMax((0,a.getCurrentTransform)(A.ctx),[E,h,i,o]),A.clip(),A.endPath()}setFillAndStrokeStyleToContext(A,E,h){const i=A.ctx,o=A.current;switch(E){case t.COLORED:const m=this.ctx;i.fillStyle=m.fillStyle,i.strokeStyle=m.strokeStyle,o.fillColor=m.fillStyle,o.strokeColor=m.strokeStyle;break;case t.UNCOLORED:const O=e.Util.makeHexColor(h[0],h[1],h[2]);i.fillStyle=O,i.strokeStyle=O,o.fillColor=O,o.strokeColor=O;break;default:throw new e.FormatError(`Unsupported paint type: ${E}`)}}getPattern(A,E,h,i){let o=h;i!==M.SHADING&&(o=e.Util.transform(o,E.baseTransform),this.matrix&&(o=e.Util.transform(o,this.matrix)));const m=this.createPatternCanvas(E);let O=new DOMMatrix(o);O=O.translate(m.offsetX,m.offsetY),O=O.scale(1/m.scaleX,1/m.scaleY);const T=A.createPattern(m.canvas,"repeat");try{T.setTransform(O)}catch(y){(0,e.warn)(`TilingPattern.getPattern: "${y==null?void 0:y.message}".`)}return T}}n.TilingPattern=s},(b,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.applyMaskImageData=a;var e=_(1);function a({src:k,srcPos:M=0,dest:C,destPos:S=0,width:p,height:R,inverseDecode:N=!1}){const x=e.FeatureTest.isLittleEndian?4278190080:255,[P,u]=N?[0,x]:[x,0],t=p>>3,s=p&7,c=k.length;C=new Uint32Array(C.buffer);for(let A=0;A<R;A++){for(const h=M+t;M<h;M++){const i=M<c?k[M]:255;C[S++]=i&128?u:P,C[S++]=i&64?u:P,C[S++]=i&32?u:P,C[S++]=i&16?u:P,C[S++]=i&8?u:P,C[S++]=i&4?u:P,C[S++]=i&2?u:P,C[S++]=i&1?u:P}if(s===0)continue;const E=M<c?k[M++]:255;for(let h=0;h<s;h++)C[S++]=E&1<<7-h?u:P}return{srcPos:M,destPos:S}}},(b,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.GlobalWorkerOptions=void 0;const _=Object.create(null);n.GlobalWorkerOptions=_,_.workerPort=_.workerPort===void 0?null:_.workerPort,_.workerSrc=_.workerSrc===void 0?"":_.workerSrc},(b,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.MessageHandler=void 0;var e=_(1);const a={UNKNOWN:0,DATA:1,ERROR:2},k={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function M(S){switch(S instanceof Error||typeof S=="object"&&S!==null||(0,e.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),S.name){case"AbortException":return new e.AbortException(S.message);case"MissingPDFException":return new e.MissingPDFException(S.message);case"PasswordException":return new e.PasswordException(S.message,S.code);case"UnexpectedResponseException":return new e.UnexpectedResponseException(S.message,S.status);case"UnknownErrorException":return new e.UnknownErrorException(S.message,S.details);default:return new e.UnknownErrorException(S.message,S.toString())}}class C{constructor(p,R,N){this.sourceName=p,this.targetName=R,this.comObj=N,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=x=>{const P=x.data;if(P.targetName!==this.sourceName)return;if(P.stream){this._processStreamMessage(P);return}if(P.callback){const t=P.callbackId,s=this.callbackCapabilities[t];if(!s)throw new Error(`Cannot resolve callback ${t}`);if(delete this.callbackCapabilities[t],P.callback===a.DATA)s.resolve(P.data);else if(P.callback===a.ERROR)s.reject(M(P.reason));else throw new Error("Unexpected callback case");return}const u=this.actionHandler[P.action];if(!u)throw new Error(`Unknown action from worker: ${P.action}`);if(P.callbackId){const t=this.sourceName,s=P.sourceName;new Promise(function(c){c(u(P.data))}).then(function(c){N.postMessage({sourceName:t,targetName:s,callback:a.DATA,callbackId:P.callbackId,data:c})},function(c){N.postMessage({sourceName:t,targetName:s,callback:a.ERROR,callbackId:P.callbackId,reason:M(c)})});return}if(P.streamId){this._createStreamSink(P);return}u(P.data)},N.addEventListener("message",this._onComObjOnMessage)}on(p,R){const N=this.actionHandler;if(N[p])throw new Error(`There is already an actionName called "${p}"`);N[p]=R}send(p,R,N){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:p,data:R},N)}sendWithPromise(p,R,N){const x=this.callbackId++,P=(0,e.createPromiseCapability)();this.callbackCapabilities[x]=P;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:p,callbackId:x,data:R},N)}catch(u){P.reject(u)}return P.promise}sendWithStream(p,R,N,x){const P=this.streamId++,u=this.sourceName,t=this.targetName,s=this.comObj;return new ReadableStream({start:c=>{const A=(0,e.createPromiseCapability)();return this.streamControllers[P]={controller:c,startCall:A,pullCall:null,cancelCall:null,isClosed:!1},s.postMessage({sourceName:u,targetName:t,action:p,streamId:P,data:R,desiredSize:c.desiredSize},x),A.promise},pull:c=>{const A=(0,e.createPromiseCapability)();return this.streamControllers[P].pullCall=A,s.postMessage({sourceName:u,targetName:t,stream:k.PULL,streamId:P,desiredSize:c.desiredSize}),A.promise},cancel:c=>{(0,e.assert)(c instanceof Error,"cancel must have a valid reason");const A=(0,e.createPromiseCapability)();return this.streamControllers[P].cancelCall=A,this.streamControllers[P].isClosed=!0,s.postMessage({sourceName:u,targetName:t,stream:k.CANCEL,streamId:P,reason:M(c)}),A.promise}},N)}_createStreamSink(p){const R=p.streamId,N=this.sourceName,x=p.sourceName,P=this.comObj,u=this,t=this.actionHandler[p.action],s={enqueue(c,A=1,E){if(this.isCancelled)return;const h=this.desiredSize;this.desiredSize-=A,h>0&&this.desiredSize<=0&&(this.sinkCapability=(0,e.createPromiseCapability)(),this.ready=this.sinkCapability.promise),P.postMessage({sourceName:N,targetName:x,stream:k.ENQUEUE,streamId:R,chunk:c},E)},close(){this.isCancelled||(this.isCancelled=!0,P.postMessage({sourceName:N,targetName:x,stream:k.CLOSE,streamId:R}),delete u.streamSinks[R])},error(c){(0,e.assert)(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,P.postMessage({sourceName:N,targetName:x,stream:k.ERROR,streamId:R,reason:M(c)}))},sinkCapability:(0,e.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:p.desiredSize,ready:null};s.sinkCapability.resolve(),s.ready=s.sinkCapability.promise,this.streamSinks[R]=s,new Promise(function(c){c(t(p.data,s))}).then(function(){P.postMessage({sourceName:N,targetName:x,stream:k.START_COMPLETE,streamId:R,success:!0})},function(c){P.postMessage({sourceName:N,targetName:x,stream:k.START_COMPLETE,streamId:R,reason:M(c)})})}_processStreamMessage(p){const R=p.streamId,N=this.sourceName,x=p.sourceName,P=this.comObj,u=this.streamControllers[R],t=this.streamSinks[R];switch(p.stream){case k.START_COMPLETE:p.success?u.startCall.resolve():u.startCall.reject(M(p.reason));break;case k.PULL_COMPLETE:p.success?u.pullCall.resolve():u.pullCall.reject(M(p.reason));break;case k.PULL:if(!t){P.postMessage({sourceName:N,targetName:x,stream:k.PULL_COMPLETE,streamId:R,success:!0});break}t.desiredSize<=0&&p.desiredSize>0&&t.sinkCapability.resolve(),t.desiredSize=p.desiredSize,new Promise(function(s){s(t.onPull&&t.onPull())}).then(function(){P.postMessage({sourceName:N,targetName:x,stream:k.PULL_COMPLETE,streamId:R,success:!0})},function(s){P.postMessage({sourceName:N,targetName:x,stream:k.PULL_COMPLETE,streamId:R,reason:M(s)})});break;case k.ENQUEUE:if((0,e.assert)(u,"enqueue should have stream controller"),u.isClosed)break;u.controller.enqueue(p.chunk);break;case k.CLOSE:if((0,e.assert)(u,"close should have stream controller"),u.isClosed)break;u.isClosed=!0,u.controller.close(),this._deleteStreamController(u,R);break;case k.ERROR:(0,e.assert)(u,"error should have stream controller"),u.controller.error(M(p.reason)),this._deleteStreamController(u,R);break;case k.CANCEL_COMPLETE:p.success?u.cancelCall.resolve():u.cancelCall.reject(M(p.reason)),this._deleteStreamController(u,R);break;case k.CANCEL:if(!t)break;new Promise(function(s){s(t.onCancel&&t.onCancel(M(p.reason)))}).then(function(){P.postMessage({sourceName:N,targetName:x,stream:k.CANCEL_COMPLETE,streamId:R,success:!0})},function(s){P.postMessage({sourceName:N,targetName:x,stream:k.CANCEL_COMPLETE,streamId:R,reason:M(s)})}),t.sinkCapability.reject(M(p.reason)),t.isCancelled=!0,delete this.streamSinks[R];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(p,R){await Promise.allSettled([p.startCall&&p.startCall.promise,p.pullCall&&p.pullCall.promise,p.cancelCall&&p.cancelCall.promise]),delete this.streamControllers[R]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}n.MessageHandler=C},(b,n,_)=>{var k,M;Object.defineProperty(n,"__esModule",{value:!0}),n.Metadata=void 0;var e=_(1);class a{constructor({parsedData:S,rawData:p}){oe(this,k,void 0);oe(this,M,void 0);ye(this,k,S),ye(this,M,p)}getRaw(){return I(this,M)}get(S){return I(this,k).get(S)??null}getAll(){return(0,e.objectFromMap)(I(this,k))}has(S){return I(this,k).has(S)}}k=new WeakMap,M=new WeakMap,n.Metadata=a},(b,n,_)=>{var C,S,p,R,N,x,dt;Object.defineProperty(n,"__esModule",{value:!0}),n.OptionalContentConfig=void 0;var e=_(1);const a=Symbol("INTERNAL");class k{constructor(t,s){oe(this,C,!0);this.name=t,this.intent=s}get visible(){return I(this,C)}_setVisible(t,s){t!==a&&(0,e.unreachable)("Internal method `_setVisible` called."),ye(this,C,s)}}C=new WeakMap;class M{constructor(t){oe(this,x);oe(this,S,!0);oe(this,p,new Map);oe(this,R,null);oe(this,N,null);if(this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,ye(this,N,t.order);for(const s of t.groups)I(this,p).set(s.id,new k(s.name,s.intent));if(t.baseState==="OFF")for(const s of I(this,p).values())s._setVisible(a,!1);for(const s of t.on)I(this,p).get(s)._setVisible(a,!0);for(const s of t.off)I(this,p).get(s)._setVisible(a,!1);ye(this,R,new Map);for(const[s,c]of I(this,p))I(this,R).set(s,c.visible)}}isVisible(t){if(I(this,p).size===0)return!0;if(!t)return(0,e.warn)("Optional content group not defined."),!0;if(t.type==="OCG")return I(this,p).has(t.id)?I(this,p).get(t.id).visible:((0,e.warn)(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return ue(this,x,dt).call(this,t.expression);if(!t.policy||t.policy==="AnyOn"){for(const s of t.ids){if(!I(this,p).has(s))return(0,e.warn)(`Optional content group not found: ${s}`),!0;if(I(this,p).get(s).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const s of t.ids){if(!I(this,p).has(s))return(0,e.warn)(`Optional content group not found: ${s}`),!0;if(!I(this,p).get(s).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const s of t.ids){if(!I(this,p).has(s))return(0,e.warn)(`Optional content group not found: ${s}`),!0;if(!I(this,p).get(s).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const s of t.ids){if(!I(this,p).has(s))return(0,e.warn)(`Optional content group not found: ${s}`),!0;if(I(this,p).get(s).visible)return!1}return!0}return(0,e.warn)(`Unknown optional content policy ${t.policy}.`),!0}return(0,e.warn)(`Unknown group type ${t.type}.`),!0}setVisibility(t,s=!0){if(!I(this,p).has(t)){(0,e.warn)(`Optional content group not found: ${t}`);return}I(this,p).get(t)._setVisible(a,!!s),ye(this,S,null)}get hasInitialVisibility(){if(I(this,S)!==null)return I(this,S);for(const[t,s]of I(this,p)){const c=I(this,R).get(t);if(s.visible!==c)return ye(this,S,!1)}return ye(this,S,!0)}getOrder(){return I(this,p).size?I(this,N)?I(this,N).slice():[...I(this,p).keys()]:null}getGroups(){return I(this,p).size>0?(0,e.objectFromMap)(I(this,p)):null}getGroup(t){return I(this,p).get(t)||null}}S=new WeakMap,p=new WeakMap,R=new WeakMap,N=new WeakMap,x=new WeakSet,dt=function(t){const s=t.length;if(s<2)return!0;const c=t[0];for(let A=1;A<s;A++){const E=t[A];let h;if(Array.isArray(E))h=ue(this,x,dt).call(this,E);else if(I(this,p).has(E))h=I(this,p).get(E).visible;else return(0,e.warn)(`Optional content group not found: ${E}`),!0;switch(c){case"And":if(!h)return!1;break;case"Or":if(h)return!0;break;case"Not":return!h;default:return!0}}return c==="And"},n.OptionalContentConfig=M},(b,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFDataTransportStream=void 0;var e=_(1),a=_(8);class k{constructor(p,R){(0,e.assert)(R,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=p.progressiveDone||!1,this._contentDispositionFilename=p.contentDispositionFilename||null;const N=p.initialData;if((N==null?void 0:N.length)>0){const x=new Uint8Array(N).buffer;this._queuedChunks.push(x)}this._pdfDataRangeTransport=R,this._isStreamingSupported=!p.disableStream,this._isRangeSupported=!p.disableRange,this._contentLength=p.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((x,P)=>{this._onReceiveData({begin:x,chunk:P})}),this._pdfDataRangeTransport.addProgressListener((x,P)=>{this._onProgress({loaded:x,total:P})}),this._pdfDataRangeTransport.addProgressiveReadListener(x=>{this._onReceiveData({chunk:x})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(p){const R=new Uint8Array(p.chunk).buffer;if(p.begin===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(R):this._queuedChunks.push(R);else{const N=this._rangeReaders.some(function(x){return x._begin!==p.begin?!1:(x._enqueue(R),!0)});(0,e.assert)(N,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var p;return((p=this._fullRequestReader)==null?void 0:p._loaded)??0}_onProgress(p){if(p.total===void 0){const R=this._rangeReaders[0];R!=null&&R.onProgress&&R.onProgress({loaded:p.loaded})}else{const R=this._fullRequestReader;R!=null&&R.onProgress&&R.onProgress({loaded:p.loaded,total:p.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(p){const R=this._rangeReaders.indexOf(p);R>=0&&this._rangeReaders.splice(R,1)}getFullReader(){(0,e.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const p=this._queuedChunks;return this._queuedChunks=null,new M(this,p,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(p,R){if(R<=this._progressiveDataLength)return null;const N=new C(this,p,R);return this._pdfDataRangeTransport.requestDataRange(p,R),this._rangeReaders.push(N),N}cancelAllRequests(p){this._fullRequestReader&&this._fullRequestReader.cancel(p);for(const R of this._rangeReaders.slice(0))R.cancel(p);this._pdfDataRangeTransport.abort()}}n.PDFDataTransportStream=k;class M{constructor(p,R,N=!1,x=null){this._stream=p,this._done=N||!1,this._filename=(0,a.isPdfFile)(x)?x:null,this._queuedChunks=R||[],this._loaded=0;for(const P of this._queuedChunks)this._loaded+=P.byteLength;this._requests=[],this._headersReady=Promise.resolve(),p._fullRequestReader=this,this.onProgress=null}_enqueue(p){this._done||(this._requests.length>0?this._requests.shift().resolve({value:p,done:!1}):this._queuedChunks.push(p),this._loaded+=p.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const p=(0,e.createPromiseCapability)();return this._requests.push(p),p.promise}cancel(p){this._done=!0;for(const R of this._requests)R.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class C{constructor(p,R,N){this._stream=p,this._begin=R,this._end=N,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(p){if(!this._done){if(this._requests.length===0)this._queuedChunk=p;else{this._requests.shift().resolve({value:p,done:!1});for(const N of this._requests)N.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const R=this._queuedChunk;return this._queuedChunk=null,{value:R,done:!1}}if(this._done)return{value:void 0,done:!0};const p=(0,e.createPromiseCapability)();return this._requests.push(p),p.promise}cancel(p){this._done=!0;for(const R of this._requests)R.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(b,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.XfaText=void 0;class _{static textContent(a){const k=[],M={items:k,styles:Object.create(null)};function C(S){var N;if(!S)return;let p=null;const R=S.name;if(R==="#text")p=S.value;else if(_.shouldBuildText(R))(N=S==null?void 0:S.attributes)!=null&&N.textContent?p=S.attributes.textContent:S.value&&(p=S.value);else return;if(p!==null&&k.push({str:p}),!!S.children)for(const x of S.children)C(x)}return C(a),M}static shouldBuildText(a){return!(a==="textarea"||a==="input"||a==="option"||a==="select")}}n.XfaText=_},(b,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.NodeStandardFontDataFactory=n.NodeCanvasFactory=n.NodeCMapReaderFactory=void 0;var e=_(9);const a=function(S){return new Promise((p,R)=>{require$$5.readFile(S,(x,P)=>{if(x||!P){R(new Error(x));return}p(new Uint8Array(P))})})};class k extends e.BaseCanvasFactory{_createCanvas(p,R){return require$$5.createCanvas(p,R)}}n.NodeCanvasFactory=k;class M extends e.BaseCMapReaderFactory{_fetchData(p,R){return a(p).then(N=>({cMapData:N,compressionType:R}))}}n.NodeCMapReaderFactory=M;class C extends e.BaseStandardFontDataFactory{_fetchData(p){return a(p)}}n.NodeStandardFontDataFactory=C},(b,n,_)=>{var S,p,R,N,x,P,u,t,s,ft,A,kt,h,pt,o,Ft;Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationEditorLayer=void 0;var e=_(7),a=_(1),k=_(23),M=_(24);const O=class O{constructor(y){oe(this,s);oe(this,A);oe(this,h);oe(this,o);oe(this,S,void 0);oe(this,p,!1);oe(this,R,this.pointerup.bind(this));oe(this,N,this.pointerdown.bind(this));oe(this,x,new Map);oe(this,P,!1);oe(this,u,!1);oe(this,t,void 0);O._initialized||(O._initialized=!0,k.FreeTextEditor.initialize(y.l10n),M.InkEditor.initialize(y.l10n),y.uiManager.registerEditorTypes([k.FreeTextEditor,M.InkEditor])),ye(this,t,y.uiManager),this.annotationStorage=y.annotationStorage,this.pageIndex=y.pageIndex,this.div=y.div,ye(this,S,y.accessibilityManager),I(this,t).addLayer(this)}updateToolbar(y){I(this,t).updateToolbar(y)}updateMode(y=I(this,t).getMode()){ue(this,o,Ft).call(this),y===a.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),I(this,t).unselectAll()}addInkEditorIfNeeded(y){if(!y&&I(this,t).getMode()!==a.AnnotationEditorType.INK)return;if(!y){for(const te of I(this,x).values())if(te.isEmpty()){te.setInBackground();return}}ue(this,h,pt).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(y){I(this,t).setEditingState(y)}addCommands(y){I(this,t).addCommands(y)}enable(){this.div.style.pointerEvents="auto";for(const y of I(this,x).values())y.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const y of I(this,x).values())y.disableEditing()}setActiveEditor(y){I(this,t).getActive()!==y&&I(this,t).setActiveEditor(y)}enableClick(){this.div.addEventListener("pointerdown",I(this,N)),this.div.addEventListener("pointerup",I(this,R))}disableClick(){this.div.removeEventListener("pointerdown",I(this,N)),this.div.removeEventListener("pointerup",I(this,R))}attach(y){I(this,x).set(y.id,y)}detach(y){var D;I(this,x).delete(y.id),(D=I(this,S))==null||D.removePointerInTextLayer(y.contentDiv)}remove(y){I(this,t).removeEditor(y),this.detach(y),this.annotationStorage.remove(y.id),y.div.style.display="none",setTimeout(()=>{y.div.style.display="",y.div.remove(),y.isAttachedToDOM=!1,document.activeElement===document.body&&I(this,t).focusMainContainer()},0),I(this,u)||this.addInkEditorIfNeeded(!1)}add(y){if(ue(this,s,ft).call(this,y),I(this,t).addEditor(y),this.attach(y),!y.isAttachedToDOM){const D=y.render();this.div.append(D),y.isAttachedToDOM=!0}this.moveEditorInDOM(y),y.onceAdded(),this.addToAnnotationStorage(y)}moveEditorInDOM(y){var D;(D=I(this,S))==null||D.moveElementInDOM(this.div,y.div,y.contentDiv,!0)}addToAnnotationStorage(y){!y.isEmpty()&&!this.annotationStorage.has(y.id)&&this.annotationStorage.setValue(y.id,y)}addOrRebuild(y){y.needsToBeRebuilt()?y.rebuild():this.add(y)}addANewEditor(y){const D=()=>{this.addOrRebuild(y)},te=()=>{y.remove()};this.addCommands({cmd:D,undo:te,mustExec:!0})}addUndoableEditor(y){const D=()=>{this.addOrRebuild(y)},te=()=>{y.remove()};this.addCommands({cmd:D,undo:te,mustExec:!1})}getNextId(){return I(this,t).getId()}deserialize(y){switch(y.annotationType){case a.AnnotationEditorType.FREETEXT:return k.FreeTextEditor.deserialize(y,this);case a.AnnotationEditorType.INK:return M.InkEditor.deserialize(y,this)}return null}setSelected(y){I(this,t).setSelected(y)}toggleSelected(y){I(this,t).toggleSelected(y)}isSelected(y){return I(this,t).isSelected(y)}unselect(y){I(this,t).unselect(y)}pointerup(y){const D=e.KeyboardManager.platform.isMac;if(!(y.button!==0||y.ctrlKey&&D)&&y.target===this.div&&I(this,P)){if(ye(this,P,!1),!I(this,p)){ye(this,p,!0);return}ue(this,h,pt).call(this,y)}}pointerdown(y){const D=e.KeyboardManager.platform.isMac;if(y.button!==0||y.ctrlKey&&D||y.target!==this.div)return;ye(this,P,!0);const te=I(this,t).getActive();ye(this,p,!te||te.isEmpty())}drop(y){const D=y.dataTransfer.getData("text/plain"),te=I(this,t).getEditor(D);if(!te)return;y.preventDefault(),y.dataTransfer.dropEffect="move",ue(this,s,ft).call(this,te);const se=this.div.getBoundingClientRect(),Z=y.clientX-se.x,J=y.clientY-se.y;te.translate(Z-te.startX,J-te.startY),this.moveEditorInDOM(te),te.div.focus()}dragover(y){y.preventDefault()}destroy(){var y,D;((y=I(this,t).getActive())==null?void 0:y.parent)===this&&I(this,t).setActiveEditor(null);for(const te of I(this,x).values())(D=I(this,S))==null||D.removePointerInTextLayer(te.contentDiv),te.isAttachedToDOM=!1,te.div.remove(),te.parent=null;this.div=null,I(this,x).clear(),I(this,t).removeLayer(this)}render(y){this.viewport=y.viewport,(0,e.bindEvents)(this,this.div,["dragover","drop"]),this.setDimensions();for(const D of I(this,t).getEditors(this.pageIndex))this.add(D);this.updateMode()}update(y){this.viewport=y.viewport,this.setDimensions(),this.updateMode()}get scaleFactor(){return this.viewport.scale}get pageDimensions(){const[y,D,te,se]=this.viewport.viewBox,Z=te-y,J=se-D;return[Z,J]}get viewportBaseDimensions(){const{width:y,height:D,rotation:te}=this.viewport;return te%180===0?[y,D]:[D,y]}setDimensions(){const{width:y,height:D,rotation:te}=this.viewport,se=te%180!==0,Z=Math.floor(y)+"px",J=Math.floor(D)+"px";this.div.style.width=se?J:Z,this.div.style.height=se?Z:J,this.div.setAttribute("data-main-rotation",te)}};S=new WeakMap,p=new WeakMap,R=new WeakMap,N=new WeakMap,x=new WeakMap,P=new WeakMap,u=new WeakMap,t=new WeakMap,s=new WeakSet,ft=function(y){var D;y.parent!==this&&(this.attach(y),y.pageIndex=this.pageIndex,(D=y.parent)==null||D.detach(y),y.parent=this,y.div&&y.isAttachedToDOM&&(y.div.remove(),this.div.append(y.div)))},A=new WeakSet,kt=function(y){switch(I(this,t).getMode()){case a.AnnotationEditorType.FREETEXT:return new k.FreeTextEditor(y);case a.AnnotationEditorType.INK:return new M.InkEditor(y)}return null},h=new WeakSet,pt=function(y){const D=this.getNextId(),te=ue(this,A,kt).call(this,{parent:this,id:D,x:y.offsetX,y:y.offsetY});return te&&this.add(te),te},o=new WeakSet,Ft=function(){ye(this,u,!0);for(const y of I(this,x).values())y.isEmpty()&&y.remove();ye(this,u,!1)},Me(O,"_initialized",!1);let C=O;n.AnnotationEditorLayer=C},(b,n,_)=>{var C,S,p,R,N,x,P,u,Ot,s,Mt,A,Dt,h,gt;Object.defineProperty(n,"__esModule",{value:!0}),n.FreeTextEditor=void 0;var e=_(1),a=_(7),k=_(6);const o=class o extends k.AnnotationEditor{constructor(T){super({...T,name:"freeTextEditor"});oe(this,u);oe(this,s);oe(this,A);oe(this,h);oe(this,C,this.editorDivBlur.bind(this));oe(this,S,this.editorDivFocus.bind(this));oe(this,p,this.editorDivKeydown.bind(this));oe(this,R,void 0);oe(this,N,"");oe(this,x,!1);oe(this,P,void 0);ye(this,R,T.color||o._defaultColor||k.AnnotationEditor._defaultLineColor),ye(this,P,T.fontSize||o._defaultFontSize)}static initialize(T){this._l10nPromise=new Map(["free_text_default_content","editor_free_text_aria_label"].map(D=>[D,T.get(D)]));const y=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(y.getPropertyValue("--freetext-padding"))}static updateDefaultParams(T,y){switch(T){case e.AnnotationEditorParamsType.FREETEXT_SIZE:o._defaultFontSize=y;break;case e.AnnotationEditorParamsType.FREETEXT_COLOR:o._defaultColor=y;break}}updateParams(T,y){switch(T){case e.AnnotationEditorParamsType.FREETEXT_SIZE:ue(this,u,Ot).call(this,y);break;case e.AnnotationEditorParamsType.FREETEXT_COLOR:ue(this,s,Mt).call(this,y);break}}static get defaultPropertiesToUpdate(){return[[e.AnnotationEditorParamsType.FREETEXT_SIZE,o._defaultFontSize],[e.AnnotationEditorParamsType.FREETEXT_COLOR,o._defaultColor||k.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[e.AnnotationEditorParamsType.FREETEXT_SIZE,I(this,P)],[e.AnnotationEditorParamsType.FREETEXT_COLOR,I(this,R)]]}getInitialTranslation(){return[-o._internalPadding*this.parent.scaleFactor,-(o._internalPadding+I(this,P))*this.parent.scaleFactor]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(e.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.enableEditing(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.editorDiv.addEventListener("keydown",I(this,p)),this.editorDiv.addEventListener("focus",I(this,S)),this.editorDiv.addEventListener("blur",I(this,C)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.disableEditing(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",I(this,p)),this.editorDiv.removeEventListener("focus",I(this,S)),this.editorDiv.removeEventListener("blur",I(this,C)),this.div.focus(),this.isEditing=!1)}focusin(T){super.focusin(T),T.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),super.remove()}commit(){super.commit(),I(this,x)||(ye(this,x,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),ye(this,N,ue(this,A,Dt).call(this).trimEnd()),ue(this,h,gt).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(T){this.enableEditMode(),this.editorDiv.focus()}keydown(T){T.target===this.div&&T.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(T){o._keyboardManager.exec(this,T)}editorDivFocus(T){this.isEditing=!0}editorDivBlur(T){this.isEditing=!1}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let T,y;this.width&&(T=this.x,y=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",`${this.id}-editor`),this.enableEditing(),o._l10nPromise.get("editor_free_text_aria_label").then(te=>{var se;return(se=this.editorDiv)==null?void 0:se.setAttribute("aria-label",te)}),o._l10nPromise.get("free_text_default_content").then(te=>{var se;return(se=this.editorDiv)==null?void 0:se.setAttribute("default-content",te)}),this.editorDiv.contentEditable=!0;const{style:D}=this.editorDiv;if(D.fontSize=`calc(${I(this,P)}px * var(--scale-factor))`,D.color=I(this,R),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,a.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[te,se]=this.parent.viewportBaseDimensions;this.setAt(T*te,y*se,this.width*te,this.height*se);for(const Z of I(this,N).split(`
`)){const J=document.createElement("div");J.append(Z?document.createTextNode(Z):document.createElement("br")),this.editorDiv.append(J)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(T,y){const D=super.deserialize(T,y);return ye(D,P,T.fontSize),ye(D,R,e.Util.makeHexColor(...T.color)),ye(D,N,T.value),D}serialize(){if(this.isEmpty())return null;const T=o._internalPadding*this.parent.scaleFactor,y=this.getRect(T,T),D=k.AnnotationEditor._colorManager.convert(getComputedStyle(this.editorDiv).color);return{annotationType:e.AnnotationEditorType.FREETEXT,color:D,fontSize:I(this,P),value:I(this,N),pageIndex:this.parent.pageIndex,rect:y,rotation:this.rotation}}};C=new WeakMap,S=new WeakMap,p=new WeakMap,R=new WeakMap,N=new WeakMap,x=new WeakMap,P=new WeakMap,u=new WeakSet,Ot=function(T){const y=te=>{this.editorDiv.style.fontSize=`calc(${te}px * var(--scale-factor))`,this.translate(0,-(te-I(this,P))*this.parent.scaleFactor),ye(this,P,te),ue(this,h,gt).call(this)},D=I(this,P);this.parent.addCommands({cmd:()=>{y(T)},undo:()=>{y(D)},mustExec:!0,type:e.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},s=new WeakSet,Mt=function(T){const y=I(this,R);this.parent.addCommands({cmd:()=>{ye(this,R,T),this.editorDiv.style.color=T},undo:()=>{ye(this,R,y),this.editorDiv.style.color=y},mustExec:!0,type:e.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},A=new WeakSet,Dt=function(){const T=this.editorDiv.getElementsByTagName("div");if(T.length===0)return this.editorDiv.innerText;const y=[];for(let D=0,te=T.length;D<te;D++){const Z=T[D].firstChild;(Z==null?void 0:Z.nodeName)==="#text"?y.push(Z.data):y.push("")}return y.join(`
`)},h=new WeakSet,gt=function(){const[T,y]=this.parent.viewportBaseDimensions,D=this.div.getBoundingClientRect();this.width=D.width/T,this.height=D.height/y},Me(o,"_freeTextDefaultContent",""),Me(o,"_l10nPromise"),Me(o,"_internalPadding",0),Me(o,"_defaultColor",null),Me(o,"_defaultFontSize",10),Me(o,"_keyboardManager",new a.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],o.prototype.commitOrRemove]])),Me(o,"_type","freetext");let M=o;n.FreeTextEditor=M},(b,n,_)=>{var p,R,N,x,P,u,t,s,c,A,E,h,i,o,m,It,T,Lt,D,Nt,se,jt,J,mt,V,Ut,re,Bt,be,Wt,f,$e,F,yt,B,nt,X,rt,l,Ke,v,_t,L,it,ie,bt,ee,qt,ne,Ht,pe,Gt,fe,vt,Se,st,xe,Je,Fe,At;Object.defineProperty(n,"__esModule",{value:!0}),n.InkEditor=void 0,Object.defineProperty(n,"fitCurve",{enumerable:!0,get:function(){return k.fitCurve}});var e=_(1),a=_(6),k=_(25),M=_(7);const C=16,Te=class Te extends a.AnnotationEditor{constructor(ae){super({...ae,name:"inkEditor"});oe(this,m);oe(this,T);oe(this,D);oe(this,se);oe(this,J);oe(this,V);oe(this,re);oe(this,be);oe(this,f);oe(this,F);oe(this,B);oe(this,X);oe(this,l);oe(this,v);oe(this,L);oe(this,ee);oe(this,ne);oe(this,pe);oe(this,fe);oe(this,Se);oe(this,xe);oe(this,Fe);oe(this,p,0);oe(this,R,0);oe(this,N,0);oe(this,x,this.canvasPointermove.bind(this));oe(this,P,this.canvasPointerleave.bind(this));oe(this,u,this.canvasPointerup.bind(this));oe(this,t,this.canvasPointerdown.bind(this));oe(this,s,!1);oe(this,c,!1);oe(this,A,null);oe(this,E,null);oe(this,h,0);oe(this,i,0);oe(this,o,null);this.color=ae.color||null,this.thickness=ae.thickness||null,this.opacity=ae.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(ae){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink_aria_label"].map(ge=>[ge,ae.get(ge)]))}static updateDefaultParams(ae,ge){switch(ae){case e.AnnotationEditorParamsType.INK_THICKNESS:Te._defaultThickness=ge;break;case e.AnnotationEditorParamsType.INK_COLOR:Te._defaultColor=ge;break;case e.AnnotationEditorParamsType.INK_OPACITY:Te._defaultOpacity=ge/100;break}}updateParams(ae,ge){switch(ae){case e.AnnotationEditorParamsType.INK_THICKNESS:ue(this,m,It).call(this,ge);break;case e.AnnotationEditorParamsType.INK_COLOR:ue(this,T,Lt).call(this,ge);break;case e.AnnotationEditorParamsType.INK_OPACITY:ue(this,D,Nt).call(this,ge);break}}static get defaultPropertiesToUpdate(){return[[e.AnnotationEditorParamsType.INK_THICKNESS,Te._defaultThickness],[e.AnnotationEditorParamsType.INK_COLOR,Te._defaultColor||a.AnnotationEditor._defaultLineColor],[e.AnnotationEditorParamsType.INK_OPACITY,Math.round(Te._defaultOpacity*100)]]}get propertiesToUpdate(){return[[e.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Te._defaultThickness],[e.AnnotationEditorParamsType.INK_COLOR,this.color||Te._defaultColor||a.AnnotationEditor._defaultLineColor],[e.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??Te._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(ue(this,B,nt).call(this),ue(this,X,rt).call(this)),this.isAttachedToDOM||(this.parent.add(this),ue(this,l,Ke).call(this)),ue(this,xe,Je).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,I(this,E).disconnect(),ye(this,E,null),super.remove())}enableEditMode(){I(this,s)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",I(this,t)),this.canvas.addEventListener("pointerup",I(this,u)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",I(this,t)),this.canvas.removeEventListener("pointerup",I(this,u)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){I(this,s)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),ye(this,s,!0),this.div.classList.add("disabled"),ue(this,xe,Je).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus())}focusin(ae){super.focusin(ae),this.enableEditMode()}canvasPointerdown(ae){ae.button!==0||!this.isInEditMode()||I(this,s)||(this.setInForeground(),ae.type!=="mouse"&&this.div.focus(),ae.stopPropagation(),this.canvas.addEventListener("pointerleave",I(this,P)),this.canvas.addEventListener("pointermove",I(this,x)),ue(this,V,Ut).call(this,ae.offsetX,ae.offsetY))}canvasPointermove(ae){ae.stopPropagation(),ue(this,re,Bt).call(this,ae.offsetX,ae.offsetY)}canvasPointerup(ae){ae.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(ae.stopPropagation(),ue(this,F,yt).call(this,ae),this.setInBackground())}canvasPointerleave(ae){ue(this,F,yt).call(this,ae),this.setInBackground()}render(){if(this.div)return this.div;let ae,ge;this.width&&(ae=this.x,ge=this.y),super.render(),Te._l10nPromise.get("editor_ink_aria_label").then(_e=>{var Ae;return(Ae=this.div)==null?void 0:Ae.setAttribute("aria-label",_e)});const[Q,$,z,me]=ue(this,se,jt).call(this);if(this.setAt(Q,$,0,0),this.setDims(z,me),ue(this,B,nt).call(this),this.width){const[_e,Ae]=this.parent.viewportBaseDimensions;this.setAt(ae*_e,ge*Ae,this.width*_e,this.height*Ae),ye(this,c,!0),ue(this,l,Ke).call(this),this.setDims(this.width*_e,this.height*Ae),ue(this,f,$e).call(this),ue(this,Fe,At).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return ue(this,X,rt).call(this),this.div}setDimensions(ae,ge){const Q=Math.round(ae),$=Math.round(ge);if(I(this,h)===Q&&I(this,i)===$)return;ye(this,h,Q),ye(this,i,$),this.canvas.style.visibility="hidden",I(this,p)&&Math.abs(I(this,p)-ae/ge)>.01&&(ge=Math.ceil(ae/I(this,p)),this.setDims(ae,ge));const[z,me]=this.parent.viewportBaseDimensions;this.width=ae/z,this.height=ge/me,I(this,s)&&ue(this,v,_t).call(this,ae,ge),ue(this,l,Ke).call(this),ue(this,f,$e).call(this),this.canvas.style.visibility="visible"}static deserialize(ae,ge){var Ie,ke;const Q=super.deserialize(ae,ge);Q.thickness=ae.thickness,Q.color=e.Util.makeHexColor(...ae.color),Q.opacity=ae.opacity;const[$,z]=ge.pageDimensions,me=Q.width*$,_e=Q.height*z,Ae=ge.scaleFactor,Ee=ae.thickness/2;ye(Q,p,me/_e),ye(Q,s,!0),ye(Q,h,Math.round(me)),ye(Q,i,Math.round(_e));for(const{bezier:Ce}of ae.paths){const Ne=[];Q.paths.push(Ne);let Le=Ae*(Ce[0]-Ee),Be=Ae*(_e-Ce[1]-Ee);for(let je=2,qe=Ce.length;je<qe;je+=6){const Ve=Ae*(Ce[je]-Ee),Xe=Ae*(_e-Ce[je+1]-Ee),Ge=Ae*(Ce[je+2]-Ee),Ue=Ae*(_e-Ce[je+3]-Ee),He=Ae*(Ce[je+4]-Ee),Ye=Ae*(_e-Ce[je+5]-Ee);Ne.push([[Le,Be],[Ve,Xe],[Ge,Ue],[He,Ye]]),Le=He,Be=Ye}const Re=ue(this,ie,bt).call(this,Ne);Q.bezierPath2D.push(Re)}const we=ue(Ie=Q,fe,vt).call(Ie);return ye(Q,N,Math.max(C,we[2]-we[0])),ye(Q,R,Math.max(C,we[3]-we[1])),ue(ke=Q,v,_t).call(ke,me,_e),Q}serialize(){if(this.isEmpty())return null;const ae=this.getRect(0,0),ge=this.rotation%180===0?ae[3]-ae[1]:ae[2]-ae[0],Q=a.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:e.AnnotationEditorType.INK,color:Q,thickness:this.thickness,opacity:this.opacity,paths:ue(this,ee,qt).call(this,this.scaleFactor/this.parent.scaleFactor,this.translationX,this.translationY,ge),pageIndex:this.parent.pageIndex,rect:ae,rotation:this.rotation}}};p=new WeakMap,R=new WeakMap,N=new WeakMap,x=new WeakMap,P=new WeakMap,u=new WeakMap,t=new WeakMap,s=new WeakMap,c=new WeakMap,A=new WeakMap,E=new WeakMap,h=new WeakMap,i=new WeakMap,o=new WeakMap,m=new WeakSet,It=function(ae){const ge=this.thickness;this.parent.addCommands({cmd:()=>{this.thickness=ae,ue(this,xe,Je).call(this)},undo:()=>{this.thickness=ge,ue(this,xe,Je).call(this)},mustExec:!0,type:e.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},T=new WeakSet,Lt=function(ae){const ge=this.color;this.parent.addCommands({cmd:()=>{this.color=ae,ue(this,f,$e).call(this)},undo:()=>{this.color=ge,ue(this,f,$e).call(this)},mustExec:!0,type:e.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},D=new WeakSet,Nt=function(ae){ae/=100;const ge=this.opacity;this.parent.addCommands({cmd:()=>{this.opacity=ae,ue(this,f,$e).call(this)},undo:()=>{this.opacity=ge,ue(this,f,$e).call(this)},mustExec:!0,type:e.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},se=new WeakSet,jt=function(){const{width:ae,height:ge,rotation:Q}=this.parent.viewport;switch(Q){case 90:return[0,ae,ae,ge];case 180:return[ae,ge,ae,ge];case 270:return[ge,0,ae,ge];default:return[0,0,ae,ge]}},J=new WeakSet,mt=function(){this.ctx.lineWidth=this.thickness*this.parent.scaleFactor/this.scaleFactor,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.miterLimit=10,this.ctx.strokeStyle=`${this.color}${(0,M.opacityToHex)(this.opacity)}`},V=new WeakSet,Ut=function(ae,ge){this.isEditing=!0,I(this,c)||(ye(this,c,!0),ue(this,l,Ke).call(this),this.thickness||(this.thickness=Te._defaultThickness),this.color||(this.color=Te._defaultColor||a.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=Te._defaultOpacity)),this.currentPath.push([ae,ge]),ye(this,A,null),ue(this,J,mt).call(this),this.ctx.beginPath(),this.ctx.moveTo(ae,ge),ye(this,o,()=>{I(this,o)&&(I(this,A)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):ue(this,f,$e).call(this),this.ctx.lineTo(...I(this,A)),ye(this,A,null),this.ctx.stroke()),window.requestAnimationFrame(I(this,o)))}),window.requestAnimationFrame(I(this,o))},re=new WeakSet,Bt=function(ae,ge){const[Q,$]=this.currentPath.at(-1);ae===Q&&ge===$||(this.currentPath.push([ae,ge]),ye(this,A,[ae,ge]))},be=new WeakSet,Wt=function(ae,ge){var Ee;this.ctx.closePath(),ye(this,o,null),ae=Math.min(Math.max(ae,0),this.canvas.width),ge=Math.min(Math.max(ge,0),this.canvas.height);const[Q,$]=this.currentPath.at(-1);(ae!==Q||ge!==$)&&this.currentPath.push([ae,ge]);let z;if(this.currentPath.length!==1)z=(0,k.fitCurve)(this.currentPath,30,null);else{const we=[ae,ge];z=[[we,we.slice(),we.slice(),we]]}const me=ue(Ee=Te,ie,bt).call(Ee,z);this.currentPath.length=0;const _e=()=>{this.paths.push(z),this.bezierPath2D.push(me),this.rebuild()},Ae=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(ue(this,B,nt).call(this),ue(this,X,rt).call(this)),ue(this,xe,Je).call(this))};this.parent.addCommands({cmd:_e,undo:Ae,mustExec:!0})},f=new WeakSet,$e=function(){if(this.isEmpty()){ue(this,L,it).call(this);return}ue(this,J,mt).call(this);const{canvas:ae,ctx:ge}=this;ge.setTransform(1,0,0,1,0,0),ge.clearRect(0,0,ae.width,ae.height),ue(this,L,it).call(this);for(const Q of this.bezierPath2D)ge.stroke(Q)},F=new WeakSet,yt=function(ae){ue(this,be,Wt).call(this,ae.offsetX,ae.offsetY),this.canvas.removeEventListener("pointerleave",I(this,P)),this.canvas.removeEventListener("pointermove",I(this,x)),this.parent.addToAnnotationStorage(this)},B=new WeakSet,nt=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",Te._l10nPromise.get("editor_ink_canvas_aria_label").then(ae=>{var ge;return(ge=this.canvas)==null?void 0:ge.setAttribute("aria-label",ae)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},X=new WeakSet,rt=function(){ye(this,E,new ResizeObserver(ae=>{const ge=ae[0].contentRect;ge.width&&ge.height&&this.setDimensions(ge.width,ge.height)})),I(this,E).observe(this.div)},l=new WeakSet,Ke=function(){if(!I(this,c))return;const[ae,ge]=this.parent.viewportBaseDimensions;this.canvas.width=Math.ceil(this.width*ae),this.canvas.height=Math.ceil(this.height*ge),ue(this,L,it).call(this)},v=new WeakSet,_t=function(ae,ge){const Q=ue(this,Se,st).call(this),$=(ae-Q)/I(this,N),z=(ge-Q)/I(this,R);this.scaleFactor=Math.min($,z)},L=new WeakSet,it=function(){const ae=ue(this,Se,st).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+ae,this.translationY*this.scaleFactor+ae)},ie=new WeakSet,bt=function(ae){const ge=new Path2D;for(let Q=0,$=ae.length;Q<$;Q++){const[z,me,_e,Ae]=ae[Q];Q===0&&ge.moveTo(...z),ge.bezierCurveTo(me[0],me[1],_e[0],_e[1],Ae[0],Ae[1])}return ge},ee=new WeakSet,qt=function(ae,ge,Q,$){const me=[],_e=this.thickness/2;let Ae,Ee;for(const we of this.paths){Ae=[],Ee=[];for(let Ie=0,ke=we.length;Ie<ke;Ie++){const[Ce,Ne,Le,Be]=we[Ie],Re=ae*(Ce[0]+ge)+_e,je=$-ae*(Ce[1]+Q)-_e,qe=ae*(Ne[0]+ge)+_e,Ve=$-ae*(Ne[1]+Q)-_e,Xe=ae*(Le[0]+ge)+_e,Ge=$-ae*(Le[1]+Q)-_e,Ue=ae*(Be[0]+ge)+_e,He=$-ae*(Be[1]+Q)-_e;Ie===0&&(Ae.push(Re,je),Ee.push(Re,je)),Ae.push(qe,Ve,Xe,Ge,Ue,He),ue(this,ne,Ht).call(this,Re,je,qe,Ve,Xe,Ge,Ue,He,4,Ee)}me.push({bezier:Ae,points:Ee})}return me},ne=new WeakSet,Ht=function(ae,ge,Q,$,z,me,_e,Ae,Ee,we){if(ue(this,pe,Gt).call(this,ae,ge,Q,$,z,me,_e,Ae)){we.push(_e,Ae);return}for(let Ie=1;Ie<Ee-1;Ie++){const ke=Ie/Ee,Ce=1-ke;let Ne=ke*ae+Ce*Q,Le=ke*ge+Ce*$,Be=ke*Q+Ce*z,Re=ke*$+Ce*me;const je=ke*z+Ce*_e,qe=ke*me+Ce*Ae;Ne=ke*Ne+Ce*Be,Le=ke*Le+Ce*Re,Be=ke*Be+Ce*je,Re=ke*Re+Ce*qe,Ne=ke*Ne+Ce*Be,Le=ke*Le+Ce*Re,we.push(Ne,Le)}we.push(_e,Ae)},pe=new WeakSet,Gt=function(ae,ge,Q,$,z,me,_e,Ae){const we=(3*Q-2*ae-_e)**2,Ie=(3*$-2*ge-Ae)**2,ke=(3*z-ae-2*_e)**2,Ce=(3*me-ge-2*Ae)**2;return Math.max(we,ke)+Math.max(Ie,Ce)<=10},fe=new WeakSet,vt=function(){let ae=1/0,ge=-1/0,Q=1/0,$=-1/0;for(const z of this.paths)for(const[me,_e,Ae,Ee]of z){const we=e.Util.bezierBoundingBox(...me,..._e,...Ae,...Ee);ae=Math.min(ae,we[0]),Q=Math.min(Q,we[1]),ge=Math.max(ge,we[2]),$=Math.max($,we[3])}return[ae,Q,ge,$]},Se=new WeakSet,st=function(){return I(this,s)?Math.ceil(this.thickness*this.parent.scaleFactor):0},xe=new WeakSet,Je=function(ae=!1){if(this.isEmpty())return;if(!I(this,s)){ue(this,f,$e).call(this);return}const ge=ue(this,fe,vt).call(this),Q=ue(this,Se,st).call(this);ye(this,N,Math.max(C,ge[2]-ge[0])),ye(this,R,Math.max(C,ge[3]-ge[1]));const $=Math.ceil(Q+I(this,N)*this.scaleFactor),z=Math.ceil(Q+I(this,R)*this.scaleFactor),[me,_e]=this.parent.viewportBaseDimensions;this.width=$/me,this.height=z/_e,ye(this,p,$/z),ue(this,Fe,At).call(this);const Ae=this.translationX,Ee=this.translationY;this.translationX=-ge[0],this.translationY=-ge[1],ue(this,l,Ke).call(this),ue(this,f,$e).call(this),ye(this,h,$),ye(this,i,z),this.setDims($,z);const we=ae?Q/this.scaleFactor/2:0;this.translate(Ae-this.translationX-we,Ee-this.translationY-we)},Fe=new WeakSet,At=function(){const{style:ae}=this.div;I(this,p)>=1?(ae.minHeight=`${C}px`,ae.minWidth=`${Math.round(I(this,p)*C)}px`):(ae.minWidth=`${C}px`,ae.minHeight=`${Math.round(C/I(this,p))}px`)},oe(Te,ie),Me(Te,"_defaultColor",null),Me(Te,"_defaultOpacity",1),Me(Te,"_defaultThickness",1),Me(Te,"_l10nPromise"),Me(Te,"_type","ink");let S=Te;n.InkEditor=S},(b,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.fitCurve=void 0;const e=_(26);n.fitCurve=e},b=>{function n(u,t,s){if(!Array.isArray(u))throw new TypeError("First argument should be an array");if(u.forEach(h=>{if(!Array.isArray(h)||h.some(i=>typeof i!="number")||h.length!==u[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),u=u.filter((h,i)=>i===0||!h.every((o,m)=>o===u[i-1][m])),u.length<2)return[];const c=u.length,A=N(u[1],u[0]),E=N(u[c-2],u[c-1]);return _(u,A,E,t,s)}function _(u,t,s,c,A){var h,i,o,m,O,T,y,D,te,se,Z,J,G;if(u.length===2)return J=x.vectorLen(x.subtract(u[0],u[1]))/3,h=[u[0],x.addArrays(u[0],x.mulItems(t,J)),x.addArrays(u[1],x.mulItems(s,J)),u[1]],[h];if(i=C(u),[h,m,T]=e(u,i,i,t,s,A),m===0||m<c)return[h];if(m<c*c)for(o=i,O=m,y=T,G=0;G<20;G++){if(o=k(h,u,o),[h,m,T]=e(u,i,o,t,s,A),m<c)return[h];if(T===y){let V=m/O;if(V>.9999&&V<1.0001)break}O=m,y=T}return Z=[],D=x.subtract(u[T-1],u[T+1]),D.every(V=>V===0)&&(D=x.subtract(u[T-1],u[T]),[D[0],D[1]]=[-D[1],D[0]]),te=x.normalize(D),se=x.mulItems(te,-1),Z=Z.concat(_(u.slice(0,T+1),t,te,c,A)),Z=Z.concat(_(u.slice(T),se,s,c,A)),Z}function e(u,t,s,c,A,E){var h,i,o;return h=a(u,s,c,A),[i,o]=S(u,h,t),E&&E({bez:h,points:u,params:t,maxErr:i,maxPoint:o}),[h,i,o]}function a(u,t,s,c){var A,E,h,i,o,m,O,T,y,D,te,se,Z,J,G,V,K,re=u[0],he=u[u.length-1];for(A=[re,null,null,he],E=x.zeros_Xx2x2(t.length),Z=0,J=t.length;Z<J;Z++)V=t[Z],K=1-V,h=E[Z],h[0]=x.mulItems(s,3*V*(K*K)),h[1]=x.mulItems(c,3*K*(V*V));for(i=[[0,0],[0,0]],o=[0,0],Z=0,J=u.length;Z<J;Z++)V=t[Z],h=E[Z],i[0][0]+=x.dot(h[0],h[0]),i[0][1]+=x.dot(h[0],h[1]),i[1][0]+=x.dot(h[0],h[1]),i[1][1]+=x.dot(h[1],h[1]),G=x.subtract(u[Z],P.q([re,re,he,he],V)),o[0]+=x.dot(h[0],G),o[1]+=x.dot(h[1],G);return m=i[0][0]*i[1][1]-i[1][0]*i[0][1],O=i[0][0]*o[1]-i[1][0]*o[0],T=o[0]*i[1][1]-o[1]*i[0][1],y=m===0?0:T/m,D=m===0?0:O/m,se=x.vectorLen(x.subtract(re,he)),te=1e-6*se,y<te||D<te?(A[1]=x.addArrays(re,x.mulItems(s,se/3)),A[2]=x.addArrays(he,x.mulItems(c,se/3))):(A[1]=x.addArrays(re,x.mulItems(s,y)),A[2]=x.addArrays(he,x.mulItems(c,D))),A}function k(u,t,s){return s.map((c,A)=>M(u,t[A],c))}function M(u,t,s){var c=x.subtract(P.q(u,s),t),A=P.qprime(u,s),E=x.mulMatrix(c,A),h=x.sum(x.squareItems(A))+2*x.mulMatrix(c,P.qprimeprime(u,s));return h===0?s:s-E/h}function C(u){var t=[],s,c,A;return u.forEach((E,h)=>{s=h?c+x.vectorLen(x.subtract(E,A)):0,t.push(s),c=s,A=E}),t=t.map(E=>E/c),t}function S(u,t,s){var c,A,E,h,i,o,m,O;A=0,E=Math.floor(u.length/2);const T=p(t,10);for(i=0,o=u.length;i<o;i++)m=u[i],O=R(t,s[i],T,10),h=x.subtract(P.q(t,O),m),c=h[0]*h[0]+h[1]*h[1],c>A&&(A=c,E=i);return[A,E]}var p=function(u,t){for(var s,c=[0],A=u[0],E=0,h=1;h<=t;h++)s=P.q(u,h/t),E+=x.vectorLen(x.subtract(s,A)),c.push(E),A=s;return c=c.map(i=>i/E),c};function R(u,t,s,c){if(t<0)return 0;if(t>1)return 1;for(var A,E,h,i,o,m=1;m<=c;m++)if(t<=s[m]){i=(m-1)/c,h=m/c,E=s[m-1],A=s[m],o=(t-E)/(A-E)*(h-i)+i;break}return o}function N(u,t){return x.normalize(x.subtract(u,t))}class x{static zeros_Xx2x2(t){for(var s=[];t--;)s.push([0,0]);return s}static mulItems(t,s){return t.map(c=>c*s)}static mulMatrix(t,s){return t.reduce((c,A,E)=>c+A*s[E],0)}static subtract(t,s){return t.map((c,A)=>c-s[A])}static addArrays(t,s){return t.map((c,A)=>c+s[A])}static addItems(t,s){return t.map(c=>c+s)}static sum(t){return t.reduce((s,c)=>s+c)}static dot(t,s){return x.mulMatrix(t,s)}static vectorLen(t){return Math.hypot(...t)}static divItems(t,s){return t.map(c=>c/s)}static squareItems(t){return t.map(s=>s*s)}static normalize(t){return this.divItems(t,this.vectorLen(t))}}class P{static q(t,s){var c=1-s,A=x.mulItems(t[0],c*c*c),E=x.mulItems(t[1],3*c*c*s),h=x.mulItems(t[2],3*c*s*s),i=x.mulItems(t[3],s*s*s);return x.addArrays(x.addArrays(A,E),x.addArrays(h,i))}static qprime(t,s){var c=1-s,A=x.mulItems(x.subtract(t[1],t[0]),3*c*c),E=x.mulItems(x.subtract(t[2],t[1]),6*c*s),h=x.mulItems(x.subtract(t[3],t[2]),3*s*s);return x.addArrays(x.addArrays(A,E),h)}static qprimeprime(t,s){return x.addArrays(x.mulItems(x.addArrays(x.subtract(t[2],x.mulItems(t[1],2)),t[0]),6*(1-s)),x.mulItems(x.addArrays(x.subtract(t[3],x.mulItems(t[2],2)),t[1]),6*s))}}b.exports=n,b.exports.fitCubic=_,b.exports.createTangent=N},(b,n,_)=>{var f,St,F,Et,B,Pt;Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationLayer=void 0;var e=_(1),a=_(8),k=_(5),M=_(28),C=_(29);const S=1e3,p=9,R=new WeakSet;function N(Y){return{width:Y[2]-Y[0],height:Y[3]-Y[1]}}class x{static create(l){switch(l.data.annotationType){case e.AnnotationType.LINK:return new u(l);case e.AnnotationType.TEXT:return new t(l);case e.AnnotationType.WIDGET:switch(l.data.fieldType){case"Tx":return new c(l);case"Btn":return l.data.radioButton?new E(l):l.data.checkBox?new A(l):new h(l);case"Ch":return new i(l)}return new s(l);case e.AnnotationType.POPUP:return new o(l);case e.AnnotationType.FREETEXT:return new O(l);case e.AnnotationType.LINE:return new T(l);case e.AnnotationType.SQUARE:return new y(l);case e.AnnotationType.CIRCLE:return new D(l);case e.AnnotationType.POLYLINE:return new te(l);case e.AnnotationType.CARET:return new Z(l);case e.AnnotationType.INK:return new J(l);case e.AnnotationType.POLYGON:return new se(l);case e.AnnotationType.HIGHLIGHT:return new G(l);case e.AnnotationType.UNDERLINE:return new V(l);case e.AnnotationType.SQUIGGLY:return new K(l);case e.AnnotationType.STRIKEOUT:return new re(l);case e.AnnotationType.STAMP:return new he(l);case e.AnnotationType.FILEATTACHMENT:return new be(l);default:return new P(l)}}}class P{constructor(l,{isRenderable:g=!1,ignoreBorder:v=!1,createQuadrilaterals:w=!1}={}){this.isRenderable=g,this.data=l.data,this.layer=l.layer,this.page=l.page,this.viewport=l.viewport,this.linkService=l.linkService,this.downloadManager=l.downloadManager,this.imageResourcesPath=l.imageResourcesPath,this.renderForms=l.renderForms,this.svgFactory=l.svgFactory,this.annotationStorage=l.annotationStorage,this.enableScripting=l.enableScripting,this.hasJSActions=l.hasJSActions,this._fieldObjects=l.fieldObjects,this._mouseState=l.mouseState,g&&(this.container=this._createContainer(v)),w&&(this.quadrilaterals=this._createQuadrilaterals(v))}_createContainer(l=!1){const g=this.data,v=this.page,w=this.viewport,L=document.createElement("section"),{width:H,height:ie}=N(g.rect),[de,ee,le,ne]=w.viewBox,ce=le-de,pe=ne-ee;L.setAttribute("data-annotation-id",g.id);const j=e.Util.normalizeRect([g.rect[0],v.view[3]-g.rect[1]+v.view[1],g.rect[2],v.view[3]-g.rect[3]+v.view[1]]);if(!l&&g.borderStyle.width>0){L.style.borderWidth=`${g.borderStyle.width}px`;const ve=g.borderStyle.horizontalCornerRadius,Se=g.borderStyle.verticalCornerRadius;if(ve>0||Se>0){const xe=`calc(${ve}px * var(--scale-factor)) / calc(${Se}px * var(--scale-factor))`;L.style.borderRadius=xe}else if(this instanceof E){const xe=`calc(${H}px * var(--scale-factor)) / calc(${ie}px * var(--scale-factor))`;L.style.borderRadius=xe}switch(g.borderStyle.style){case e.AnnotationBorderStyleType.SOLID:L.style.borderStyle="solid";break;case e.AnnotationBorderStyleType.DASHED:L.style.borderStyle="dashed";break;case e.AnnotationBorderStyleType.BEVELED:(0,e.warn)("Unimplemented border style: beveled");break;case e.AnnotationBorderStyleType.INSET:(0,e.warn)("Unimplemented border style: inset");break;case e.AnnotationBorderStyleType.UNDERLINE:L.style.borderBottomStyle="solid";break}const Pe=g.borderColor||null;Pe?L.style.borderColor=e.Util.makeHexColor(Pe[0]|0,Pe[1]|0,Pe[2]|0):L.style.borderWidth=0}L.style.left=`${100*(j[0]-de)/ce}%`,L.style.top=`${100*(j[1]-ee)/pe}%`;const{rotation:fe}=g;return g.hasOwnCanvas||fe===0?(L.style.width=`${100*H/ce}%`,L.style.height=`${100*ie/pe}%`):this.setRotation(fe,L),L}setRotation(l,g=this.container){const[v,w,L,H]=this.viewport.viewBox,ie=L-v,de=H-w,{width:ee,height:le}=N(this.data.rect);let ne,ce;l%180===0?(ne=100*ee/ie,ce=100*le/de):(ne=100*le/ie,ce=100*ee/de),g.style.width=`${ne}%`,g.style.height=`${ce}%`,g.setAttribute("data-main-rotation",(360-l)%360)}get _commonActions(){const l=(g,v,w)=>{const L=w.detail[g];w.target.style[v]=M.ColorConverters[`${L[0]}_HTML`](L.slice(1))};return(0,e.shadow)(this,"_commonActions",{display:g=>{const v=g.detail.display%2===1;this.container.style.visibility=v?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:v,print:g.detail.display===0||g.detail.display===3})},print:g=>{this.annotationStorage.setValue(this.data.id,{print:g.detail.print})},hidden:g=>{this.container.style.visibility=g.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:g.detail.hidden})},focus:g=>{setTimeout(()=>g.target.focus({preventScroll:!1}),0)},userName:g=>{g.target.title=g.detail.userName},readonly:g=>{g.detail.readonly?g.target.setAttribute("readonly",""):g.target.removeAttribute("readonly")},required:g=>{this._setRequired(g.target,g.detail.required)},bgColor:g=>{l("bgColor","backgroundColor",g)},fillColor:g=>{l("fillColor","backgroundColor",g)},fgColor:g=>{l("fgColor","color",g)},textColor:g=>{l("textColor","color",g)},borderColor:g=>{l("borderColor","borderColor",g)},strokeColor:g=>{l("strokeColor","borderColor",g)},rotation:g=>{const v=g.detail.rotation;this.setRotation(v),this.annotationStorage.setValue(this.data.id,{rotation:v})}})}_dispatchEventFromSandbox(l,g){const v=this._commonActions;for(const w of Object.keys(g.detail)){const L=l[w]||v[w];L&&L(g)}}_setDefaultPropertiesFromJS(l){if(!this.enableScripting)return;const g=this.annotationStorage.getRawValue(this.data.id);if(!g)return;const v=this._commonActions;for(const[w,L]of Object.entries(g)){const H=v[w];if(H){const ie={detail:{[w]:L},target:l};H(ie),delete g[w]}}}_createQuadrilaterals(l=!1){if(!this.data.quadPoints)return null;const g=[],v=this.data.rect;for(const w of this.data.quadPoints)this.data.rect=[w[2].x,w[2].y,w[1].x,w[1].y],g.push(this._createContainer(l));return this.data.rect=v,g}_createPopup(l,g){let v=this.container;this.quadrilaterals&&(l=l||this.quadrilaterals,v=this.quadrilaterals[0]),l||(l=document.createElement("div"),l.className="popupTriggerArea",v.append(l));const L=new m({container:v,trigger:l,color:g.color,titleObj:g.titleObj,modificationDate:g.modificationDate,contentsObj:g.contentsObj,richText:g.richText,hideWrapper:!0}).render();L.style.left="100%",v.append(L)}_renderQuadrilaterals(l){for(const g of this.quadrilaterals)g.className=l;return this.quadrilaterals}render(){(0,e.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(l,g=null){const v=[];if(this._fieldObjects){const w=this._fieldObjects[l];if(w)for(const{page:L,id:H,exportValues:ie}of w){if(L===-1||H===g)continue;const de=typeof ie=="string"?ie:null,ee=document.querySelector(`[data-element-id="${H}"]`);if(ee&&!R.has(ee)){(0,e.warn)(`_getElementsByName - element not allowed: ${H}`);continue}v.push({id:H,exportValue:de,domElement:ee})}return v}for(const w of document.getElementsByName(l)){const{id:L,exportValue:H}=w;L!==g&&R.has(w)&&v.push({id:L,exportValue:H,domElement:w})}return v}static get platform(){const l=typeof navigator<"u"?navigator.platform:"";return(0,e.shadow)(this,"platform",{isWin:l.includes("Win"),isMac:l.includes("Mac")})}}class u extends P{constructor(l,g=null){super(l,{isRenderable:!0,ignoreBorder:!!(g!=null&&g.ignoreBorder),createQuadrilaterals:!0}),this.isTooltipOnly=l.data.isTooltipOnly}render(){const{data:l,linkService:g}=this,v=document.createElement("a");v.setAttribute("data-element-id",l.id);let w=!1;return l.url?(g.addLinkAttributes(v,l.url,l.newWindow),w=!0):l.action?(this._bindNamedAction(v,l.action),w=!0):l.dest?(this._bindLink(v,l.dest),w=!0):(l.actions&&(l.actions.Action||l.actions["Mouse Up"]||l.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(v,l),w=!0),l.resetForm?(this._bindResetFormAction(v,l.resetForm),w=!0):this.isTooltipOnly&&!w&&(this._bindLink(v,""),w=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((L,H)=>{const ie=H===0?v:v.cloneNode();return L.append(ie),L}):(this.container.className="linkAnnotation",w&&this.container.append(v),this.container)}_bindLink(l,g){l.href=this.linkService.getDestinationHash(g),l.onclick=()=>(g&&this.linkService.goToDestination(g),!1),(g||g==="")&&(l.className="internalLink")}_bindNamedAction(l,g){l.href=this.linkService.getAnchorUrl(""),l.onclick=()=>(this.linkService.executeNamedAction(g),!1),l.className="internalLink"}_bindJSAction(l,g){l.href=this.linkService.getAnchorUrl("");const v=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const w of Object.keys(g.actions)){const L=v.get(w);L&&(l[L]=()=>{var H;return(H=this.linkService.eventBus)==null||H.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g.id,name:w}}),!1})}l.onclick||(l.onclick=()=>!1),l.className="internalLink"}_bindResetFormAction(l,g){const v=l.onclick;if(v||(l.href=this.linkService.getAnchorUrl("")),l.className="internalLink",!this._fieldObjects){(0,e.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),v||(l.onclick=()=>!1);return}l.onclick=()=>{var le;v&&v();const{fields:w,refs:L,include:H}=g,ie=[];if(w.length!==0||L.length!==0){const ne=new Set(L);for(const ce of w){const pe=this._fieldObjects[ce]||[];for(const{id:j}of pe)ne.add(j)}for(const ce of Object.values(this._fieldObjects))for(const pe of ce)ne.has(pe.id)===H&&ie.push(pe)}else for(const ne of Object.values(this._fieldObjects))ie.push(...ne);const de=this.annotationStorage,ee=[];for(const ne of ie){const{id:ce}=ne;switch(ee.push(ce),ne.type){case"text":{const j=ne.defaultValue||"";de.setValue(ce,{value:j});break}case"checkbox":case"radiobutton":{const j=ne.defaultValue===ne.exportValues;de.setValue(ce,{value:j});break}case"combobox":case"listbox":{const j=ne.defaultValue||"";de.setValue(ce,{value:j});break}default:continue}const pe=document.querySelector(`[data-element-id="${ce}"]`);if(pe){if(!R.has(pe)){(0,e.warn)(`_bindResetFormAction - element not allowed: ${ce}`);continue}}else continue;pe.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((le=this.linkService.eventBus)==null||le.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:ee,name:"ResetForm"}})),!1}}}class t extends P{constructor(l){var v,w,L;const g=!!(l.data.hasPopup||(v=l.data.titleObj)!=null&&v.str||(w=l.data.contentsObj)!=null&&w.str||(L=l.data.richText)!=null&&L.str);super(l,{isRenderable:g})}render(){this.container.className="textAnnotation";const l=document.createElement("img");return l.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",l.alt="[{{type}} Annotation]",l.dataset.l10nId="text_annotation_type",l.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(l,this.data),this.container.append(l),this.container}}class s extends P{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(l){const{isWin:g,isMac:v}=P.platform;return g&&l.ctrlKey||v&&l.metaKey}_setEventListener(l,g,v,w){g.includes("mouse")?l.addEventListener(g,L=>{var H;(H=this.linkService.eventBus)==null||H.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:v,value:w(L),shift:L.shiftKey,modifier:this._getKeyModifier(L)}})}):l.addEventListener(g,L=>{var H;(H=this.linkService.eventBus)==null||H.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:v,value:w(L)}})})}_setEventListeners(l,g,v){var w;for(const[L,H]of g)(H==="Action"||(w=this.data.actions)!=null&&w[H])&&this._setEventListener(l,L,H,v)}_setBackgroundColor(l){const g=this.data.backgroundColor||null;l.style.backgroundColor=g===null?"transparent":e.Util.makeHexColor(g[0],g[1],g[2])}_setTextStyle(l){const g=["left","center","right"],{fontColor:v}=this.data.defaultAppearanceData,w=this.data.defaultAppearanceData.fontSize||p,L=l.style;let H;if(this.data.multiLine){const ie=Math.abs(this.data.rect[3]-this.data.rect[1]),de=Math.round(ie/(e.LINE_FACTOR*w))||1,ee=ie/de;H=Math.min(w,Math.round(ee/e.LINE_FACTOR))}else{const ie=Math.abs(this.data.rect[3]-this.data.rect[1]);H=Math.min(w,Math.round(ie/e.LINE_FACTOR))}L.fontSize=`calc(${H}px * var(--scale-factor))`,L.color=e.Util.makeHexColor(v[0],v[1],v[2]),this.data.textAlignment!==null&&(L.textAlign=g[this.data.textAlignment])}_setRequired(l,g){g?l.setAttribute("required",!0):l.removeAttribute("required"),l.setAttribute("aria-required",g)}}class c extends s{constructor(l){const g=l.renderForms||!l.data.hasAppearance&&!!l.data.fieldValue;super(l,{isRenderable:g})}setPropertyOnSiblings(l,g,v,w){const L=this.annotationStorage;for(const H of this._getElementsByName(l.name,l.id))H.domElement&&(H.domElement[g]=v),L.setValue(H.id,{[w]:v})}render(){var w;const l=this.annotationStorage,g=this.data.id;this.container.className="textWidgetAnnotation";let v=null;if(this.renderForms){const L=l.getValue(g,{value:this.data.fieldValue});let H=L.formattedValue||L.value||"";const ie=l.getValue(g,{charLimit:this.data.maxLen}).charLimit;ie&&H.length>ie&&(H=H.slice(0,ie));const de={userValue:H,formattedValue:null,valueOnFocus:""};this.data.multiLine?(v=document.createElement("textarea"),v.textContent=H,this.data.doNotScroll&&(v.style.overflowY="hidden")):(v=document.createElement("input"),v.type="text",v.setAttribute("value",H),this.data.doNotScroll&&(v.style.overflowX="hidden")),R.add(v),v.setAttribute("data-element-id",g),v.disabled=this.data.readOnly,v.name=this.data.fieldName,v.tabIndex=S,this._setRequired(v,this.data.required),ie&&(v.maxLength=ie),v.addEventListener("input",le=>{l.setValue(g,{value:le.target.value}),this.setPropertyOnSiblings(v,"value",le.target.value,"value")}),v.addEventListener("resetform",le=>{const ne=this.data.defaultFieldValue??"";v.value=de.userValue=ne,de.formattedValue=null});let ee=le=>{const{formattedValue:ne}=de;ne!=null&&(le.target.value=ne),le.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){v.addEventListener("focus",ne=>{de.userValue&&(ne.target.value=de.userValue),de.valueOnFocus=ne.target.value}),v.addEventListener("updatefromsandbox",ne=>{const ce={value(pe){de.userValue=pe.detail.value??"",l.setValue(g,{value:de.userValue.toString()}),pe.target.value=de.userValue},formattedValue(pe){const{formattedValue:j}=pe.detail;de.formattedValue=j,j!=null&&pe.target!==document.activeElement&&(pe.target.value=j),l.setValue(g,{formattedValue:j})},selRange(pe){pe.target.setSelectionRange(...pe.detail.selRange)},charLimit:pe=>{var Se;const{charLimit:j}=pe.detail,{target:fe}=pe;if(j===0){fe.removeAttribute("maxLength");return}fe.setAttribute("maxLength",j);let ve=de.userValue;!ve||ve.length<=j||(ve=ve.slice(0,j),fe.value=de.userValue=ve,l.setValue(g,{value:ve}),(Se=this.linkService.eventBus)==null||Se.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:ve,willCommit:!0,commitKey:1,selStart:fe.selectionStart,selEnd:fe.selectionEnd}}))}};this._dispatchEventFromSandbox(ce,ne)}),v.addEventListener("keydown",ne=>{var j;let ce=-1;if(ne.key==="Escape"?ce=0:ne.key==="Enter"?ce=2:ne.key==="Tab"&&(ce=3),ce===-1)return;const{value:pe}=ne.target;de.valueOnFocus!==pe&&(de.userValue=pe,(j=this.linkService.eventBus)==null||j.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:pe,willCommit:!0,commitKey:ce,selStart:ne.target.selectionStart,selEnd:ne.target.selectionEnd}}))});const le=ee;ee=null,v.addEventListener("blur",ne=>{var pe;const{value:ce}=ne.target;de.userValue=ce,this._mouseState.isDown&&de.valueOnFocus!==ce&&((pe=this.linkService.eventBus)==null||pe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:ce,willCommit:!0,commitKey:1,selStart:ne.target.selectionStart,selEnd:ne.target.selectionEnd}})),le(ne)}),(w=this.data.actions)!=null&&w.Keystroke&&v.addEventListener("beforeinput",ne=>{var xe;const{data:ce,target:pe}=ne,{value:j,selectionStart:fe,selectionEnd:ve}=pe;let Se=fe,Pe=ve;switch(ne.inputType){case"deleteWordBackward":{const Oe=j.substring(0,fe).match(/\w*[^\w]*$/);Oe&&(Se-=Oe[0].length);break}case"deleteWordForward":{const Oe=j.substring(fe).match(/^[^\w]*\w*/);Oe&&(Pe+=Oe[0].length);break}case"deleteContentBackward":fe===ve&&(Se-=1);break;case"deleteContentForward":fe===ve&&(Pe+=1);break}ne.preventDefault(),(xe=this.linkService.eventBus)==null||xe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:j,change:ce||"",willCommit:!1,selStart:Se,selEnd:Pe}})}),this._setEventListeners(v,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],ne=>ne.target.value)}if(ee&&v.addEventListener("blur",ee),this.data.comb){const ne=(this.data.rect[2]-this.data.rect[0])/ie;v.classList.add("comb"),v.style.letterSpacing=`calc(${ne}px * var(--scale-factor) - 1ch)`}}else v=document.createElement("div"),v.textContent=this.data.fieldValue,v.style.verticalAlign="middle",v.style.display="table-cell";return this._setTextStyle(v),this._setBackgroundColor(v),this._setDefaultPropertiesFromJS(v),this.container.append(v),this.container}}class A extends s{constructor(l){super(l,{isRenderable:l.renderForms})}render(){const l=this.annotationStorage,g=this.data,v=g.id;let w=l.getValue(v,{value:g.exportValue===g.fieldValue}).value;typeof w=="string"&&(w=w!=="Off",l.setValue(v,{value:w})),this.container.className="buttonWidgetAnnotation checkBox";const L=document.createElement("input");return R.add(L),L.setAttribute("data-element-id",v),L.disabled=g.readOnly,this._setRequired(L,this.data.required),L.type="checkbox",L.name=g.fieldName,w&&L.setAttribute("checked",!0),L.setAttribute("exportValue",g.exportValue),L.tabIndex=S,L.addEventListener("change",H=>{const{name:ie,checked:de}=H.target;for(const ee of this._getElementsByName(ie,v)){const le=de&&ee.exportValue===g.exportValue;ee.domElement&&(ee.domElement.checked=le),l.setValue(ee.id,{value:le})}l.setValue(v,{value:de})}),L.addEventListener("resetform",H=>{const ie=g.defaultFieldValue||"Off";H.target.checked=ie===g.exportValue}),this.enableScripting&&this.hasJSActions&&(L.addEventListener("updatefromsandbox",H=>{const ie={value(de){de.target.checked=de.detail.value!=="Off",l.setValue(v,{value:de.target.checked})}};this._dispatchEventFromSandbox(ie,H)}),this._setEventListeners(L,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],H=>H.target.checked)),this._setBackgroundColor(L),this._setDefaultPropertiesFromJS(L),this.container.append(L),this.container}}class E extends s{constructor(l){super(l,{isRenderable:l.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const l=this.annotationStorage,g=this.data,v=g.id;let w=l.getValue(v,{value:g.fieldValue===g.buttonValue}).value;typeof w=="string"&&(w=w!==g.buttonValue,l.setValue(v,{value:w}));const L=document.createElement("input");if(R.add(L),L.setAttribute("data-element-id",v),L.disabled=g.readOnly,this._setRequired(L,this.data.required),L.type="radio",L.name=g.fieldName,w&&L.setAttribute("checked",!0),L.tabIndex=S,L.addEventListener("change",H=>{const{name:ie,checked:de}=H.target;for(const ee of this._getElementsByName(ie,v))l.setValue(ee.id,{value:!1});l.setValue(v,{value:de})}),L.addEventListener("resetform",H=>{const ie=g.defaultFieldValue;H.target.checked=ie!=null&&ie===g.buttonValue}),this.enableScripting&&this.hasJSActions){const H=g.buttonValue;L.addEventListener("updatefromsandbox",ie=>{const de={value:ee=>{const le=H===ee.detail.value;for(const ne of this._getElementsByName(ee.target.name)){const ce=le&&ne.id===v;ne.domElement&&(ne.domElement.checked=ce),l.setValue(ne.id,{value:ce})}}};this._dispatchEventFromSandbox(de,ie)}),this._setEventListeners(L,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],ie=>ie.target.checked)}return this._setBackgroundColor(L),this._setDefaultPropertiesFromJS(L),this.container.append(L),this.container}}class h extends u{constructor(l){super(l,{ignoreBorder:l.data.hasAppearance})}render(){const l=super.render();l.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(l.title=this.data.alternativeText);const g=l.lastChild;return this.enableScripting&&this.hasJSActions&&g&&(this._setDefaultPropertiesFromJS(g),g.addEventListener("updatefromsandbox",v=>{this._dispatchEventFromSandbox({},v)})),l}}class i extends s{constructor(l){super(l,{isRenderable:l.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const l=this.annotationStorage,g=this.data.id,v=l.getValue(g,{value:this.data.fieldValue}),w=document.createElement("select");R.add(w),w.setAttribute("data-element-id",g),w.disabled=this.data.readOnly,this._setRequired(w,this.data.required),w.name=this.data.fieldName,w.tabIndex=S;let L=this.data.combo&&this.data.options.length>0;this.data.combo||(w.size=this.data.options.length,this.data.multiSelect&&(w.multiple=!0)),w.addEventListener("resetform",ee=>{const le=this.data.defaultFieldValue;for(const ne of w.options)ne.selected=ne.value===le});for(const ee of this.data.options){const le=document.createElement("option");le.textContent=ee.displayValue,le.value=ee.exportValue,v.value.includes(ee.exportValue)&&(le.setAttribute("selected",!0),L=!1),w.append(le)}let H=null;if(L){const ee=document.createElement("option");ee.value=" ",ee.setAttribute("hidden",!0),ee.setAttribute("selected",!0),w.prepend(ee),H=()=>{ee.remove(),w.removeEventListener("input",H),H=null},w.addEventListener("input",H)}const ie=(ee,le)=>{const ne=le?"value":"textContent",ce=ee.target.options;return ee.target.multiple?Array.prototype.filter.call(ce,pe=>pe.selected).map(pe=>pe[ne]):ce.selectedIndex===-1?null:ce[ce.selectedIndex][ne]},de=ee=>{const le=ee.target.options;return Array.prototype.map.call(le,ne=>({displayValue:ne.textContent,exportValue:ne.value}))};return this.enableScripting&&this.hasJSActions?(w.addEventListener("updatefromsandbox",ee=>{const le={value(ne){H==null||H();const ce=ne.detail.value,pe=new Set(Array.isArray(ce)?ce:[ce]);for(const j of w.options)j.selected=pe.has(j.value);l.setValue(g,{value:ie(ne,!0)})},multipleSelection(ne){w.multiple=!0},remove(ne){const ce=w.options,pe=ne.detail.remove;ce[pe].selected=!1,w.remove(pe),ce.length>0&&Array.prototype.findIndex.call(ce,fe=>fe.selected)===-1&&(ce[0].selected=!0),l.setValue(g,{value:ie(ne,!0),items:de(ne)})},clear(ne){for(;w.length!==0;)w.remove(0);l.setValue(g,{value:null,items:[]})},insert(ne){const{index:ce,displayValue:pe,exportValue:j}=ne.detail.insert,fe=w.children[ce],ve=document.createElement("option");ve.textContent=pe,ve.value=j,fe?fe.before(ve):w.append(ve),l.setValue(g,{value:ie(ne,!0),items:de(ne)})},items(ne){const{items:ce}=ne.detail;for(;w.length!==0;)w.remove(0);for(const pe of ce){const{displayValue:j,exportValue:fe}=pe,ve=document.createElement("option");ve.textContent=j,ve.value=fe,w.append(ve)}w.options.length>0&&(w.options[0].selected=!0),l.setValue(g,{value:ie(ne,!0),items:de(ne)})},indices(ne){const ce=new Set(ne.detail.indices);for(const pe of ne.target.options)pe.selected=ce.has(pe.index);l.setValue(g,{value:ie(ne,!0)})},editable(ne){ne.target.disabled=!ne.detail.editable}};this._dispatchEventFromSandbox(le,ee)}),w.addEventListener("input",ee=>{var ce;const le=ie(ee,!0),ne=ie(ee,!1);l.setValue(g,{value:le}),(ce=this.linkService.eventBus)==null||ce.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:ne,changeEx:le,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(w,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],ee=>ee.target.checked)):w.addEventListener("input",function(ee){l.setValue(g,{value:ie(ee,!0)})}),this.data.combo&&this._setTextStyle(w),this._setBackgroundColor(w),this._setDefaultPropertiesFromJS(w),this.container.append(w),this.container}}class o extends P{constructor(l){var v,w,L;const g=!!((v=l.data.titleObj)!=null&&v.str||(w=l.data.contentsObj)!=null&&w.str||(L=l.data.richText)!=null&&L.str);super(l,{isRenderable:g})}render(){const l=["Line","Square","Circle","PolyLine","Polygon","Ink"];if(this.container.className="popupAnnotation",l.includes(this.data.parentType))return this.container;const g=`[data-annotation-id="${this.data.parentId}"]`,v=this.layer.querySelectorAll(g);if(v.length===0)return this.container;const w=new m({container:this.container,trigger:Array.from(v),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),L=this.page,H=e.Util.normalizeRect([this.data.parentRect[0],L.view[3]-this.data.parentRect[1]+L.view[1],this.data.parentRect[2],L.view[3]-this.data.parentRect[3]+L.view[1]]),ie=H[0]+this.data.parentRect[2]-this.data.parentRect[0],de=H[1],[ee,le,ne,ce]=this.viewport.viewBox,pe=ne-ee,j=ce-le;return this.container.style.left=`${100*(ie-ee)/pe}%`,this.container.style.top=`${100*(de-le)/j}%`,this.container.append(w.render()),this.container}}class m{constructor(l){this.container=l.container,this.trigger=l.trigger,this.color=l.color,this.titleObj=l.titleObj,this.modificationDate=l.modificationDate,this.contentsObj=l.contentsObj,this.richText=l.richText,this.hideWrapper=l.hideWrapper||!1,this.pinned=!1}render(){var ie,de;const g=document.createElement("div");g.className="popupWrapper",this.hideElement=this.hideWrapper?g:this.container,this.hideElement.hidden=!0;const v=document.createElement("div");v.className="popup";const w=this.color;if(w){const ee=.7*(255-w[0])+w[0],le=.7*(255-w[1])+w[1],ne=.7*(255-w[2])+w[2];v.style.backgroundColor=e.Util.makeHexColor(ee|0,le|0,ne|0)}const L=document.createElement("h1");L.dir=this.titleObj.dir,L.textContent=this.titleObj.str,v.append(L);const H=a.PDFDateString.toDateObject(this.modificationDate);if(H){const ee=document.createElement("span");ee.className="popupDate",ee.textContent="{{date}}, {{time}}",ee.dataset.l10nId="annotation_date_string",ee.dataset.l10nArgs=JSON.stringify({date:H.toLocaleDateString(),time:H.toLocaleTimeString()}),v.append(ee)}if((ie=this.richText)!=null&&ie.str&&(!((de=this.contentsObj)!=null&&de.str)||this.contentsObj.str===this.richText.str))C.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:v}),v.lastChild.className="richText popupContent";else{const ee=this._formatContents(this.contentsObj);v.append(ee)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const ee of this.trigger)ee.addEventListener("click",this._toggle.bind(this)),ee.addEventListener("mouseover",this._show.bind(this,!1)),ee.addEventListener("mouseout",this._hide.bind(this,!1));return v.addEventListener("click",this._hide.bind(this,!0)),g.append(v),g}_formatContents({str:l,dir:g}){const v=document.createElement("p");v.className="popupContent",v.dir=g;const w=l.split(/(?:\r\n?|\n)/);for(let L=0,H=w.length;L<H;++L){const ie=w[L];v.append(document.createTextNode(ie)),L<H-1&&v.append(document.createElement("br"))}return v}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(l=!1){l&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(l=!0){l&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class O extends P{constructor(l){var v,w,L;const g=!!(l.data.hasPopup||(v=l.data.titleObj)!=null&&v.str||(w=l.data.contentsObj)!=null&&w.str||(L=l.data.richText)!=null&&L.str);super(l,{isRenderable:g,ignoreBorder:!0}),this.textContent=l.data.textContent}render(){if(this.container.className="freeTextAnnotation",this.textContent){const l=document.createElement("div");l.className="annotationTextContent",l.setAttribute("role","comment");for(const g of this.textContent){const v=document.createElement("span");v.textContent=g,l.append(v)}this.container.append(l)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class T extends P{constructor(l){var v,w,L;const g=!!(l.data.hasPopup||(v=l.data.titleObj)!=null&&v.str||(w=l.data.contentsObj)!=null&&w.str||(L=l.data.richText)!=null&&L.str);super(l,{isRenderable:g,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const l=this.data,{width:g,height:v}=N(l.rect),w=this.svgFactory.create(g,v,!0),L=this.svgFactory.createElement("svg:line");return L.setAttribute("x1",l.rect[2]-l.lineCoordinates[0]),L.setAttribute("y1",l.rect[3]-l.lineCoordinates[1]),L.setAttribute("x2",l.rect[2]-l.lineCoordinates[2]),L.setAttribute("y2",l.rect[3]-l.lineCoordinates[3]),L.setAttribute("stroke-width",l.borderStyle.width||1),L.setAttribute("stroke","transparent"),L.setAttribute("fill","transparent"),w.append(L),this.container.append(w),this._createPopup(L,l),this.container}}class y extends P{constructor(l){var v,w,L;const g=!!(l.data.hasPopup||(v=l.data.titleObj)!=null&&v.str||(w=l.data.contentsObj)!=null&&w.str||(L=l.data.richText)!=null&&L.str);super(l,{isRenderable:g,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const l=this.data,{width:g,height:v}=N(l.rect),w=this.svgFactory.create(g,v,!0),L=l.borderStyle.width,H=this.svgFactory.createElement("svg:rect");return H.setAttribute("x",L/2),H.setAttribute("y",L/2),H.setAttribute("width",g-L),H.setAttribute("height",v-L),H.setAttribute("stroke-width",L||1),H.setAttribute("stroke","transparent"),H.setAttribute("fill","transparent"),w.append(H),this.container.append(w),this._createPopup(H,l),this.container}}class D extends P{constructor(l){var v,w,L;const g=!!(l.data.hasPopup||(v=l.data.titleObj)!=null&&v.str||(w=l.data.contentsObj)!=null&&w.str||(L=l.data.richText)!=null&&L.str);super(l,{isRenderable:g,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const l=this.data,{width:g,height:v}=N(l.rect),w=this.svgFactory.create(g,v,!0),L=l.borderStyle.width,H=this.svgFactory.createElement("svg:ellipse");return H.setAttribute("cx",g/2),H.setAttribute("cy",v/2),H.setAttribute("rx",g/2-L/2),H.setAttribute("ry",v/2-L/2),H.setAttribute("stroke-width",L||1),H.setAttribute("stroke","transparent"),H.setAttribute("fill","transparent"),w.append(H),this.container.append(w),this._createPopup(H,l),this.container}}class te extends P{constructor(l){var v,w,L;const g=!!(l.data.hasPopup||(v=l.data.titleObj)!=null&&v.str||(w=l.data.contentsObj)!=null&&w.str||(L=l.data.richText)!=null&&L.str);super(l,{isRenderable:g,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const l=this.data,{width:g,height:v}=N(l.rect),w=this.svgFactory.create(g,v,!0);let L=[];for(const ie of l.vertices){const de=ie.x-l.rect[0],ee=l.rect[3]-ie.y;L.push(de+","+ee)}L=L.join(" ");const H=this.svgFactory.createElement(this.svgElementName);return H.setAttribute("points",L),H.setAttribute("stroke-width",l.borderStyle.width||1),H.setAttribute("stroke","transparent"),H.setAttribute("fill","transparent"),w.append(H),this.container.append(w),this._createPopup(H,l),this.container}}class se extends te{constructor(l){super(l),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Z extends P{constructor(l){var v,w,L;const g=!!(l.data.hasPopup||(v=l.data.titleObj)!=null&&v.str||(w=l.data.contentsObj)!=null&&w.str||(L=l.data.richText)!=null&&L.str);super(l,{isRenderable:g,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class J extends P{constructor(l){var v,w,L;const g=!!(l.data.hasPopup||(v=l.data.titleObj)!=null&&v.str||(w=l.data.contentsObj)!=null&&w.str||(L=l.data.richText)!=null&&L.str);super(l,{isRenderable:g,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const l=this.data,{width:g,height:v}=N(l.rect),w=this.svgFactory.create(g,v,!0);for(const L of l.inkLists){let H=[];for(const de of L){const ee=de.x-l.rect[0],le=l.rect[3]-de.y;H.push(`${ee},${le}`)}H=H.join(" ");const ie=this.svgFactory.createElement(this.svgElementName);ie.setAttribute("points",H),ie.setAttribute("stroke-width",l.borderStyle.width||1),ie.setAttribute("stroke","transparent"),ie.setAttribute("fill","transparent"),this._createPopup(ie,l),w.append(ie)}return this.container.append(w),this.container}}class G extends P{constructor(l){var v,w,L;const g=!!(l.data.hasPopup||(v=l.data.titleObj)!=null&&v.str||(w=l.data.contentsObj)!=null&&w.str||(L=l.data.richText)!=null&&L.str);super(l,{isRenderable:g,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class V extends P{constructor(l){var v,w,L;const g=!!(l.data.hasPopup||(v=l.data.titleObj)!=null&&v.str||(w=l.data.contentsObj)!=null&&w.str||(L=l.data.richText)!=null&&L.str);super(l,{isRenderable:g,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class K extends P{constructor(l){var v,w,L;const g=!!(l.data.hasPopup||(v=l.data.titleObj)!=null&&v.str||(w=l.data.contentsObj)!=null&&w.str||(L=l.data.richText)!=null&&L.str);super(l,{isRenderable:g,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class re extends P{constructor(l){var v,w,L;const g=!!(l.data.hasPopup||(v=l.data.titleObj)!=null&&v.str||(w=l.data.contentsObj)!=null&&w.str||(L=l.data.richText)!=null&&L.str);super(l,{isRenderable:g,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class he extends P{constructor(l){var v,w,L;const g=!!(l.data.hasPopup||(v=l.data.titleObj)!=null&&v.str||(w=l.data.contentsObj)!=null&&w.str||(L=l.data.richText)!=null&&L.str);super(l,{isRenderable:g,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class be extends P{constructor(l){var w;super(l,{isRenderable:!0});const{filename:g,content:v}=this.data.file;this.filename=(0,a.getFilenameFromUrl)(g),this.content=v,(w=this.linkService.eventBus)==null||w.dispatch("fileattachmentannotation",{source:this,filename:g,content:v})}render(){var g,v;this.container.className="fileAttachmentAnnotation";const l=document.createElement("div");return l.className="popupTriggerArea",l.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&((g=this.data.titleObj)!=null&&g.str||(v=this.data.contentsObj)!=null&&v.str||this.data.richText)&&this._createPopup(l,this.data),this.container.append(l),this.container}_download(){var l;(l=this.downloadManager)==null||l.openOrDownloadData(this.container,this.content,this.filename)}}const X=class X{static render(l){var ie,de;const{annotations:g,div:v,viewport:w,accessibilityManager:L}=l;ue(this,F,Et).call(this,v,w);let H=0;for(const ee of g){if(ee.annotationType!==e.AnnotationType.POPUP){const{width:ne,height:ce}=N(ee.rect);if(ne<=0||ce<=0)continue}const le=x.create({data:ee,layer:v,page:l.page,viewport:w,linkService:l.linkService,downloadManager:l.downloadManager,imageResourcesPath:l.imageResourcesPath||"",renderForms:l.renderForms!==!1,svgFactory:new a.DOMSVGFactory,annotationStorage:l.annotationStorage||new k.AnnotationStorage,enableScripting:l.enableScripting,hasJSActions:l.hasJSActions,fieldObjects:l.fieldObjects,mouseState:l.mouseState||{isDown:!1}});if(le.isRenderable){const ne=le.render();if(ee.hidden&&(ne.style.visibility="hidden"),Array.isArray(ne))for(const ce of ne)ce.style.zIndex=H++,ue(ie=X,f,St).call(ie,ce,ee.id,v,L);else ne.style.zIndex=H++,le instanceof o?v.prepend(ne):ue(de=X,f,St).call(de,ne,ee.id,v,L)}}ue(this,B,Pt).call(this,v,l.annotationCanvasMap)}static update(l){const{annotationCanvasMap:g,div:v,viewport:w}=l;ue(this,F,Et).call(this,v,w),ue(this,B,Pt).call(this,v,g),v.hidden=!1}};f=new WeakSet,St=function(l,g,v,w){const L=l.firstChild||l;L.id=`${a.AnnotationPrefix}${g}`,v.append(l),w==null||w.moveElementInDOM(v,l,L,!1)},F=new WeakSet,Et=function(l,{width:g,height:v,rotation:w}){const{style:L}=l,H=w%180!==0,ie=Math.floor(g)+"px",de=Math.floor(v)+"px";L.width=H?de:ie,L.height=H?ie:de,l.setAttribute("data-main-rotation",w)},B=new WeakSet,Pt=function(l,g){if(g){for(const[v,w]of g){const L=l.querySelector(`[data-annotation-id="${v}"]`);if(!L)continue;const{firstChild:H}=L;H?H.nodeName==="CANVAS"?H.replaceWith(w):H.before(w):L.append(w)}g.clear()}},oe(X,f),oe(X,F),oe(X,B);let q=X;n.AnnotationLayer=q},(b,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ColorConverters=void 0;function _(a){return Math.floor(Math.max(0,Math.min(1,a))*255).toString(16).padStart(2,"0")}class e{static CMYK_G([k,M,C,S]){return["G",1-Math.min(1,.3*k+.59*C+.11*M+S)]}static G_CMYK([k]){return["CMYK",0,0,0,1-k]}static G_RGB([k]){return["RGB",k,k,k]}static G_HTML([k]){const M=_(k);return`#${M}${M}${M}`}static RGB_G([k,M,C]){return["G",.3*k+.59*M+.11*C]}static RGB_HTML([k,M,C]){const S=_(k),p=_(M),R=_(C);return`#${S}${p}${R}`}static T_HTML(){return"#00000000"}static CMYK_RGB([k,M,C,S]){return["RGB",1-Math.min(1,k+S),1-Math.min(1,C+S),1-Math.min(1,M+S)]}static CMYK_HTML(k){const M=this.CMYK_RGB(k).slice(1);return this.RGB_HTML(M)}static RGB_CMYK([k,M,C]){const S=1-k,p=1-M,R=1-C,N=Math.min(S,p,R);return["CMYK",S,p,R,N]}}n.ColorConverters=e},(b,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.XfaLayer=void 0;var e=_(20);class a{static setupStorage(M,C,S,p,R){const N=p.getValue(C,{value:null});switch(S.name){case"textarea":if(N.value!==null&&(M.textContent=N.value),R==="print")break;M.addEventListener("input",x=>{p.setValue(C,{value:x.target.value})});break;case"input":if(S.attributes.type==="radio"||S.attributes.type==="checkbox"){if(N.value===S.attributes.xfaOn?M.setAttribute("checked",!0):N.value===S.attributes.xfaOff&&M.removeAttribute("checked"),R==="print")break;M.addEventListener("change",x=>{p.setValue(C,{value:x.target.checked?x.target.getAttribute("xfaOn"):x.target.getAttribute("xfaOff")})})}else{if(N.value!==null&&M.setAttribute("value",N.value),R==="print")break;M.addEventListener("input",x=>{p.setValue(C,{value:x.target.value})})}break;case"select":if(N.value!==null)for(const x of S.children)x.attributes.value===N.value&&(x.attributes.selected=!0);M.addEventListener("input",x=>{const P=x.target.options,u=P.selectedIndex===-1?"":P[P.selectedIndex].value;p.setValue(C,{value:u})});break}}static setAttributes({html:M,element:C,storage:S=null,intent:p,linkService:R}){const{attributes:N}=C,x=M instanceof HTMLAnchorElement;N.type==="radio"&&(N.name=`${N.name}-${p}`);for(const[P,u]of Object.entries(N))if(u!=null)switch(P){case"class":u.length&&M.setAttribute(P,u.join(" "));break;case"dataId":break;case"id":M.setAttribute("data-element-id",u);break;case"style":Object.assign(M.style,u);break;case"textContent":M.textContent=u;break;default:(!x||P!=="href"&&P!=="newWindow")&&M.setAttribute(P,u)}x&&R.addLinkAttributes(M,N.href,N.newWindow),S&&N.dataId&&this.setupStorage(M,N.dataId,C,S)}static render(M){var t;const C=M.annotationStorage,S=M.linkService,p=M.xfaHtml,R=M.intent||"display",N=document.createElement(p.name);p.attributes&&this.setAttributes({html:N,element:p,intent:R,linkService:S});const x=[[p,-1,N]],P=M.div;if(P.append(N),M.viewport){const s=`matrix(${M.viewport.transform.join(",")})`;P.style.transform=s}R!=="richText"&&P.setAttribute("class","xfaLayer xfaFont");const u=[];for(;x.length>0;){const[s,c,A]=x.at(-1);if(c+1===s.children.length){x.pop();continue}const E=s.children[++x.at(-1)[1]];if(E===null)continue;const{name:h}=E;if(h==="#text"){const o=document.createTextNode(E.value);u.push(o),A.append(o);continue}let i;if((t=E==null?void 0:E.attributes)!=null&&t.xmlns?i=document.createElementNS(E.attributes.xmlns,h):i=document.createElement(h),A.append(i),E.attributes&&this.setAttributes({html:i,element:E,storage:C,intent:R,linkService:S}),E.children&&E.children.length>0)x.push([E,-1,i]);else if(E.value){const o=document.createTextNode(E.value);e.XfaText.shouldBuildText(h)&&u.push(o),i.append(o)}}for(const s of P.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))s.setAttribute("readOnly",!0);return{textDivs:u}}static update(M){const C=`matrix(${M.viewport.transform.join(",")})`;M.div.style.transform=C,M.div.hidden=!1}}n.XfaLayer=a},(b,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TextLayerRenderTask=void 0,n.renderTextLayer=A;var e=_(1),a=_(8);const k=1e5,M=30,C=.8,S=new Map,p=/^\s+$/g;function R(E,h){const i=S.get(E);if(i)return i;h.save(),h.font=`${M}px ${E}`;const o=h.measureText("");let m=o.fontBoundingBoxAscent,O=Math.abs(o.fontBoundingBoxDescent);if(m){h.restore();const y=m/(m+O);return S.set(E,y),y}h.strokeStyle="red",h.clearRect(0,0,M,M),h.strokeText("g",0,0);let T=h.getImageData(0,0,M,M).data;O=0;for(let y=T.length-1-3;y>=0;y-=4)if(T[y]>0){O=Math.ceil(y/4/M);break}h.clearRect(0,0,M,M),h.strokeText("A",0,M),T=h.getImageData(0,0,M,M).data,m=0;for(let y=0,D=T.length;y<D;y+=4)if(T[y]>0){m=M-Math.floor(y/4/M);break}if(h.restore(),m){const y=m/(m+O);return S.set(E,y),y}return S.set(E,C),C}function N(E,h,i,o){const m=document.createElement("span"),O=E._enhanceTextSelection?{angle:0,canvasWidth:0,hasText:h.str!=="",hasEOL:h.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1,fontSize:0}:{angle:0,canvasWidth:0,hasText:h.str!=="",hasEOL:h.hasEOL,fontSize:0};E._textDivs.push(m);const T=e.Util.transform(E._viewport.transform,h.transform);let y=Math.atan2(T[1],T[0]);const D=i[h.fontName];D.vertical&&(y+=Math.PI/2);const te=Math.hypot(T[2],T[3]),se=te*R(D.fontFamily,o);let Z,J;y===0?(Z=T[4],J=T[5]-se):(Z=T[4]+se*Math.sin(y),J=T[5]-se*Math.cos(y)),m.style.left=`${Z}px`,m.style.top=`${J}px`,m.style.fontSize=`${te}px`,m.style.fontFamily=D.fontFamily,O.fontSize=te,m.setAttribute("role","presentation"),m.textContent=h.str,m.dir=h.dir,E._fontInspectorEnabled&&(m.dataset.fontName=h.fontName),y!==0&&(O.angle=y*(180/Math.PI));let G=!1;if(h.str.length>1||E._enhanceTextSelection&&p.test(h.str))G=!0;else if(h.str!==" "&&h.transform[0]!==h.transform[3]){const V=Math.abs(h.transform[0]),K=Math.abs(h.transform[3]);V!==K&&Math.max(V,K)/Math.min(V,K)>1.5&&(G=!0)}if(G&&(D.vertical?O.canvasWidth=h.height*E._viewport.scale:O.canvasWidth=h.width*E._viewport.scale),E._textDivProperties.set(m,O),E._textContentStream&&E._layoutText(m),E._enhanceTextSelection&&O.hasText){let V=1,K=0;y!==0&&(V=Math.cos(y),K=Math.sin(y));const re=(D.vertical?h.height:h.width)*E._viewport.scale,he=te;let be,q;y!==0?(be=[V,K,-K,V,Z,J],q=e.Util.getAxialAlignedBoundingBox([0,0,re,he],be)):q=[Z,J,Z+re,J+he],E._bounds.push({left:q[0],top:q[1],right:q[2],bottom:q[3],div:m,size:[re,he],m:be})}}function x(E){if(E._canceled)return;const h=E._textDivs,i=E._capability,o=h.length;if(o>k){E._renderingDone=!0,i.resolve();return}if(!E._textContentStream)for(let m=0;m<o;m++)E._layoutText(h[m]);E._renderingDone=!0,i.resolve()}function P(E,h,i){let o=0;for(let m=0;m<i;m++){const O=E[h++];O>0&&(o=o?Math.min(O,o):O)}return o}function u(E){const h=E._bounds,i=E._viewport,o=t(i.width,i.height,h);for(let m=0;m<o.length;m++){const O=h[m].div,T=E._textDivProperties.get(O);if(T.angle===0){T.paddingLeft=h[m].left-o[m].left,T.paddingTop=h[m].top-o[m].top,T.paddingRight=o[m].right-h[m].right,T.paddingBottom=o[m].bottom-h[m].bottom,E._textDivProperties.set(O,T);continue}const y=o[m],D=h[m],te=D.m,se=te[0],Z=te[1],J=[[0,0],[0,D.size[1]],[D.size[0],0],D.size],G=new Float64Array(64);for(let K=0,re=J.length;K<re;K++){const he=e.Util.applyTransform(J[K],te);G[K+0]=se&&(y.left-he[0])/se,G[K+4]=Z&&(y.top-he[1])/Z,G[K+8]=se&&(y.right-he[0])/se,G[K+12]=Z&&(y.bottom-he[1])/Z,G[K+16]=Z&&(y.left-he[0])/-Z,G[K+20]=se&&(y.top-he[1])/se,G[K+24]=Z&&(y.right-he[0])/-Z,G[K+28]=se&&(y.bottom-he[1])/se,G[K+32]=se&&(y.left-he[0])/-se,G[K+36]=Z&&(y.top-he[1])/-Z,G[K+40]=se&&(y.right-he[0])/-se,G[K+44]=Z&&(y.bottom-he[1])/-Z,G[K+48]=Z&&(y.left-he[0])/Z,G[K+52]=se&&(y.top-he[1])/-se,G[K+56]=Z&&(y.right-he[0])/Z,G[K+60]=se&&(y.bottom-he[1])/-se}const V=1+Math.min(Math.abs(se),Math.abs(Z));T.paddingLeft=P(G,32,16)/V,T.paddingTop=P(G,48,16)/V,T.paddingRight=P(G,0,16)/V,T.paddingBottom=P(G,16,16)/V,E._textDivProperties.set(O,T)}}function t(E,h,i){const o=i.map(function(O,T){return{x1:O.left,y1:O.top,x2:O.right,y2:O.bottom,index:T,x1New:void 0,x2New:void 0}});s(E,o);const m=new Array(i.length);for(const O of o){const T=O.index;m[T]={left:O.x1New,top:0,right:O.x2New,bottom:0}}i.map(function(O,T){const y=m[T],D=o[T];D.x1=O.top,D.y1=E-y.right,D.x2=O.bottom,D.y2=E-y.left,D.index=T,D.x1New=void 0,D.x2New=void 0}),s(h,o);for(const O of o){const T=O.index;m[T].top=O.x1New,m[T].bottom=O.x2New}return m}function s(E,h){h.sort(function(m,O){return m.x1-O.x1||m.index-O.index});const o=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];for(const m of h){let O=0;for(;O<o.length&&o[O].end<=m.y1;)O++;let T=o.length-1;for(;T>=0&&o[T].start>=m.y2;)T--;let y,D,te,se,Z=-1/0;for(te=O;te<=T;te++){y=o[te],D=y.boundary;let V;D.x2>m.x1?V=D.index>m.index?D.x1New:m.x1:D.x2New===void 0?V=(D.x2+m.x1)/2:V=D.x2New,V>Z&&(Z=V)}for(m.x1New=Z,te=O;te<=T;te++)y=o[te],D=y.boundary,D.x2New===void 0?D.x2>m.x1?D.index>m.index&&(D.x2New=D.x2):D.x2New=Z:D.x2New>Z&&(D.x2New=Math.max(Z,D.x2));const J=[];let G=null;for(te=O;te<=T;te++){y=o[te],D=y.boundary;const V=D.x2>m.x2?D:m;G===V?J.at(-1).end=y.end:(J.push({start:y.start,end:y.end,boundary:V}),G=V)}for(o[O].start<m.y1&&(J[0].start=m.y1,J.unshift({start:o[O].start,end:m.y1,boundary:o[O].boundary})),m.y2<o[T].end&&(J.at(-1).end=m.y2,J.push({start:m.y2,end:o[T].end,boundary:o[T].boundary})),te=O;te<=T;te++){if(y=o[te],D=y.boundary,D.x2New!==void 0)continue;let V=!1;for(se=O-1;!V&&se>=0&&o[se].start>=D.y1;se--)V=o[se].boundary===D;for(se=T+1;!V&&se<o.length&&o[se].end<=D.y2;se++)V=o[se].boundary===D;for(se=0;!V&&se<J.length;se++)V=J[se].boundary===D;V||(D.x2New=Z)}Array.prototype.splice.apply(o,[O,T-O+1,...J])}for(const m of o){const O=m.boundary;O.x2New===void 0&&(O.x2New=Math.max(E,O.x2))}}class c{constructor({textContent:h,textContentStream:i,container:o,viewport:m,textDivs:O,textContentItemsStr:T,enhanceTextSelection:y}){var D;y&&(0,a.deprecated)("The `enhanceTextSelection` functionality will be removed in the future."),this._textContent=h,this._textContentStream=i,this._container=o,this._document=o.ownerDocument,this._viewport=m,this._textDivs=O||[],this._textContentItemsStr=T||[],this._enhanceTextSelection=!!y,this._fontInspectorEnabled=!!((D=globalThis.FontInspector)!=null&&D.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,e.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._devicePixelRatio=globalThis.devicePixelRatio||1,this._capability.promise.finally(()=>{this._enhanceTextSelection||(this._textDivProperties=null),this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new e.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._renderTimer!==null&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(h,i){for(let o=0,m=h.length;o<m;o++){if(h[o].str===void 0){if(h[o].type==="beginMarkedContentProps"||h[o].type==="beginMarkedContent"){const O=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),h[o].id!==null&&this._container.setAttribute("id",`${h[o].id}`),O.append(this._container)}else h[o].type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(h[o].str),N(this,h[o],i,this._layoutTextCtx)}}_layoutText(h){const i=this._textDivProperties.get(h);let o="";if(i.canvasWidth!==0&&i.hasText){const{fontFamily:m}=h.style,{fontSize:O}=i;(O!==this._layoutTextLastFontSize||m!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${O*this._devicePixelRatio}px ${m}`,this._layoutTextLastFontSize=O,this._layoutTextLastFontFamily=m);const{width:T}=this._layoutTextCtx.measureText(h.textContent);if(T>0){const y=this._devicePixelRatio*i.canvasWidth/T;this._enhanceTextSelection&&(i.scale=y),o=`scaleX(${y})`}}if(i.angle!==0&&(o=`rotate(${i.angle}deg) ${o}`),o.length>0&&(this._enhanceTextSelection&&(i.originalTransform=o),h.style.transform=o),i.hasText&&this._container.append(h),i.hasEOL){const m=document.createElement("br");m.setAttribute("role","presentation"),this._container.append(m)}}_render(h=0){const i=(0,e.createPromiseCapability)();let o=Object.create(null);const m=this._document.createElement("canvas");if(m.height=m.width=M,this._layoutTextCtx=m.getContext("2d",{alpha:!1}),this._textContent){const O=this._textContent.items,T=this._textContent.styles;this._processItems(O,T),i.resolve()}else if(this._textContentStream){const O=()=>{this._reader.read().then(({value:T,done:y})=>{if(y){i.resolve();return}Object.assign(o,T.styles),this._processItems(T.items,o),O()},i.reject)};this._reader=this._textContentStream.getReader(),O()}else throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');i.promise.then(()=>{o=null,h?this._renderTimer=setTimeout(()=>{x(this),this._renderTimer=null},h):x(this)},this._capability.reject)}expandTextDivs(h=!1){if(!this._enhanceTextSelection||!this._renderingDone)return;this._bounds!==null&&(u(this),this._bounds=null);const i=[],o=[];for(let m=0,O=this._textDivs.length;m<O;m++){const T=this._textDivs[m],y=this._textDivProperties.get(T);y.hasText&&(h?(i.length=0,o.length=0,y.originalTransform&&i.push(y.originalTransform),y.paddingTop>0?(o.push(`${y.paddingTop}px`),i.push(`translateY(${-y.paddingTop}px)`)):o.push(0),y.paddingRight>0?o.push(`${y.paddingRight/y.scale}px`):o.push(0),y.paddingBottom>0?o.push(`${y.paddingBottom}px`):o.push(0),y.paddingLeft>0?(o.push(`${y.paddingLeft/y.scale}px`),i.push(`translateX(${-y.paddingLeft/y.scale}px)`)):o.push(0),T.style.padding=o.join(" "),i.length&&(T.style.transform=i.join(" "))):(T.style.padding=null,T.style.transform=y.originalTransform))}}}n.TextLayerRenderTask=c;function A(E){const h=new c({textContent:E.textContent,textContentStream:E.textContentStream,container:E.container,viewport:E.viewport,textDivs:E.textDivs,textContentItemsStr:E.textContentItemsStr,enhanceTextSelection:E.enhanceTextSelection});return h._render(E.timeout),h}},(b,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SVGGraphics=void 0;var e=_(8),a=_(1),k=_(3);let M=class{constructor(){(0,a.unreachable)("Not implemented: SVGGraphics")}};n.SVGGraphics=M;{let t=function(i){let o=[];const m=[];for(const O of i){if(O.fn==="save"){o.push({fnId:92,fn:"group",items:[]}),m.push(o),o=o.at(-1).items;continue}O.fn==="restore"?o=m.pop():o.push(O)}return o},s=function(i){if(Number.isInteger(i))return i.toString();const o=i.toFixed(10);let m=o.length-1;if(o[m]!=="0")return o;do m--;while(o[m]==="0");return o.substring(0,o[m]==="."?m:m+1)},c=function(i){if(i[4]===0&&i[5]===0){if(i[1]===0&&i[2]===0)return i[0]===1&&i[3]===1?"":`scale(${s(i[0])} ${s(i[3])})`;if(i[0]===i[3]&&i[1]===-i[2]){const o=Math.acos(i[0])*180/Math.PI;return`rotate(${s(o)})`}}else if(i[0]===1&&i[1]===0&&i[2]===0&&i[3]===1)return`translate(${s(i[4])} ${s(i[5])})`;return`matrix(${s(i[0])} ${s(i[1])} ${s(i[2])} ${s(i[3])} ${s(i[4])} ${s(i[5])})`};const C={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},S="http://www.w3.org/XML/1998/namespace",p="http://www.w3.org/1999/xlink",R=["butt","round","square"],N=["miter","round","bevel"],x=function(i,o="",m=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!m)return URL.createObjectURL(new Blob([i],{type:o}));const O="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let T=`data:${o};base64,`;for(let y=0,D=i.length;y<D;y+=3){const te=i[y]&255,se=i[y+1]&255,Z=i[y+2]&255,J=te>>2,G=(te&3)<<4|se>>4,V=y+1<D?(se&15)<<2|Z>>6:64,K=y+2<D?Z&63:64;T+=O[J]+O[G]+O[V]+O[K]}return T},P=function(){const i=new Uint8Array([137,80,78,71,13,10,26,10]),o=12,m=new Int32Array(256);for(let Z=0;Z<256;Z++){let J=Z;for(let G=0;G<8;G++)J&1?J=3988292384^J>>1&2147483647:J=J>>1&2147483647;m[Z]=J}function O(Z,J,G){let V=-1;for(let K=J;K<G;K++){const re=(V^Z[K])&255,he=m[re];V=V>>>8^he}return V^-1}function T(Z,J,G,V){let K=V;const re=J.length;G[K]=re>>24&255,G[K+1]=re>>16&255,G[K+2]=re>>8&255,G[K+3]=re&255,K+=4,G[K]=Z.charCodeAt(0)&255,G[K+1]=Z.charCodeAt(1)&255,G[K+2]=Z.charCodeAt(2)&255,G[K+3]=Z.charCodeAt(3)&255,K+=4,G.set(J,K),K+=J.length;const he=O(G,V+4,K);G[K]=he>>24&255,G[K+1]=he>>16&255,G[K+2]=he>>8&255,G[K+3]=he&255}function y(Z,J,G){let V=1,K=0;for(let re=J;re<G;++re)V=(V+(Z[re]&255))%65521,K=(K+V)%65521;return K<<16|V}function D(Z){if(!k.isNodeJS)return te(Z);try{let J;parseInt(process.versions.node)>=8?J=Z:J=Buffer.from(Z);const G=require$$5.deflateSync(J,{level:9});return G instanceof Uint8Array?G:new Uint8Array(G)}catch(J){(0,a.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+J)}return te(Z)}function te(Z){let J=Z.length;const G=65535,V=Math.ceil(J/G),K=new Uint8Array(2+J+V*5+4);let re=0;K[re++]=120,K[re++]=156;let he=0;for(;J>G;)K[re++]=0,K[re++]=255,K[re++]=255,K[re++]=0,K[re++]=0,K.set(Z.subarray(he,he+G),re),re+=G,he+=G,J-=G;K[re++]=1,K[re++]=J&255,K[re++]=J>>8&255,K[re++]=~J&65535&255,K[re++]=(~J&65535)>>8&255,K.set(Z.subarray(he),re),re+=Z.length-he;const be=y(Z,0,Z.length);return K[re++]=be>>24&255,K[re++]=be>>16&255,K[re++]=be>>8&255,K[re++]=be&255,K}function se(Z,J,G,V){const K=Z.width,re=Z.height;let he,be,q;const f=Z.data;switch(J){case a.ImageKind.GRAYSCALE_1BPP:be=0,he=1,q=K+7>>3;break;case a.ImageKind.RGB_24BPP:be=2,he=8,q=K*3;break;case a.ImageKind.RGBA_32BPP:be=6,he=8,q=K*4;break;default:throw new Error("invalid format")}const d=new Uint8Array((1+q)*re);let F=0,U=0;for(let g=0;g<re;++g)d[F++]=0,d.set(f.subarray(U,U+q),F),U+=q,F+=q;if(J===a.ImageKind.GRAYSCALE_1BPP&&V){F=0;for(let g=0;g<re;g++){F++;for(let v=0;v<q;v++)d[F++]^=255}}const B=new Uint8Array([K>>24&255,K>>16&255,K>>8&255,K&255,re>>24&255,re>>16&255,re>>8&255,re&255,he,be,0,0,0]),W=D(d),X=i.length+o*3+B.length+W.length,Y=new Uint8Array(X);let l=0;return Y.set(i,l),l+=i.length,T("IHDR",B,Y,l),l+=o+B.length,T("IDATA",W,Y,l),l+=o+W.length,T("IEND",new Uint8Array(0),Y,l),x(Y,"image/png",G)}return function(J,G,V){const K=J.kind===void 0?a.ImageKind.GRAYSCALE_1BPP:J.kind;return se(J,K,G,V)}}();class u{constructor(){this.fontSizeScale=1,this.fontWeight=C.fontWeight,this.fontSize=0,this.textMatrix=a.IDENTITY_MATRIX,this.fontMatrix=a.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=a.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=C.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(o,m){this.x=o,this.y=m}}let A=0,E=0,h=0;n.SVGGraphics=M=class{constructor(i,o,m=!1){(0,e.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new e.DOMSVGFactory,this.current=new u,this.transformMatrix=a.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=i,this.objs=o,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!m,this._operatorIdMapping=[];for(const O in a.OPS)this._operatorIdMapping[a.OPS[O]]=O}save(){this.transformStack.push(this.transformMatrix);const i=this.current;this.extraStack.push(i),this.current=i.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(i){this.save(),this.executeOpTree(i),this.restore()}loadDependencies(i){const o=i.fnArray,m=i.argsArray;for(let O=0,T=o.length;O<T;O++)if(o[O]===a.OPS.dependency)for(const y of m[O]){const D=y.startsWith("g_")?this.commonObjs:this.objs,te=new Promise(se=>{D.get(y,se)});this.current.dependencies.push(te)}return Promise.all(this.current.dependencies)}transform(i,o,m,O,T,y){const D=[i,o,m,O,T,y];this.transformMatrix=a.Util.transform(this.transformMatrix,D),this.tgrp=null}getSVG(i,o){this.viewport=o;const m=this._initialize(o);return this.loadDependencies(i).then(()=>(this.transformMatrix=a.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(i)),m))}convertOpList(i){const o=this._operatorIdMapping,m=i.argsArray,O=i.fnArray,T=[];for(let y=0,D=O.length;y<D;y++){const te=O[y];T.push({fnId:te,fn:o[te],args:m[y]})}return t(T)}executeOpTree(i){for(const o of i){const m=o.fn,O=o.fnId,T=o.args;switch(O|0){case a.OPS.beginText:this.beginText();break;case a.OPS.dependency:break;case a.OPS.setLeading:this.setLeading(T);break;case a.OPS.setLeadingMoveText:this.setLeadingMoveText(T[0],T[1]);break;case a.OPS.setFont:this.setFont(T);break;case a.OPS.showText:this.showText(T[0]);break;case a.OPS.showSpacedText:this.showText(T[0]);break;case a.OPS.endText:this.endText();break;case a.OPS.moveText:this.moveText(T[0],T[1]);break;case a.OPS.setCharSpacing:this.setCharSpacing(T[0]);break;case a.OPS.setWordSpacing:this.setWordSpacing(T[0]);break;case a.OPS.setHScale:this.setHScale(T[0]);break;case a.OPS.setTextMatrix:this.setTextMatrix(T[0],T[1],T[2],T[3],T[4],T[5]);break;case a.OPS.setTextRise:this.setTextRise(T[0]);break;case a.OPS.setTextRenderingMode:this.setTextRenderingMode(T[0]);break;case a.OPS.setLineWidth:this.setLineWidth(T[0]);break;case a.OPS.setLineJoin:this.setLineJoin(T[0]);break;case a.OPS.setLineCap:this.setLineCap(T[0]);break;case a.OPS.setMiterLimit:this.setMiterLimit(T[0]);break;case a.OPS.setFillRGBColor:this.setFillRGBColor(T[0],T[1],T[2]);break;case a.OPS.setStrokeRGBColor:this.setStrokeRGBColor(T[0],T[1],T[2]);break;case a.OPS.setStrokeColorN:this.setStrokeColorN(T);break;case a.OPS.setFillColorN:this.setFillColorN(T);break;case a.OPS.shadingFill:this.shadingFill(T[0]);break;case a.OPS.setDash:this.setDash(T[0],T[1]);break;case a.OPS.setRenderingIntent:this.setRenderingIntent(T[0]);break;case a.OPS.setFlatness:this.setFlatness(T[0]);break;case a.OPS.setGState:this.setGState(T[0]);break;case a.OPS.fill:this.fill();break;case a.OPS.eoFill:this.eoFill();break;case a.OPS.stroke:this.stroke();break;case a.OPS.fillStroke:this.fillStroke();break;case a.OPS.eoFillStroke:this.eoFillStroke();break;case a.OPS.clip:this.clip("nonzero");break;case a.OPS.eoClip:this.clip("evenodd");break;case a.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case a.OPS.paintImageXObject:this.paintImageXObject(T[0]);break;case a.OPS.paintInlineImageXObject:this.paintInlineImageXObject(T[0]);break;case a.OPS.paintImageMaskXObject:this.paintImageMaskXObject(T[0]);break;case a.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(T[0],T[1]);break;case a.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case a.OPS.closePath:this.closePath();break;case a.OPS.closeStroke:this.closeStroke();break;case a.OPS.closeFillStroke:this.closeFillStroke();break;case a.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case a.OPS.nextLine:this.nextLine();break;case a.OPS.transform:this.transform(T[0],T[1],T[2],T[3],T[4],T[5]);break;case a.OPS.constructPath:this.constructPath(T[0],T[1]);break;case a.OPS.endPath:this.endPath();break;case 92:this.group(o.items);break;default:(0,a.warn)(`Unimplemented operator ${m}`);break}}}setWordSpacing(i){this.current.wordSpacing=i}setCharSpacing(i){this.current.charSpacing=i}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(i,o,m,O,T,y){const D=this.current;D.textMatrix=D.lineMatrix=[i,o,m,O,T,y],D.textMatrixScale=Math.hypot(i,o),D.x=D.lineX=0,D.y=D.lineY=0,D.xcoords=[],D.ycoords=[],D.tspan=this.svgFactory.createElement("svg:tspan"),D.tspan.setAttributeNS(null,"font-family",D.fontFamily),D.tspan.setAttributeNS(null,"font-size",`${s(D.fontSize)}px`),D.tspan.setAttributeNS(null,"y",s(-D.y)),D.txtElement=this.svgFactory.createElement("svg:text"),D.txtElement.append(D.tspan)}beginText(){const i=this.current;i.x=i.lineX=0,i.y=i.lineY=0,i.textMatrix=a.IDENTITY_MATRIX,i.lineMatrix=a.IDENTITY_MATRIX,i.textMatrixScale=1,i.tspan=this.svgFactory.createElement("svg:tspan"),i.txtElement=this.svgFactory.createElement("svg:text"),i.txtgrp=this.svgFactory.createElement("svg:g"),i.xcoords=[],i.ycoords=[]}moveText(i,o){const m=this.current;m.x=m.lineX+=i,m.y=m.lineY+=o,m.xcoords=[],m.ycoords=[],m.tspan=this.svgFactory.createElement("svg:tspan"),m.tspan.setAttributeNS(null,"font-family",m.fontFamily),m.tspan.setAttributeNS(null,"font-size",`${s(m.fontSize)}px`),m.tspan.setAttributeNS(null,"y",s(-m.y))}showText(i){const o=this.current,m=o.font,O=o.fontSize;if(O===0)return;const T=o.fontSizeScale,y=o.charSpacing,D=o.wordSpacing,te=o.fontDirection,se=o.textHScale*te,Z=m.vertical,J=Z?1:-1,G=m.defaultVMetrics,V=O*o.fontMatrix[0];let K=0;for(const be of i){if(be===null){K+=te*D;continue}else if(typeof be=="number"){K+=J*be*O/1e3;continue}const q=(be.isSpace?D:0)+y,f=be.fontChar;let d,F,U=be.width;if(Z){let W;const X=be.vmetric||G;W=be.vmetric?X[1]:U*.5,W=-W*V;const Y=X[2]*V;U=X?-X[0]:U,d=W/T,F=(K+Y)/T}else d=K/T,F=0;(be.isInFont||m.missingFile)&&(o.xcoords.push(o.x+d),Z&&o.ycoords.push(-o.y+F),o.tspan.textContent+=f);let B;Z?B=U*V-q*te:B=U*V+q*te,K+=B}o.tspan.setAttributeNS(null,"x",o.xcoords.map(s).join(" ")),Z?o.tspan.setAttributeNS(null,"y",o.ycoords.map(s).join(" ")):o.tspan.setAttributeNS(null,"y",s(-o.y)),Z?o.y-=K:o.x+=K*se,o.tspan.setAttributeNS(null,"font-family",o.fontFamily),o.tspan.setAttributeNS(null,"font-size",`${s(o.fontSize)}px`),o.fontStyle!==C.fontStyle&&o.tspan.setAttributeNS(null,"font-style",o.fontStyle),o.fontWeight!==C.fontWeight&&o.tspan.setAttributeNS(null,"font-weight",o.fontWeight);const re=o.textRenderingMode&a.TextRenderingMode.FILL_STROKE_MASK;if(re===a.TextRenderingMode.FILL||re===a.TextRenderingMode.FILL_STROKE?(o.fillColor!==C.fillColor&&o.tspan.setAttributeNS(null,"fill",o.fillColor),o.fillAlpha<1&&o.tspan.setAttributeNS(null,"fill-opacity",o.fillAlpha)):o.textRenderingMode===a.TextRenderingMode.ADD_TO_PATH?o.tspan.setAttributeNS(null,"fill","transparent"):o.tspan.setAttributeNS(null,"fill","none"),re===a.TextRenderingMode.STROKE||re===a.TextRenderingMode.FILL_STROKE){const be=1/(o.textMatrixScale||1);this._setStrokeAttributes(o.tspan,be)}let he=o.textMatrix;o.textRise!==0&&(he=he.slice(),he[5]+=o.textRise),o.txtElement.setAttributeNS(null,"transform",`${c(he)} scale(${s(se)}, -1)`),o.txtElement.setAttributeNS(S,"xml:space","preserve"),o.txtElement.append(o.tspan),o.txtgrp.append(o.txtElement),this._ensureTransformGroup().append(o.txtElement)}setLeadingMoveText(i,o){this.setLeading(-o),this.moveText(i,o)}addFontStyle(i){if(!i.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const o=x(i.data,i.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${i.loadedName}"; src: url(${o}); }
`}setFont(i){const o=this.current,m=this.commonObjs.get(i[0]);let O=i[1];o.font=m,this.embedFonts&&!m.missingFile&&!this.embeddedFonts[m.loadedName]&&(this.addFontStyle(m),this.embeddedFonts[m.loadedName]=m),o.fontMatrix=m.fontMatrix||a.FONT_IDENTITY_MATRIX;let T="normal";m.black?T="900":m.bold&&(T="bold");const y=m.italic?"italic":"normal";O<0?(O=-O,o.fontDirection=-1):o.fontDirection=1,o.fontSize=O,o.fontFamily=m.loadedName,o.fontWeight=T,o.fontStyle=y,o.tspan=this.svgFactory.createElement("svg:tspan"),o.tspan.setAttributeNS(null,"y",s(-o.y)),o.xcoords=[],o.ycoords=[]}endText(){var o;const i=this.current;i.textRenderingMode&a.TextRenderingMode.ADD_TO_PATH_FLAG&&((o=i.txtElement)!=null&&o.hasChildNodes())&&(i.element=i.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(i){i>0&&(this.current.lineWidth=i)}setLineCap(i){this.current.lineCap=R[i]}setLineJoin(i){this.current.lineJoin=N[i]}setMiterLimit(i){this.current.miterLimit=i}setStrokeAlpha(i){this.current.strokeAlpha=i}setStrokeRGBColor(i,o,m){this.current.strokeColor=a.Util.makeHexColor(i,o,m)}setFillAlpha(i){this.current.fillAlpha=i}setFillRGBColor(i,o,m){this.current.fillColor=a.Util.makeHexColor(i,o,m),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(i){this.current.strokeColor=this._makeColorN_Pattern(i)}setFillColorN(i){this.current.fillColor=this._makeColorN_Pattern(i)}shadingFill(i){const o=this.viewport.width,m=this.viewport.height,O=a.Util.inverseTransform(this.transformMatrix),T=a.Util.applyTransform([0,0],O),y=a.Util.applyTransform([0,m],O),D=a.Util.applyTransform([o,0],O),te=a.Util.applyTransform([o,m],O),se=Math.min(T[0],y[0],D[0],te[0]),Z=Math.min(T[1],y[1],D[1],te[1]),J=Math.max(T[0],y[0],D[0],te[0]),G=Math.max(T[1],y[1],D[1],te[1]),V=this.svgFactory.createElement("svg:rect");V.setAttributeNS(null,"x",se),V.setAttributeNS(null,"y",Z),V.setAttributeNS(null,"width",J-se),V.setAttributeNS(null,"height",G-Z),V.setAttributeNS(null,"fill",this._makeShadingPattern(i)),this.current.fillAlpha<1&&V.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(V)}_makeColorN_Pattern(i){return i[0]==="TilingPattern"?this._makeTilingPattern(i):this._makeShadingPattern(i)}_makeTilingPattern(i){const o=i[1],m=i[2],O=i[3]||a.IDENTITY_MATRIX,[T,y,D,te]=i[4],se=i[5],Z=i[6],J=i[7],G=`shading${h++}`,[V,K,re,he]=a.Util.normalizeRect([...a.Util.applyTransform([T,y],O),...a.Util.applyTransform([D,te],O)]),[be,q]=a.Util.singularValueDecompose2dScale(O),f=se*be,d=Z*q,F=this.svgFactory.createElement("svg:pattern");F.setAttributeNS(null,"id",G),F.setAttributeNS(null,"patternUnits","userSpaceOnUse"),F.setAttributeNS(null,"width",f),F.setAttributeNS(null,"height",d),F.setAttributeNS(null,"x",`${V}`),F.setAttributeNS(null,"y",`${K}`);const U=this.svg,B=this.transformMatrix,W=this.current.fillColor,X=this.current.strokeColor,Y=this.svgFactory.create(re-V,he-K);if(this.svg=Y,this.transformMatrix=O,J===2){const l=a.Util.makeHexColor(...o);this.current.fillColor=l,this.current.strokeColor=l}return this.executeOpTree(this.convertOpList(m)),this.svg=U,this.transformMatrix=B,this.current.fillColor=W,this.current.strokeColor=X,F.append(Y.childNodes[0]),this.defs.append(F),`url(#${G})`}_makeShadingPattern(i){switch(typeof i=="string"&&(i=this.objs.get(i)),i[0]){case"RadialAxial":const o=`shading${h++}`,m=i[3];let O;switch(i[1]){case"axial":const T=i[4],y=i[5];O=this.svgFactory.createElement("svg:linearGradient"),O.setAttributeNS(null,"id",o),O.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),O.setAttributeNS(null,"x1",T[0]),O.setAttributeNS(null,"y1",T[1]),O.setAttributeNS(null,"x2",y[0]),O.setAttributeNS(null,"y2",y[1]);break;case"radial":const D=i[4],te=i[5],se=i[6],Z=i[7];O=this.svgFactory.createElement("svg:radialGradient"),O.setAttributeNS(null,"id",o),O.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),O.setAttributeNS(null,"cx",te[0]),O.setAttributeNS(null,"cy",te[1]),O.setAttributeNS(null,"r",Z),O.setAttributeNS(null,"fx",D[0]),O.setAttributeNS(null,"fy",D[1]),O.setAttributeNS(null,"fr",se);break;default:throw new Error(`Unknown RadialAxial type: ${i[1]}`)}for(const T of m){const y=this.svgFactory.createElement("svg:stop");y.setAttributeNS(null,"offset",T[0]),y.setAttributeNS(null,"stop-color",T[1]),O.append(y)}return this.defs.append(O),`url(#${o})`;case"Mesh":return(0,a.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${i[0]}`)}}setDash(i,o){this.current.dashArray=i,this.current.dashPhase=o}constructPath(i,o){const m=this.current;let O=m.x,T=m.y,y=[],D=0;for(const te of i)switch(te|0){case a.OPS.rectangle:O=o[D++],T=o[D++];const se=o[D++],Z=o[D++],J=O+se,G=T+Z;y.push("M",s(O),s(T),"L",s(J),s(T),"L",s(J),s(G),"L",s(O),s(G),"Z");break;case a.OPS.moveTo:O=o[D++],T=o[D++],y.push("M",s(O),s(T));break;case a.OPS.lineTo:O=o[D++],T=o[D++],y.push("L",s(O),s(T));break;case a.OPS.curveTo:O=o[D+4],T=o[D+5],y.push("C",s(o[D]),s(o[D+1]),s(o[D+2]),s(o[D+3]),s(O),s(T)),D+=6;break;case a.OPS.curveTo2:y.push("C",s(O),s(T),s(o[D]),s(o[D+1]),s(o[D+2]),s(o[D+3])),O=o[D+2],T=o[D+3],D+=4;break;case a.OPS.curveTo3:O=o[D+2],T=o[D+3],y.push("C",s(o[D]),s(o[D+1]),s(O),s(T),s(O),s(T)),D+=4;break;case a.OPS.closePath:y.push("Z");break}y=y.join(" "),m.path&&i.length>0&&i[0]!==a.OPS.rectangle&&i[0]!==a.OPS.moveTo?y=m.path.getAttributeNS(null,"d")+y:(m.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(m.path)),m.path.setAttributeNS(null,"d",y),m.path.setAttributeNS(null,"fill","none"),m.element=m.path,m.setCurrentPoint(O,T)}endPath(){const i=this.current;if(i.path=null,!this.pendingClip)return;if(!i.element){this.pendingClip=null;return}const o=`clippath${A++}`,m=this.svgFactory.createElement("svg:clipPath");m.setAttributeNS(null,"id",o),m.setAttributeNS(null,"transform",c(this.transformMatrix));const O=i.element.cloneNode(!0);if(this.pendingClip==="evenodd"?O.setAttributeNS(null,"clip-rule","evenodd"):O.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,m.append(O),this.defs.append(m),i.activeClipUrl){i.clipGroup=null;for(const T of this.extraStack)T.clipGroup=null;m.setAttributeNS(null,"clip-path",i.activeClipUrl)}i.activeClipUrl=`url(#${o})`,this.tgrp=null}clip(i){this.pendingClip=i}closePath(){const i=this.current;if(i.path){const o=`${i.path.getAttributeNS(null,"d")}Z`;i.path.setAttributeNS(null,"d",o)}}setLeading(i){this.current.leading=-i}setTextRise(i){this.current.textRise=i}setTextRenderingMode(i){this.current.textRenderingMode=i}setHScale(i){this.current.textHScale=i/100}setRenderingIntent(i){}setFlatness(i){}setGState(i){for(const[o,m]of i)switch(o){case"LW":this.setLineWidth(m);break;case"LC":this.setLineCap(m);break;case"LJ":this.setLineJoin(m);break;case"ML":this.setMiterLimit(m);break;case"D":this.setDash(m[0],m[1]);break;case"RI":this.setRenderingIntent(m);break;case"FL":this.setFlatness(m);break;case"Font":this.setFont(m);break;case"CA":this.setStrokeAlpha(m);break;case"ca":this.setFillAlpha(m);break;default:(0,a.warn)(`Unimplemented graphic state operator ${o}`);break}}fill(){const i=this.current;i.element&&(i.element.setAttributeNS(null,"fill",i.fillColor),i.element.setAttributeNS(null,"fill-opacity",i.fillAlpha),this.endPath())}stroke(){const i=this.current;i.element&&(this._setStrokeAttributes(i.element),i.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(i,o=1){const m=this.current;let O=m.dashArray;o!==1&&O.length>0&&(O=O.map(function(T){return o*T})),i.setAttributeNS(null,"stroke",m.strokeColor),i.setAttributeNS(null,"stroke-opacity",m.strokeAlpha),i.setAttributeNS(null,"stroke-miterlimit",s(m.miterLimit)),i.setAttributeNS(null,"stroke-linecap",m.lineCap),i.setAttributeNS(null,"stroke-linejoin",m.lineJoin),i.setAttributeNS(null,"stroke-width",s(o*m.lineWidth)+"px"),i.setAttributeNS(null,"stroke-dasharray",O.map(s).join(" ")),i.setAttributeNS(null,"stroke-dashoffset",s(o*m.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const i=this.svgFactory.createElement("svg:rect");i.setAttributeNS(null,"x","0"),i.setAttributeNS(null,"y","0"),i.setAttributeNS(null,"width","1px"),i.setAttributeNS(null,"height","1px"),i.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(i)}paintImageXObject(i){const o=i.startsWith("g_")?this.commonObjs.get(i):this.objs.get(i);if(!o){(0,a.warn)(`Dependent image with object ID ${i} is not ready yet`);return}this.paintInlineImageXObject(o)}paintInlineImageXObject(i,o){const m=i.width,O=i.height,T=P(i,this.forceDataSchema,!!o),y=this.svgFactory.createElement("svg:rect");y.setAttributeNS(null,"x","0"),y.setAttributeNS(null,"y","0"),y.setAttributeNS(null,"width",s(m)),y.setAttributeNS(null,"height",s(O)),this.current.element=y,this.clip("nonzero");const D=this.svgFactory.createElement("svg:image");D.setAttributeNS(p,"xlink:href",T),D.setAttributeNS(null,"x","0"),D.setAttributeNS(null,"y",s(-O)),D.setAttributeNS(null,"width",s(m)+"px"),D.setAttributeNS(null,"height",s(O)+"px"),D.setAttributeNS(null,"transform",`scale(${s(1/m)} ${s(-1/O)})`),o?o.append(D):this._ensureTransformGroup().append(D)}paintImageMaskXObject(i){const o=this.current,m=i.width,O=i.height,T=o.fillColor;o.maskId=`mask${E++}`;const y=this.svgFactory.createElement("svg:mask");y.setAttributeNS(null,"id",o.maskId);const D=this.svgFactory.createElement("svg:rect");D.setAttributeNS(null,"x","0"),D.setAttributeNS(null,"y","0"),D.setAttributeNS(null,"width",s(m)),D.setAttributeNS(null,"height",s(O)),D.setAttributeNS(null,"fill",T),D.setAttributeNS(null,"mask",`url(#${o.maskId})`),this.defs.append(y),this._ensureTransformGroup().append(D),this.paintInlineImageXObject(i,y)}paintFormXObjectBegin(i,o){if(Array.isArray(i)&&i.length===6&&this.transform(i[0],i[1],i[2],i[3],i[4],i[5]),o){const m=o[2]-o[0],O=o[3]-o[1],T=this.svgFactory.createElement("svg:rect");T.setAttributeNS(null,"x",o[0]),T.setAttributeNS(null,"y",o[1]),T.setAttributeNS(null,"width",s(m)),T.setAttributeNS(null,"height",s(O)),this.current.element=T,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(i){const o=this.svgFactory.create(i.width,i.height),m=this.svgFactory.createElement("svg:defs");o.append(m),this.defs=m;const O=this.svgFactory.createElement("svg:g");return O.setAttributeNS(null,"transform",c(i.transform)),o.append(O),this.svg=O,o}_ensureClipGroup(){if(!this.current.clipGroup){const i=this.svgFactory.createElement("svg:g");i.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(i),this.current.clipGroup=i}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",c(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}},(b,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFNodeStream=void 0;var e=_(1),a=_(33);const k=require$$5,M=require$$5,C=require$$5,S=require$$5,p=/^file:\/\/\/[a-zA-Z]:\//;function R(E){const h=S.parse(E);return h.protocol==="file:"||h.host?h:/^[a-z]:[/\\]/i.test(E)?S.parse(`file:///${E}`):(h.host||(h.protocol="file:"),h)}class N{constructor(h){this.source=h,this.url=R(h.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&h.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var h;return((h=this._fullRequestReader)==null?void 0:h._loaded)??0}getFullReader(){return(0,e.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new c(this):new t(this),this._fullRequestReader}getRangeReader(h,i){if(i<=this._progressiveDataLength)return null;const o=this.isFsUrl?new A(this,h,i):new s(this,h,i);return this._rangeRequestReaders.push(o),o}cancelAllRequests(h){this._fullRequestReader&&this._fullRequestReader.cancel(h);for(const i of this._rangeRequestReaders.slice(0))i.cancel(h)}}n.PDFNodeStream=N;class x{constructor(h){this._url=h.url,this._done=!1,this._storedError=null,this.onProgress=null;const i=h.source;this._contentLength=i.length,this._loaded=0,this._filename=null,this._disableRange=i.disableRange||!1,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!i.disableStream,this._isRangeSupported=!i.disableRange,this._readableStream=null,this._readCapability=(0,e.createPromiseCapability)(),this._headersCapability=(0,e.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const h=this._readableStream.read();return h===null?(this._readCapability=(0,e.createPromiseCapability)(),this.read()):(this._loaded+=h.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(h).buffer,done:!1})}cancel(h){if(!this._readableStream){this._error(h);return}this._readableStream.destroy(h)}_error(h){this._storedError=h,this._readCapability.resolve()}_setReadableStream(h){this._readableStream=h,h.on("readable",()=>{this._readCapability.resolve()}),h.on("end",()=>{h.destroy(),this._done=!0,this._readCapability.resolve()}),h.on("error",i=>{this._error(i)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new e.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class P{constructor(h){this._url=h.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,e.createPromiseCapability)();const i=h.source;this._isStreamingSupported=!i.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const h=this._readableStream.read();return h===null?(this._readCapability=(0,e.createPromiseCapability)(),this.read()):(this._loaded+=h.length,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(h).buffer,done:!1})}cancel(h){if(!this._readableStream){this._error(h);return}this._readableStream.destroy(h)}_error(h){this._storedError=h,this._readCapability.resolve()}_setReadableStream(h){this._readableStream=h,h.on("readable",()=>{this._readCapability.resolve()}),h.on("end",()=>{h.destroy(),this._done=!0,this._readCapability.resolve()}),h.on("error",i=>{this._error(i)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function u(E,h){return{protocol:E.protocol,auth:E.auth,host:E.hostname,port:E.port,path:E.path,method:"GET",headers:h}}class t extends x{constructor(h){super(h);const i=o=>{if(o.statusCode===404){const y=new e.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=y,this._headersCapability.reject(y);return}this._headersCapability.resolve(),this._setReadableStream(o);const m=y=>this._readableStream.headers[y.toLowerCase()],{allowRangeRequests:O,suggestedLength:T}=(0,a.validateRangeRequestCapabilities)({getResponseHeader:m,isHttp:h.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=O,this._contentLength=T||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(m)};this._request=null,this._url.protocol==="http:"?this._request=M.request(u(this._url,h.httpHeaders),i):this._request=C.request(u(this._url,h.httpHeaders),i),this._request.on("error",o=>{this._storedError=o,this._headersCapability.reject(o)}),this._request.end()}}class s extends P{constructor(h,i,o){super(h),this._httpHeaders={};for(const O in h.httpHeaders){const T=h.httpHeaders[O];typeof T>"u"||(this._httpHeaders[O]=T)}this._httpHeaders.Range=`bytes=${i}-${o-1}`;const m=O=>{if(O.statusCode===404){const T=new e.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=T;return}this._setReadableStream(O)};this._request=null,this._url.protocol==="http:"?this._request=M.request(u(this._url,this._httpHeaders),m):this._request=C.request(u(this._url,this._httpHeaders),m),this._request.on("error",O=>{this._storedError=O}),this._request.end()}}class c extends x{constructor(h){super(h);let i=decodeURIComponent(this._url.path);p.test(this._url.href)&&(i=i.replace(/^\//,"")),k.lstat(i,(o,m)=>{if(o){o.code==="ENOENT"&&(o=new e.MissingPDFException(`Missing PDF "${i}".`)),this._storedError=o,this._headersCapability.reject(o);return}this._contentLength=m.size,this._setReadableStream(k.createReadStream(i)),this._headersCapability.resolve()})}}class A extends P{constructor(h,i,o){super(h);let m=decodeURIComponent(this._url.path);p.test(this._url.href)&&(m=m.replace(/^\//,"")),this._setReadableStream(k.createReadStream(m,{start:i,end:o-1}))}}},(b,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.createResponseStatusError=S,n.extractFilenameFromHeader=C,n.validateRangeRequestCapabilities=M,n.validateResponseStatus=p;var e=_(1),a=_(34),k=_(8);function M({getResponseHeader:R,isHttp:N,rangeChunkSize:x,disableRange:P}){const u={allowRangeRequests:!1,suggestedLength:void 0},t=parseInt(R("Content-Length"),10);return!Number.isInteger(t)||(u.suggestedLength=t,t<=2*x)||P||!N||R("Accept-Ranges")!=="bytes"||(R("Content-Encoding")||"identity")!=="identity"||(u.allowRangeRequests=!0),u}function C(R){const N=R("Content-Disposition");if(N){let x=(0,a.getFilenameFromContentDispositionHeader)(N);if(x.includes("%"))try{x=decodeURIComponent(x)}catch{}if((0,k.isPdfFile)(x))return x}return null}function S(R,N){return R===404||R===0&&N.startsWith("file:")?new e.MissingPDFException('Missing PDF "'+N+'".'):new e.UnexpectedResponseException(`Unexpected server response (${R}) while retrieving PDF "${N}".`,R)}function p(R){return R===200||R===206}},(b,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.getFilenameFromContentDispositionHeader=a;var e=_(1);function a(k){let M=!0,C=S("filename\\*","i").exec(k);if(C){C=C[1];let t=x(C);return t=unescape(t),t=P(t),t=u(t),R(t)}if(C=N(k),C){const t=u(C);return R(t)}if(C=S("filename","i").exec(k),C){C=C[1];let t=x(C);return t=u(t),R(t)}function S(t,s){return new RegExp("(?:^|;)\\s*"+t+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',s)}function p(t,s){if(t){if(!/^[\x00-\xFF]+$/.test(s))return s;try{const c=new TextDecoder(t,{fatal:!0}),A=(0,e.stringToBytes)(s);s=c.decode(A),M=!1}catch{}}return s}function R(t){return M&&/[\x80-\xff]/.test(t)&&(t=p("utf-8",t),M&&(t=p("iso-8859-1",t))),t}function N(t){const s=[];let c;const A=S("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(c=A.exec(t))!==null;){let[,h,i,o]=c;if(h=parseInt(h,10),h in s){if(h===0)break;continue}s[h]=[i,o]}const E=[];for(let h=0;h<s.length&&h in s;++h){let[i,o]=s[h];o=x(o),i&&(o=unescape(o),h===0&&(o=P(o))),E.push(o)}return E.join("")}function x(t){if(t.startsWith('"')){const s=t.slice(1).split('\\"');for(let c=0;c<s.length;++c){const A=s[c].indexOf('"');A!==-1&&(s[c]=s[c].slice(0,A),s.length=c+1),s[c]=s[c].replace(/\\(.)/g,"$1")}t=s.join('"')}return t}function P(t){const s=t.indexOf("'");if(s===-1)return t;const c=t.slice(0,s),E=t.slice(s+1).replace(/^[^']*'/,"");return p(c,E)}function u(t){return!t.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(t)?t:t.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(s,c,A,E){if(A==="q"||A==="Q")return E=E.replace(/_/g," "),E=E.replace(/=([0-9a-fA-F]{2})/g,function(h,i){return String.fromCharCode(parseInt(i,16))}),p(c,E);try{E=atob(E)}catch{}return p(c,E)})}return""}},(b,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFNetworkStream=void 0;var e=_(1),a=_(33);const k=200,M=206;function C(x){const P=x.response;return typeof P!="string"?P:(0,e.stringToBytes)(P).buffer}class S{constructor(P,u={}){this.url=P,this.isHttp=/^https?:/i.test(P),this.httpHeaders=this.isHttp&&u.httpHeaders||Object.create(null),this.withCredentials=u.withCredentials||!1,this.getXhr=u.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(P,u,t){const s={begin:P,end:u};for(const c in t)s[c]=t[c];return this.request(s)}requestFull(P){return this.request(P)}request(P){const u=this.getXhr(),t=this.currXhrId++,s=this.pendingRequests[t]={xhr:u};u.open("GET",this.url),u.withCredentials=this.withCredentials;for(const c in this.httpHeaders){const A=this.httpHeaders[c];typeof A>"u"||u.setRequestHeader(c,A)}return this.isHttp&&"begin"in P&&"end"in P?(u.setRequestHeader("Range",`bytes=${P.begin}-${P.end-1}`),s.expectedStatus=M):s.expectedStatus=k,u.responseType="arraybuffer",P.onError&&(u.onerror=function(c){P.onError(u.status)}),u.onreadystatechange=this.onStateChange.bind(this,t),u.onprogress=this.onProgress.bind(this,t),s.onHeadersReceived=P.onHeadersReceived,s.onDone=P.onDone,s.onError=P.onError,s.onProgress=P.onProgress,u.send(null),t}onProgress(P,u){var s;const t=this.pendingRequests[P];t&&((s=t.onProgress)==null||s.call(t,u))}onStateChange(P,u){var h,i,o;const t=this.pendingRequests[P];if(!t)return;const s=t.xhr;if(s.readyState>=2&&t.onHeadersReceived&&(t.onHeadersReceived(),delete t.onHeadersReceived),s.readyState!==4||!(P in this.pendingRequests))return;if(delete this.pendingRequests[P],s.status===0&&this.isHttp){(h=t.onError)==null||h.call(t,s.status);return}const c=s.status||k;if(!(c===k&&t.expectedStatus===M)&&c!==t.expectedStatus){(i=t.onError)==null||i.call(t,s.status);return}const E=C(s);if(c===M){const m=s.getResponseHeader("Content-Range"),O=/bytes (\d+)-(\d+)\/(\d+)/.exec(m);t.onDone({begin:parseInt(O[1],10),chunk:E})}else E?t.onDone({begin:0,chunk:E}):(o=t.onError)==null||o.call(t,s.status)}getRequestXhr(P){return this.pendingRequests[P].xhr}isPendingRequest(P){return P in this.pendingRequests}abortRequest(P){const u=this.pendingRequests[P].xhr;delete this.pendingRequests[P],u.abort()}}class p{constructor(P){this._source=P,this._manager=new S(P.url,{httpHeaders:P.httpHeaders,withCredentials:P.withCredentials}),this._rangeChunkSize=P.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(P){const u=this._rangeRequestReaders.indexOf(P);u>=0&&this._rangeRequestReaders.splice(u,1)}getFullReader(){return(0,e.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new R(this._manager,this._source),this._fullRequestReader}getRangeReader(P,u){const t=new N(this._manager,P,u);return t.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(t),t}cancelAllRequests(P){var u;(u=this._fullRequestReader)==null||u.cancel(P);for(const t of this._rangeRequestReaders.slice(0))t.cancel(P)}}n.PDFNetworkStream=p;class R{constructor(P,u){this._manager=P;const t={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=u.url,this._fullRequestId=P.requestFull(t),this._headersReceivedCapability=(0,e.createPromiseCapability)(),this._disableRange=u.disableRange||!1,this._contentLength=u.length,this._rangeChunkSize=u.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const P=this._fullRequestId,u=this._manager.getRequestXhr(P),t=A=>u.getResponseHeader(A),{allowRangeRequests:s,suggestedLength:c}=(0,a.validateRangeRequestCapabilities)({getResponseHeader:t,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=c||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(t),this._isRangeSupported&&this._manager.abortRequest(P),this._headersReceivedCapability.resolve()}_onDone(P){if(P&&(this._requests.length>0?this._requests.shift().resolve({value:P.chunk,done:!1}):this._cachedChunks.push(P.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(P){this._storedError=(0,a.createResponseStatusError)(P,this._url),this._headersReceivedCapability.reject(this._storedError);for(const u of this._requests)u.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(P){var u;(u=this.onProgress)==null||u.call(this,{loaded:P.loaded,total:P.lengthComputable?P.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const P=(0,e.createPromiseCapability)();return this._requests.push(P),P.promise}cancel(P){this._done=!0,this._headersReceivedCapability.reject(P);for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class N{constructor(P,u,t){this._manager=P;const s={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=P.url,this._requestId=P.requestRange(u,t,s),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var P;(P=this.onClosed)==null||P.call(this,this)}_onDone(P){const u=P.chunk;this._requests.length>0?this._requests.shift().resolve({value:u,done:!1}):this._queuedChunk=u,this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(P){this._storedError=(0,a.createResponseStatusError)(P,this._url);for(const u of this._requests)u.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(P){var u;this.isStreamingSupported||(u=this.onProgress)==null||u.call(this,{loaded:P.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const u=this._queuedChunk;return this._queuedChunk=null,{value:u,done:!1}}if(this._done)return{value:void 0,done:!0};const P=(0,e.createPromiseCapability)();return this._requests.push(P),P.promise}cancel(P){this._done=!0;for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(b,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFFetchStream=void 0;var e=_(1),a=_(33);function k(R,N,x){return{method:"GET",headers:R,signal:x.signal,mode:"cors",credentials:N?"include":"same-origin",redirect:"follow"}}function M(R){const N=new Headers;for(const x in R){const P=R[x];typeof P>"u"||N.append(x,P)}return N}class C{constructor(N){this.source=N,this.isHttp=/^https?:/i.test(N.url),this.httpHeaders=this.isHttp&&N.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var N;return((N=this._fullRequestReader)==null?void 0:N._loaded)??0}getFullReader(){return(0,e.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new S(this),this._fullRequestReader}getRangeReader(N,x){if(x<=this._progressiveDataLength)return null;const P=new p(this,N,x);return this._rangeRequestReaders.push(P),P}cancelAllRequests(N){this._fullRequestReader&&this._fullRequestReader.cancel(N);for(const x of this._rangeRequestReaders.slice(0))x.cancel(N)}}n.PDFFetchStream=C;class S{constructor(N){this._stream=N,this._reader=null,this._loaded=0,this._filename=null;const x=N.source;this._withCredentials=x.withCredentials||!1,this._contentLength=x.length,this._headersCapability=(0,e.createPromiseCapability)(),this._disableRange=x.disableRange||!1,this._rangeChunkSize=x.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!x.disableStream,this._isRangeSupported=!x.disableRange,this._headers=M(this._stream.httpHeaders);const P=x.url;fetch(P,k(this._headers,this._withCredentials,this._abortController)).then(u=>{if(!(0,a.validateResponseStatus)(u.status))throw(0,a.createResponseStatusError)(u.status,P);this._reader=u.body.getReader(),this._headersCapability.resolve();const t=A=>u.headers.get(A),{allowRangeRequests:s,suggestedLength:c}=(0,a.validateRangeRequestCapabilities)({getResponseHeader:t,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=s,this._contentLength=c||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(t),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new e.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:N,done:x}=await this._reader.read();return x?{value:N,done:x}:(this._loaded+=N.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(N).buffer,done:!1})}cancel(N){this._reader&&this._reader.cancel(N),this._abortController.abort()}}class p{constructor(N,x,P){this._stream=N,this._reader=null,this._loaded=0;const u=N.source;this._withCredentials=u.withCredentials||!1,this._readCapability=(0,e.createPromiseCapability)(),this._isStreamingSupported=!u.disableStream,this._abortController=new AbortController,this._headers=M(this._stream.httpHeaders),this._headers.append("Range",`bytes=${x}-${P-1}`);const t=u.url;fetch(t,k(this._headers,this._withCredentials,this._abortController)).then(s=>{if(!(0,a.validateResponseStatus)(s.status))throw(0,a.createResponseStatusError)(s.status,t);this._readCapability.resolve(),this._reader=s.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:N,done:x}=await this._reader.read();return x?{value:N,done:x}:(this._loaded+=N.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(N).buffer,done:!1})}cancel(N){this._reader&&this._reader.cancel(N),this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(b){var n=__webpack_module_cache__[b];if(n!==void 0)return n.exports;var _=__webpack_module_cache__[b]={exports:{}};return __webpack_modules__[b](_,_.exports,__w_pdfjs_require__),_.exports}var __webpack_exports__={};return(()=>{var b=__webpack_exports__;Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"AnnotationEditorLayer",{enumerable:!0,get:function(){return a.AnnotationEditorLayer}}),Object.defineProperty(b,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return n.AnnotationEditorParamsType}}),Object.defineProperty(b,"AnnotationEditorType",{enumerable:!0,get:function(){return n.AnnotationEditorType}}),Object.defineProperty(b,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return k.AnnotationEditorUIManager}}),Object.defineProperty(b,"AnnotationLayer",{enumerable:!0,get:function(){return M.AnnotationLayer}}),Object.defineProperty(b,"AnnotationMode",{enumerable:!0,get:function(){return n.AnnotationMode}}),Object.defineProperty(b,"CMapCompressionType",{enumerable:!0,get:function(){return n.CMapCompressionType}}),Object.defineProperty(b,"GlobalWorkerOptions",{enumerable:!0,get:function(){return C.GlobalWorkerOptions}}),Object.defineProperty(b,"InvalidPDFException",{enumerable:!0,get:function(){return n.InvalidPDFException}}),Object.defineProperty(b,"LoopbackPort",{enumerable:!0,get:function(){return _.LoopbackPort}}),Object.defineProperty(b,"MissingPDFException",{enumerable:!0,get:function(){return n.MissingPDFException}}),Object.defineProperty(b,"OPS",{enumerable:!0,get:function(){return n.OPS}}),Object.defineProperty(b,"PDFDataRangeTransport",{enumerable:!0,get:function(){return _.PDFDataRangeTransport}}),Object.defineProperty(b,"PDFDateString",{enumerable:!0,get:function(){return e.PDFDateString}}),Object.defineProperty(b,"PDFWorker",{enumerable:!0,get:function(){return _.PDFWorker}}),Object.defineProperty(b,"PasswordResponses",{enumerable:!0,get:function(){return n.PasswordResponses}}),Object.defineProperty(b,"PermissionFlag",{enumerable:!0,get:function(){return n.PermissionFlag}}),Object.defineProperty(b,"PixelsPerInch",{enumerable:!0,get:function(){return e.PixelsPerInch}}),Object.defineProperty(b,"RenderingCancelledException",{enumerable:!0,get:function(){return e.RenderingCancelledException}}),Object.defineProperty(b,"SVGGraphics",{enumerable:!0,get:function(){return R.SVGGraphics}}),Object.defineProperty(b,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return n.UNSUPPORTED_FEATURES}}),Object.defineProperty(b,"UnexpectedResponseException",{enumerable:!0,get:function(){return n.UnexpectedResponseException}}),Object.defineProperty(b,"Util",{enumerable:!0,get:function(){return n.Util}}),Object.defineProperty(b,"VerbosityLevel",{enumerable:!0,get:function(){return n.VerbosityLevel}}),Object.defineProperty(b,"XfaLayer",{enumerable:!0,get:function(){return N.XfaLayer}}),Object.defineProperty(b,"build",{enumerable:!0,get:function(){return _.build}}),Object.defineProperty(b,"createPromiseCapability",{enumerable:!0,get:function(){return n.createPromiseCapability}}),Object.defineProperty(b,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return n.createValidAbsoluteUrl}}),Object.defineProperty(b,"getDocument",{enumerable:!0,get:function(){return _.getDocument}}),Object.defineProperty(b,"getFilenameFromUrl",{enumerable:!0,get:function(){return e.getFilenameFromUrl}}),Object.defineProperty(b,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return e.getPdfFilenameFromUrl}}),Object.defineProperty(b,"getXfaPageViewport",{enumerable:!0,get:function(){return e.getXfaPageViewport}}),Object.defineProperty(b,"isPdfFile",{enumerable:!0,get:function(){return e.isPdfFile}}),Object.defineProperty(b,"loadScript",{enumerable:!0,get:function(){return e.loadScript}}),Object.defineProperty(b,"renderTextLayer",{enumerable:!0,get:function(){return p.renderTextLayer}}),Object.defineProperty(b,"shadow",{enumerable:!0,get:function(){return n.shadow}}),Object.defineProperty(b,"version",{enumerable:!0,get:function(){return _.version}});var n=__w_pdfjs_require__(1),_=__w_pdfjs_require__(4),e=__w_pdfjs_require__(8),a=__w_pdfjs_require__(22),k=__w_pdfjs_require__(7),M=__w_pdfjs_require__(27),C=__w_pdfjs_require__(15),S=__w_pdfjs_require__(3),p=__w_pdfjs_require__(30),R=__w_pdfjs_require__(31),N=__w_pdfjs_require__(29);if(S.isNodeJS){const{PDFNodeStream:x}=__w_pdfjs_require__(32);(0,_.setPDFNetworkStreamFactory)(P=>new x(P))}else{const{PDFNetworkStream:x}=__w_pdfjs_require__(35),{PDFFetchStream:P}=__w_pdfjs_require__(36);(0,_.setPDFNetworkStreamFactory)(u=>(0,e.isValidFetchUrl)(u.url)?new P(u):new x(u))}})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports;function _objectWithoutPropertiesLoose(b,n){if(b==null)return{};var _={},e=Object.keys(b),a,k;for(k=0;k<e.length;k++)a=e[k],!(n.indexOf(a)>=0)&&(_[a]=b[a]);return _}function _objectWithoutProperties(b,n){if(b==null)return{};var _=_objectWithoutPropertiesLoose(b,n),e,a;if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(b);for(a=0;a<k.length;a++)e=k[a],!(n.indexOf(e)>=0)&&Object.prototype.propertyIsEnumerable.call(b,e)&&(_[e]=b[e])}return _}function _typeof(b){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},_typeof(b)}function _classCallCheck(b,n){if(!(b instanceof n))throw new TypeError("Cannot call a class as a function")}function toPrimitive(b,n){if(_typeof(b)!="object"||!b)return b;var _=b[Symbol.toPrimitive];if(_!==void 0){var e=_.call(b,n||"default");if(_typeof(e)!="object")return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(b)}function toPropertyKey(b){var n=toPrimitive(b,"string");return _typeof(n)=="symbol"?n:String(n)}function _defineProperties(b,n){for(var _=0;_<n.length;_++){var e=n[_];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(b,toPropertyKey(e.key),e)}}function _createClass(b,n,_){return n&&_defineProperties(b.prototype,n),_&&_defineProperties(b,_),Object.defineProperty(b,"prototype",{writable:!1}),b}function _assertThisInitialized(b){if(b===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b}function _inherits(b,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(n&&n.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),Object.defineProperty(b,"prototype",{writable:!1}),n&&_setPrototypeOf(b,n)}function _possibleConstructorReturn(b,n){if(n&&(_typeof(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(b)}function _getPrototypeOf(b){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(_){return _.__proto__||Object.getPrototypeOf(_)},_getPrototypeOf(b)}function _defineProperty(b,n,_){return n=toPropertyKey(n),n in b?Object.defineProperty(b,n,{value:_,enumerable:!0,configurable:!0,writable:!0}):b[n]=_,b}var propTypes={exports:{}},ReactPropTypesSecret$1="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",ReactPropTypesSecret_1=ReactPropTypesSecret$1,ReactPropTypesSecret=ReactPropTypesSecret_1;function emptyFunction(){}function emptyFunctionWithReset(){}emptyFunctionWithReset.resetWarningCache=emptyFunction;var factoryWithThrowingShims=function(){function b(e,a,k,M,C,S){if(S!==ReactPropTypesSecret){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}b.isRequired=b;function n(){return b}var _={array:b,bigint:b,bool:b,func:b,number:b,object:b,string:b,symbol:b,any:b,arrayOf:n,element:b,elementType:b,instanceOf:n,node:b,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:emptyFunctionWithReset,resetWarningCache:emptyFunction};return _.PropTypes=_,_};propTypes.exports=factoryWithThrowingShims();var propTypesExports=propTypes.exports;const PropTypes=getDefaultExportFromCjs(propTypesExports);var __spreadArray=globalThis&&globalThis.__spreadArray||function(b,n,_){if(_||arguments.length===2)for(var e=0,a=n.length,k;e<a;e++)(k||!(e in n))&&(k||(k=Array.prototype.slice.call(n,0,e)),k[e]=n[e]);return b.concat(k||Array.prototype.slice.call(n))},clipboardEvents=["onCopy","onCut","onPaste"],compositionEvents=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],focusEvents=["onFocus","onBlur"],formEvents=["onInput","onInvalid","onReset","onSubmit"],imageEvents=["onLoad","onError"],keyboardEvents=["onKeyDown","onKeyPress","onKeyUp"],mediaEvents=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],mouseEvents=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],dragEvents=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],selectionEvents=["onSelect"],touchEvents=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],pointerEvents=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],uiEvents=["onScroll"],wheelEvents=["onWheel"],animationEvents=["onAnimationStart","onAnimationEnd","onAnimationIteration"],transitionEvents=["onTransitionEnd"],otherEvents=["onToggle"],changeEvents=["onChange"],allEvents=__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([],clipboardEvents,!0),compositionEvents,!0),focusEvents,!0),formEvents,!0),imageEvents,!0),keyboardEvents,!0),mediaEvents,!0),mouseEvents,!0),dragEvents,!0),selectionEvents,!0),touchEvents,!0),pointerEvents,!0),uiEvents,!0),wheelEvents,!0),animationEvents,!0),transitionEvents,!0),changeEvents,!0),otherEvents,!0);function makeEventProps(b,n){var _={};return allEvents.forEach(function(e){var a=b[e];a&&(n?_[e]=function(k){return a(k,n(e))}:_[e]=a)}),_}function makeCancellablePromise(b){var n=!1,_=new Promise(function(e,a){b.then(function(k){return!n&&e(k)}).catch(function(k){return!n&&a(k)})});return{promise:_,cancel:function(){n=!0}}}function r(b){var n,_,e="";if(typeof b=="string"||typeof b=="number")e+=b;else if(typeof b=="object")if(Array.isArray(b))for(n=0;n<b.length;n++)b[n]&&(_=r(b[n]))&&(e&&(e+=" "),e+=_);else for(n in b)b[n]&&(e&&(e+=" "),e+=n);return e}function clsx(){for(var b,n,_=0,e="";_<arguments.length;)(b=arguments[_++])&&(n=r(b))&&(e&&(e+=" "),e+=n);return e}var isProduction$1=!0,prefix="Invariant failed";function invariant(b,n){if(!b){if(isProduction$1)throw new Error(prefix);var _=typeof n=="function"?n():n,e=_?"".concat(prefix,": ").concat(_):prefix;throw new Error(e)}}var isProduction=!0;function warning(b,n){if(!isProduction){if(b)return;var _="Warning: "+n;typeof console<"u"&&console.warn(_);try{throw Error(_)}catch{}}}const DocumentContext=reactExports.createContext(null);function Message(b){var n=b.children,_=b.type;return React.createElement("div",{className:"react-pdf__message react-pdf__message--".concat(_)},n)}Message.propTypes={children:PropTypes.node,type:PropTypes.oneOf(["error","loading","no-data"]).isRequired};var DEFAULT_LINK_REL="noopener noreferrer nofollow",LinkService=function(){function b(){_classCallCheck(this,b),this.externalLinkTarget=null,this.externalLinkRel=null}return _createClass(b,[{key:"setDocument",value:function(_){this.pdfDocument=_}},{key:"setViewer",value:function(_){this.pdfViewer=_}},{key:"setExternalLinkRel",value:function(_){this.externalLinkRel=_}},{key:"setExternalLinkTarget",value:function(_){this.externalLinkTarget=_}},{key:"setHistory",value:function(){}},{key:"pagesCount",get:function(){return this.pdfDocument?this.pdfDocument.numPages:0}},{key:"page",get:function(){return this.pdfViewer.currentPageNumber},set:function(_){this.pdfViewer.currentPageNumber=_}},{key:"rotation",get:function(){return 0},set:function(_){}},{key:"goToDestination",value:function(_){var e=this;new Promise(function(a){typeof _=="string"?e.pdfDocument.getDestination(_).then(a):Array.isArray(_)?a(_):_.then(a)}).then(function(a){invariant(Array.isArray(a),'"'.concat(a,'" is not a valid destination array.'));var k=a[0];new Promise(function(M){k instanceof Object?e.pdfDocument.getPageIndex(k).then(function(C){M(C)}).catch(function(){invariant(!1,'"'.concat(k,'" is not a valid page reference.'))}):typeof k=="number"?M(k):invariant(!1,'"'.concat(k,'" is not a valid destination reference.'))}).then(function(M){var C=M+1;invariant(C>=1&&C<=e.pagesCount,'"'.concat(C,'" is not a valid page number.')),e.pdfViewer.scrollPageIntoView({dest:_,pageIndex:M,pageNumber:C})})})}},{key:"navigateTo",value:function(_){this.goToDestination(_)}},{key:"goToPage",value:function(){}},{key:"addLinkAttributes",value:function(_,e,a){_.href=e,_.rel=this.externalLinkRel||DEFAULT_LINK_REL,_.target=a?"_blank":this.externalLinkTarget||""}},{key:"getDestinationHash",value:function(){return"#"}},{key:"getAnchorUrl",value:function(){return"#"}},{key:"setHash",value:function(){}},{key:"executeNamedAction",value:function(){}},{key:"cachePageRef",value:function(){}},{key:"isPageVisible",value:function(){return!0}},{key:"isPageCached",value:function(){return!0}}]),b}(),PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};function _arrayWithHoles(b){if(Array.isArray(b))return b}function _iterableToArrayLimit(b,n){var _=b==null?null:typeof Symbol<"u"&&b[Symbol.iterator]||b["@@iterator"];if(_!=null){var e,a,k,M,C=[],S=!0,p=!1;try{if(k=(_=_.call(b)).next,n===0){if(Object(_)!==_)return;S=!1}else for(;!(S=(e=k.call(_)).done)&&(C.push(e.value),C.length!==n);S=!0);}catch(R){p=!0,a=R}finally{try{if(!S&&_.return!=null&&(M=_.return(),Object(M)!==M))return}finally{if(p)throw a}}return C}}function _arrayLikeToArray(b,n){(n==null||n>b.length)&&(n=b.length);for(var _=0,e=new Array(n);_<n;_++)e[_]=b[_];return e}function _unsupportedIterableToArray(b,n){if(b){if(typeof b=="string")return _arrayLikeToArray(b,n);var _=Object.prototype.toString.call(b).slice(8,-1);if(_==="Object"&&b.constructor&&(_=b.constructor.name),_==="Map"||_==="Set")return Array.from(b);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return _arrayLikeToArray(b,n)}}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _slicedToArray(b,n){return _arrayWithHoles(b)||_iterableToArrayLimit(b,n)||_unsupportedIterableToArray(b,n)||_nonIterableRest()}var isBrowser=typeof document<"u",isLocalFileSystem=isBrowser&&window.location.protocol==="file:";function isDefined(b){return typeof b<"u"}function isProvided(b){return isDefined(b)&&b!==null}function isString(b){return typeof b=="string"}function isArrayBuffer(b){return b instanceof ArrayBuffer}function isBlob(b){return invariant(isBrowser,"isBlob can only be used in a browser environment"),b instanceof Blob}function isFile$1(b){return invariant(isBrowser,"isFile can only be used in a browser environment"),b instanceof File}function isDataURI(b){return isString(b)&&/^data:/.test(b)}function dataURItoByteString(b){invariant(isDataURI(b),"Invalid data URI.");var n=b.split(","),_=_slicedToArray(n,2),e=_[0],a=_[1],k=e.split(";");return k.indexOf("base64")!==-1?atob(a):unescape(a)}function getDevicePixelRatio(){return isBrowser&&window.devicePixelRatio||1}var allowFileAccessFromFilesTip="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function displayCORSWarning(){warning(!isLocalFileSystem,"Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ".concat(allowFileAccessFromFilesTip))}function displayWorkerWarning(){warning(!isLocalFileSystem,"Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ".concat(allowFileAccessFromFilesTip))}function cancelRunningTask(b){b&&b.cancel&&b.cancel()}function makePageCallback(b,n){return Object.defineProperty(b,"width",{get:function(){return this.view[2]*n},configurable:!0}),Object.defineProperty(b,"height",{get:function(){return this.view[3]*n},configurable:!0}),Object.defineProperty(b,"originalWidth",{get:function(){return this.view[2]},configurable:!0}),Object.defineProperty(b,"originalHeight",{get:function(){return this.view[3]},configurable:!0}),b}function isCancelException(b){return b.name==="RenderingCancelledException"}function loadFromFile(b){return new Promise(function(n,_){var e=new FileReader;return e.onload=function(){return n(new Uint8Array(e.result))},e.onerror=function(a){switch(a.target.error.code){case a.target.error.NOT_FOUND_ERR:return _(new Error("Error while reading a file: File not found."));case a.target.error.NOT_READABLE_ERR:return _(new Error("Error while reading a file: File not readable."));case a.target.error.SECURITY_ERR:return _(new Error("Error while reading a file: Security error."));case a.target.error.ABORT_ERR:return _(new Error("Error while reading a file: Aborted."));default:return _(new Error("Error while reading a file."))}},e.readAsArrayBuffer(b),null})}function _arrayWithoutHoles(b){if(Array.isArray(b))return _arrayLikeToArray(b)}function _iterableToArray(b){if(typeof Symbol<"u"&&b[Symbol.iterator]!=null||b["@@iterator"]!=null)return Array.from(b)}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _toConsumableArray(b){return _arrayWithoutHoles(b)||_iterableToArray(b)||_unsupportedIterableToArray(b)||_nonIterableSpread()}var eventProps=function(){var b={};return[].concat(_toConsumableArray(mouseEvents),_toConsumableArray(touchEvents),_toConsumableArray(keyboardEvents)).forEach(function(n){b[n]=PropTypes.func}),b}(),fileTypes=[PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.shape({data:PropTypes.oneOfType([PropTypes.object,PropTypes.string]),httpHeaders:PropTypes.object,range:PropTypes.object,url:PropTypes.string,withCredentials:PropTypes.bool})];typeof File<"u"&&fileTypes.push(PropTypes.instanceOf(File));typeof Blob<"u"&&fileTypes.push(PropTypes.instanceOf(Blob));var isClassName=PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.string)]),isFile=PropTypes.oneOfType(fileTypes),isLinkService=PropTypes.instanceOf(LinkService);PropTypes.oneOf(["_self","_blank","_parent","_top"]);var isPage=PropTypes.shape({commonObjs:PropTypes.shape({}).isRequired,getAnnotations:PropTypes.func.isRequired,getTextContent:PropTypes.func.isRequired,getViewport:PropTypes.func.isRequired,render:PropTypes.func.isRequired}),isPageIndex=function b(n,_,e){var a=n[_],k=n.pageNumber,M=n.pdf;if(!isDefined(M))return null;if(isDefined(a)){if(typeof a!="number")return new Error("`".concat(_,"` of type `").concat(_typeof(a),"` supplied to `").concat(e,"`, expected `number`."));if(a<0)return new Error("Expected `".concat(_,"` to be greater or equal to 0."));var C=M.numPages;if(a+1>C)return new Error("Expected `".concat(_,"` to be less or equal to ").concat(C-1,"."))}else if(!isDefined(k))return new Error("`".concat(_,"` not supplied. Either pageIndex or pageNumber must be supplied to `").concat(e,"`."));return null},isPageNumber=function b(n,_,e){var a=n[_],k=n.pageIndex,M=n.pdf;if(!isDefined(M))return null;if(isDefined(a)){if(typeof a!="number")return new Error("`".concat(_,"` of type `").concat(_typeof(a),"` supplied to `").concat(e,"`, expected `number`."));if(a<1)return new Error("Expected `".concat(_,"` to be greater or equal to 1."));var C=M.numPages;if(a>C)return new Error("Expected `".concat(_,"` to be less or equal to ").concat(C,"."))}else if(!isDefined(k))return new Error("`".concat(_,"` not supplied. Either pageIndex or pageNumber must be supplied to `").concat(e,"`."));return null},isPdf=PropTypes.oneOfType([PropTypes.shape({getDestination:PropTypes.func.isRequired,getOutline:PropTypes.func.isRequired,getPage:PropTypes.func.isRequired,numPages:PropTypes.number.isRequired}),PropTypes.bool]),isRef=PropTypes.oneOfType([PropTypes.func,PropTypes.shape({current:PropTypes.any})]),isRenderMode=PropTypes.oneOf(["canvas","none","svg"]),isRotate=PropTypes.oneOf([0,90,180,270]),_excluded=["url"];function ownKeys$3(b,n){var _=Object.keys(b);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(b);n&&(e=e.filter(function(a){return Object.getOwnPropertyDescriptor(b,a).enumerable})),_.push.apply(_,e)}return _}function _objectSpread$3(b){for(var n=1;n<arguments.length;n++){var _=arguments[n]!=null?arguments[n]:{};n%2?ownKeys$3(Object(_),!0).forEach(function(e){_defineProperty(b,e,_[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(_)):ownKeys$3(Object(_)).forEach(function(e){Object.defineProperty(b,e,Object.getOwnPropertyDescriptor(_,e))})}return b}function _createSuper$5(b){var n=_isNativeReflectConstruct$5();return function(){var e=_getPrototypeOf(b),a;if(n){var k=_getPrototypeOf(this).constructor;a=Reflect.construct(e,arguments,k)}else a=e.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _isNativeReflectConstruct$5(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var PDFDataRangeTransport=pdfExports.PDFDataRangeTransport,Document=function(b){_inherits(_,b);var n=_createSuper$5(_);function _(){var e;_classCallCheck(this,_);for(var a=arguments.length,k=new Array(a),M=0;M<a;M++)k[M]=arguments[M];return e=n.call.apply(n,[this].concat(k)),_defineProperty(_assertThisInitialized(e),"state",{pdf:null}),_defineProperty(_assertThisInitialized(e),"viewer",{scrollPageIntoView:function(S){var p=S.dest,R=S.pageIndex,N=S.pageNumber,x=e.props.onItemClick;if(x){x({dest:p,pageIndex:R,pageNumber:N});return}var P=e.pages[R];if(P){P.scrollIntoView();return}warning(!1,"An internal link leading to page ".concat(N," was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>."))}}),_defineProperty(_assertThisInitialized(e),"linkService",new LinkService),_defineProperty(_assertThisInitialized(e),"loadDocument",function(){cancelRunningTask(e.runningTask),e.loadingTask&&e.loadingTask.destroy();var C=makeCancellablePromise(e.findDocumentSource());e.runningTask=C,C.promise.then(function(S){if(e.onSourceSuccess(),!!S){e.setState(function(u){return u.pdf?{pdf:null}:null});var p=e.props,R=p.options,N=p.onLoadProgress,x=p.onPassword,P=pdfExports.getDocument(_objectSpread$3(_objectSpread$3({},S),R));P.onPassword=x,N&&(P.onProgress=N),e.loadingTask=P,P.promise.then(function(u){e.setState(function(t){return t.pdf&&t.pdf.fingerprint===u.fingerprint?null:{pdf:u}},e.onLoadSuccess)}).catch(function(u){e.onLoadError(u)})}}).catch(function(S){e.onSourceError(S)})}),_defineProperty(_assertThisInitialized(e),"setupLinkService",function(){var C=e.props,S=C.externalLinkRel,p=C.externalLinkTarget;e.linkService.setViewer(e.viewer),e.linkService.setExternalLinkRel(S),e.linkService.setExternalLinkTarget(p)}),_defineProperty(_assertThisInitialized(e),"onSourceSuccess",function(){var C=e.props.onSourceSuccess;C&&C()}),_defineProperty(_assertThisInitialized(e),"onSourceError",function(C){warning(C);var S=e.props.onSourceError;S&&S(C)}),_defineProperty(_assertThisInitialized(e),"onLoadSuccess",function(){var C=e.props.onLoadSuccess,S=e.state.pdf;C&&C(S),e.pages=new Array(S.numPages),e.linkService.setDocument(S)}),_defineProperty(_assertThisInitialized(e),"onLoadError",function(C){e.setState({pdf:!1}),warning(C);var S=e.props.onLoadError;S&&S(C)}),_defineProperty(_assertThisInitialized(e),"findDocumentSource",function(){return new Promise(function(C){var S=e.props.file;if(S||C(null),typeof S=="string"){if(isDataURI(S)){var p=dataURItoByteString(S);C({data:p})}displayCORSWarning(),C({url:S})}if(S instanceof PDFDataRangeTransport&&C({range:S}),isArrayBuffer(S)&&C({data:S}),isBrowser&&(isBlob(S)||isFile$1(S))){loadFromFile(S).then(function(P){C({data:P})});return}if(invariant(_typeof(S)==="object","Invalid parameter in file, need either Uint8Array, string or a parameter object"),invariant(S.url||S.data||S.range,"Invalid parameter object: need either .data, .range or .url"),typeof S.url=="string"){if(isDataURI(S.url)){var R=S.url,N=_objectWithoutProperties(S,_excluded),x=dataURItoByteString(R);C(_objectSpread$3({data:x},N))}displayCORSWarning()}C(S)})}),_defineProperty(_assertThisInitialized(e),"registerPage",function(C,S){e.pages[C]=S}),_defineProperty(_assertThisInitialized(e),"unregisterPage",function(C){delete e.pages[C]}),e}return _createClass(_,[{key:"componentDidMount",value:function(){this.loadDocument(),this.setupLinkService()}},{key:"componentDidUpdate",value:function(a){var k=this.props.file;k!==a.file&&this.loadDocument()}},{key:"componentWillUnmount",value:function(){cancelRunningTask(this.runningTask),this.loadingTask&&this.loadingTask.destroy()}},{key:"childContext",get:function(){var a=this.linkService,k=this.registerPage,M=this.unregisterPage,C=this.props,S=C.imageResourcesPath,p=C.renderMode,R=C.rotate,N=this.state.pdf;return{imageResourcesPath:S,linkService:a,pdf:N,registerPage:k,renderMode:p,rotate:R,unregisterPage:M}}},{key:"eventProps",get:function(){var a=this;return makeEventProps(this.props,function(){return a.state.pdf})}},{key:"renderChildren",value:function(){var a=this.props.children;return React.createElement(DocumentContext.Provider,{value:this.childContext},a)}},{key:"renderContent",value:function(){var a=this.props.file,k=this.state.pdf;if(!a){var M=this.props.noData;return React.createElement(Message,{type:"no-data"},typeof M=="function"?M():M)}if(k===null){var C=this.props.loading;return React.createElement(Message,{type:"loading"},typeof C=="function"?C():C)}if(k===!1){var S=this.props.error;return React.createElement(Message,{type:"error"},typeof S=="function"?S():S)}return this.renderChildren()}},{key:"render",value:function(){var a=this.props,k=a.className,M=a.inputRef;return React.createElement("div",_extends({className:clsx("react-pdf__Document",k),ref:M},this.eventProps),this.renderContent())}}]),_}(reactExports.PureComponent);Document.defaultProps={error:"Failed to load PDF file.",loading:"Loading PDF…",noData:"No PDF file specified.",onPassword:function b(n,_){switch(_){case PasswordResponses.NEED_PASSWORD:{var e=prompt("Enter the password to open this PDF file.");n(e);break}case PasswordResponses.INCORRECT_PASSWORD:{var a=prompt("Invalid password. Please try again.");n(a);break}}}};var isFunctionOrNode$1=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Document.propTypes=_objectSpread$3(_objectSpread$3({},eventProps),{},{children:PropTypes.node,className:isClassName,error:isFunctionOrNode$1,externalLinkRel:PropTypes.string,externalLinkTarget:PropTypes.string,file:isFile,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode$1,noData:isFunctionOrNode$1,onItemClick:PropTypes.func,onLoadError:PropTypes.func,onLoadProgress:PropTypes.func,onLoadSuccess:PropTypes.func,onPassword:PropTypes.func,onSourceError:PropTypes.func,onSourceSuccess:PropTypes.func,rotate:PropTypes.number});var isDestination=PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.any)]);PropTypes.shape({dest:isDestination,items:PropTypes.arrayOf(PropTypes.shape({dest:isDestination,title:PropTypes.string})),title:PropTypes.string}).isRequired,PropTypes.func,isPdf.isRequired;function ownKeys$2(b,n){var _=Object.keys(b);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(b);n&&(e=e.filter(function(a){return Object.getOwnPropertyDescriptor(b,a).enumerable})),_.push.apply(_,e)}return _}function _objectSpread$2(b){for(var n=1;n<arguments.length;n++){var _=arguments[n]!=null?arguments[n]:{};n%2?ownKeys$2(Object(_),!0).forEach(function(e){_defineProperty(b,e,_[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(_)):ownKeys$2(Object(_)).forEach(function(e){Object.defineProperty(b,e,Object.getOwnPropertyDescriptor(_,e))})}return b}_objectSpread$2({className:isClassName,inputRef:isRef,onItemClick:PropTypes.func,onLoadError:PropTypes.func,onLoadSuccess:PropTypes.func,pdf:isPdf},eventProps);function mergeRefs(){for(var b=[],n=0;n<arguments.length;n++)b[n]=arguments[n];var _=b.filter(Boolean);if(_.length<=1){var e=_[0];return e||null}return function(k){_.forEach(function(M){typeof M=="function"?M(k):M&&(M.current=k)})}}const PageContext=reactExports.createContext(null);function _createSuper$4(b){var n=_isNativeReflectConstruct$4();return function(){var e=_getPrototypeOf(b),a;if(n){var k=_getPrototypeOf(this).constructor;a=Reflect.construct(e,arguments,k)}else a=e.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _isNativeReflectConstruct$4(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ANNOTATION_MODE=pdfExports.AnnotationMode,PageCanvasInternal=function(b){_inherits(_,b);var n=_createSuper$4(_);function _(){var e;_classCallCheck(this,_);for(var a=arguments.length,k=new Array(a),M=0;M<a;M++)k[M]=arguments[M];return e=n.call.apply(n,[this].concat(k)),_defineProperty(_assertThisInitialized(e),"canvasElement",reactExports.createRef()),_defineProperty(_assertThisInitialized(e),"onRenderSuccess",function(){e.renderer=null;var C=e.props,S=C.onRenderSuccess,p=C.page,R=C.scale;S&&S(makePageCallback(p,R))}),_defineProperty(_assertThisInitialized(e),"onRenderError",function(C){if(!isCancelException(C)){warning(C);var S=e.props.onRenderError;S&&S(C)}}),_defineProperty(_assertThisInitialized(e),"drawPageOnCanvas",function(){var C=e.canvasElement.current;if(!C)return null;var S=_assertThisInitialized(e),p=S.renderViewport,R=S.viewport,N=e.props,x=N.canvasBackground,P=N.page,u=N.renderForms;C.width=p.width,C.height=p.height,C.style.width="".concat(Math.floor(R.width),"px"),C.style.height="".concat(Math.floor(R.height),"px");var t={annotationMode:u?ANNOTATION_MODE.ENABLE_FORMS:ANNOTATION_MODE.ENABLE,get canvasContext(){return C.getContext("2d",{alpha:!1})},viewport:p};x&&(t.background=x),e.cancelRenderingTask();var s=P.render(t);return e.renderer=s,s.promise.then(e.onRenderSuccess).catch(e.onRenderError)}),e}return _createClass(_,[{key:"componentDidMount",value:function(){this.drawPageOnCanvas()}},{key:"componentDidUpdate",value:function(a){var k=this.props,M=k.canvasBackground,C=k.devicePixelRatio,S=k.page,p=k.renderForms;(M!==a.canvasBackground||C!==a.devicePixelRatio||p!==a.renderForms)&&(S.cleanup(),this.drawPageOnCanvas())}},{key:"componentWillUnmount",value:function(){this.cancelRenderingTask();var a=this.canvasElement.current;a&&(a.width=0,a.height=0)}},{key:"cancelRenderingTask",value:function(){this.renderer&&(this.renderer.cancel(),this.renderer=null)}},{key:"devicePixelRatio",get:function(){var a=this.props.devicePixelRatio;return a||getDevicePixelRatio()}},{key:"renderViewport",get:function(){var a=this.devicePixelRatio,k=this.props,M=k.page,C=k.rotate,S=k.scale;return M.getViewport({scale:S*a,rotation:C})}},{key:"viewport",get:function(){var a=this.props,k=a.page,M=a.rotate,C=a.scale;return k.getViewport({scale:C,rotation:M})}},{key:"render",value:function(){var a=this.props.canvasRef;return React.createElement("canvas",{className:"react-pdf__Page__canvas",dir:"ltr",ref:mergeRefs(a,this.canvasElement),style:{display:"block",userSelect:"none"}})}}]),_}(reactExports.PureComponent);PageCanvasInternal.propTypes={canvasBackground:PropTypes.string,canvasRef:isRef,devicePixelRatio:PropTypes.number,onRenderError:PropTypes.func,onRenderSuccess:PropTypes.func,page:isPage.isRequired,renderForms:PropTypes.bool,rotate:isRotate,scale:PropTypes.number.isRequired};function PageCanvas(b){return React.createElement(PageContext.Consumer,null,function(n){return React.createElement(PageCanvasInternal,_extends({},n,b))})}function _createSuper$3(b){var n=_isNativeReflectConstruct$3();return function(){var e=_getPrototypeOf(b),a;if(n){var k=_getPrototypeOf(this).constructor;a=Reflect.construct(e,arguments,k)}else a=e.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _isNativeReflectConstruct$3(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var PageSVGInternal=function(b){_inherits(_,b);var n=_createSuper$3(_);function _(){var e;_classCallCheck(this,_);for(var a=arguments.length,k=new Array(a),M=0;M<a;M++)k[M]=arguments[M];return e=n.call.apply(n,[this].concat(k)),_defineProperty(_assertThisInitialized(e),"state",{svg:null}),_defineProperty(_assertThisInitialized(e),"onRenderSuccess",function(){e.renderer=null;var C=e.props,S=C.onRenderSuccess,p=C.page,R=C.scale;S&&S(makePageCallback(p,R))}),_defineProperty(_assertThisInitialized(e),"onRenderError",function(C){if(!isCancelException(C)){warning(C);var S=e.props.onRenderError;S&&S(C)}}),_defineProperty(_assertThisInitialized(e),"renderSVG",function(){var C=e.props.page;return e.renderer=C.getOperatorList(),e.renderer.then(function(S){var p=new pdfExports.SVGGraphics(C.commonObjs,C.objs);e.renderer=p.getSVG(S,e.viewport).then(function(R){e.setState({svg:R},e.onRenderSuccess)}).catch(e.onRenderError)}).catch(e.onRenderError)}),_defineProperty(_assertThisInitialized(e),"drawPageOnContainer",function(C){var S=e.state.svg;if(!(!C||!S)){C.firstElementChild||C.appendChild(S);var p=e.viewport,R=p.width,N=p.height;S.setAttribute("width",R),S.setAttribute("height",N)}}),e}return _createClass(_,[{key:"componentDidMount",value:function(){this.renderSVG()}},{key:"viewport",get:function(){var a=this.props,k=a.page,M=a.rotate,C=a.scale;return k.getViewport({scale:C,rotation:M})}},{key:"render",value:function(){var a=this,k=this.viewport,M=k.width,C=k.height;return React.createElement("div",{className:"react-pdf__Page__svg",ref:function(p){return a.drawPageOnContainer(p)},style:{display:"block",backgroundColor:"white",overflow:"hidden",width:M,height:C,userSelect:"none"}})}}]),_}(reactExports.PureComponent);PageSVGInternal.propTypes={onRenderError:PropTypes.func,onRenderSuccess:PropTypes.func,page:isPage.isRequired,rotate:isRotate,scale:PropTypes.number.isRequired};function PageSVG(b){return React.createElement(PageContext.Consumer,null,function(n){return React.createElement(PageSVGInternal,_extends({},n,b))})}function ownKeys$1(b,n){var _=Object.keys(b);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(b);n&&(e=e.filter(function(a){return Object.getOwnPropertyDescriptor(b,a).enumerable})),_.push.apply(_,e)}return _}function _objectSpread$1(b){for(var n=1;n<arguments.length;n++){var _=arguments[n]!=null?arguments[n]:{};n%2?ownKeys$1(Object(_),!0).forEach(function(e){_defineProperty(b,e,_[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(_)):ownKeys$1(Object(_)).forEach(function(e){Object.defineProperty(b,e,Object.getOwnPropertyDescriptor(_,e))})}return b}function _createSuper$2(b){var n=_isNativeReflectConstruct$2();return function(){var e=_getPrototypeOf(b),a;if(n){var k=_getPrototypeOf(this).constructor;a=Reflect.construct(e,arguments,k)}else a=e.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _isNativeReflectConstruct$2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var TextLayerInternal=function(b){_inherits(_,b);var n=_createSuper$2(_);function _(){var e;_classCallCheck(this,_);for(var a=arguments.length,k=new Array(a),M=0;M<a;M++)k[M]=arguments[M];return e=n.call.apply(n,[this].concat(k)),_defineProperty(_assertThisInitialized(e),"state",{textContent:null}),_defineProperty(_assertThisInitialized(e),"layerElement",reactExports.createRef()),_defineProperty(_assertThisInitialized(e),"endElement",reactExports.createRef()),_defineProperty(_assertThisInitialized(e),"loadTextContent",function(){var C=e.props.page,S=makeCancellablePromise(C.getTextContent());e.runningTask=S,S.promise.then(function(p){e.setState({textContent:p},e.onLoadSuccess)}).catch(function(p){e.onLoadError(p)})}),_defineProperty(_assertThisInitialized(e),"onLoadSuccess",function(){var C=e.props.onGetTextSuccess,S=e.state.textContent;C&&C(S)}),_defineProperty(_assertThisInitialized(e),"onLoadError",function(C){e.setState({textItems:!1}),warning(C);var S=e.props.onGetTextError;S&&S(C)}),_defineProperty(_assertThisInitialized(e),"onRenderSuccess",function(){var C=e.props.onRenderTextLayerSuccess;C&&C()}),_defineProperty(_assertThisInitialized(e),"onRenderError",function(C){warning(C);var S=e.props.onRenderTextLayerError;S&&S(C)}),_defineProperty(_assertThisInitialized(e),"onMouseDown",function(){var C=e.endElement.current;C&&C.classList.add("active")}),_defineProperty(_assertThisInitialized(e),"onMouseUp",function(){var C=e.endElement.current;C&&C.classList.remove("active")}),e}return _createClass(_,[{key:"componentDidMount",value:function(){var a=this.props.page;invariant(a,"Attempted to load page text content, but no page was specified."),warning(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer"),this.loadTextContent()}},{key:"componentDidUpdate",value:function(a){var k=this.props.page;a.page&&k!==a.page&&this.loadTextContent()}},{key:"componentWillUnmount",value:function(){cancelRunningTask(this.runningTask)}},{key:"viewport",get:function(){var a=this.props,k=a.page,M=a.rotate,C=a.scale;return k.getViewport({scale:C,rotation:M})}},{key:"unrotatedViewport",get:function(){var a=this.props,k=a.page,M=a.scale;return k.getViewport({scale:M})}},{key:"rotate",get:function(){var a=this.props,k=a.page,M=a.rotate;return M-k.rotate}},{key:"renderTextLayer",value:function(){var a=this,k=this.state.textContent;if(!k)return null;var M=this.layerElement.current,C=this.viewport,S=this.props,p=S.customTextRenderer,R=S.pageIndex,N=S.pageNumber;cancelRunningTask(this.runningTask),M.innerHTML="";var x={container:M,textContent:k,viewport:C},P=pdfExports.renderTextLayer(x);this.runningTask=P,P.promise.then(function(){var u=document.createElement("div");if(u.className="endOfContent",M.append(u),a.endElement.current=u,p){var t=0;k.items.forEach(function(s,c){var A=a.layerElement.current.children[t],E=p(_objectSpread$1({pageIndex:R,pageNumber:N,itemIndex:c},s));A.innerHTML=E,t+=s.str&&s.hasEOL?2:1})}a.onRenderSuccess()}).catch(function(u){a.onRenderError(u)})}},{key:"render",value:function(){return React.createElement("div",{className:"react-pdf__Page__textContent textLayer",onMouseUp:this.onMouseUp,onMouseDown:this.onMouseDown,ref:this.layerElement},this.renderTextLayer())}}]),_}(reactExports.PureComponent);TextLayerInternal.propTypes={customTextRenderer:PropTypes.func,onGetTextError:PropTypes.func,onGetTextSuccess:PropTypes.func,onRenderTextLayerError:PropTypes.func,onRenderTextLayerSuccess:PropTypes.func,page:isPage.isRequired,pageIndex:PropTypes.number.isRequired,pageNumber:PropTypes.number.isRequired,rotate:isRotate,scale:PropTypes.number};function TextLayer$1(b){return React.createElement(PageContext.Consumer,null,function(n){return React.createElement(TextLayerInternal,_extends({},n,b))})}function _createSuper$1(b){var n=_isNativeReflectConstruct$1();return function(){var e=_getPrototypeOf(b),a;if(n){var k=_getPrototypeOf(this).constructor;a=Reflect.construct(e,arguments,k)}else a=e.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _isNativeReflectConstruct$1(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var AnnotationLayerInternal=function(b){_inherits(_,b);var n=_createSuper$1(_);function _(){var e;_classCallCheck(this,_);for(var a=arguments.length,k=new Array(a),M=0;M<a;M++)k[M]=arguments[M];return e=n.call.apply(n,[this].concat(k)),_defineProperty(_assertThisInitialized(e),"state",{annotations:null}),_defineProperty(_assertThisInitialized(e),"layerElement",reactExports.createRef()),_defineProperty(_assertThisInitialized(e),"loadAnnotations",function(){var C=e.props.page,S=makeCancellablePromise(C.getAnnotations());e.runningTask=S,S.promise.then(function(p){e.setState({annotations:p},e.onLoadSuccess)}).catch(function(p){e.onLoadError(p)})}),_defineProperty(_assertThisInitialized(e),"onLoadSuccess",function(){var C=e.props.onGetAnnotationsSuccess,S=e.state.annotations;C&&C(S)}),_defineProperty(_assertThisInitialized(e),"onLoadError",function(C){e.setState({annotations:!1}),warning(C);var S=e.props.onGetAnnotationsError;S&&S(C)}),_defineProperty(_assertThisInitialized(e),"onRenderSuccess",function(){var C=e.props.onRenderAnnotationLayerSuccess;C&&C()}),_defineProperty(_assertThisInitialized(e),"onRenderError",function(C){warning(C);var S=e.props.onRenderAnnotationLayerError;S&&S(C)}),e}return _createClass(_,[{key:"componentDidMount",value:function(){var a=this.props.page;invariant(a,"Attempted to load page annotations, but no page was specified."),warning(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations"),this.loadAnnotations()}},{key:"componentDidUpdate",value:function(a){var k=this.props,M=k.page,C=k.renderForms;(a.page&&M!==a.page||C!==a.renderForms)&&this.loadAnnotations()}},{key:"componentWillUnmount",value:function(){cancelRunningTask(this.runningTask)}},{key:"viewport",get:function(){var a=this.props,k=a.page,M=a.rotate,C=a.scale;return k.getViewport({scale:C,rotation:M})}},{key:"renderAnnotationLayer",value:function(){var a=this.state.annotations;if(a){var k=this.props,M=k.imageResourcesPath,C=k.linkService,S=k.page,p=k.renderForms,R=this.viewport.clone({dontFlip:!0}),N={annotations:a,div:this.layerElement.current,imageResourcesPath:M,linkService:C,page:S,renderForms:p,viewport:R};this.layerElement.current.innerHTML="";try{pdfExports.AnnotationLayer.render(N),this.onRenderSuccess()}catch(x){this.onRenderError(x)}}}},{key:"render",value:function(){return React.createElement("div",{className:"react-pdf__Page__annotations annotationLayer",ref:this.layerElement},this.renderAnnotationLayer())}}]),_}(reactExports.PureComponent);AnnotationLayerInternal.propTypes={imageResourcesPath:PropTypes.string,linkService:isLinkService.isRequired,onGetAnnotationsError:PropTypes.func,onGetAnnotationsSuccess:PropTypes.func,onRenderAnnotationLayerError:PropTypes.func,onRenderAnnotationLayerSuccess:PropTypes.func,page:isPage,renderForms:PropTypes.bool,rotate:isRotate,scale:PropTypes.number};var AnnotationLayer$1=function b(n){return React.createElement(DocumentContext.Consumer,null,function(_){return React.createElement(PageContext.Consumer,null,function(e){return React.createElement(AnnotationLayerInternal,_extends({},_,e,n))})})};function ownKeys(b,n){var _=Object.keys(b);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(b);n&&(e=e.filter(function(a){return Object.getOwnPropertyDescriptor(b,a).enumerable})),_.push.apply(_,e)}return _}function _objectSpread(b){for(var n=1;n<arguments.length;n++){var _=arguments[n]!=null?arguments[n]:{};n%2?ownKeys(Object(_),!0).forEach(function(e){_defineProperty(b,e,_[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(_)):ownKeys(Object(_)).forEach(function(e){Object.defineProperty(b,e,Object.getOwnPropertyDescriptor(_,e))})}return b}function _createSuper(b){var n=_isNativeReflectConstruct();return function(){var e=_getPrototypeOf(b),a;if(n){var k=_getPrototypeOf(this).constructor;a=Reflect.construct(e,arguments,k)}else a=e.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _isNativeReflectConstruct(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var defaultScale=1,PageInternal=function(b){_inherits(_,b);var n=_createSuper(_);function _(){var e;_classCallCheck(this,_);for(var a=arguments.length,k=new Array(a),M=0;M<a;M++)k[M]=arguments[M];return e=n.call.apply(n,[this].concat(k)),_defineProperty(_assertThisInitialized(e),"state",{page:null}),_defineProperty(_assertThisInitialized(e),"pageElement",reactExports.createRef()),_defineProperty(_assertThisInitialized(e),"onLoadSuccess",function(){var C=e.props,S=C.onLoadSuccess,p=C.registerPage,R=e.state.page;S&&S(makePageCallback(R,e.scale)),p&&p(e.pageIndex,e.pageElement.current)}),_defineProperty(_assertThisInitialized(e),"onLoadError",function(C){e.setState({page:!1}),warning(C);var S=e.props.onLoadError;S&&S(C)}),_defineProperty(_assertThisInitialized(e),"loadPage",function(){var C=e.props.pdf,S=e.getPageNumber();if(S){e.setState(function(R){return R.page?{page:null}:null});var p=makeCancellablePromise(C.getPage(S));e.runningTask=p,p.promise.then(function(R){e.setState({page:R},e.onLoadSuccess)}).catch(function(R){e.onLoadError(R)})}}),e}return _createClass(_,[{key:"componentDidMount",value:function(){var a=this.props.pdf;invariant(a,"Attempted to load a page, but no document was specified."),this.loadPage()}},{key:"componentDidUpdate",value:function(a){var k=this.props.pdf;if(a.pdf&&k!==a.pdf||this.getPageNumber()!==this.getPageNumber(a)){var M=this.props.unregisterPage;M&&M(this.getPageIndex(a)),this.loadPage()}}},{key:"componentWillUnmount",value:function(){var a=this.props.unregisterPage;a&&a(this.pageIndex),cancelRunningTask(this.runningTask)}},{key:"childContext",get:function(){var a=this.pageIndex,k=this.pageNumber,M=this.state.page;if(!M)return{};var C=this.props,S=C.canvasBackground,p=C.customTextRenderer,R=C.devicePixelRatio,N=C.onGetAnnotationsError,x=C.onGetAnnotationsSuccess,P=C.onGetTextError,u=C.onGetTextSuccess,t=C.onRenderAnnotationLayerError,s=C.onRenderAnnotationLayerSuccess,c=C.onRenderError,A=C.onRenderSuccess,E=C.onRenderTextLayerError,h=C.onRenderTextLayerSuccess,i=C.renderForms,o=C.renderInteractiveForms;return{canvasBackground:S,customTextRenderer:p,devicePixelRatio:R,onGetAnnotationsError:N,onGetAnnotationsSuccess:x,onGetTextError:P,onGetTextSuccess:u,onRenderAnnotationLayerError:t,onRenderAnnotationLayerSuccess:s,onRenderError:c,onRenderSuccess:A,onRenderTextLayerError:E,onRenderTextLayerSuccess:h,page:M,pageIndex:a,pageNumber:k,renderForms:i??o,rotate:this.rotate,scale:this.scale}}},{key:"getPageIndex",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props;return isProvided(a.pageNumber)?a.pageNumber-1:isProvided(a.pageIndex)?a.pageIndex:null}},{key:"getPageNumber",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props;return isProvided(a.pageNumber)?a.pageNumber:isProvided(a.pageIndex)?a.pageIndex+1:null}},{key:"pageIndex",get:function(){return this.getPageIndex()}},{key:"pageNumber",get:function(){return this.getPageNumber()}},{key:"rotate",get:function(){var a=this.props.rotate;if(isProvided(a))return a;var k=this.state.page;return k?k.rotate:null}},{key:"scale",get:function(){var a=this.state.page;if(!a)return null;var k=this.props,M=k.scale,C=k.width,S=k.height,p=this.rotate,R=1,N=M===null?defaultScale:M;if(C||S){var x=a.getViewport({scale:1,rotation:p});R=C?C/x.width:S/x.height}return N*R}},{key:"eventProps",get:function(){var a=this;return makeEventProps(this.props,function(){var k=a.state.page;return k&&makePageCallback(k,a.scale)})}},{key:"pageKey",get:function(){return"".concat(this.pageIndex,"@").concat(this.scale,"/").concat(this.rotate)}},{key:"pageKeyNoScale",get:function(){return"".concat(this.pageIndex,"/").concat(this.rotate)}},{key:"renderMainLayer",value:function(){var a=this.props,k=a.canvasRef,M=a.renderMode;switch(M){case"none":return null;case"svg":return React.createElement(PageSVG,{key:"".concat(this.pageKeyNoScale,"_svg")});case"canvas":default:return React.createElement(PageCanvas,{key:"".concat(this.pageKey,"_canvas"),canvasRef:k})}}},{key:"renderTextLayer",value:function(){var a=this.props.renderTextLayer;return a?React.createElement(TextLayer$1,{key:"".concat(this.pageKey,"_text")}):null}},{key:"renderAnnotationLayer",value:function(){var a=this.props.renderAnnotationLayer;return a?React.createElement(AnnotationLayer$1,{key:"".concat(this.pageKey,"_annotations")}):null}},{key:"renderChildren",value:function(){var a=this.props.children;return React.createElement(PageContext.Provider,{value:this.childContext},this.renderMainLayer(),this.renderTextLayer(),this.renderAnnotationLayer(),a)}},{key:"renderContent",value:function(){var a=this.pageNumber,k=this.props.pdf,M=this.state.page;if(!a){var C=this.props.noData;return React.createElement(Message,{type:"no-data"},typeof C=="function"?C():C)}if(k===null||M===null){var S=this.props.loading;return React.createElement(Message,{type:"loading"},typeof S=="function"?S():S)}if(k===!1||M===!1){var p=this.props.error;return React.createElement(Message,{type:"error"},typeof p=="function"?p():p)}return this.renderChildren()}},{key:"render",value:function(){var a=this.pageNumber,k=this.props,M=k.className,C=k.inputRef;return React.createElement("div",_extends({className:clsx("react-pdf__Page",M),"data-page-number":a,ref:mergeRefs(C,this.pageElement),style:{position:"relative",minWidth:"min-content",minHeight:"min-content"}},this.eventProps),this.renderContent())}}]),_}(reactExports.PureComponent);PageInternal.defaultProps={error:"Failed to load the page.",loading:"Loading page…",noData:"No page specified.",renderAnnotationLayer:!0,renderMode:"canvas",renderTextLayer:!0,scale:defaultScale};var isFunctionOrNode=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);PageInternal.propTypes=_objectSpread(_objectSpread({},eventProps),{},{canvasBackground:PropTypes.string,children:PropTypes.node,className:isClassName,customTextRenderer:PropTypes.func,devicePixelRatio:PropTypes.number,error:isFunctionOrNode,height:PropTypes.number,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode,noData:isFunctionOrNode,onGetTextError:PropTypes.func,onGetTextSuccess:PropTypes.func,onLoadError:PropTypes.func,onLoadSuccess:PropTypes.func,onRenderError:PropTypes.func,onRenderSuccess:PropTypes.func,onRenderTextLayerError:PropTypes.func,onRenderTextLayerSuccess:PropTypes.func,pageIndex:isPageIndex,pageNumber:isPageNumber,pdf:isPdf,registerPage:PropTypes.func,renderAnnotationLayer:PropTypes.bool,renderForms:PropTypes.bool,renderInteractiveForms:PropTypes.bool,renderMode:isRenderMode,renderTextLayer:PropTypes.bool,rotate:isRotate,scale:PropTypes.number,unregisterPage:PropTypes.func,width:PropTypes.number});function Page(b,n){return React.createElement(DocumentContext.Consumer,null,function(_){return React.createElement(PageInternal,_extends({ref:n},_,b))})}const Page$1=React.forwardRef(Page);displayWorkerWarning();pdfExports.GlobalWorkerOptions.workerSrc=new URL("/assets/pdf.worker-6b078827.js",self.location);const AnnotationLayer="",TextLayer="";function PdfSupport(b){const[n,_]=reactExports.useState(),e=reactExports.createRef(),[a,k]=reactExports.useState(window.innerWidth);return reactExports.useEffect(()=>{const M=new AbortController;return window.addEventListener("resize",()=>{k(window.innerWidth)},{passive:!0,signal:M.signal}),()=>M.abort()}),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[!n&&jsxRuntimeExports.jsx("progress",{className:"w-full",value:0,max:b.size,ref:e}),jsxRuntimeExports.jsx(Document,{className:"max-w-[100vw] overflow-x-hidden",file:serverUrl(`/files/${b.path}`),externalLinkRel:"_blank",options:{withCredentials:!0,length:b.size},loading:Loading,onLoadProgress:({loaded:M})=>{e.current&&(e.current.value=M)},onLoadSuccess:M=>{_(M.numPages)},children:Array.from(new Array(n),(M,C)=>jsxRuntimeExports.jsx(Page$1,{className:"mx-auto w-fit max-w-[100px]",pageIndex:C,loading:Loading,width:Math.min(a,1e3)},C))})]})}export{PdfSupport as default};
