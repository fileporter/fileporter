var $e=Object.defineProperty;var ze=(_,n,b)=>n in _?$e(_,n,{enumerable:!0,configurable:!0,writable:!0,value:b}):_[n]=b;var Mt=(_,n,b)=>(ze(_,typeof n!="symbol"?n+"":n,b),b),ae=(_,n,b)=>{if(!n.has(_))throw TypeError("Cannot "+b)};var I=(_,n,b)=>(ae(_,n,"read from private field"),b?b.call(_):n.get(_)),ot=(_,n,b)=>{if(n.has(_))throw TypeError("Cannot add the same private member more than once");n instanceof WeakSet?n.add(_):n.set(_,b)},yt=(_,n,b,t)=>(ae(_,n,"write to private field"),t?t.call(_,b):n.set(_,b),b),oe=(_,n,b,t)=>({set _(a){yt(_,n,a,b)},get _(){return I(_,n,t)}}),ut=(_,n,b)=>(ae(_,n,"access private method"),b);import{g as getAugmentedNamespace,_ as _setPrototypeOf,r as reactExports,R as React,a as _extends,j as jsxRuntimeExports,s as serverUrl,L as Loading}from"./index-a6515dc5.js";function commonjsRequire(_){throw new Error('Could not dynamically require "'+_+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdfExports={},pdf={get exports(){return pdfExports},set exports(_){pdfExports=_}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(n,b){module.exports=b()})(globalThis,()=>(()=>{var __webpack_modules__=[,(_,n,b)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.VerbosityLevel=n.Util=n.UnknownErrorException=n.UnexpectedResponseException=n.UNSUPPORTED_FEATURES=n.TextRenderingMode=n.StreamType=n.RenderingIntentFlag=n.PermissionFlag=n.PasswordResponses=n.PasswordException=n.PageActionEventType=n.OPS=n.MissingPDFException=n.LINE_FACTOR=n.LINE_DESCENT_FACTOR=n.InvalidPDFException=n.ImageKind=n.IDENTITY_MATRIX=n.FormatError=n.FontType=n.FeatureTest=n.FONT_IDENTITY_MATRIX=n.DocumentActionEventType=n.CMapCompressionType=n.BaseException=n.AnnotationType=n.AnnotationStateModelType=n.AnnotationReviewState=n.AnnotationReplyType=n.AnnotationMode=n.AnnotationMarkedState=n.AnnotationFlag=n.AnnotationFieldFlag=n.AnnotationEditorType=n.AnnotationEditorPrefix=n.AnnotationEditorParamsType=n.AnnotationBorderStyleType=n.AnnotationActionEventType=n.AbortException=void 0,n.arrayByteLength=st,n.arraysToBytes=dt,n.assert=p,n.bytesToString=L,n.createPromiseCapability=gt,n.createValidAbsoluteUrl=O,n.escapeString=Pt,n.getModificationDate=at,n.getVerbosityLevel=rt,n.info=ct,n.isArrayBuffer=Dt,n.isArrayEqual=te,n.isAscii=Ot,n.objectFromMap=nt,n.objectSize=lt,n.setVerbosityLevel=Y,n.shadow=U,n.string32=tt,n.stringToBytes=H,n.stringToPDFString=Tt,n.stringToUTF16BEString=Ft,n.stringToUTF8String=zt,n.unreachable=W,n.utf8StringToString=Ct,n.warn=bt,b(2);const t=[1,0,0,1,0,0];n.IDENTITY_MATRIX=t;const a=[.001,0,0,.001,0,0];n.FONT_IDENTITY_MATRIX=a;const k=1.35;n.LINE_FACTOR=k;const F=.35;n.LINE_DESCENT_FACTOR=F;const T={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};n.RenderingIntentFlag=T;const v={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};n.AnnotationMode=v;const f="pdfjs_internal_editor_";n.AnnotationEditorPrefix=f;const R={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};n.AnnotationEditorType=R;const N={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};n.AnnotationEditorParamsType=N;const w={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};n.PermissionFlag=w;const P={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};n.TextRenderingMode=P;const u={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};n.ImageKind=u;const e={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};n.AnnotationType=e;const i={MARKED:"Marked",REVIEW:"Review"};n.AnnotationStateModelType=i;const c={MARKED:"Marked",UNMARKED:"Unmarked"};n.AnnotationMarkedState=c;const S={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};n.AnnotationReviewState=S;const E={GROUP:"Group",REPLY:"R"};n.AnnotationReplyType=E;const h={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};n.AnnotationFlag=h;const s={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};n.AnnotationFieldFlag=s;const o={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};n.AnnotationBorderStyleType=o;const m={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};n.AnnotationActionEventType=m;const M={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};n.DocumentActionEventType=M;const x={O:"PageOpen",C:"PageClose"};n.PageActionEventType=x;const y={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"};n.StreamType=y;const D={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};n.FontType=D;const et={ERRORS:0,WARNINGS:1,INFOS:5};n.VerbosityLevel=et;const it={NONE:0,BINARY:1,STREAM:2};n.CMapCompressionType=it;const Z={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};n.OPS=Z;const J={unknown:"unknown",forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"};n.UNSUPPORTED_FEATURES=J;const G={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};n.PasswordResponses=G;let V=et.WARNINGS;function Y(Q){Number.isInteger(Q)&&(V=Q)}function rt(){return V}function ct(Q){V>=et.INFOS&&console.log(`Info: ${Q}`)}function bt(Q){V>=et.WARNINGS&&console.log(`Warning: ${Q}`)}function W(Q){throw new Error(Q)}function p(Q,$){Q||W($)}function d(Q){if(!Q)return!1;switch(Q.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function O(Q,$=null,z=null){if(!Q)return null;try{if(z&&typeof Q=="string"){if(z.addDefaultProtocol&&Q.startsWith("www.")){const _t=Q.match(/\./g);_t&&_t.length>=2&&(Q=`http://${Q}`)}if(z.tryConvertEncoding)try{Q=zt(Q)}catch{}}const mt=$?new URL(Q,$):new URL(Q);if(d(mt))return mt}catch{}return null}function U(Q,$,z){return Object.defineProperty(Q,$,{value:z,enumerable:!0,configurable:!0,writable:!1}),z}const B=function(){function $(z,mt){this.constructor===$&&W("Cannot initialize BaseException."),this.message=z,this.name=mt}return $.prototype=new Error,$.constructor=$,$}();n.BaseException=B;class q extends B{constructor($,z){super($,"PasswordException"),this.code=z}}n.PasswordException=q;class K extends B{constructor($,z){super($,"UnknownErrorException"),this.details=z}}n.UnknownErrorException=K;class X extends B{constructor($){super($,"InvalidPDFException")}}n.InvalidPDFException=X;class l extends B{constructor($){super($,"MissingPDFException")}}n.MissingPDFException=l;class g extends B{constructor($,z){super($,"UnexpectedResponseException"),this.status=z}}n.UnexpectedResponseException=g;class A extends B{constructor($){super($,"FormatError")}}n.FormatError=A;class C extends B{constructor($){super($,"AbortException")}}n.AbortException=C;function L(Q){(typeof Q!="object"||Q===null||Q.length===void 0)&&W("Invalid argument for bytesToString");const $=Q.length,z=8192;if($<z)return String.fromCharCode.apply(null,Q);const mt=[];for(let _t=0;_t<$;_t+=z){const At=Math.min(_t+z,$),Et=Q.subarray(_t,At);mt.push(String.fromCharCode.apply(null,Et))}return mt.join("")}function H(Q){typeof Q!="string"&&W("Invalid argument for stringToBytes");const $=Q.length,z=new Uint8Array($);for(let mt=0;mt<$;++mt)z[mt]=Q.charCodeAt(mt)&255;return z}function st(Q){if(Q.length!==void 0)return Q.length;if(Q.byteLength!==void 0)return Q.byteLength;W("Invalid argument for arrayByteLength")}function dt(Q){const $=Q.length;if($===1&&Q[0]instanceof Uint8Array)return Q[0];let z=0;for(let At=0;At<$;At++)z+=st(Q[At]);let mt=0;const _t=new Uint8Array(z);for(let At=0;At<$;At++){let Et=Q[At];Et instanceof Uint8Array||(typeof Et=="string"?Et=H(Et):Et=new Uint8Array(Et));const wt=Et.byteLength;_t.set(Et,mt),mt+=wt}return _t}function tt(Q){return String.fromCharCode(Q>>24&255,Q>>16&255,Q>>8&255,Q&255)}function lt(Q){return Object.keys(Q).length}function nt(Q){const $=Object.create(null);for(const[z,mt]of Q)$[z]=mt;return $}function ht(){const Q=new Uint8Array(4);return Q[0]=1,new Uint32Array(Q.buffer,0,1)[0]===1}function ft(){try{return new Function(""),!0}catch{return!1}}class j{static get isLittleEndian(){return U(this,"isLittleEndian",ht())}static get isEvalSupported(){return U(this,"isEvalSupported",ft())}static get isOffscreenCanvasSupported(){return U(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}}n.FeatureTest=j;const pt=[...Array(256).keys()].map(Q=>Q.toString(16).padStart(2,"0"));class vt{static makeHexColor($,z,mt){return`#${pt[$]}${pt[z]}${pt[mt]}`}static scaleMinMax($,z){let mt;$[0]?($[0]<0&&(mt=z[0],z[0]=z[1],z[1]=mt),z[0]*=$[0],z[1]*=$[0],$[3]<0&&(mt=z[2],z[2]=z[3],z[3]=mt),z[2]*=$[3],z[3]*=$[3]):(mt=z[0],z[0]=z[2],z[2]=mt,mt=z[1],z[1]=z[3],z[3]=mt,$[1]<0&&(mt=z[2],z[2]=z[3],z[3]=mt),z[2]*=$[1],z[3]*=$[1],$[2]<0&&(mt=z[0],z[0]=z[1],z[1]=mt),z[0]*=$[2],z[1]*=$[2]),z[0]+=$[4],z[1]+=$[4],z[2]+=$[5],z[3]+=$[5]}static transform($,z){return[$[0]*z[0]+$[2]*z[1],$[1]*z[0]+$[3]*z[1],$[0]*z[2]+$[2]*z[3],$[1]*z[2]+$[3]*z[3],$[0]*z[4]+$[2]*z[5]+$[4],$[1]*z[4]+$[3]*z[5]+$[5]]}static applyTransform($,z){const mt=$[0]*z[0]+$[1]*z[2]+z[4],_t=$[0]*z[1]+$[1]*z[3]+z[5];return[mt,_t]}static applyInverseTransform($,z){const mt=z[0]*z[3]-z[1]*z[2],_t=($[0]*z[3]-$[1]*z[2]+z[2]*z[5]-z[4]*z[3])/mt,At=(-$[0]*z[1]+$[1]*z[0]+z[4]*z[1]-z[5]*z[0])/mt;return[_t,At]}static getAxialAlignedBoundingBox($,z){const mt=vt.applyTransform($,z),_t=vt.applyTransform($.slice(2,4),z),At=vt.applyTransform([$[0],$[3]],z),Et=vt.applyTransform([$[2],$[1]],z);return[Math.min(mt[0],_t[0],At[0],Et[0]),Math.min(mt[1],_t[1],At[1],Et[1]),Math.max(mt[0],_t[0],At[0],Et[0]),Math.max(mt[1],_t[1],At[1],Et[1])]}static inverseTransform($){const z=$[0]*$[3]-$[1]*$[2];return[$[3]/z,-$[1]/z,-$[2]/z,$[0]/z,($[2]*$[5]-$[4]*$[3])/z,($[4]*$[1]-$[5]*$[0])/z]}static apply3dTransform($,z){return[$[0]*z[0]+$[1]*z[1]+$[2]*z[2],$[3]*z[0]+$[4]*z[1]+$[5]*z[2],$[6]*z[0]+$[7]*z[1]+$[8]*z[2]]}static singularValueDecompose2dScale($){const z=[$[0],$[2],$[1],$[3]],mt=$[0]*z[0]+$[1]*z[2],_t=$[0]*z[1]+$[1]*z[3],At=$[2]*z[0]+$[3]*z[2],Et=$[2]*z[1]+$[3]*z[3],wt=(mt+Et)/2,It=Math.sqrt((mt+Et)**2-4*(mt*Et-At*_t))/2,kt=wt+It||1,xt=wt-It||1;return[Math.sqrt(kt),Math.sqrt(xt)]}static normalizeRect($){const z=$.slice(0);return $[0]>$[2]&&(z[0]=$[2],z[2]=$[0]),$[1]>$[3]&&(z[1]=$[3],z[3]=$[1]),z}static intersect($,z){const mt=Math.max(Math.min($[0],$[2]),Math.min(z[0],z[2])),_t=Math.min(Math.max($[0],$[2]),Math.max(z[0],z[2]));if(mt>_t)return null;const At=Math.max(Math.min($[1],$[3]),Math.min(z[1],z[3])),Et=Math.min(Math.max($[1],$[3]),Math.max(z[1],z[3]));return At>Et?null:[mt,At,_t,Et]}static bezierBoundingBox($,z,mt,_t,At,Et,wt,It){const kt=[],xt=[[],[]];let Nt,Lt,Bt,Rt,jt,qt,Vt,Xt;for(let Yt=0;Yt<2;++Yt){if(Yt===0?(Lt=6*$-12*mt+6*At,Nt=-3*$+9*mt-9*At+3*wt,Bt=3*mt-3*$):(Lt=6*z-12*_t+6*Et,Nt=-3*z+9*_t-9*Et+3*It,Bt=3*_t-3*z),Math.abs(Nt)<1e-12){if(Math.abs(Lt)<1e-12)continue;Rt=-Bt/Lt,0<Rt&&Rt<1&&kt.push(Rt);continue}Vt=Lt*Lt-4*Bt*Nt,Xt=Math.sqrt(Vt),!(Vt<0)&&(jt=(-Lt+Xt)/(2*Nt),0<jt&&jt<1&&kt.push(jt),qt=(-Lt-Xt)/(2*Nt),0<qt&&qt<1&&kt.push(qt))}let Gt=kt.length,Ut;const Ht=Gt;for(;Gt--;)Rt=kt[Gt],Ut=1-Rt,xt[0][Gt]=Ut*Ut*Ut*$+3*Ut*Ut*Rt*mt+3*Ut*Rt*Rt*At+Rt*Rt*Rt*wt,xt[1][Gt]=Ut*Ut*Ut*z+3*Ut*Ut*Rt*_t+3*Ut*Rt*Rt*Et+Rt*Rt*Rt*It;return xt[0][Ht]=$,xt[1][Ht]=z,xt[0][Ht+1]=wt,xt[1][Ht+1]=It,xt[0].length=xt[1].length=Ht+2,[Math.min(...xt[0]),Math.min(...xt[1]),Math.max(...xt[0]),Math.max(...xt[1])]}}n.Util=vt;const St=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Tt(Q){if(Q[0]>="ï"){let z;if(Q[0]==="þ"&&Q[1]==="ÿ"?z="utf-16be":Q[0]==="ÿ"&&Q[1]==="þ"?z="utf-16le":Q[0]==="ï"&&Q[1]==="»"&&Q[2]==="¿"&&(z="utf-8"),z)try{const mt=new TextDecoder(z,{fatal:!0}),_t=H(Q);return mt.decode(_t)}catch(mt){bt(`stringToPDFString: "${mt}".`)}}const $=[];for(let z=0,mt=Q.length;z<mt;z++){const _t=St[Q.charCodeAt(z)];$.push(_t?String.fromCharCode(_t):Q.charAt(z))}return $.join("")}function Pt(Q){return Q.replace(/([()\\\n\r])/g,$=>$===`
`?"\\n":$==="\r"?"\\r":`\\${$}`)}function Ot(Q){return/^[\x00-\x7F]*$/.test(Q)}function Ft(Q){const $=["þÿ"];for(let z=0,mt=Q.length;z<mt;z++){const _t=Q.charCodeAt(z);$.push(String.fromCharCode(_t>>8&255),String.fromCharCode(_t&255))}return $.join("")}function zt(Q){return decodeURIComponent(escape(Q))}function Ct(Q){return unescape(encodeURIComponent(Q))}function Dt(Q){return typeof Q=="object"&&Q!==null&&Q.byteLength!==void 0}function te(Q,$){if(Q.length!==$.length)return!1;for(let z=0,mt=Q.length;z<mt;z++)if(Q[z]!==$[z])return!1;return!0}function at(Q=new Date){return[Q.getUTCFullYear().toString(),(Q.getUTCMonth()+1).toString().padStart(2,"0"),Q.getUTCDate().toString().padStart(2,"0"),Q.getUTCHours().toString().padStart(2,"0"),Q.getUTCMinutes().toString().padStart(2,"0"),Q.getUTCSeconds().toString().padStart(2,"0")].join("")}function gt(){const Q=Object.create(null);let $=!1;return Object.defineProperty(Q,"settled",{get(){return $}}),Q.promise=new Promise(function(z,mt){Q.resolve=function(_t){$=!0,z(_t)},Q.reject=function(_t){$=!0,mt(_t)}}),Q}},(_,n,b)=>{b(3)},(_,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.isNodeJS=void 0;const b=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");n.isNodeJS=b},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var _,b,t,a,k,F,T,v,f,le,N,w;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(5),_display_utils=__w_pdfjs_require__(8),_font_loader=__w_pdfjs_require__(11),_canvas=__w_pdfjs_require__(12),_worker_options=__w_pdfjs_require__(15),_is_node=__w_pdfjs_require__(3),_message_handler=__w_pdfjs_require__(16),_metadata=__w_pdfjs_require__(17),_optional_content_config=__w_pdfjs_require__(18),_transport_stream=__w_pdfjs_require__(19),_xfa_text=__w_pdfjs_require__(20);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:u,NodeCMapReaderFactory:e,NodeStandardFontDataFactory:i}=__w_pdfjs_require__(21);exports.DefaultCanvasFactory=DefaultCanvasFactory=u,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=e,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=i}let createPDFNetworkStream;function setPDFNetworkStreamFactory(u){createPDFNetworkStream=u}function getDocument(u){const e=new PDFDocumentLoadingTask;let i;if(typeof u=="string"||u instanceof URL)i={url:u};else if((0,_util.isArrayBuffer)(u))i={data:u};else if(u instanceof PDFDataRangeTransport)i={range:u};else{if(typeof u!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, TypedArray, or parameter object.");if(!u.url&&!u.data&&!u.range)throw new Error("Invalid parameter object: need either .data, .range or .url");i=u}const c=Object.create(null);let S=null,E=null;for(const s in i){const o=i[s];switch(s){case"url":if(typeof window<"u")try{c[s]=new URL(o,window.location).href;continue}catch(m){(0,_util.warn)(`Cannot create valid URL: "${m}".`)}else if(typeof o=="string"||o instanceof URL){c[s]=o.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":S=o;continue;case"worker":E=o;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&o instanceof Buffer)c[s]=new Uint8Array(o);else{if(o instanceof Uint8Array)break;if(typeof o=="string")c[s]=(0,_util.stringToBytes)(o);else if(typeof o=="object"&&o!==null&&!isNaN(o.length))c[s]=new Uint8Array(o);else if((0,_util.isArrayBuffer)(o))c[s]=new Uint8Array(o);else throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}continue}c[s]=o}if(c.CMapReaderFactory=c.CMapReaderFactory||DefaultCMapReaderFactory,c.StandardFontDataFactory=c.StandardFontDataFactory||DefaultStandardFontDataFactory,c.ignoreErrors=c.stopAtErrors!==!0,c.fontExtraProperties=c.fontExtraProperties===!0,c.pdfBug=c.pdfBug===!0,c.enableXfa=c.enableXfa===!0,(!Number.isInteger(c.rangeChunkSize)||c.rangeChunkSize<1)&&(c.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),(typeof c.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(c.docBaseUrl))&&(c.docBaseUrl=null),(!Number.isInteger(c.maxImageSize)||c.maxImageSize<-1)&&(c.maxImageSize=-1),typeof c.cMapUrl!="string"&&(c.cMapUrl=null),typeof c.standardFontDataUrl!="string"&&(c.standardFontDataUrl=null),typeof c.useWorkerFetch!="boolean"&&(c.useWorkerFetch=c.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&c.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),typeof c.isEvalSupported!="boolean"&&(c.isEvalSupported=!0),typeof c.disableFontFace!="boolean"&&(c.disableFontFace=_is_node.isNodeJS),typeof c.useSystemFonts!="boolean"&&(c.useSystemFonts=!_is_node.isNodeJS&&!c.disableFontFace),(typeof c.ownerDocument!="object"||c.ownerDocument===null)&&(c.ownerDocument=globalThis.document),typeof c.disableRange!="boolean"&&(c.disableRange=!1),typeof c.disableStream!="boolean"&&(c.disableStream=!1),typeof c.disableAutoFetch!="boolean"&&(c.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(c.verbosity),!E){const s={verbosity:c.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};E=s.port?PDFWorker.fromPort(s):new PDFWorker(s),e._worker=E}const h=e.docId;return E.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");const s=_fetchDocument(E,c,S,h),o=new Promise(function(m){let M;S?M=new _transport_stream.PDFDataTransportStream({length:c.length,initialData:c.initialData,progressiveDone:c.progressiveDone,contentDispositionFilename:c.contentDispositionFilename,disableRange:c.disableRange,disableStream:c.disableStream},S):c.data||(M=createPDFNetworkStream({url:c.url,length:c.length,httpHeaders:c.httpHeaders,withCredentials:c.withCredentials,rangeChunkSize:c.rangeChunkSize,disableRange:c.disableRange,disableStream:c.disableStream})),m(M)});return Promise.all([s,o]).then(function([m,M]){if(e.destroyed)throw new Error("Loading aborted");const x=new _message_handler.MessageHandler(h,m,E.port),y=new WorkerTransport(x,e,M,c);e._transport=y,x.send("Ready",null)})}).catch(e._capability.reject),e}async function _fetchDocument(u,e,i,c){if(u.destroyed)throw new Error("Worker was destroyed");i&&(e.length=i.length,e.initialData=i.initialData,e.progressiveDone=i.progressiveDone,e.contentDispositionFilename=i.contentDispositionFilename);const S=await u.messageHandler.sendWithPromise("GetDocRequest",{docId:c,apiVersion:"2.16.105",source:{data:e.data,url:e.url,password:e.password,disableAutoFetch:e.disableAutoFetch,rangeChunkSize:e.rangeChunkSize,length:e.length},maxImageSize:e.maxImageSize,disableFontFace:e.disableFontFace,docBaseUrl:e.docBaseUrl,ignoreErrors:e.ignoreErrors,isEvalSupported:e.isEvalSupported,fontExtraProperties:e.fontExtraProperties,enableXfa:e.enableXfa,useSystemFonts:e.useSystemFonts,cMapUrl:e.useWorkerFetch?e.cMapUrl:null,standardFontDataUrl:e.useWorkerFetch?e.standardFontDataUrl:null});if(e.data&&(e.data=null),u.destroyed)throw new Error("Worker was destroyed");return S}const n=class{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${oe(n,_)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}async destroy(){var e;this.destroyed=!0,await((e=this._transport)==null?void 0:e.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};let PDFDocumentLoadingTask=n;_=new WeakMap,ot(PDFDocumentLoadingTask,_,0),exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(e,i,c=!1,S=null){this.length=e,this.initialData=i,this.progressiveDone=c,this.contentDispositionFilename=S,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,i){for(const c of this._rangeListeners)c(e,i)}onDataProgress(e,i){this._readyCapability.promise.then(()=>{for(const c of this._progressListeners)c(e,i)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const i of this._progressiveReadListeners)i(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,i){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(e,i){this._pdfInfo=e,this._transport=i,Object.defineProperty(this,"fingerprint",{get(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.fingerprint`, please use `PDFDocumentProxy.fingerprints` instead."),this.fingerprints[0]}}),Object.defineProperty(this,"getStats",{value:async()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getStats`, please use the `PDFDocumentProxy.stats`-getter instead."),this.stats||{streamTypes:{},fontTypes:{}})})}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get stats(){return this._transport.stats}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(){return this._transport.annotationStorage.size<=0&&(0,_display_utils.deprecated)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this._transport.saveDocument()}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(e,i,c,S,E=!1){this._pageIndex=e,this._pageInfo=i,this._ownerDocument=S,this._transport=c,this._stats=E?new _display_utils.StatTimer:null,this._pdfBug=E,this.commonObjs=c.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:i=this.rotate,offsetX:c=0,offsetY:S=0,dontFlip:E=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:e,rotation:i,offsetX:c,offsetY:S,dontFlip:E})}getAnnotations({intent:e="display"}={}){const i=this._transport.getRenderingIntent(e);let c=this._annotationPromises.get(i.cacheKey);return c||(c=this._transport.getAnnotations(this._pageIndex,i.renderingIntent),this._annotationPromises.set(i.cacheKey,c),c=c.then(S=>{for(const E of S)E.titleObj!==void 0&&Object.defineProperty(E,"title",{get(){return(0,_display_utils.deprecated)("`title`-property on annotation, please use `titleObj` instead."),E.titleObj.str}}),E.contentsObj!==void 0&&Object.defineProperty(E,"contents",{get(){return(0,_display_utils.deprecated)("`contents`-property on annotation, please use `contentsObj` instead."),E.contentsObj.str}});return S})),c}getJSActions(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:i,intent:c="display",annotationMode:S=_util.AnnotationMode.ENABLE,transform:E=null,imageLayer:h=null,canvasFactory:s=null,background:o=null,optionalContentConfigPromise:m=null,annotationCanvasMap:M=null,pageColors:x=null,printAnnotationStorage:y=null}){var Y,rt;((Y=arguments[0])==null?void 0:Y.renderInteractiveForms)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `renderInteractiveForms`-option, please use the `annotationMode`-option instead."),arguments[0].renderInteractiveForms===!0&&S===_util.AnnotationMode.ENABLE&&(S=_util.AnnotationMode.ENABLE_FORMS)),((rt=arguments[0])==null?void 0:rt.includeAnnotationStorage)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `includeAnnotationStorage`-option, please use the `annotationMode`-option instead."),arguments[0].includeAnnotationStorage===!0&&S===_util.AnnotationMode.ENABLE&&(S=_util.AnnotationMode.ENABLE_STORAGE)),this._stats&&this._stats.time("Overall");const D=this._transport.getRenderingIntent(c,S,y);this.pendingCleanup=!1,m||(m=this._transport.getOptionalContentConfig());let et=this._intentStates.get(D.cacheKey);et||(et=Object.create(null),this._intentStates.set(D.cacheKey,et)),et.streamReaderCancelTimeout&&(clearTimeout(et.streamReaderCancelTimeout),et.streamReaderCancelTimeout=null);const it=s||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),Z=!!(D.renderingIntent&_util.RenderingIntentFlag.PRINT);et.displayReadyCapability||(et.displayReadyCapability=(0,_util.createPromiseCapability)(),et.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(D));const J=ct=>{et.renderTasks.delete(G),(this.cleanupAfterRender||Z)&&(this.pendingCleanup=!0),this._tryCleanup(),ct?(G.capability.reject(ct),this._abortOperatorList({intentState:et,reason:ct instanceof Error?ct:new Error(ct)})):G.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},G=new InternalRenderTask({callback:J,params:{canvasContext:e,viewport:i,transform:E,imageLayer:h,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:M,operatorList:et.operatorList,pageIndex:this._pageIndex,canvasFactory:it,useRequestAnimationFrame:!Z,pdfBug:this._pdfBug,pageColors:x});(et.renderTasks||(et.renderTasks=new Set)).add(G);const V=G.task;return Promise.all([et.displayReadyCapability.promise,m]).then(([ct,bt])=>{if(this.pendingCleanup){J();return}this._stats&&this._stats.time("Rendering"),G.initializeGraphics({transparency:ct,optionalContentConfig:bt}),G.operatorListChanged()}).catch(J),V}getOperatorList({intent:e="display",annotationMode:i=_util.AnnotationMode.ENABLE,printAnnotationStorage:c=null}={}){function S(){h.operatorList.lastChunk&&(h.opListReadCapability.resolve(h.operatorList),h.renderTasks.delete(s))}const E=this._transport.getRenderingIntent(e,i,c,!0);let h=this._intentStates.get(E.cacheKey);h||(h=Object.create(null),this._intentStates.set(E.cacheKey,h));let s;return h.opListReadCapability||(s=Object.create(null),s.operatorListChanged=S,h.opListReadCapability=(0,_util.createPromiseCapability)(),(h.renderTasks||(h.renderTasks=new Set)).add(s),h.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(E)),h.opListReadCapability.promise}streamTextContent({disableCombineTextItems:e=!1,includeMarkedContent:i=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:e!==!0,includeMarkedContent:i===!0},{highWaterMark:100,size(S){return S.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(c=>_xfa_text.XfaText.textContent(c));const i=this.streamTextContent(e);return new Promise(function(c,S){function E(){h.read().then(function({value:o,done:m}){if(m){c(s);return}Object.assign(s.styles,o.styles),s.items.push(...o.items),E()},S)}const h=i.getReader(),s={items:[],styles:Object.create(null)};E()})}getStructTree(){return this._structTreePromise||(this._structTreePromise=this._transport.getStructTree(this._pageIndex))}_destroy(){this.destroyed=!0;const e=[];for(const i of this._intentStates.values())if(this._abortOperatorList({intentState:i,reason:new Error("Page was destroyed."),force:!0}),!i.opListReadCapability)for(const c of i.renderTasks)e.push(c.completed),c.cancel();this.objs.clear();for(const i of this._bitmaps)i.close();return this._bitmaps.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(e)}cleanup(e=!1){return this.pendingCleanup=!0,this._tryCleanup(e)}_tryCleanup(e=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:i,operatorList:c}of this._intentStates.values())if(i.size>0||!c.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,e&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const i of this._bitmaps)i.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(e,i){const c=this._intentStates.get(i);c&&(this._stats&&this._stats.timeEnd("Page Request"),c.displayReadyCapability&&c.displayReadyCapability.resolve(e))}_renderPageChunk(e,i){for(let c=0,S=e.length;c<S;c++)i.operatorList.fnArray.push(e.fnArray[c]),i.operatorList.argsArray.push(e.argsArray[c]);i.operatorList.lastChunk=e.lastChunk,i.operatorList.separateAnnots=e.separateAnnots;for(const c of i.renderTasks)c.operatorListChanged();e.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:e,cacheKey:i,annotationStorageMap:c}){const E=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:i,annotationStorage:c}).getReader(),h=this._intentStates.get(i);h.streamReader=E;const s=()=>{E.read().then(({value:o,done:m})=>{if(m){h.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(o,h),s())},o=>{if(h.streamReader=null,!this._transport.destroyed){if(h.operatorList){h.operatorList.lastChunk=!0;for(const m of h.renderTasks)m.operatorListChanged();this._tryCleanup()}if(h.displayReadyCapability)h.displayReadyCapability.reject(o);else if(h.opListReadCapability)h.opListReadCapability.reject(o);else throw o}})};s()}_abortOperatorList({intentState:e,reason:i,force:c=!1}){if(e.streamReader){if(!c){if(e.renderTasks.size>0)return;if(i instanceof _display_utils.RenderingCancelledException){e.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:e,reason:i,force:!0}),e.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT);return}}if(e.streamReader.cancel(new _util.AbortException(i.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[S,E]of this._intentStates)if(E===e){this._intentStates.delete(S);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve()}postMessage(e,i){const c={data:structuredClone(e,i)};this._deferred.then(()=>{for(const S of this._listeners)S.call(this,c)})}addEventListener(e,i){this._listeners.push(i)}removeEventListener(e,i){const c=this._listeners.indexOf(i);this._listeners.splice(c,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const u=(b=document==null?void 0:document.currentScript)==null?void 0:b.src;u&&(PDFWorkerUtil.fallbackWorkerSrc=u.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(u,e){let i;try{if(i=new URL(u),!i.origin||i.origin==="null")return!1}catch{return!1}const c=new URL(e,i);return i.origin===c.origin},PDFWorkerUtil.createCDNWrapper=function(u){const e=`importScripts("${u}");`;return URL.createObjectURL(new Blob([e]))}}const _PDFWorker=class{constructor({name:u=null,port:e=null,verbosity:i=(0,_util.getVerbosityLevel)()}={}){if(e&&I(_PDFWorker,t).has(e))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=u,this.destroyed=!1,this.verbosity=i,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,e){I(_PDFWorker,t).set(e,this),this._initializeFromPort(e);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(u){this._port=u,this._messageHandler=new _message_handler.MessageHandler("main","worker",u),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:u}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,u)||(u=PDFWorkerUtil.createCDNWrapper(new URL(u,window.location).href));const e=new Worker(u),i=new _message_handler.MessageHandler("main","worker",e),c=()=>{e.removeEventListener("error",S),i.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},S=()=>{this._webWorker||c()};e.addEventListener("error",S),i.on("test",h=>{if(e.removeEventListener("error",S),this.destroyed){c();return}h?(this._messageHandler=i,this._port=e,this._webWorker=e,this._readyCapability.resolve(),i.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),i.destroy(),e.terminate())}),i.on("ready",h=>{if(e.removeEventListener("error",S),this.destroyed){c();return}try{E()}catch{this._setupFakeWorker()}});const E=()=>{const h=new Uint8Array;i.send("test",h,[h.buffer])};E();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(u=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const e=new LoopbackPort;this._port=e;const i=`fake${PDFWorkerUtil.fakeWorkerId++}`,c=new _message_handler.MessageHandler(i+"_worker",i,e);u.setup(c,e);const S=new _message_handler.MessageHandler(i,i+"_worker",e);this._messageHandler=S,this._readyCapability.resolve(),S.send("configure",{verbosity:this.verbosity})}).catch(u=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${u.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),I(_PDFWorker,t).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(u){if(!(u!=null&&u.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return I(this,t).has(u.port)?I(this,t).get(u.port):new _PDFWorker(u)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var u;try{return((u=globalThis.pdfjsWorker)==null?void 0:u.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};let PDFWorker=_PDFWorker;t=new WeakMap,ot(PDFWorker,t,new WeakMap),exports.PDFWorker=PDFWorker,PDFWorker.getWorkerSrc=function(){return(0,_display_utils.deprecated)("`PDFWorker.getWorkerSrc()`, please use `PDFWorker.workerSrc` instead."),this.workerSrc};class WorkerTransport{constructor(e,i,c,S){ot(this,a,null);ot(this,k,new Map);ot(this,F,new Map);ot(this,T,null);this.messageHandler=e,this.loadingTask=i,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:i.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:S.ownerDocument,styleElement:S.styleElement}),this._params=S,S.useWorkerFetch||(this.CMapReaderFactory=new S.CMapReaderFactory({baseUrl:S.cMapUrl,isCompressed:S.cMapPacked}),this.StandardFontDataFactory=new S.StandardFontDataFactory({baseUrl:S.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=c,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get stats(){return I(this,a)}getRenderingIntent(e,i=_util.AnnotationMode.ENABLE,c=null,S=!1){let E=_util.RenderingIntentFlag.DISPLAY,h=null;switch(e){case"any":E=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":E=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${e}`)}switch(i){case _util.AnnotationMode.DISABLE:E+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:E+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:E+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,h=(E&_util.RenderingIntentFlag.PRINT&&c instanceof _annotation_storage.PrintAnnotationStorage?c:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${i}`)}return S&&(E+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:E,cacheKey:`${E}_${_annotation_storage.AnnotationStorage.getHash(h)}`,annotationStorageMap:h}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const c of I(this,k).values())e.push(c._destroy());I(this,k).clear(),I(this,F).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const i=this.messageHandler.sendWithPromise("Terminate",null);return e.push(i),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),yt(this,T,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:i}=this;e.on("GetReader",(c,S)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=E=>{this._lastProgress={loaded:E.loaded,total:E.total}},S.onPull=()=>{this._fullReader.read().then(function({value:E,done:h}){if(h){S.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(E),"GetReader - expected an ArrayBuffer."),S.enqueue(new Uint8Array(E),1,[E])}).catch(E=>{S.error(E)})},S.onCancel=E=>{this._fullReader.cancel(E),S.ready.catch(h=>{if(!this.destroyed)throw h})}}),e.on("ReaderHeadersReady",c=>{const S=(0,_util.createPromiseCapability)(),E=this._fullReader;return E.headersReady.then(()=>{var h;(!E.isStreamingSupported||!E.isRangeSupported)&&(this._lastProgress&&((h=i.onProgress)==null||h.call(i,this._lastProgress)),E.onProgress=s=>{var o;(o=i.onProgress)==null||o.call(i,{loaded:s.loaded,total:s.total})}),S.resolve({isStreamingSupported:E.isStreamingSupported,isRangeSupported:E.isRangeSupported,contentLength:E.contentLength})},S.reject),S.promise}),e.on("GetRangeReader",(c,S)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const E=this._networkStream.getRangeReader(c.begin,c.end);if(!E){S.close();return}S.onPull=()=>{E.read().then(function({value:h,done:s}){if(s){S.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(h),"GetRangeReader - expected an ArrayBuffer."),S.enqueue(new Uint8Array(h),1,[h])}).catch(h=>{S.error(h)})},S.onCancel=h=>{E.cancel(h),S.ready.catch(s=>{if(!this.destroyed)throw s})}}),e.on("GetDoc",({pdfInfo:c})=>{this._numPages=c.numPages,this._htmlForXfa=c.htmlForXfa,delete c.htmlForXfa,i._capability.resolve(new PDFDocumentProxy(c,this))}),e.on("DocException",function(c){let S;switch(c.name){case"PasswordException":S=new _util.PasswordException(c.message,c.code);break;case"InvalidPDFException":S=new _util.InvalidPDFException(c.message);break;case"MissingPDFException":S=new _util.MissingPDFException(c.message);break;case"UnexpectedResponseException":S=new _util.UnexpectedResponseException(c.message,c.status);break;case"UnknownErrorException":S=new _util.UnknownErrorException(c.message,c.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}i._capability.reject(S)}),e.on("PasswordRequest",c=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),i.onPassword){const S=E=>{E instanceof Error?this._passwordCapability.reject(E):this._passwordCapability.resolve({password:E})};try{i.onPassword(S,c.code)}catch(E){this._passwordCapability.reject(E)}}else this._passwordCapability.reject(new _util.PasswordException(c.message,c.code));return this._passwordCapability.promise}),e.on("DataLoaded",c=>{var S;(S=i.onProgress)==null||S.call(i,{loaded:c.length,total:c.length}),this.downloadInfoCapability.resolve(c)}),e.on("StartRenderPage",c=>{if(this.destroyed)return;I(this,k).get(c.pageIndex)._startRenderPage(c.transparency,c.cacheKey)}),e.on("commonobj",([c,S,E])=>{var h;if(!this.destroyed&&!this.commonObjs.has(c))switch(S){case"Font":const s=this._params;if("error"in E){const M=E.error;(0,_util.warn)(`Error during font loading: ${M}`),this.commonObjs.resolve(c,M);break}let o=null;s.pdfBug&&((h=globalThis.FontInspector)!=null&&h.enabled)&&(o={registerFont(M,x){globalThis.FontInspector.fontAdded(M,x)}});const m=new _font_loader.FontFaceObject(E,{isEvalSupported:s.isEvalSupported,disableFontFace:s.disableFontFace,ignoreErrors:s.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:o});this.fontLoader.bind(m).catch(M=>e.sendWithPromise("FontFallback",{id:c})).finally(()=>{!s.fontExtraProperties&&m.data&&(m.data=null),this.commonObjs.resolve(c,m)});break;case"FontPath":case"Image":this.commonObjs.resolve(c,E);break;default:throw new Error(`Got unknown common object type ${S}`)}}),e.on("obj",([c,S,E,h])=>{var o;if(this.destroyed)return;const s=I(this,k).get(S);if(!s.objs.has(c))switch(E){case"Image":s.objs.resolve(c,h);const m=8e6;if(h){let M;if(h.bitmap){const{bitmap:x,width:y,height:D}=h;M=y*D*4,s._bitmaps.add(x)}else M=((o=h.data)==null?void 0:o.length)||0;M>m&&(s.cleanupAfterRender=!0)}break;case"Pattern":s.objs.resolve(c,h);break;default:throw new Error(`Got unknown object type ${E}`)}}),e.on("DocProgress",c=>{var S;this.destroyed||(S=i.onProgress)==null||S.call(i,{loaded:c.loaded,total:c.total})}),e.on("DocStats",c=>{this.destroyed||yt(this,a,Object.freeze({streamTypes:Object.freeze(c.streamTypes),fontTypes:Object.freeze(c.fontTypes)}))}),e.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),e.on("FetchBuiltInCMap",c=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(c):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),e.on("FetchStandardFontData",c=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(c):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:e}){var i,c;this.destroyed||(c=(i=this.loadingTask).onUnsupportedFeature)==null||c.call(i,e)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const i=e-1,c=I(this,F).get(i);if(c)return c;const S=this.messageHandler.sendWithPromise("GetPage",{pageIndex:i}).then(E=>{if(this.destroyed)throw new Error("Transport destroyed");const h=new PDFPageProxy(i,E,this,this._params.ownerDocument,this._params.pdfBug);return I(this,k).set(i,h),h});return I(this,F).set(i,S),S}getPageIndex(e){return typeof e!="object"||e===null||!Number.isInteger(e.num)||e.num<0||!Number.isInteger(e.gen)||e.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen})}getAnnotations(e,i){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:i})}saveDocument(){var e;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:((e=this._fullReader)==null?void 0:e.filename)??null}).finally(()=>{this.annotationStorage.resetModified()})}getFieldObjects(){return this._getFieldObjectsPromise||(this._getFieldObjectsPromise=this.messageHandler.sendWithPromise("GetFieldObjects",null))}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(e=>new _optional_content_config.OptionalContentConfig(e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return I(this,T)||yt(this,T,this.messageHandler.sendWithPromise("GetMetadata",null).then(e=>{var i,c;return{info:e[0],metadata:e[1]?new _metadata.Metadata(e[1]):null,contentDispositionFilename:((i=this._fullReader)==null?void 0:i.filename)??null,contentLength:((c=this._fullReader)==null?void 0:c.contentLength)??null}}))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(await this.messageHandler.sendWithPromise("Cleanup",null),!this.destroyed){for(const i of I(this,k).values())if(!i.cleanup())throw new Error(`startCleanup: Page ${i.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),yt(this,T,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null}}get loadingParams(){const e=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:e.disableAutoFetch,enableXfa:e.enableXfa})}}a=new WeakMap,k=new WeakMap,F=new WeakMap,T=new WeakMap;class PDFObjects{constructor(){ot(this,f);ot(this,v,Object.create(null))}get(e,i=null){if(i){const S=ut(this,f,le).call(this,e);return S.capability.promise.then(()=>i(S.data)),null}const c=I(this,v)[e];if(!(c!=null&&c.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${e}.`);return c.data}has(e){const i=I(this,v)[e];return(i==null?void 0:i.capability.settled)||!1}resolve(e,i=null){const c=ut(this,f,le).call(this,e);c.data=i,c.capability.resolve()}clear(){yt(this,v,Object.create(null))}}v=new WeakMap,f=new WeakSet,le=function(e){const i=I(this,v)[e];return i||(I(this,v)[e]={capability:(0,_util.createPromiseCapability)(),data:null})};class RenderTask{constructor(e){ot(this,N,null);yt(this,N,e),this.onContinue=null}get promise(){return I(this,N).capability.promise}cancel(){I(this,N).cancel()}get separateAnnots(){const{separateAnnots:e}=I(this,N).operatorList;if(!e)return!1;const{annotationCanvasMap:i}=I(this,N);return e.form||e.canvas&&(i==null?void 0:i.size)>0}}N=new WeakMap,exports.RenderTask=RenderTask;const P=class{constructor({callback:e,params:i,objs:c,commonObjs:S,annotationCanvasMap:E,operatorList:h,pageIndex:s,canvasFactory:o,useRequestAnimationFrame:m=!1,pdfBug:M=!1,pageColors:x=null}){this.callback=e,this.params=i,this.objs=c,this.commonObjs=S,this.annotationCanvasMap=E,this.operatorListIdx=null,this.operatorList=h,this._pageIndex=s,this.canvasFactory=o,this._pdfBug=M,this.pageColors=x,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=m===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=i.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:i}){var o;if(this.cancelled)return;if(this._canvas){if(I(P,w).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");I(P,w).add(this._canvas)}this._pdfBug&&((o=globalThis.StepperManager)!=null&&o.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:c,viewport:S,transform:E,imageLayer:h,background:s}=this.params;this.gfx=new _canvas.CanvasGraphics(c,this.commonObjs,this.objs,this.canvasFactory,h,i,this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:E,viewport:S,transparency:e,background:s}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(e=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&I(P,w).delete(this._canvas),this.callback(e||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}this.stepper&&this.stepper.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&I(P,w).delete(this._canvas),this.callback())))}};let InternalRenderTask=P;w=new WeakMap,ot(InternalRenderTask,w,new WeakSet);const version="2.16.105";exports.version=version;const build="172ccdbe5";exports.build=build},(_,n,b)=>{var v,xe,R;Object.defineProperty(n,"__esModule",{value:!0}),n.PrintAnnotationStorage=n.AnnotationStorage=void 0;var t=b(1),a=b(6),k=b(10);class F{constructor(){ot(this,v);this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(w,P){const u=this._storage.get(w);return u===void 0?P:Object.assign(P,u)}getRawValue(w){return this._storage.get(w)}remove(w){if(this._storage.delete(w),this._storage.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const P of this._storage.values())if(P instanceof a.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(w,P){const u=this._storage.get(w);let e=!1;if(u!==void 0)for(const[i,c]of Object.entries(P))u[i]!==c&&(e=!0,u[i]=c);else e=!0,this._storage.set(w,P);e&&ut(this,v,xe).call(this),P instanceof a.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(P.constructor._type)}has(w){return this._storage.has(w)}getAll(){return this._storage.size>0?(0,t.objectFromMap)(this._storage):null}get size(){return this._storage.size}resetModified(){this._modified&&(this._modified=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new T(this)}get serializable(){if(this._storage.size===0)return null;const w=new Map;for(const[P,u]of this._storage){const e=u instanceof a.AnnotationEditor?u.serialize():u;e&&w.set(P,e)}return w}static getHash(w){if(!w)return"";const P=new k.MurmurHash3_64;for(const[u,e]of w)P.update(`${u}:${JSON.stringify(e)}`);return P.hexdigest()}}v=new WeakSet,xe=function(){this._modified||(this._modified=!0,typeof this.onSetModified=="function"&&this.onSetModified())},n.AnnotationStorage=F;class T extends F{constructor(P){super();ot(this,R,null);yt(this,R,structuredClone(P.serializable))}get print(){(0,t.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return I(this,R)}}R=new WeakMap,n.PrintAnnotationStorage=T},(_,n,b)=>{var F,T,v,f,R,N;Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationEditor=void 0;var t=b(7),a=b(1);const w=class{constructor(u){ot(this,F,this.focusin.bind(this));ot(this,T,this.focusout.bind(this));ot(this,v,!1);ot(this,f,!1);ot(this,R,!1);ot(this,N,w._zIndex++);this.constructor===w&&(0,a.unreachable)("Cannot initialize AnnotationEditor."),this.parent=u.parent,this.id=u.id,this.width=this.height=null,this.pageIndex=u.parent.pageIndex,this.name=u.name,this.div=null;const[e,i]=this.parent.viewportBaseDimensions;this.x=u.x/e,this.y=u.y/i,this.rotation=this.parent.viewport.rotation,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,a.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=I(this,N)}focusin(u){I(this,v)?yt(this,v,!1):this.parent.setSelected(this)}focusout(u){if(!this.isAttachedToDOM)return;const e=u.relatedTarget;e!=null&&e.closest(`#${this.id}`)||(u.preventDefault(),this.parent.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.parent.addToAnnotationStorage(this)}dragstart(u){const e=this.parent.div.getBoundingClientRect();this.startX=u.clientX-e.x,this.startY=u.clientY-e.y,u.dataTransfer.setData("text/plain",this.id),u.dataTransfer.effectAllowed="move"}setAt(u,e,i,c){const[S,E]=this.parent.viewportBaseDimensions;[i,c]=this.screenToPageTranslation(i,c),this.x=(u+i)/S,this.y=(e+c)/E,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(u,e){const[i,c]=this.parent.viewportBaseDimensions;[u,e]=this.screenToPageTranslation(u,e),this.x+=u/i,this.y+=e/c,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(u,e){const{rotation:i}=this.parent.viewport;switch(i){case 90:return[e,-u];case 180:return[-u,-e];case 270:return[-e,u];default:return[u,e]}}setDims(u,e){const[i,c]=this.parent.viewportBaseDimensions;this.div.style.width=`${100*u/i}%`,this.div.style.height=`${100*e/c}%`}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",I(this,F)),this.div.addEventListener("focusout",I(this,T));const[u,e]=this.getInitialTranslation();return this.translate(u,e),(0,t.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(u){const e=t.KeyboardManager.platform.isMac;if(u.button!==0||u.ctrlKey&&e){u.preventDefault();return}u.ctrlKey&&!e||u.shiftKey||u.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this),yt(this,v,!0)}getRect(u,e){const[i,c]=this.parent.viewportBaseDimensions,[S,E]=this.parent.pageDimensions,h=S*u/i,s=E*e/c,o=this.x*S,m=this.y*E,M=this.width*S,x=this.height*E;switch(this.rotation){case 0:return[o+h,E-m-s-x,o+h+M,E-m-s];case 90:return[o+s,E-m+h,o+s+x,E-m+h+M];case 180:return[o-h-M,E-m+s,o-h,E-m+s+x];case 270:return[o-s-x,E-m-h-M,o-s,E-m-h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(u,e){const[i,c,S,E]=u,h=S-i,s=E-c;switch(this.rotation){case 0:return[i,e-E,h,s];case 90:return[i,e-c,s,h];case 180:return[S,e-c,h,s];case 270:return[S,e-E,s,h];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){yt(this,R,!0)}disableEditMode(){yt(this,R,!1)}isInEditMode(){return I(this,R)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var u;(u=this.div)==null||u.addEventListener("focusin",I(this,F))}serialize(){(0,a.unreachable)("An editor must be serializable")}static deserialize(u,e){const i=new this.prototype.constructor({parent:e,id:e.getNextId()});i.rotation=u.rotation;const[c,S]=e.pageDimensions,[E,h,s,o]=i.getRectInCurrentCoords(u.rect,S);return i.x=E/c,i.y=h/S,i.width=s/c,i.height=o/S,i}remove(){this.div.removeEventListener("focusin",I(this,F)),this.div.removeEventListener("focusout",I(this,T)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var u;(u=this.div)==null||u.classList.add("selectedEditor")}unselect(){var u;(u=this.div)==null||u.classList.remove("selectedEditor")}updateParams(u,e){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return I(this,f)}set isEditing(u){yt(this,f,u),u?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};let k=w;F=new WeakMap,T=new WeakMap,v=new WeakMap,f=new WeakMap,R=new WeakMap,N=new WeakMap,Mt(k,"_colorManager",new t.ColorManager),Mt(k,"_zIndex",1),n.AnnotationEditor=k},(_,n,b)=>{var P,u,e,i,c,S,Pe,s,m,M,x,y,D,et,it,Z,J,G,V,Y,rt,ct,bt,W,p,d,Ce,U,ce,q,Wt,X,Qt,g,we,C,Re,H,he,dt,Zt,lt,ee;Object.defineProperty(n,"__esModule",{value:!0}),n.KeyboardManager=n.CommandManager=n.ColorManager=n.AnnotationEditorUIManager=void 0,n.bindEvents=k,n.opacityToHex=F;var t=b(1),a=b(8);function k(ft,j,pt){for(const vt of pt)j.addEventListener(vt,ft[vt].bind(ft))}function F(ft){return Math.round(Math.min(255,Math.max(1,255*ft))).toString(16).padStart(2,"0")}class T{constructor(){ot(this,P,0)}getId(){return`${t.AnnotationEditorPrefix}${oe(this,P)._++}`}}P=new WeakMap;class v{constructor(j=128){ot(this,u,[]);ot(this,e,!1);ot(this,i,void 0);ot(this,c,-1);yt(this,i,j)}add({cmd:j,undo:pt,mustExec:vt,type:St=NaN,overwriteIfSameType:Tt=!1,keepUndo:Pt=!1}){if(vt&&j(),I(this,e))return;const Ot={cmd:j,undo:pt,type:St};if(I(this,c)===-1){I(this,u).length>0&&(I(this,u).length=0),yt(this,c,0),I(this,u).push(Ot);return}if(Tt&&I(this,u)[I(this,c)].type===St){Pt&&(Ot.undo=I(this,u)[I(this,c)].undo),I(this,u)[I(this,c)]=Ot;return}const Ft=I(this,c)+1;Ft===I(this,i)?I(this,u).splice(0,1):(yt(this,c,Ft),Ft<I(this,u).length&&I(this,u).splice(Ft)),I(this,u).push(Ot)}undo(){I(this,c)!==-1&&(yt(this,e,!0),I(this,u)[I(this,c)].undo(),yt(this,e,!1),yt(this,c,I(this,c)-1))}redo(){I(this,c)<I(this,u).length-1&&(yt(this,c,I(this,c)+1),yt(this,e,!0),I(this,u)[I(this,c)].cmd(),yt(this,e,!1))}hasSomethingToUndo(){return I(this,c)!==-1}hasSomethingToRedo(){return I(this,c)<I(this,u).length-1}destroy(){yt(this,u,null)}}u=new WeakMap,e=new WeakMap,i=new WeakMap,c=new WeakMap,n.CommandManager=v;const h=class{constructor(j){ot(this,S);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const pt=h.platform.isMac;for(const[vt,St]of j)for(const Tt of vt){const Pt=Tt.startsWith("mac+");pt&&Pt?(this.callbacks.set(Tt.slice(4),St),this.allKeys.add(Tt.split("+").at(-1))):!pt&&!Pt&&(this.callbacks.set(Tt,St),this.allKeys.add(Tt.split("+").at(-1)))}}static get platform(){const j=typeof navigator<"u"?navigator.platform:"";return(0,t.shadow)(this,"platform",{isWin:j.includes("Win"),isMac:j.includes("Mac")})}exec(j,pt){if(!this.allKeys.has(pt.key))return;const vt=this.callbacks.get(ut(this,S,Pe).call(this,pt));vt&&(vt.bind(j)(),pt.stopPropagation(),pt.preventDefault())}};let f=h;S=new WeakSet,Pe=function(j){j.altKey&&this.buffer.push("alt"),j.ctrlKey&&this.buffer.push("ctrl"),j.metaKey&&this.buffer.push("meta"),j.shiftKey&&this.buffer.push("shift"),this.buffer.push(j.key);const pt=this.buffer.join("+");return this.buffer.length=0,pt},n.KeyboardManager=f;class R{constructor(){ot(this,s,null)}copy(j){j&&(Array.isArray(j)?yt(this,s,j.map(pt=>pt.serialize())):yt(this,s,[j.serialize()]),yt(this,s,I(this,s).filter(pt=>!!pt)),I(this,s).length===0&&yt(this,s,null))}paste(){return I(this,s)}isEmpty(){return I(this,s)===null}destroy(){yt(this,s,null)}}s=new WeakMap;const o=class{get _colors(){const j=new Map([["CanvasText",null],["Canvas",null]]);return(0,a.getColorValues)(j),(0,t.shadow)(this,"_colors",j)}convert(j){const pt=(0,a.getRGB)(j);if(!window.matchMedia("(forced-colors: active)").matches)return pt;for(const[vt,St]of this._colors)if(St.every((Tt,Pt)=>Tt===pt[Pt]))return o._colorsMapping.get(vt);return pt}getHexCode(j){const pt=this._colors.get(j);return pt?t.Util.makeHexColor(...pt):j}};let N=o;Mt(N,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]])),n.ColorManager=N;const ht=class{constructor(j,pt){ot(this,d);ot(this,U);ot(this,q);ot(this,X);ot(this,g);ot(this,C);ot(this,H);ot(this,dt);ot(this,lt);ot(this,m,null);ot(this,M,new Map);ot(this,x,new Map);ot(this,y,new R);ot(this,D,new v);ot(this,et,0);ot(this,it,null);ot(this,Z,null);ot(this,J,new T);ot(this,G,!1);ot(this,V,t.AnnotationEditorType.NONE);ot(this,Y,new Set);ot(this,rt,this.keydown.bind(this));ot(this,ct,this.onEditingAction.bind(this));ot(this,bt,this.onPageChanging.bind(this));ot(this,W,{isEditing:!1,isEmpty:!0,hasEmptyClipboard:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});ot(this,p,null);yt(this,p,j),yt(this,Z,pt),I(this,Z)._on("editingaction",I(this,ct)),I(this,Z)._on("pagechanging",I(this,bt))}destroy(){ut(this,U,ce).call(this),I(this,Z)._off("editingaction",I(this,ct)),I(this,Z)._off("pagechanging",I(this,bt));for(const j of I(this,x).values())j.destroy();I(this,x).clear(),I(this,M).clear(),yt(this,m,null),I(this,Y).clear(),I(this,y).destroy(),I(this,D).destroy()}onPageChanging({pageNumber:j}){yt(this,et,j-1)}focusMainContainer(){I(this,p).focus()}keydown(j){var pt;(pt=this.getActive())!=null&&pt.shouldGetKeyboardEvents()||ht._keyboardManager.exec(this,j)}onEditingAction(j){["undo","redo","cut","copy","paste","delete","selectAll"].includes(j.name)&&this[j.name]()}setEditingState(j){j?(ut(this,d,Ce).call(this),ut(this,q,Wt).call(this,{isEditing:I(this,V)!==t.AnnotationEditorType.NONE,isEmpty:ut(this,dt,Zt).call(this),hasSomethingToUndo:I(this,D).hasSomethingToUndo(),hasSomethingToRedo:I(this,D).hasSomethingToRedo(),hasSelectedEditor:!1,hasEmptyClipboard:I(this,y).isEmpty()})):(ut(this,U,ce).call(this),ut(this,q,Wt).call(this,{isEditing:!1}))}registerEditorTypes(j){yt(this,it,j);for(const pt of I(this,it))ut(this,X,Qt).call(this,pt.defaultPropertiesToUpdate)}getId(){return I(this,J).getId()}addLayer(j){I(this,x).set(j.pageIndex,j),I(this,G)?j.enable():j.disable()}removeLayer(j){I(this,x).delete(j.pageIndex)}updateMode(j){if(yt(this,V,j),j===t.AnnotationEditorType.NONE)this.setEditingState(!1),ut(this,C,Re).call(this);else{this.setEditingState(!0),ut(this,g,we).call(this);for(const pt of I(this,x).values())pt.updateMode(j)}}updateToolbar(j){j!==I(this,V)&&I(this,Z).dispatch("switchannotationeditormode",{source:this,mode:j})}updateParams(j,pt){for(const vt of I(this,Y))vt.updateParams(j,pt);for(const vt of I(this,it))vt.updateDefaultParams(j,pt)}getEditors(j){const pt=[];for(const vt of I(this,M).values())vt.pageIndex===j&&pt.push(vt);return pt}getEditor(j){return I(this,M).get(j)}addEditor(j){I(this,M).set(j.id,j)}removeEditor(j){I(this,M).delete(j.id),this.unselect(j)}setActiveEditor(j){I(this,m)!==j&&(yt(this,m,j),j&&ut(this,X,Qt).call(this,j.propertiesToUpdate))}toggleSelected(j){if(I(this,Y).has(j)){I(this,Y).delete(j),j.unselect(),ut(this,q,Wt).call(this,{hasSelectedEditor:this.hasSelection});return}I(this,Y).add(j),j.select(),ut(this,X,Qt).call(this,j.propertiesToUpdate),ut(this,q,Wt).call(this,{hasSelectedEditor:!0})}setSelected(j){for(const pt of I(this,Y))pt!==j&&pt.unselect();I(this,Y).clear(),I(this,Y).add(j),j.select(),ut(this,X,Qt).call(this,j.propertiesToUpdate),ut(this,q,Wt).call(this,{hasSelectedEditor:!0})}isSelected(j){return I(this,Y).has(j)}unselect(j){j.unselect(),I(this,Y).delete(j),ut(this,q,Wt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return I(this,Y).size!==0}undo(){I(this,D).undo(),ut(this,q,Wt).call(this,{hasSomethingToUndo:I(this,D).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:ut(this,dt,Zt).call(this)})}redo(){I(this,D).redo(),ut(this,q,Wt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:I(this,D).hasSomethingToRedo(),isEmpty:ut(this,dt,Zt).call(this)})}addCommands(j){I(this,D).add(j),ut(this,q,Wt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:ut(this,dt,Zt).call(this)})}delete(){if(I(this,m)&&I(this,m).commitOrRemove(),!this.hasSelection)return;const j=[...I(this,Y)],pt=()=>{for(const St of j)St.remove()},vt=()=>{for(const St of j)ut(this,H,he).call(this,St)};this.addCommands({cmd:pt,undo:vt,mustExec:!0})}copy(){if(I(this,m)&&I(this,m).commitOrRemove(),this.hasSelection){const j=[];for(const pt of I(this,Y))pt.isEmpty()||j.push(pt);if(j.length===0)return;I(this,y).copy(j),ut(this,q,Wt).call(this,{hasEmptyClipboard:!1})}}cut(){this.copy(),this.delete()}paste(){if(I(this,y).isEmpty())return;this.unselectAll();const j=I(this,x).get(I(this,et)),pt=I(this,y).paste().map(Tt=>j.deserialize(Tt)),vt=()=>{for(const Tt of pt)ut(this,H,he).call(this,Tt);ut(this,lt,ee).call(this,pt)},St=()=>{for(const Tt of pt)Tt.remove()};this.addCommands({cmd:vt,undo:St,mustExec:!0})}selectAll(){for(const j of I(this,Y))j.commit();ut(this,lt,ee).call(this,I(this,M).values())}unselectAll(){if(I(this,m)){I(this,m).commitOrRemove();return}if(ut(this,lt,ee).size!==0){for(const j of I(this,Y))j.unselect();I(this,Y).clear(),ut(this,q,Wt).call(this,{hasSelectedEditor:!1})}}isActive(j){return I(this,m)===j}getActive(){return I(this,m)}getMode(){return I(this,V)}};let w=ht;m=new WeakMap,M=new WeakMap,x=new WeakMap,y=new WeakMap,D=new WeakMap,et=new WeakMap,it=new WeakMap,Z=new WeakMap,J=new WeakMap,G=new WeakMap,V=new WeakMap,Y=new WeakMap,rt=new WeakMap,ct=new WeakMap,bt=new WeakMap,W=new WeakMap,p=new WeakMap,d=new WeakSet,Ce=function(){I(this,p).addEventListener("keydown",I(this,rt))},U=new WeakSet,ce=function(){I(this,p).removeEventListener("keydown",I(this,rt))},q=new WeakSet,Wt=function(j){Object.entries(j).some(([vt,St])=>I(this,W)[vt]!==St)&&I(this,Z).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(I(this,W),j)})},X=new WeakSet,Qt=function(j){I(this,Z).dispatch("annotationeditorparamschanged",{source:this,details:j})},g=new WeakSet,we=function(){if(!I(this,G)){yt(this,G,!0);for(const j of I(this,x).values())j.enable()}},C=new WeakSet,Re=function(){if(this.unselectAll(),I(this,G)){yt(this,G,!1);for(const j of I(this,x).values())j.disable()}},H=new WeakSet,he=function(j){const pt=I(this,x).get(j.pageIndex);pt?pt.addOrRebuild(j):this.addEditor(j)},dt=new WeakSet,Zt=function(){if(I(this,M).size===0)return!0;if(I(this,M).size===1)for(const j of I(this,M).values())return j.isEmpty();return!1},lt=new WeakSet,ee=function(j){I(this,Y).clear();for(const pt of j)pt.isEmpty()||(I(this,Y).add(pt),pt.select());ut(this,q,Wt).call(this,{hasSelectedEditor:!0})},Mt(w,"_keyboardManager",new f([[["ctrl+a","mac+meta+a"],ht.prototype.selectAll],[["ctrl+c","mac+meta+c"],ht.prototype.copy],[["ctrl+v","mac+meta+v"],ht.prototype.paste],[["ctrl+x","mac+meta+x"],ht.prototype.cut],[["ctrl+z","mac+meta+z"],ht.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],ht.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],ht.prototype.delete],[["Escape","mac+Escape"],ht.prototype.unselectAll]])),n.AnnotationEditorUIManager=w},(_,n,b)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.StatTimer=n.RenderingCancelledException=n.PixelsPerInch=n.PageViewport=n.PDFDateString=n.DOMStandardFontDataFactory=n.DOMSVGFactory=n.DOMCanvasFactory=n.DOMCMapReaderFactory=n.AnnotationPrefix=void 0,n.deprecated=o,n.getColorValues=D,n.getCurrentTransform=et,n.getCurrentTransformInverse=it,n.getFilenameFromUrl=c,n.getPdfFilenameFromUrl=S,n.getRGB=y,n.getXfaPageViewport=x,n.isDataScheme=e,n.isPdfFile=i,n.isValidFetchUrl=h,n.loadScript=s;var t=b(9),a=b(1);const k="http://www.w3.org/2000/svg",F="pdfjs_internal_id_";n.AnnotationPrefix=F;const Z=class{};let T=Z;Mt(T,"CSS",96),Mt(T,"PDF",72),Mt(T,"PDF_TO_CSS_UNITS",Z.CSS/Z.PDF),n.PixelsPerInch=T;class v extends t.BaseCanvasFactory{constructor({ownerDocument:G=globalThis.document}={}){super(),this._document=G}_createCanvas(G,V){const Y=this._document.createElement("canvas");return Y.width=G,Y.height=V,Y}}n.DOMCanvasFactory=v;async function f(J,G=!1){if(h(J,document.baseURI)){const V=await fetch(J);if(!V.ok)throw new Error(V.statusText);return G?new Uint8Array(await V.arrayBuffer()):(0,a.stringToBytes)(await V.text())}return new Promise((V,Y)=>{const rt=new XMLHttpRequest;rt.open("GET",J,!0),G&&(rt.responseType="arraybuffer"),rt.onreadystatechange=()=>{if(rt.readyState===XMLHttpRequest.DONE){if(rt.status===200||rt.status===0){let ct;if(G&&rt.response?ct=new Uint8Array(rt.response):!G&&rt.responseText&&(ct=(0,a.stringToBytes)(rt.responseText)),ct){V(ct);return}}Y(new Error(rt.statusText))}},rt.send(null)})}class R extends t.BaseCMapReaderFactory{_fetchData(G,V){return f(G,this.isCompressed).then(Y=>({cMapData:Y,compressionType:V}))}}n.DOMCMapReaderFactory=R;class N extends t.BaseStandardFontDataFactory{_fetchData(G){return f(G,!0)}}n.DOMStandardFontDataFactory=N;class w extends t.BaseSVGFactory{_createSVG(G){return document.createElementNS(k,G)}}n.DOMSVGFactory=w;class P{constructor({viewBox:G,scale:V,rotation:Y,offsetX:rt=0,offsetY:ct=0,dontFlip:bt=!1}){this.viewBox=G,this.scale=V,this.rotation=Y,this.offsetX=rt,this.offsetY=ct;const W=(G[2]+G[0])/2,p=(G[3]+G[1])/2;let d,O,U,B;switch(Y%=360,Y<0&&(Y+=360),Y){case 180:d=-1,O=0,U=0,B=1;break;case 90:d=0,O=1,U=1,B=0;break;case 270:d=0,O=-1,U=-1,B=0;break;case 0:d=1,O=0,U=0,B=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}bt&&(U=-U,B=-B);let q,K,X,l;d===0?(q=Math.abs(p-G[1])*V+rt,K=Math.abs(W-G[0])*V+ct,X=Math.abs(G[3]-G[1])*V,l=Math.abs(G[2]-G[0])*V):(q=Math.abs(W-G[0])*V+rt,K=Math.abs(p-G[1])*V+ct,X=Math.abs(G[2]-G[0])*V,l=Math.abs(G[3]-G[1])*V),this.transform=[d*V,O*V,U*V,B*V,q-d*V*W-U*V*p,K-O*V*W-B*V*p],this.width=X,this.height=l}clone({scale:G=this.scale,rotation:V=this.rotation,offsetX:Y=this.offsetX,offsetY:rt=this.offsetY,dontFlip:ct=!1}={}){return new P({viewBox:this.viewBox.slice(),scale:G,rotation:V,offsetX:Y,offsetY:rt,dontFlip:ct})}convertToViewportPoint(G,V){return a.Util.applyTransform([G,V],this.transform)}convertToViewportRectangle(G){const V=a.Util.applyTransform([G[0],G[1]],this.transform),Y=a.Util.applyTransform([G[2],G[3]],this.transform);return[V[0],V[1],Y[0],Y[1]]}convertToPdfPoint(G,V){return a.Util.applyInverseTransform([G,V],this.transform)}}n.PageViewport=P;class u extends a.BaseException{constructor(G,V){super(G,"RenderingCancelledException"),this.type=V}}n.RenderingCancelledException=u;function e(J){const G=J.length;let V=0;for(;V<G&&J[V].trim()==="";)V++;return J.substring(V,V+5).toLowerCase()==="data:"}function i(J){return typeof J=="string"&&/\.pdf$/i.test(J)}function c(J){const G=J.indexOf("#"),V=J.indexOf("?"),Y=Math.min(G>0?G:J.length,V>0?V:J.length);return J.substring(J.lastIndexOf("/",Y)+1,Y)}function S(J,G="document.pdf"){if(typeof J!="string")return G;if(e(J))return(0,a.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),G;const V=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,Y=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,rt=V.exec(J);let ct=Y.exec(rt[1])||Y.exec(rt[2])||Y.exec(rt[3]);if(ct&&(ct=ct[0],ct.includes("%")))try{ct=Y.exec(decodeURIComponent(ct))[0]}catch{}return ct||G}class E{constructor(){this.started=Object.create(null),this.times=[]}time(G){G in this.started&&(0,a.warn)(`Timer is already running for ${G}`),this.started[G]=Date.now()}timeEnd(G){G in this.started||(0,a.warn)(`Timer has not been started for ${G}`),this.times.push({name:G,start:this.started[G],end:Date.now()}),delete this.started[G]}toString(){const G=[];let V=0;for(const Y of this.times){const rt=Y.name;rt.length>V&&(V=rt.length)}for(const Y of this.times){const rt=Y.end-Y.start;G.push(`${Y.name.padEnd(V)} ${rt}ms
`)}return G.join("")}}n.StatTimer=E;function h(J,G){try{const{protocol:V}=G?new URL(J,G):new URL(J);return V==="http:"||V==="https:"}catch{return!1}}function s(J,G=!1){return new Promise((V,Y)=>{const rt=document.createElement("script");rt.src=J,rt.onload=function(ct){G&&rt.remove(),V(ct)},rt.onerror=function(){Y(new Error(`Cannot load script at: ${rt.src}`))},(document.head||document.documentElement).append(rt)})}function o(J){console.log("Deprecated API usage: "+J)}let m;class M{static toDateObject(G){if(!G||typeof G!="string")return null;m||(m=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const V=m.exec(G);if(!V)return null;const Y=parseInt(V[1],10);let rt=parseInt(V[2],10);rt=rt>=1&&rt<=12?rt-1:0;let ct=parseInt(V[3],10);ct=ct>=1&&ct<=31?ct:1;let bt=parseInt(V[4],10);bt=bt>=0&&bt<=23?bt:0;let W=parseInt(V[5],10);W=W>=0&&W<=59?W:0;let p=parseInt(V[6],10);p=p>=0&&p<=59?p:0;const d=V[7]||"Z";let O=parseInt(V[8],10);O=O>=0&&O<=23?O:0;let U=parseInt(V[9],10)||0;return U=U>=0&&U<=59?U:0,d==="-"?(bt+=O,W+=U):d==="+"&&(bt-=O,W-=U),new Date(Date.UTC(Y,rt,ct,bt,W,p))}}n.PDFDateString=M;function x(J,{scale:G=1,rotation:V=0}){const{width:Y,height:rt}=J.attributes.style,ct=[0,0,parseInt(Y),parseInt(rt)];return new P({viewBox:ct,scale:G,rotation:V})}function y(J){if(J.startsWith("#")){const G=parseInt(J.slice(1),16);return[(G&16711680)>>16,(G&65280)>>8,G&255]}return J.startsWith("rgb(")?J.slice(4,-1).split(",").map(G=>parseInt(G)):J.startsWith("rgba(")?J.slice(5,-1).split(",").map(G=>parseInt(G)).slice(0,3):((0,a.warn)(`Not a valid color format: "${J}"`),[0,0,0])}function D(J){const G=document.createElement("span");G.style.visibility="hidden",document.body.append(G);for(const V of J.keys()){G.style.color=V;const Y=window.getComputedStyle(G).color;J.set(V,y(Y))}G.remove()}function et(J){const{a:G,b:V,c:Y,d:rt,e:ct,f:bt}=J.getTransform();return[G,V,Y,rt,ct,bt]}function it(J){const{a:G,b:V,c:Y,d:rt,e:ct,f:bt}=J.getTransform().invertSelf();return[G,V,Y,rt,ct,bt]}},(_,n,b)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BaseStandardFontDataFactory=n.BaseSVGFactory=n.BaseCanvasFactory=n.BaseCMapReaderFactory=void 0;var t=b(1);class a{constructor(){this.constructor===a&&(0,t.unreachable)("Cannot initialize BaseCanvasFactory.")}create(f,R){if(f<=0||R<=0)throw new Error("Invalid canvas size");const N=this._createCanvas(f,R);return{canvas:N,context:N.getContext("2d")}}reset(f,R,N){if(!f.canvas)throw new Error("Canvas is not specified");if(R<=0||N<=0)throw new Error("Invalid canvas size");f.canvas.width=R,f.canvas.height=N}destroy(f){if(!f.canvas)throw new Error("Canvas is not specified");f.canvas.width=0,f.canvas.height=0,f.canvas=null,f.context=null}_createCanvas(f,R){(0,t.unreachable)("Abstract method `_createCanvas` called.")}}n.BaseCanvasFactory=a;class k{constructor({baseUrl:f=null,isCompressed:R=!1}){this.constructor===k&&(0,t.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=f,this.isCompressed=R}async fetch({name:f}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!f)throw new Error("CMap name must be specified.");const R=this.baseUrl+f+(this.isCompressed?".bcmap":""),N=this.isCompressed?t.CMapCompressionType.BINARY:t.CMapCompressionType.NONE;return this._fetchData(R,N).catch(w=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${R}`)})}_fetchData(f,R){(0,t.unreachable)("Abstract method `_fetchData` called.")}}n.BaseCMapReaderFactory=k;class F{constructor({baseUrl:f=null}){this.constructor===F&&(0,t.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=f}async fetch({filename:f}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!f)throw new Error("Font filename must be specified.");const R=`${this.baseUrl}${f}`;return this._fetchData(R).catch(N=>{throw new Error(`Unable to load font data at: ${R}`)})}_fetchData(f){(0,t.unreachable)("Abstract method `_fetchData` called.")}}n.BaseStandardFontDataFactory=F;class T{constructor(){this.constructor===T&&(0,t.unreachable)("Cannot initialize BaseSVGFactory.")}create(f,R,N=!1){if(f<=0||R<=0)throw new Error("Invalid SVG dimensions");const w=this._createSVG("svg:svg");return w.setAttribute("version","1.1"),N||(w.setAttribute("width",`${f}px`),w.setAttribute("height",`${R}px`)),w.setAttribute("preserveAspectRatio","none"),w.setAttribute("viewBox",`0 0 ${f} ${R}`),w}createElement(f){if(typeof f!="string")throw new Error("Invalid SVG element type");return this._createSVG(f)}_createSVG(f){(0,t.unreachable)("Abstract method `_createSVG` called.")}}n.BaseSVGFactory=T},(_,n,b)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.MurmurHash3_64=void 0;var t=b(1);const a=3285377520,k=4294901760,F=65535;class T{constructor(f){this.h1=f?f&4294967295:a,this.h2=f?f&4294967295:a}update(f){let R,N;if(typeof f=="string"){R=new Uint8Array(f.length*2),N=0;for(let m=0,M=f.length;m<M;m++){const x=f.charCodeAt(m);x<=255?R[N++]=x:(R[N++]=x>>>8,R[N++]=x&255)}}else if((0,t.isArrayBuffer)(f))R=f.slice(),N=R.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const w=N>>2,P=N-w*4,u=new Uint32Array(R.buffer,0,w);let e=0,i=0,c=this.h1,S=this.h2;const E=3432918353,h=461845907,s=E&F,o=h&F;for(let m=0;m<w;m++)m&1?(e=u[m],e=e*E&k|e*s&F,e=e<<15|e>>>17,e=e*h&k|e*o&F,c^=e,c=c<<13|c>>>19,c=c*5+3864292196):(i=u[m],i=i*E&k|i*s&F,i=i<<15|i>>>17,i=i*h&k|i*o&F,S^=i,S=S<<13|S>>>19,S=S*5+3864292196);switch(e=0,P){case 3:e^=R[w*4+2]<<16;case 2:e^=R[w*4+1]<<8;case 1:e^=R[w*4],e=e*E&k|e*s&F,e=e<<15|e>>>17,e=e*h&k|e*o&F,w&1?c^=e:S^=e}this.h1=c,this.h2=S}hexdigest(){let f=this.h1,R=this.h2;f^=R>>>1,f=f*3981806797&k|f*36045&F,R=R*4283543511&k|((R<<16|f>>>16)*2950163797&k)>>>16,f^=R>>>1,f=f*444984403&k|f*60499&F,R=R*3301882366&k|((R<<16|f>>>16)*3120437893&k)>>>16,f^=R>>>1;const N=(f>>>0).toString(16),w=(R>>>0).toString(16);return N.padStart(8,"0")+w.padStart(8,"0")}}n.MurmurHash3_64=T},(_,n,b)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.FontLoader=n.FontFaceObject=void 0;var t=b(1);class a{constructor({docId:v,onUnsupportedFeature:f,ownerDocument:R=globalThis.document,styleElement:N=null}){this.constructor===a&&(0,t.unreachable)("Cannot initialize BaseFontLoader."),this.docId=v,this._onUnsupportedFeature=f,this._document=R,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(v){this.nativeFontFaces.push(v),this._document.fonts.add(v)}insertRule(v){let f=this.styleElement;f||(f=this.styleElement=this._document.createElement("style"),f.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].append(f));const R=f.sheet;R.insertRule(v,R.cssRules.length)}clear(){for(const v of this.nativeFontFaces)this._document.fonts.delete(v);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(v){if(v.attached||v.missingFile)return;if(v.attached=!0,this.isFontLoadingAPISupported){const R=v.createNativeFontFace();if(R){this.addNativeFontFace(R);try{await R.loaded}catch(N){throw this._onUnsupportedFeature({featureId:t.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,t.warn)(`Failed to load font '${R.family}': '${N}'.`),v.disableFontFace=!0,N}}return}const f=v.createFontFaceRule();if(f){if(this.insertRule(f),this.isSyncFontLoadingSupported)return;await new Promise(R=>{const N=this._queueLoadingCallback(R);this._prepareFontLoadEvent([f],[v],N)})}}_queueLoadingCallback(v){(0,t.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){var f;const v=!!((f=this._document)!=null&&f.fonts);return(0,t.shadow)(this,"isFontLoadingAPISupported",v)}get isSyncFontLoadingSupported(){(0,t.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,t.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(v,f,R){(0,t.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let k;n.FontLoader=k,n.FontLoader=k=class extends a{constructor(v){super(v),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let v=!1;if(typeof navigator>"u")v=!0;else{const f=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);(f==null?void 0:f[1])>=14&&(v=!0)}return(0,t.shadow)(this,"isSyncFontLoadingSupported",v)}_queueLoadingCallback(v){function f(){for((0,t.assert)(!N.done,"completeRequest() cannot be called twice."),N.done=!0;R.requests.length>0&&R.requests[0].done;){const w=R.requests.shift();setTimeout(w.callback,0)}}const R=this.loadingContext,N={id:`pdfjs-font-loading-${R.nextRequestId++}`,done:!1,complete:f,callback:v};return R.requests.push(N),N}get _loadTestFont(){const v=function(){return atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==")};return(0,t.shadow)(this,"_loadTestFont",v())}_prepareFontLoadEvent(v,f,R){function N(it,Z){return it.charCodeAt(Z)<<24|it.charCodeAt(Z+1)<<16|it.charCodeAt(Z+2)<<8|it.charCodeAt(Z+3)&255}function w(it,Z,J,G){const V=it.substring(0,Z),Y=it.substring(Z+J);return V+G+Y}let P,u;const e=this._document.createElement("canvas");e.width=1,e.height=1;const i=e.getContext("2d");let c=0;function S(it,Z){if(c++,c>30){(0,t.warn)("Load test font never loaded."),Z();return}if(i.font="30px "+it,i.fillText(".",0,20),i.getImageData(0,0,1,1).data[3]>0){Z();return}setTimeout(S.bind(null,it,Z))}const E=`lt${Date.now()}${this.loadTestFontId++}`;let h=this._loadTestFont;h=w(h,976,E.length,E);const o=16,m=1482184792;let M=N(h,o);for(P=0,u=E.length-3;P<u;P+=4)M=M-m+N(E,P)|0;P<E.length&&(M=M-m+N(E+"XXX",P)|0),h=w(h,o,4,(0,t.string32)(M));const x=`url(data:font/opentype;base64,${btoa(h)});`,y=`@font-face {font-family:"${E}";src:${x}}`;this.insertRule(y);const D=[];for(const it of f)D.push(it.loadedName);D.push(E);const et=this._document.createElement("div");et.style.visibility="hidden",et.style.width=et.style.height="10px",et.style.position="absolute",et.style.top=et.style.left="0px";for(const it of D){const Z=this._document.createElement("span");Z.textContent="Hi",Z.style.fontFamily=it,et.append(Z)}this._document.body.append(et),S(E,()=>{et.remove(),R.complete()})}};class F{constructor(v,{isEvalSupported:f=!0,disableFontFace:R=!1,ignoreErrors:N=!1,onUnsupportedFeature:w,fontRegistry:P=null}){this.compiledGlyphs=Object.create(null);for(const u in v)this[u]=v[u];this.isEvalSupported=f!==!1,this.disableFontFace=R===!0,this.ignoreErrors=N===!0,this._onUnsupportedFeature=w,this.fontRegistry=P}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let v;if(!this.cssFontInfo)v=new FontFace(this.loadedName,this.data,{});else{const f={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(f.style=`oblique ${this.cssFontInfo.italicAngle}deg`),v=new FontFace(this.cssFontInfo.fontFamily,this.data,f)}return this.fontRegistry&&this.fontRegistry.registerFont(this),v}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const v=(0,t.bytesToString)(this.data),f=`url(data:${this.mimetype};base64,${btoa(v)});`;let R;if(!this.cssFontInfo)R=`@font-face {font-family:"${this.loadedName}";src:${f}}`;else{let N=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(N+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),R=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${N}src:${f}}`}return this.fontRegistry&&this.fontRegistry.registerFont(this,f),R}getPathGenerator(v,f){if(this.compiledGlyphs[f]!==void 0)return this.compiledGlyphs[f];let R;try{R=v.get(this.loadedName+"_path_"+f)}catch(N){if(!this.ignoreErrors)throw N;return this._onUnsupportedFeature({featureId:t.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,t.warn)(`getPathGenerator - ignoring character: "${N}".`),this.compiledGlyphs[f]=function(w,P){}}if(this.isEvalSupported&&t.FeatureTest.isEvalSupported){const N=[];for(const w of R){const P=w.args!==void 0?w.args.join(","):"";N.push("c.",w.cmd,"(",P,`);
`)}return this.compiledGlyphs[f]=new Function("c","size",N.join(""))}return this.compiledGlyphs[f]=function(N,w){for(const P of R)P.cmd==="scale"&&(P.args=[w,-w]),N[P.cmd].apply(N,P.args)}}}n.FontFaceObject=F},(_,n,b)=>{var rt,ue;Object.defineProperty(n,"__esModule",{value:!0}),n.CanvasGraphics=void 0;var t=b(8),a=b(1),k=b(13),F=b(14),T=b(3);const v=16,f=100,R=4096,N=15,w=10,P=T.isNodeJS&&typeof Path2D>"u"?-1:1e3,u=16;function e(W,p){if(W._removeMirroring)throw new Error("Context is already forwarding operations.");W.__originalSave=W.save,W.__originalRestore=W.restore,W.__originalRotate=W.rotate,W.__originalScale=W.scale,W.__originalTranslate=W.translate,W.__originalTransform=W.transform,W.__originalSetTransform=W.setTransform,W.__originalResetTransform=W.resetTransform,W.__originalClip=W.clip,W.__originalMoveTo=W.moveTo,W.__originalLineTo=W.lineTo,W.__originalBezierCurveTo=W.bezierCurveTo,W.__originalRect=W.rect,W.__originalClosePath=W.closePath,W.__originalBeginPath=W.beginPath,W._removeMirroring=()=>{W.save=W.__originalSave,W.restore=W.__originalRestore,W.rotate=W.__originalRotate,W.scale=W.__originalScale,W.translate=W.__originalTranslate,W.transform=W.__originalTransform,W.setTransform=W.__originalSetTransform,W.resetTransform=W.__originalResetTransform,W.clip=W.__originalClip,W.moveTo=W.__originalMoveTo,W.lineTo=W.__originalLineTo,W.bezierCurveTo=W.__originalBezierCurveTo,W.rect=W.__originalRect,W.closePath=W.__originalClosePath,W.beginPath=W.__originalBeginPath,delete W._removeMirroring},W.save=function(){p.save(),this.__originalSave()},W.restore=function(){p.restore(),this.__originalRestore()},W.translate=function(O,U){p.translate(O,U),this.__originalTranslate(O,U)},W.scale=function(O,U){p.scale(O,U),this.__originalScale(O,U)},W.transform=function(O,U,B,q,K,X){p.transform(O,U,B,q,K,X),this.__originalTransform(O,U,B,q,K,X)},W.setTransform=function(O,U,B,q,K,X){p.setTransform(O,U,B,q,K,X),this.__originalSetTransform(O,U,B,q,K,X)},W.resetTransform=function(){p.resetTransform(),this.__originalResetTransform()},W.rotate=function(O){p.rotate(O),this.__originalRotate(O)},W.clip=function(O){p.clip(O),this.__originalClip(O)},W.moveTo=function(d,O){p.moveTo(d,O),this.__originalMoveTo(d,O)},W.lineTo=function(d,O){p.lineTo(d,O),this.__originalLineTo(d,O)},W.bezierCurveTo=function(d,O,U,B,q,K){p.bezierCurveTo(d,O,U,B,q,K),this.__originalBezierCurveTo(d,O,U,B,q,K)},W.rect=function(d,O,U,B){p.rect(d,O,U,B),this.__originalRect(d,O,U,B)},W.closePath=function(){p.closePath(),this.__originalClosePath()},W.beginPath=function(){p.beginPath(),this.__originalBeginPath()}}class i{constructor(p){this.canvasFactory=p,this.cache=Object.create(null)}getCanvas(p,d,O){let U;return this.cache[p]!==void 0?(U=this.cache[p],this.canvasFactory.reset(U,d,O)):(U=this.canvasFactory.create(d,O),this.cache[p]=U),U}delete(p){delete this.cache[p]}clear(){for(const p in this.cache){const d=this.cache[p];this.canvasFactory.destroy(d),delete this.cache[p]}}}function c(W,p,d,O,U,B,q,K,X,l){const[g,A,C,L,H,st]=(0,t.getCurrentTransform)(W);if(A===0&&C===0){const lt=q*g+H,nt=Math.round(lt),ht=K*L+st,ft=Math.round(ht),j=(q+X)*g+H,pt=Math.abs(Math.round(j)-nt)||1,vt=(K+l)*L+st,St=Math.abs(Math.round(vt)-ft)||1;return W.setTransform(Math.sign(g),0,0,Math.sign(L),nt,ft),W.drawImage(p,d,O,U,B,0,0,pt,St),W.setTransform(g,A,C,L,H,st),[pt,St]}if(g===0&&L===0){const lt=K*C+H,nt=Math.round(lt),ht=q*A+st,ft=Math.round(ht),j=(K+l)*C+H,pt=Math.abs(Math.round(j)-nt)||1,vt=(q+X)*A+st,St=Math.abs(Math.round(vt)-ft)||1;return W.setTransform(0,Math.sign(A),Math.sign(C),0,nt,ft),W.drawImage(p,d,O,U,B,0,0,St,pt),W.setTransform(g,A,C,L,H,st),[St,pt]}W.drawImage(p,d,O,U,B,q,K,X,l);const dt=Math.hypot(g,A),tt=Math.hypot(C,L);return[dt*X,tt*l]}function S(W){const{width:p,height:d}=W;if(p>P||d>P)return null;const O=1e3,U=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),B=p+1;let q=new Uint8Array(B*(d+1)),K,X,l;const g=p+7&-8;let A=new Uint8Array(g*d),C=0;for(const tt of W.data){let lt=128;for(;lt>0;)A[C++]=tt&lt?0:255,lt>>=1}let L=0;for(C=0,A[C]!==0&&(q[0]=1,++L),X=1;X<p;X++)A[C]!==A[C+1]&&(q[X]=A[C]?2:1,++L),C++;for(A[C]!==0&&(q[X]=2,++L),K=1;K<d;K++){C=K*g,l=K*B,A[C-g]!==A[C]&&(q[l]=A[C]?1:8,++L);let tt=(A[C]?4:0)+(A[C-g]?8:0);for(X=1;X<p;X++)tt=(tt>>2)+(A[C+1]?4:0)+(A[C-g+1]?8:0),U[tt]&&(q[l+X]=U[tt],++L),C++;if(A[C-g]!==A[C]&&(q[l+X]=A[C]?2:4,++L),L>O)return null}for(C=g*(d-1),l=K*B,A[C]!==0&&(q[l]=8,++L),X=1;X<p;X++)A[C]!==A[C+1]&&(q[l+X]=A[C]?4:8,++L),C++;if(A[C]!==0&&(q[l+X]=4,++L),L>O)return null;const H=new Int32Array([0,B,-1,0,-B,0,0,0,1]),st=new Path2D;for(K=0;L&&K<=d;K++){let tt=K*B;const lt=tt+p;for(;tt<lt&&!q[tt];)tt++;if(tt===lt)continue;st.moveTo(tt%B,K);const nt=tt;let ht=q[tt];do{const ft=H[ht];do tt+=ft;while(!q[tt]);const j=q[tt];j!==5&&j!==10?(ht=j,q[tt]=0):(ht=j&51*ht>>4,q[tt]&=ht>>2|ht<<2),st.lineTo(tt%B,tt/B|0),q[tt]||--L}while(nt!==tt);--K}return A=null,q=null,function(tt){tt.save(),tt.scale(1/p,-1/d),tt.translate(0,-d),tt.fill(st),tt.beginPath(),tt.restore()}}class E{constructor(p,d){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=a.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=a.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=a.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,p,d])}clone(){const p=Object.create(this);return p.clipBox=this.clipBox.slice(),p}setCurrentPoint(p,d){this.x=p,this.y=d}updatePathMinMax(p,d,O){[d,O]=a.Util.applyTransform([d,O],p),this.minX=Math.min(this.minX,d),this.minY=Math.min(this.minY,O),this.maxX=Math.max(this.maxX,d),this.maxY=Math.max(this.maxY,O)}updateRectMinMax(p,d){const O=a.Util.applyTransform(d,p),U=a.Util.applyTransform(d.slice(2),p);this.minX=Math.min(this.minX,O[0],U[0]),this.minY=Math.min(this.minY,O[1],U[1]),this.maxX=Math.max(this.maxX,O[0],U[0]),this.maxY=Math.max(this.maxY,O[1],U[1])}updateScalingPathMinMax(p,d){a.Util.scaleMinMax(p,d),this.minX=Math.min(this.minX,d[0]),this.maxX=Math.max(this.maxX,d[1]),this.minY=Math.min(this.minY,d[2]),this.maxY=Math.max(this.maxY,d[3])}updateCurvePathMinMax(p,d,O,U,B,q,K,X,l,g){const A=a.Util.bezierBoundingBox(d,O,U,B,q,K,X,l);if(g){g[0]=Math.min(g[0],A[0],A[2]),g[1]=Math.max(g[1],A[0],A[2]),g[2]=Math.min(g[2],A[1],A[3]),g[3]=Math.max(g[3],A[1],A[3]);return}this.updateRectMinMax(p,A)}getPathBoundingBox(p=k.PathType.FILL,d=null){const O=[this.minX,this.minY,this.maxX,this.maxY];if(p===k.PathType.STROKE){d||(0,a.unreachable)("Stroke bounding box must include transform.");const U=a.Util.singularValueDecompose2dScale(d),B=U[0]*this.lineWidth/2,q=U[1]*this.lineWidth/2;O[0]-=B,O[1]-=q,O[2]+=B,O[3]+=q}return O}updateClipFromPath(){const p=a.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(p||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(p){this.clipBox=p,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(p=k.PathType.FILL,d=null){return a.Util.intersect(this.clipBox,this.getPathBoundingBox(p,d))}}function h(W,p,d=null){if(typeof ImageData<"u"&&p instanceof ImageData){W.putImageData(p,0,0);return}const O=p.height,U=p.width,B=O%u,q=(O-B)/u,K=B===0?q:q+1,X=W.createImageData(U,u);let l=0,g;const A=p.data,C=X.data;let L,H,st,dt,tt,lt,nt,ht;if(d)switch(d.length){case 1:tt=d[0],lt=d[0],nt=d[0],ht=d[0];break;case 4:tt=d[0],lt=d[1],nt=d[2],ht=d[3];break}if(p.kind===a.ImageKind.GRAYSCALE_1BPP){const ft=A.byteLength,j=new Uint32Array(C.buffer,0,C.byteLength>>2),pt=j.length,vt=U+7>>3;let St=4294967295,Tt=a.FeatureTest.isLittleEndian?4278190080:255;for(ht&&ht[0]===255&&ht[255]===0&&([St,Tt]=[Tt,St]),L=0;L<K;L++){for(st=L<q?u:B,g=0,H=0;H<st;H++){const Pt=ft-l;let Ot=0;const Ft=Pt>vt?U:Pt*8-7,zt=Ft&-8;let Ct=0,Dt=0;for(;Ot<zt;Ot+=8)Dt=A[l++],j[g++]=Dt&128?St:Tt,j[g++]=Dt&64?St:Tt,j[g++]=Dt&32?St:Tt,j[g++]=Dt&16?St:Tt,j[g++]=Dt&8?St:Tt,j[g++]=Dt&4?St:Tt,j[g++]=Dt&2?St:Tt,j[g++]=Dt&1?St:Tt;for(;Ot<Ft;Ot++)Ct===0&&(Dt=A[l++],Ct=128),j[g++]=Dt&Ct?St:Tt,Ct>>=1}for(;g<pt;)j[g++]=0;W.putImageData(X,0,L*u)}}else if(p.kind===a.ImageKind.RGBA_32BPP){const ft=!!(tt||lt||nt);for(H=0,dt=U*u*4,L=0;L<q;L++){if(C.set(A.subarray(l,l+dt)),l+=dt,ft)for(let j=0;j<dt;j+=4)tt&&(C[j+0]=tt[C[j+0]]),lt&&(C[j+1]=lt[C[j+1]]),nt&&(C[j+2]=nt[C[j+2]]);W.putImageData(X,0,H),H+=u}if(L<K){if(dt=U*B*4,C.set(A.subarray(l,l+dt)),ft)for(let j=0;j<dt;j+=4)tt&&(C[j+0]=tt[C[j+0]]),lt&&(C[j+1]=lt[C[j+1]]),nt&&(C[j+2]=nt[C[j+2]]);W.putImageData(X,0,H)}}else if(p.kind===a.ImageKind.RGB_24BPP){const ft=!!(tt||lt||nt);for(st=u,dt=U*st,L=0;L<K;L++){for(L>=q&&(st=B,dt=U*st),g=0,H=dt;H--;)C[g++]=A[l++],C[g++]=A[l++],C[g++]=A[l++],C[g++]=255;if(ft)for(let j=0;j<g;j+=4)tt&&(C[j+0]=tt[C[j+0]]),lt&&(C[j+1]=lt[C[j+1]]),nt&&(C[j+2]=nt[C[j+2]]);W.putImageData(X,0,L*u)}}else throw new Error(`bad image kind: ${p.kind}`)}function s(W,p){if(p.bitmap){W.drawImage(p.bitmap,0,0);return}const d=p.height,O=p.width,U=d%u,B=(d-U)/u,q=U===0?B:B+1,K=W.createImageData(O,u);let X=0;const l=p.data,g=K.data;for(let A=0;A<q;A++){const C=A<B?u:U;({srcPos:X}=(0,F.applyMaskImageData)({src:l,srcPos:X,dest:g,width:O,height:C})),W.putImageData(K,0,A*u)}}function o(W,p){const d=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let O=0,U=d.length;O<U;O++){const B=d[O];W[B]!==void 0&&(p[B]=W[B])}W.setLineDash!==void 0&&(p.setLineDash(W.getLineDash()),p.lineDashOffset=W.lineDashOffset)}function m(W,p){W.strokeStyle=W.fillStyle=p||"#000000",W.fillRule="nonzero",W.globalAlpha=1,W.lineWidth=1,W.lineCap="butt",W.lineJoin="miter",W.miterLimit=10,W.globalCompositeOperation="source-over",W.font="10px sans-serif",W.setLineDash!==void 0&&(W.setLineDash([]),W.lineDashOffset=0)}function M(W,p,d,O){const U=W.length;for(let B=3;B<U;B+=4){const q=W[B];if(q===0)W[B-3]=p,W[B-2]=d,W[B-1]=O;else if(q<255){const K=255-q;W[B-3]=W[B-3]*q+p*K>>8,W[B-2]=W[B-2]*q+d*K>>8,W[B-1]=W[B-1]*q+O*K>>8}}}function x(W,p,d){const O=W.length,U=1/255;for(let B=3;B<O;B+=4){const q=d?d[W[B]]:W[B];p[B]=p[B]*q*U|0}}function y(W,p,d){const O=W.length;for(let U=3;U<O;U+=4){const B=W[U-3]*77+W[U-2]*152+W[U-1]*28;p[U]=d?p[U]*d[B>>8]>>8:p[U]*B>>16}}function D(W,p,d,O,U,B,q,K,X,l,g){const A=!!B,C=A?B[0]:0,L=A?B[1]:0,H=A?B[2]:0;let st;U==="Luminosity"?st=y:st=x;const tt=Math.min(O,Math.ceil(1048576/d));for(let lt=0;lt<O;lt+=tt){const nt=Math.min(tt,O-lt),ht=W.getImageData(K-l,lt+(X-g),d,nt),ft=p.getImageData(K,lt+X,d,nt);A&&M(ht.data,C,L,H),st(ht.data,ft.data,q),p.putImageData(ft,K,lt+X)}}function et(W,p,d,O){const U=O[0],B=O[1],q=O[2]-U,K=O[3]-B;q===0||K===0||(D(p.context,d,q,K,p.subtype,p.backdrop,p.transferMap,U,B,p.offsetX,p.offsetY),W.save(),W.globalAlpha=1,W.globalCompositeOperation="source-over",W.setTransform(1,0,0,1,0,0),W.drawImage(d.canvas,0,0),W.restore())}function it(W,p){const d=a.Util.singularValueDecompose2dScale(W);d[0]=Math.fround(d[0]),d[1]=Math.fround(d[1]);const O=Math.fround((globalThis.devicePixelRatio||1)*t.PixelsPerInch.PDF_TO_CSS_UNITS);return p!==void 0?p:d[0]<=O||d[1]<=O}const Z=["butt","round","square"],J=["miter","round","bevel"],G={},V={},bt=class{constructor(p,d,O,U,B,q,K,X){ot(this,rt);this.ctx=p,this.current=new E(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=d,this.objs=O,this.canvasFactory=U,this.imageLayer=B,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=q,this.cachedCanvases=new i(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=K,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=(X==null?void 0:X.background)||null,this.foregroundColor=(X==null?void 0:X.foreground)||null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(p,d=null){return typeof p=="string"?p.startsWith("g_")?this.commonObjs.get(p):this.objs.get(p):d}beginDrawing({transform:p,viewport:d,transparency:O=!1,background:U=null}){const B=this.ctx.canvas.width,q=this.ctx.canvas.height,K=U||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const X=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const l=this.backgroundColor=this.ctx.fillStyle;let g=!0,A=K;if(this.ctx.fillStyle=K,A=this.ctx.fillStyle,g=typeof A=="string"&&/^#[0-9A-Fa-f]{6}$/.test(A),X==="#000000"&&l==="#ffffff"||X===l||!g)this.foregroundColor=this.backgroundColor=null;else{const[C,L,H]=(0,t.getRGB)(A),st=tt=>(tt/=255,tt<=.03928?tt/12.92:((tt+.055)/1.055)**2.4),dt=Math.round(.2126*st(C)+.7152*st(L)+.0722*st(H));this.selectColor=(tt,lt,nt)=>{const ht=.2126*st(tt)+.7152*st(lt)+.0722*st(nt);return Math.round(ht)===dt?l:X}}}if(this.ctx.fillStyle=this.backgroundColor||K,this.ctx.fillRect(0,0,B,q),this.ctx.restore(),O){const X=this.cachedCanvases.getCanvas("transparent",B,q);this.compositeCtx=this.ctx,this.transparentCanvas=X.canvas,this.ctx=X.context,this.ctx.save(),this.ctx.transform(...(0,t.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),m(this.ctx,this.foregroundColor),p&&(this.ctx.transform(...p),this.outputScaleX=p[0],this.outputScaleY=p[0]),this.ctx.transform(...d.transform),this.viewportScale=d.scale,this.baseTransform=(0,t.getCurrentTransform)(this.ctx),this.imageLayer&&((0,t.deprecated)("The `imageLayer` functionality will be removed in the future."),this.imageLayer.beginLayout())}executeOperatorList(p,d,O,U){const B=p.argsArray,q=p.fnArray;let K=d||0;const X=B.length;if(X===K)return K;const l=X-K>w&&typeof O=="function",g=l?Date.now()+N:0;let A=0;const C=this.commonObjs,L=this.objs;let H;for(;;){if(U!==void 0&&K===U.nextBreakPoint)return U.breakIt(K,O),K;if(H=q[K],H!==a.OPS.dependency)this[H].apply(this,B[K]);else for(const st of B[K]){const dt=st.startsWith("g_")?C:L;if(!dt.has(st))return dt.get(st,O),K}if(K++,K===X)return K;if(l&&++A>w){if(Date.now()>g)return O(),K;A=0}}}endDrawing(){ut(this,rt,ue).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const p of this._cachedBitmapsMap.values()){for(const d of p.values())typeof HTMLCanvasElement<"u"&&d instanceof HTMLCanvasElement&&(d.width=d.height=0);p.clear()}this._cachedBitmapsMap.clear(),this.imageLayer&&this.imageLayer.endLayout()}_scaleImage(p,d){const O=p.width,U=p.height;let B=Math.max(Math.hypot(d[0],d[1]),1),q=Math.max(Math.hypot(d[2],d[3]),1),K=O,X=U,l="prescale1",g,A;for(;B>2&&K>1||q>2&&X>1;){let C=K,L=X;B>2&&K>1&&(C=Math.ceil(K/2),B/=K/C),q>2&&X>1&&(L=Math.ceil(X/2),q/=X/L),g=this.cachedCanvases.getCanvas(l,C,L),A=g.context,A.clearRect(0,0,C,L),A.drawImage(p,0,0,K,X,0,0,C,L),p=g.canvas,K=C,X=L,l=l==="prescale1"?"prescale2":"prescale1"}return{img:p,paintWidth:K,paintHeight:X}}_createMaskCanvas(p){const d=this.ctx,{width:O,height:U}=p,B=this.current.fillColor,q=this.current.patternFill,K=(0,t.getCurrentTransform)(d);let X,l,g,A;if((p.bitmap||p.data)&&p.count>1){const pt=p.bitmap||p.data.buffer,vt=K.slice(0,4);l=JSON.stringify(q?vt:[vt,B]),X=this._cachedBitmapsMap.get(pt),X||(X=new Map,this._cachedBitmapsMap.set(pt,X));const St=X.get(l);if(St&&!q){const Tt=Math.round(Math.min(K[0],K[2])+K[4]),Pt=Math.round(Math.min(K[1],K[3])+K[5]);return{canvas:St,offsetX:Tt,offsetY:Pt}}g=St}g||(A=this.cachedCanvases.getCanvas("maskCanvas",O,U),s(A.context,p));let C=a.Util.transform(K,[1/O,0,0,-1/U,0,0]);C=a.Util.transform(C,[1,0,0,1,0,-U]);const L=a.Util.applyTransform([0,0],C),H=a.Util.applyTransform([O,U],C),st=a.Util.normalizeRect([L[0],L[1],H[0],H[1]]),dt=Math.round(st[2]-st[0])||1,tt=Math.round(st[3]-st[1])||1,lt=this.cachedCanvases.getCanvas("fillCanvas",dt,tt),nt=lt.context,ht=Math.min(L[0],H[0]),ft=Math.min(L[1],H[1]);nt.translate(-ht,-ft),nt.transform(...C),g||(g=this._scaleImage(A.canvas,(0,t.getCurrentTransformInverse)(nt)),g=g.img,X&&q&&X.set(l,g)),nt.imageSmoothingEnabled=it((0,t.getCurrentTransform)(nt),p.interpolate),c(nt,g,0,0,g.width,g.height,0,0,O,U),nt.globalCompositeOperation="source-in";const j=a.Util.transform((0,t.getCurrentTransformInverse)(nt),[1,0,0,1,-ht,-ft]);return nt.fillStyle=q?B.getPattern(d,this,j,k.PathType.FILL):B,nt.fillRect(0,0,O,U),X&&!q&&(this.cachedCanvases.delete("fillCanvas"),X.set(l,lt.canvas)),{canvas:lt.canvas,offsetX:Math.round(ht),offsetY:Math.round(ft)}}setLineWidth(p){p!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=p,this.ctx.lineWidth=p}setLineCap(p){this.ctx.lineCap=Z[p]}setLineJoin(p){this.ctx.lineJoin=J[p]}setMiterLimit(p){this.ctx.miterLimit=p}setDash(p,d){const O=this.ctx;O.setLineDash!==void 0&&(O.setLineDash(p),O.lineDashOffset=d)}setRenderingIntent(p){}setFlatness(p){}setGState(p){for(let d=0,O=p.length;d<O;d++){const U=p[d],B=U[0],q=U[1];switch(B){case"LW":this.setLineWidth(q);break;case"LC":this.setLineCap(q);break;case"LJ":this.setLineJoin(q);break;case"ML":this.setMiterLimit(q);break;case"D":this.setDash(q[0],q[1]);break;case"RI":this.setRenderingIntent(q);break;case"FL":this.setFlatness(q);break;case"Font":this.setFont(q[0],q[1]);break;case"CA":this.current.strokeAlpha=U[1];break;case"ca":this.current.fillAlpha=U[1],this.ctx.globalAlpha=U[1];break;case"BM":this.ctx.globalCompositeOperation=q;break;case"SMask":this.current.activeSMask=q?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=q}}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const p=this.inSMaskMode;this.current.activeSMask&&!p?this.beginSMaskMode():!this.current.activeSMask&&p&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const p=this.ctx.canvas.width,d=this.ctx.canvas.height,O="smaskGroupAt"+this.groupLevel,U=this.cachedCanvases.getCanvas(O,p,d);this.suspendedCtx=this.ctx,this.ctx=U.context;const B=this.ctx;B.setTransform(...(0,t.getCurrentTransform)(this.suspendedCtx)),o(this.suspendedCtx,B),e(B,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),o(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(p){if(!this.current.activeSMask)return;p?(p[0]=Math.floor(p[0]),p[1]=Math.floor(p[1]),p[2]=Math.ceil(p[2]),p[3]=Math.ceil(p[3])):p=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const d=this.current.activeSMask,O=this.suspendedCtx;et(O,d,this.ctx,p),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(o(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const p=this.current;this.stateStack.push(p),this.current=p.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),o(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(p,d,O,U,B,q){this.ctx.transform(p,d,O,U,B,q),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(p,d,O){const U=this.ctx,B=this.current;let q=B.x,K=B.y,X,l;const g=(0,t.getCurrentTransform)(U),A=g[0]===0&&g[3]===0||g[1]===0&&g[2]===0,C=A?O.slice(0):null;for(let L=0,H=0,st=p.length;L<st;L++)switch(p[L]|0){case a.OPS.rectangle:q=d[H++],K=d[H++];const dt=d[H++],tt=d[H++],lt=q+dt,nt=K+tt;U.moveTo(q,K),dt===0||tt===0?U.lineTo(lt,nt):(U.lineTo(lt,K),U.lineTo(lt,nt),U.lineTo(q,nt)),A||B.updateRectMinMax(g,[q,K,lt,nt]),U.closePath();break;case a.OPS.moveTo:q=d[H++],K=d[H++],U.moveTo(q,K),A||B.updatePathMinMax(g,q,K);break;case a.OPS.lineTo:q=d[H++],K=d[H++],U.lineTo(q,K),A||B.updatePathMinMax(g,q,K);break;case a.OPS.curveTo:X=q,l=K,q=d[H+4],K=d[H+5],U.bezierCurveTo(d[H],d[H+1],d[H+2],d[H+3],q,K),B.updateCurvePathMinMax(g,X,l,d[H],d[H+1],d[H+2],d[H+3],q,K,C),H+=6;break;case a.OPS.curveTo2:X=q,l=K,U.bezierCurveTo(q,K,d[H],d[H+1],d[H+2],d[H+3]),B.updateCurvePathMinMax(g,X,l,q,K,d[H],d[H+1],d[H+2],d[H+3],C),q=d[H+2],K=d[H+3],H+=4;break;case a.OPS.curveTo3:X=q,l=K,q=d[H+2],K=d[H+3],U.bezierCurveTo(d[H],d[H+1],q,K,q,K),B.updateCurvePathMinMax(g,X,l,d[H],d[H+1],q,K,q,K,C),H+=4;break;case a.OPS.closePath:U.closePath();break}A&&B.updateScalingPathMinMax(g,C),B.setCurrentPoint(q,K)}closePath(){this.ctx.closePath()}stroke(p){p=typeof p<"u"?p:!0;const d=this.ctx,O=this.current.strokeColor;d.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof O=="object"&&(O!=null&&O.getPattern)?(d.save(),d.strokeStyle=O.getPattern(d,this,(0,t.getCurrentTransformInverse)(d),k.PathType.STROKE),this.rescaleAndStroke(!1),d.restore()):this.rescaleAndStroke(!0)),p&&this.consumePath(this.current.getClippedPathBoundingBox()),d.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(p){p=typeof p<"u"?p:!0;const d=this.ctx,O=this.current.fillColor,U=this.current.patternFill;let B=!1;U&&(d.save(),d.fillStyle=O.getPattern(d,this,(0,t.getCurrentTransformInverse)(d),k.PathType.FILL),B=!0);const q=this.current.getClippedPathBoundingBox();this.contentVisible&&q!==null&&(this.pendingEOFill?(d.fill("evenodd"),this.pendingEOFill=!1):d.fill()),B&&d.restore(),p&&this.consumePath(q)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=G}eoClip(){this.pendingClip=V}beginText(){this.current.textMatrix=a.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const p=this.pendingTextPaths,d=this.ctx;if(p===void 0){d.beginPath();return}d.save(),d.beginPath();for(const O of p)d.setTransform(...O.transform),d.translate(O.x,O.y),O.addToPath(d,O.fontSize);d.restore(),d.clip(),d.beginPath(),delete this.pendingTextPaths}setCharSpacing(p){this.current.charSpacing=p}setWordSpacing(p){this.current.wordSpacing=p}setHScale(p){this.current.textHScale=p/100}setLeading(p){this.current.leading=-p}setFont(p,d){const O=this.commonObjs.get(p),U=this.current;if(!O)throw new Error(`Can't find font for ${p}`);if(U.fontMatrix=O.fontMatrix||a.FONT_IDENTITY_MATRIX,(U.fontMatrix[0]===0||U.fontMatrix[3]===0)&&(0,a.warn)("Invalid font matrix for font "+p),d<0?(d=-d,U.fontDirection=-1):U.fontDirection=1,this.current.font=O,this.current.fontSize=d,O.isType3Font)return;const B=O.loadedName||"sans-serif";let q="normal";O.black?q="900":O.bold&&(q="bold");const K=O.italic?"italic":"normal",X=`"${B}", ${O.fallbackName}`;let l=d;d<v?l=v:d>f&&(l=f),this.current.fontSizeScale=d/l,this.ctx.font=`${K} ${q} ${l}px ${X}`}setTextRenderingMode(p){this.current.textRenderingMode=p}setTextRise(p){this.current.textRise=p}moveText(p,d){this.current.x=this.current.lineX+=p,this.current.y=this.current.lineY+=d}setLeadingMoveText(p,d){this.setLeading(-d),this.moveText(p,d)}setTextMatrix(p,d,O,U,B,q){this.current.textMatrix=[p,d,O,U,B,q],this.current.textMatrixScale=Math.hypot(p,d),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(p,d,O,U){const B=this.ctx,q=this.current,K=q.font,X=q.textRenderingMode,l=q.fontSize/q.fontSizeScale,g=X&a.TextRenderingMode.FILL_STROKE_MASK,A=!!(X&a.TextRenderingMode.ADD_TO_PATH_FLAG),C=q.patternFill&&!K.missingFile;let L;(K.disableFontFace||A||C)&&(L=K.getPathGenerator(this.commonObjs,p)),K.disableFontFace||C?(B.save(),B.translate(d,O),B.beginPath(),L(B,l),U&&B.setTransform(...U),(g===a.TextRenderingMode.FILL||g===a.TextRenderingMode.FILL_STROKE)&&B.fill(),(g===a.TextRenderingMode.STROKE||g===a.TextRenderingMode.FILL_STROKE)&&B.stroke(),B.restore()):((g===a.TextRenderingMode.FILL||g===a.TextRenderingMode.FILL_STROKE)&&B.fillText(p,d,O),(g===a.TextRenderingMode.STROKE||g===a.TextRenderingMode.FILL_STROKE)&&B.strokeText(p,d,O)),A&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,t.getCurrentTransform)(B),x:d,y:O,fontSize:l,addToPath:L})}get isFontSubpixelAAEnabled(){const{context:p}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);p.scale(1.5,1),p.fillText("I",0,10);const d=p.getImageData(0,0,10,10).data;let O=!1;for(let U=3;U<d.length;U+=4)if(d[U]>0&&d[U]<255){O=!0;break}return(0,a.shadow)(this,"isFontSubpixelAAEnabled",O)}showText(p){const d=this.current,O=d.font;if(O.isType3Font)return this.showType3Text(p);const U=d.fontSize;if(U===0)return;const B=this.ctx,q=d.fontSizeScale,K=d.charSpacing,X=d.wordSpacing,l=d.fontDirection,g=d.textHScale*l,A=p.length,C=O.vertical,L=C?1:-1,H=O.defaultVMetrics,st=U*d.fontMatrix[0],dt=d.textRenderingMode===a.TextRenderingMode.FILL&&!O.disableFontFace&&!d.patternFill;B.save(),B.transform(...d.textMatrix),B.translate(d.x,d.y+d.textRise),l>0?B.scale(g,-1):B.scale(g,1);let tt;if(d.patternFill){B.save();const j=d.fillColor.getPattern(B,this,(0,t.getCurrentTransformInverse)(B),k.PathType.FILL);tt=(0,t.getCurrentTransform)(B),B.restore(),B.fillStyle=j}let lt=d.lineWidth;const nt=d.textMatrixScale;if(nt===0||lt===0){const j=d.textRenderingMode&a.TextRenderingMode.FILL_STROKE_MASK;(j===a.TextRenderingMode.STROKE||j===a.TextRenderingMode.FILL_STROKE)&&(lt=this.getSinglePixelWidth())}else lt/=nt;q!==1&&(B.scale(q,q),lt/=q),B.lineWidth=lt;let ht=0,ft;for(ft=0;ft<A;++ft){const j=p[ft];if(typeof j=="number"){ht+=L*j*U/1e3;continue}let pt=!1;const vt=(j.isSpace?X:0)+K,St=j.fontChar,Tt=j.accent;let Pt,Ot,Ft=j.width;if(C){const Ct=j.vmetric||H,Dt=-(j.vmetric?Ct[1]:Ft*.5)*st,te=Ct[2]*st;Ft=Ct?-Ct[0]:Ft,Pt=Dt/q,Ot=(ht+te)/q}else Pt=ht/q,Ot=0;if(O.remeasure&&Ft>0){const Ct=B.measureText(St).width*1e3/U*q;if(Ft<Ct&&this.isFontSubpixelAAEnabled){const Dt=Ft/Ct;pt=!0,B.save(),B.scale(Dt,1),Pt/=Dt}else Ft!==Ct&&(Pt+=(Ft-Ct)/2e3*U/q)}if(this.contentVisible&&(j.isInFont||O.missingFile)){if(dt&&!Tt)B.fillText(St,Pt,Ot);else if(this.paintChar(St,Pt,Ot,tt),Tt){const Ct=Pt+U*Tt.offset.x/q,Dt=Ot-U*Tt.offset.y/q;this.paintChar(Tt.fontChar,Ct,Dt,tt)}}let zt;C?zt=Ft*st-vt*l:zt=Ft*st+vt*l,ht+=zt,pt&&B.restore()}C?d.y-=ht:d.x+=ht*g,B.restore(),this.compose()}showType3Text(p){const d=this.ctx,O=this.current,U=O.font,B=O.fontSize,q=O.fontDirection,K=U.vertical?1:-1,X=O.charSpacing,l=O.wordSpacing,g=O.textHScale*q,A=O.fontMatrix||a.FONT_IDENTITY_MATRIX,C=p.length,L=O.textRenderingMode===a.TextRenderingMode.INVISIBLE;let H,st,dt,tt;if(!(L||B===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,d.save(),d.transform(...O.textMatrix),d.translate(O.x,O.y),d.scale(g,q),H=0;H<C;++H){if(st=p[H],typeof st=="number"){tt=K*st*B/1e3,this.ctx.translate(tt,0),O.x+=tt*g;continue}const lt=(st.isSpace?l:0)+X,nt=U.charProcOperatorList[st.operatorListId];if(!nt){(0,a.warn)(`Type3 character "${st.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=st,this.save(),d.scale(B,B),d.transform(...A),this.executeOperatorList(nt),this.restore()),dt=a.Util.applyTransform([st.width,0],A)[0]*B+lt,d.translate(dt,0),O.x+=dt*g}d.restore(),this.processingType3=null}}setCharWidth(p,d){}setCharWidthAndBounds(p,d,O,U,B,q){this.ctx.rect(O,U,B-O,q-U),this.ctx.clip(),this.endPath()}getColorN_Pattern(p){let d;if(p[0]==="TilingPattern"){const O=p[1],U=this.baseTransform||(0,t.getCurrentTransform)(this.ctx),B={createCanvasGraphics:q=>new bt(q,this.commonObjs,this.objs,this.canvasFactory)};d=new k.TilingPattern(p,O,this.ctx,B,U)}else d=this._getPattern(p[1],p[2]);return d}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(p,d,O){var B;const U=((B=this.selectColor)==null?void 0:B.call(this,p,d,O))||a.Util.makeHexColor(p,d,O);this.ctx.strokeStyle=U,this.current.strokeColor=U}setFillRGBColor(p,d,O){var B;const U=((B=this.selectColor)==null?void 0:B.call(this,p,d,O))||a.Util.makeHexColor(p,d,O);this.ctx.fillStyle=U,this.current.fillColor=U,this.current.patternFill=!1}_getPattern(p,d=null){let O;return this.cachedPatterns.has(p)?O=this.cachedPatterns.get(p):(O=(0,k.getShadingPattern)(this.objs.get(p)),this.cachedPatterns.set(p,O)),d&&(O.matrix=d),O}shadingFill(p){if(!this.contentVisible)return;const d=this.ctx;this.save();const O=this._getPattern(p);d.fillStyle=O.getPattern(d,this,(0,t.getCurrentTransformInverse)(d),k.PathType.SHADING);const U=(0,t.getCurrentTransformInverse)(d);if(U){const B=d.canvas,q=B.width,K=B.height,X=a.Util.applyTransform([0,0],U),l=a.Util.applyTransform([0,K],U),g=a.Util.applyTransform([q,0],U),A=a.Util.applyTransform([q,K],U),C=Math.min(X[0],l[0],g[0],A[0]),L=Math.min(X[1],l[1],g[1],A[1]),H=Math.max(X[0],l[0],g[0],A[0]),st=Math.max(X[1],l[1],g[1],A[1]);this.ctx.fillRect(C,L,H-C,st-L)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,a.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,a.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(p,d){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(p)&&p.length===6&&this.transform(...p),this.baseTransform=(0,t.getCurrentTransform)(this.ctx),d)){const O=d[2]-d[0],U=d[3]-d[1];this.ctx.rect(d[0],d[1],O,U),this.current.updateRectMinMax((0,t.getCurrentTransform)(this.ctx),d),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(p){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const d=this.ctx;p.isolated||(0,a.info)("TODO: Support non-isolated groups."),p.knockout&&(0,a.warn)("Knockout groups not supported.");const O=(0,t.getCurrentTransform)(d);if(p.matrix&&d.transform(...p.matrix),!p.bbox)throw new Error("Bounding box is required.");let U=a.Util.getAxialAlignedBoundingBox(p.bbox,(0,t.getCurrentTransform)(d));const B=[0,0,d.canvas.width,d.canvas.height];U=a.Util.intersect(U,B)||[0,0,0,0];const q=Math.floor(U[0]),K=Math.floor(U[1]);let X=Math.max(Math.ceil(U[2])-q,1),l=Math.max(Math.ceil(U[3])-K,1),g=1,A=1;X>R&&(g=X/R,X=R),l>R&&(A=l/R,l=R),this.current.startNewPathAndClipBox([0,0,X,l]);let C="groupAt"+this.groupLevel;p.smask&&(C+="_smask_"+this.smaskCounter++%2);const L=this.cachedCanvases.getCanvas(C,X,l),H=L.context;H.scale(1/g,1/A),H.translate(-q,-K),H.transform(...O),p.smask?this.smaskStack.push({canvas:L.canvas,context:H,offsetX:q,offsetY:K,scaleX:g,scaleY:A,subtype:p.smask.subtype,backdrop:p.smask.backdrop,transferMap:p.smask.transferMap||null,startTransformInverse:null}):(d.setTransform(1,0,0,1,0,0),d.translate(q,K),d.scale(g,A),d.save()),o(d,H),this.ctx=H,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(d),this.groupLevel++}endGroup(p){if(!this.contentVisible)return;this.groupLevel--;const d=this.ctx,O=this.groupStack.pop();if(this.ctx=O,this.ctx.imageSmoothingEnabled=!1,p.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const U=(0,t.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...U);const B=a.Util.getAxialAlignedBoundingBox([0,0,d.canvas.width,d.canvas.height],U);this.ctx.drawImage(d.canvas,0,0),this.ctx.restore(),this.compose(B)}}beginAnnotation(p,d,O,U,B){if(ut(this,rt,ue).call(this),m(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(d)&&d.length===4){const q=d[2]-d[0],K=d[3]-d[1];if(B&&this.annotationCanvasMap){O=O.slice(),O[4]-=d[0],O[5]-=d[1],d=d.slice(),d[0]=d[1]=0,d[2]=q,d[3]=K;const[X,l]=a.Util.singularValueDecompose2dScale((0,t.getCurrentTransform)(this.ctx)),{viewportScale:g}=this,A=Math.ceil(q*this.outputScaleX*g),C=Math.ceil(K*this.outputScaleY*g);this.annotationCanvas=this.canvasFactory.create(A,C);const{canvas:L,context:H}=this.annotationCanvas;this.annotationCanvasMap.set(p,L),this.annotationCanvas.savedCtx=this.ctx,this.ctx=H,this.ctx.setTransform(X,0,0,-l,0,K*l),m(this.ctx,this.foregroundColor)}else m(this.ctx,this.foregroundColor),this.ctx.rect(d[0],d[1],q,K),this.ctx.clip(),this.endPath()}this.current=new E(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...O),this.transform(...U)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(p){if(!this.contentVisible)return;const d=p.count;p=this.getObject(p.data,p),p.count=d;const O=this.ctx,U=this.processingType3;if(U&&(U.compiled===void 0&&(U.compiled=S(p)),U.compiled)){U.compiled(O);return}const B=this._createMaskCanvas(p),q=B.canvas;O.save(),O.setTransform(1,0,0,1,0,0),O.drawImage(q,B.offsetX,B.offsetY),O.restore(),this.compose()}paintImageMaskXObjectRepeat(p,d,O=0,U=0,B,q){if(!this.contentVisible)return;p=this.getObject(p.data,p);const K=this.ctx;K.save();const X=(0,t.getCurrentTransform)(K);K.transform(d,O,U,B,0,0);const l=this._createMaskCanvas(p);K.setTransform(1,0,0,1,0,0);for(let g=0,A=q.length;g<A;g+=2){const C=a.Util.transform(X,[d,O,U,B,q[g],q[g+1]]),[L,H]=a.Util.applyTransform([0,0],C);K.drawImage(l.canvas,L,H)}K.restore(),this.compose()}paintImageMaskXObjectGroup(p){if(!this.contentVisible)return;const d=this.ctx,O=this.current.fillColor,U=this.current.patternFill;for(const B of p){const{data:q,width:K,height:X,transform:l}=B,g=this.cachedCanvases.getCanvas("maskCanvas",K,X),A=g.context;A.save();const C=this.getObject(q,B);s(A,C),A.globalCompositeOperation="source-in",A.fillStyle=U?O.getPattern(A,this,(0,t.getCurrentTransformInverse)(d),k.PathType.FILL):O,A.fillRect(0,0,K,X),A.restore(),d.save(),d.transform(...l),d.scale(1,-1),c(d,g.canvas,0,0,K,X,0,-1,1,1),d.restore()}this.compose()}paintImageXObject(p){if(!this.contentVisible)return;const d=this.getObject(p);if(!d){(0,a.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(d)}paintImageXObjectRepeat(p,d,O,U){if(!this.contentVisible)return;const B=this.getObject(p);if(!B){(0,a.warn)("Dependent image isn't ready yet");return}const q=B.width,K=B.height,X=[];for(let l=0,g=U.length;l<g;l+=2)X.push({transform:[d,0,0,O,U[l],U[l+1]],x:0,y:0,w:q,h:K});this.paintInlineImageXObjectGroup(B,X)}paintInlineImageXObject(p){if(!this.contentVisible)return;const d=p.width,O=p.height,U=this.ctx;this.save(),U.scale(1/d,-1/O);let B;if(typeof HTMLElement=="function"&&p instanceof HTMLElement||!p.data)B=p;else{const l=this.cachedCanvases.getCanvas("inlineImage",d,O),g=l.context;h(g,p,this.current.transferMaps),B=l.canvas}const q=this._scaleImage(B,(0,t.getCurrentTransformInverse)(U));U.imageSmoothingEnabled=it((0,t.getCurrentTransform)(U),p.interpolate);const[K,X]=c(U,q.img,0,0,q.paintWidth,q.paintHeight,0,-O,d,O);if(this.imageLayer){const[l,g]=a.Util.applyTransform([0,-O],(0,t.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:p,left:l,top:g,width:K,height:X})}this.compose(),this.restore()}paintInlineImageXObjectGroup(p,d){if(!this.contentVisible)return;const O=this.ctx,U=p.width,B=p.height,q=this.cachedCanvases.getCanvas("inlineImage",U,B),K=q.context;h(K,p,this.current.transferMaps);for(const X of d){if(O.save(),O.transform(...X.transform),O.scale(1,-1),c(O,q.canvas,X.x,X.y,X.w,X.h,0,-1,1,1),this.imageLayer){const[l,g]=a.Util.applyTransform([X.x,X.y],(0,t.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:p,left:l,top:g,width:U,height:B})}O.restore()}this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(p){}markPointProps(p,d){}beginMarkedContent(p){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(p,d){p==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(d)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(p){const d=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(p);const O=this.ctx;this.pendingClip&&(d||(this.pendingClip===V?O.clip("evenodd"):O.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),O.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const p=(0,t.getCurrentTransform)(this.ctx);if(p[1]===0&&p[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(p[0]),Math.abs(p[3]));else{const d=Math.abs(p[0]*p[3]-p[2]*p[1]),O=Math.hypot(p[0],p[2]),U=Math.hypot(p[1],p[3]);this._cachedGetSinglePixelWidth=Math.max(O,U)/d}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:p}=this.current,d=(0,t.getCurrentTransform)(this.ctx);let O,U;if(d[1]===0&&d[2]===0){const B=Math.abs(d[0]),q=Math.abs(d[3]);if(p===0)O=1/B,U=1/q;else{const K=B*p,X=q*p;O=K<1?1/K:1,U=X<1?1/X:1}}else{const B=Math.abs(d[0]*d[3]-d[2]*d[1]),q=Math.hypot(d[0],d[1]),K=Math.hypot(d[2],d[3]);if(p===0)O=K/B,U=q/B;else{const X=p*B;O=K>X?K/X:1,U=q>X?q/X:1}}this._cachedScaleForStroking=[O,U]}return this._cachedScaleForStroking}rescaleAndStroke(p){const{ctx:d}=this,{lineWidth:O}=this.current,[U,B]=this.getScaleForStroking();if(d.lineWidth=O||1,U===1&&B===1){d.stroke();return}let q,K,X;p&&(q=(0,t.getCurrentTransform)(d),K=d.getLineDash().slice(),X=d.lineDashOffset),d.scale(U,B);const l=Math.max(U,B);d.setLineDash(d.getLineDash().map(g=>g/l)),d.lineDashOffset/=l,d.stroke(),p&&(d.setTransform(...q),d.setLineDash(K),d.lineDashOffset=X)}isContentVisible(){for(let p=this.markedContentStack.length-1;p>=0;p--)if(!this.markedContentStack[p].visible)return!1;return!0}};let Y=bt;rt=new WeakSet,ue=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},n.CanvasGraphics=Y;for(const W in a.OPS)Y.prototype[W]!==void 0&&(Y.prototype[a.OPS[W]]=Y.prototype[W])},(_,n,b)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TilingPattern=n.PathType=void 0,n.getShadingPattern=u;var t=b(1),a=b(8),k=b(3);const F={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};n.PathType=F;function T(c,S){if(!S||k.isNodeJS)return;const E=S[2]-S[0],h=S[3]-S[1],s=new Path2D;s.rect(S[0],S[1],E,h),c.clip(s)}class v{constructor(){this.constructor===v&&(0,t.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,t.unreachable)("Abstract method `getPattern` called.")}}class f extends v{constructor(S){super(),this._type=S[1],this._bbox=S[2],this._colorStops=S[3],this._p0=S[4],this._p1=S[5],this._r0=S[6],this._r1=S[7],this.matrix=null}_createGradient(S){let E;this._type==="axial"?E=S.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(E=S.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const h of this._colorStops)E.addColorStop(h[0],h[1]);return E}getPattern(S,E,h,s){let o;if(s===F.STROKE||s===F.FILL){const m=E.current.getClippedPathBoundingBox(s,(0,a.getCurrentTransform)(S))||[0,0,0,0],M=Math.ceil(m[2]-m[0])||1,x=Math.ceil(m[3]-m[1])||1,y=E.cachedCanvases.getCanvas("pattern",M,x,!0),D=y.context;D.clearRect(0,0,D.canvas.width,D.canvas.height),D.beginPath(),D.rect(0,0,D.canvas.width,D.canvas.height),D.translate(-m[0],-m[1]),h=t.Util.transform(h,[1,0,0,1,m[0],m[1]]),D.transform(...E.baseTransform),this.matrix&&D.transform(...this.matrix),T(D,this._bbox),D.fillStyle=this._createGradient(D),D.fill(),o=S.createPattern(y.canvas,"no-repeat");const et=new DOMMatrix(h);try{o.setTransform(et)}catch(it){(0,t.warn)(`RadialAxialShadingPattern.getPattern: "${it==null?void 0:it.message}".`)}}else T(S,this._bbox),o=this._createGradient(S);return o}}function R(c,S,E,h,s,o,m,M){const x=S.coords,y=S.colors,D=c.data,et=c.width*4;let it;x[E+1]>x[h+1]&&(it=E,E=h,h=it,it=o,o=m,m=it),x[h+1]>x[s+1]&&(it=h,h=s,s=it,it=m,m=M,M=it),x[E+1]>x[h+1]&&(it=E,E=h,h=it,it=o,o=m,m=it);const Z=(x[E]+S.offsetX)*S.scaleX,J=(x[E+1]+S.offsetY)*S.scaleY,G=(x[h]+S.offsetX)*S.scaleX,V=(x[h+1]+S.offsetY)*S.scaleY,Y=(x[s]+S.offsetX)*S.scaleX,rt=(x[s+1]+S.offsetY)*S.scaleY;if(J>=rt)return;const ct=y[o],bt=y[o+1],W=y[o+2],p=y[m],d=y[m+1],O=y[m+2],U=y[M],B=y[M+1],q=y[M+2],K=Math.round(J),X=Math.round(rt);let l,g,A,C,L,H,st,dt;for(let tt=K;tt<=X;tt++){if(tt<V){let j;tt<J?j=0:j=(J-tt)/(J-V),l=Z-(Z-G)*j,g=ct-(ct-p)*j,A=bt-(bt-d)*j,C=W-(W-O)*j}else{let j;tt>rt?j=1:V===rt?j=0:j=(V-tt)/(V-rt),l=G-(G-Y)*j,g=p-(p-U)*j,A=d-(d-B)*j,C=O-(O-q)*j}let lt;tt<J?lt=0:tt>rt?lt=1:lt=(J-tt)/(J-rt),L=Z-(Z-Y)*lt,H=ct-(ct-U)*lt,st=bt-(bt-B)*lt,dt=W-(W-q)*lt;const nt=Math.round(Math.min(l,L)),ht=Math.round(Math.max(l,L));let ft=et*tt+nt*4;for(let j=nt;j<=ht;j++)lt=(l-j)/(l-L),lt<0?lt=0:lt>1&&(lt=1),D[ft++]=g-(g-H)*lt|0,D[ft++]=A-(A-st)*lt|0,D[ft++]=C-(C-dt)*lt|0,D[ft++]=255}}function N(c,S,E){const h=S.coords,s=S.colors;let o,m;switch(S.type){case"lattice":const M=S.verticesPerRow,x=Math.floor(h.length/M)-1,y=M-1;for(o=0;o<x;o++){let D=o*M;for(let et=0;et<y;et++,D++)R(c,E,h[D],h[D+1],h[D+M],s[D],s[D+1],s[D+M]),R(c,E,h[D+M+1],h[D+1],h[D+M],s[D+M+1],s[D+1],s[D+M])}break;case"triangles":for(o=0,m=h.length;o<m;o+=3)R(c,E,h[o],h[o+1],h[o+2],s[o],s[o+1],s[o+2]);break;default:throw new Error("illegal figure")}}class w extends v{constructor(S){super(),this._coords=S[2],this._colors=S[3],this._figures=S[4],this._bounds=S[5],this._bbox=S[7],this._background=S[8],this.matrix=null}_createMeshCanvas(S,E,h){const M=Math.floor(this._bounds[0]),x=Math.floor(this._bounds[1]),y=Math.ceil(this._bounds[2])-M,D=Math.ceil(this._bounds[3])-x,et=Math.min(Math.ceil(Math.abs(y*S[0]*1.1)),3e3),it=Math.min(Math.ceil(Math.abs(D*S[1]*1.1)),3e3),Z=y/et,J=D/it,G={coords:this._coords,colors:this._colors,offsetX:-M,offsetY:-x,scaleX:1/Z,scaleY:1/J},V=et+2*2,Y=it+2*2,rt=h.getCanvas("mesh",V,Y,!1),ct=rt.context,bt=ct.createImageData(et,it);if(E){const p=bt.data;for(let d=0,O=p.length;d<O;d+=4)p[d]=E[0],p[d+1]=E[1],p[d+2]=E[2],p[d+3]=255}for(const p of this._figures)N(bt,p,G);return ct.putImageData(bt,2,2),{canvas:rt.canvas,offsetX:M-2*Z,offsetY:x-2*J,scaleX:Z,scaleY:J}}getPattern(S,E,h,s){T(S,this._bbox);let o;if(s===F.SHADING)o=t.Util.singularValueDecompose2dScale((0,a.getCurrentTransform)(S));else if(o=t.Util.singularValueDecompose2dScale(E.baseTransform),this.matrix){const M=t.Util.singularValueDecompose2dScale(this.matrix);o=[o[0]*M[0],o[1]*M[1]]}const m=this._createMeshCanvas(o,s===F.SHADING?null:this._background,E.cachedCanvases);return s!==F.SHADING&&(S.setTransform(...E.baseTransform),this.matrix&&S.transform(...this.matrix)),S.translate(m.offsetX,m.offsetY),S.scale(m.scaleX,m.scaleY),S.createPattern(m.canvas,"no-repeat")}}class P extends v{getPattern(){return"hotpink"}}function u(c){switch(c[0]){case"RadialAxial":return new f(c);case"Mesh":return new w(c);case"Dummy":return new P}throw new Error(`Unknown IR type: ${c[0]}`)}const e={COLORED:1,UNCOLORED:2};class i{static get MAX_PATTERN_SIZE(){return(0,t.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(S,E,h,s,o){this.operatorList=S[2],this.matrix=S[3]||[1,0,0,1,0,0],this.bbox=S[4],this.xstep=S[5],this.ystep=S[6],this.paintType=S[7],this.tilingType=S[8],this.color=E,this.ctx=h,this.canvasGraphicsFactory=s,this.baseTransform=o}createPatternCanvas(S){const E=this.operatorList,h=this.bbox,s=this.xstep,o=this.ystep,m=this.paintType,M=this.tilingType,x=this.color,y=this.canvasGraphicsFactory;(0,t.info)("TilingType: "+M);const D=h[0],et=h[1],it=h[2],Z=h[3],J=t.Util.singularValueDecompose2dScale(this.matrix),G=t.Util.singularValueDecompose2dScale(this.baseTransform),V=[J[0]*G[0],J[1]*G[1]],Y=this.getSizeAndScale(s,this.ctx.canvas.width,V[0]),rt=this.getSizeAndScale(o,this.ctx.canvas.height,V[1]),ct=S.cachedCanvases.getCanvas("pattern",Y.size,rt.size,!0),bt=ct.context,W=y.createCanvasGraphics(bt);W.groupLevel=S.groupLevel,this.setFillAndStrokeStyleToContext(W,m,x);let p=D,d=et,O=it,U=Z;return D<0&&(p=0,O+=Math.abs(D)),et<0&&(d=0,U+=Math.abs(et)),bt.translate(-(Y.scale*p),-(rt.scale*d)),W.transform(Y.scale,0,0,rt.scale,0,0),bt.save(),this.clipBbox(W,p,d,O,U),W.baseTransform=(0,a.getCurrentTransform)(W.ctx),W.executeOperatorList(E),W.endDrawing(),{canvas:ct.canvas,scaleX:Y.scale,scaleY:rt.scale,offsetX:p,offsetY:d}}getSizeAndScale(S,E,h){S=Math.abs(S);const s=Math.max(i.MAX_PATTERN_SIZE,E);let o=Math.ceil(S*h);return o>=s?o=s:h=o/S,{scale:h,size:o}}clipBbox(S,E,h,s,o){const m=s-E,M=o-h;S.ctx.rect(E,h,m,M),S.current.updateRectMinMax((0,a.getCurrentTransform)(S.ctx),[E,h,s,o]),S.clip(),S.endPath()}setFillAndStrokeStyleToContext(S,E,h){const s=S.ctx,o=S.current;switch(E){case e.COLORED:const m=this.ctx;s.fillStyle=m.fillStyle,s.strokeStyle=m.strokeStyle,o.fillColor=m.fillStyle,o.strokeColor=m.strokeStyle;break;case e.UNCOLORED:const M=t.Util.makeHexColor(h[0],h[1],h[2]);s.fillStyle=M,s.strokeStyle=M,o.fillColor=M,o.strokeColor=M;break;default:throw new t.FormatError(`Unsupported paint type: ${E}`)}}getPattern(S,E,h,s){let o=h;s!==F.SHADING&&(o=t.Util.transform(o,E.baseTransform),this.matrix&&(o=t.Util.transform(o,this.matrix)));const m=this.createPatternCanvas(E);let M=new DOMMatrix(o);M=M.translate(m.offsetX,m.offsetY),M=M.scale(1/m.scaleX,1/m.scaleY);const x=S.createPattern(m.canvas,"repeat");try{x.setTransform(M)}catch(y){(0,t.warn)(`TilingPattern.getPattern: "${y==null?void 0:y.message}".`)}return x}}n.TilingPattern=i},(_,n,b)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.applyMaskImageData=a;var t=b(1);function a({src:k,srcPos:F=0,dest:T,destPos:v=0,width:f,height:R,inverseDecode:N=!1}){const w=t.FeatureTest.isLittleEndian?4278190080:255,[P,u]=N?[0,w]:[w,0],e=f>>3,i=f&7,c=k.length;T=new Uint32Array(T.buffer);for(let S=0;S<R;S++){for(const h=F+e;F<h;F++){const s=F<c?k[F]:255;T[v++]=s&128?u:P,T[v++]=s&64?u:P,T[v++]=s&32?u:P,T[v++]=s&16?u:P,T[v++]=s&8?u:P,T[v++]=s&4?u:P,T[v++]=s&2?u:P,T[v++]=s&1?u:P}if(i===0)continue;const E=F<c?k[F++]:255;for(let h=0;h<i;h++)T[v++]=E&1<<7-h?u:P}return{srcPos:F,destPos:v}}},(_,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.GlobalWorkerOptions=void 0;const b=Object.create(null);n.GlobalWorkerOptions=b,b.workerPort=b.workerPort===void 0?null:b.workerPort,b.workerSrc=b.workerSrc===void 0?"":b.workerSrc},(_,n,b)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.MessageHandler=void 0;var t=b(1);const a={UNKNOWN:0,DATA:1,ERROR:2},k={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function F(v){switch(v instanceof Error||typeof v=="object"&&v!==null||(0,t.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),v.name){case"AbortException":return new t.AbortException(v.message);case"MissingPDFException":return new t.MissingPDFException(v.message);case"PasswordException":return new t.PasswordException(v.message,v.code);case"UnexpectedResponseException":return new t.UnexpectedResponseException(v.message,v.status);case"UnknownErrorException":return new t.UnknownErrorException(v.message,v.details);default:return new t.UnknownErrorException(v.message,v.toString())}}class T{constructor(f,R,N){this.sourceName=f,this.targetName=R,this.comObj=N,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=w=>{const P=w.data;if(P.targetName!==this.sourceName)return;if(P.stream){this._processStreamMessage(P);return}if(P.callback){const e=P.callbackId,i=this.callbackCapabilities[e];if(!i)throw new Error(`Cannot resolve callback ${e}`);if(delete this.callbackCapabilities[e],P.callback===a.DATA)i.resolve(P.data);else if(P.callback===a.ERROR)i.reject(F(P.reason));else throw new Error("Unexpected callback case");return}const u=this.actionHandler[P.action];if(!u)throw new Error(`Unknown action from worker: ${P.action}`);if(P.callbackId){const e=this.sourceName,i=P.sourceName;new Promise(function(c){c(u(P.data))}).then(function(c){N.postMessage({sourceName:e,targetName:i,callback:a.DATA,callbackId:P.callbackId,data:c})},function(c){N.postMessage({sourceName:e,targetName:i,callback:a.ERROR,callbackId:P.callbackId,reason:F(c)})});return}if(P.streamId){this._createStreamSink(P);return}u(P.data)},N.addEventListener("message",this._onComObjOnMessage)}on(f,R){const N=this.actionHandler;if(N[f])throw new Error(`There is already an actionName called "${f}"`);N[f]=R}send(f,R,N){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:f,data:R},N)}sendWithPromise(f,R,N){const w=this.callbackId++,P=(0,t.createPromiseCapability)();this.callbackCapabilities[w]=P;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:f,callbackId:w,data:R},N)}catch(u){P.reject(u)}return P.promise}sendWithStream(f,R,N,w){const P=this.streamId++,u=this.sourceName,e=this.targetName,i=this.comObj;return new ReadableStream({start:c=>{const S=(0,t.createPromiseCapability)();return this.streamControllers[P]={controller:c,startCall:S,pullCall:null,cancelCall:null,isClosed:!1},i.postMessage({sourceName:u,targetName:e,action:f,streamId:P,data:R,desiredSize:c.desiredSize},w),S.promise},pull:c=>{const S=(0,t.createPromiseCapability)();return this.streamControllers[P].pullCall=S,i.postMessage({sourceName:u,targetName:e,stream:k.PULL,streamId:P,desiredSize:c.desiredSize}),S.promise},cancel:c=>{(0,t.assert)(c instanceof Error,"cancel must have a valid reason");const S=(0,t.createPromiseCapability)();return this.streamControllers[P].cancelCall=S,this.streamControllers[P].isClosed=!0,i.postMessage({sourceName:u,targetName:e,stream:k.CANCEL,streamId:P,reason:F(c)}),S.promise}},N)}_createStreamSink(f){const R=f.streamId,N=this.sourceName,w=f.sourceName,P=this.comObj,u=this,e=this.actionHandler[f.action],i={enqueue(c,S=1,E){if(this.isCancelled)return;const h=this.desiredSize;this.desiredSize-=S,h>0&&this.desiredSize<=0&&(this.sinkCapability=(0,t.createPromiseCapability)(),this.ready=this.sinkCapability.promise),P.postMessage({sourceName:N,targetName:w,stream:k.ENQUEUE,streamId:R,chunk:c},E)},close(){this.isCancelled||(this.isCancelled=!0,P.postMessage({sourceName:N,targetName:w,stream:k.CLOSE,streamId:R}),delete u.streamSinks[R])},error(c){(0,t.assert)(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,P.postMessage({sourceName:N,targetName:w,stream:k.ERROR,streamId:R,reason:F(c)}))},sinkCapability:(0,t.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:f.desiredSize,ready:null};i.sinkCapability.resolve(),i.ready=i.sinkCapability.promise,this.streamSinks[R]=i,new Promise(function(c){c(e(f.data,i))}).then(function(){P.postMessage({sourceName:N,targetName:w,stream:k.START_COMPLETE,streamId:R,success:!0})},function(c){P.postMessage({sourceName:N,targetName:w,stream:k.START_COMPLETE,streamId:R,reason:F(c)})})}_processStreamMessage(f){const R=f.streamId,N=this.sourceName,w=f.sourceName,P=this.comObj,u=this.streamControllers[R],e=this.streamSinks[R];switch(f.stream){case k.START_COMPLETE:f.success?u.startCall.resolve():u.startCall.reject(F(f.reason));break;case k.PULL_COMPLETE:f.success?u.pullCall.resolve():u.pullCall.reject(F(f.reason));break;case k.PULL:if(!e){P.postMessage({sourceName:N,targetName:w,stream:k.PULL_COMPLETE,streamId:R,success:!0});break}e.desiredSize<=0&&f.desiredSize>0&&e.sinkCapability.resolve(),e.desiredSize=f.desiredSize,new Promise(function(i){i(e.onPull&&e.onPull())}).then(function(){P.postMessage({sourceName:N,targetName:w,stream:k.PULL_COMPLETE,streamId:R,success:!0})},function(i){P.postMessage({sourceName:N,targetName:w,stream:k.PULL_COMPLETE,streamId:R,reason:F(i)})});break;case k.ENQUEUE:if((0,t.assert)(u,"enqueue should have stream controller"),u.isClosed)break;u.controller.enqueue(f.chunk);break;case k.CLOSE:if((0,t.assert)(u,"close should have stream controller"),u.isClosed)break;u.isClosed=!0,u.controller.close(),this._deleteStreamController(u,R);break;case k.ERROR:(0,t.assert)(u,"error should have stream controller"),u.controller.error(F(f.reason)),this._deleteStreamController(u,R);break;case k.CANCEL_COMPLETE:f.success?u.cancelCall.resolve():u.cancelCall.reject(F(f.reason)),this._deleteStreamController(u,R);break;case k.CANCEL:if(!e)break;new Promise(function(i){i(e.onCancel&&e.onCancel(F(f.reason)))}).then(function(){P.postMessage({sourceName:N,targetName:w,stream:k.CANCEL_COMPLETE,streamId:R,success:!0})},function(i){P.postMessage({sourceName:N,targetName:w,stream:k.CANCEL_COMPLETE,streamId:R,reason:F(i)})}),e.sinkCapability.reject(F(f.reason)),e.isCancelled=!0,delete this.streamSinks[R];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(f,R){await Promise.allSettled([f.startCall&&f.startCall.promise,f.pullCall&&f.pullCall.promise,f.cancelCall&&f.cancelCall.promise]),delete this.streamControllers[R]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}n.MessageHandler=T},(_,n,b)=>{var k,F;Object.defineProperty(n,"__esModule",{value:!0}),n.Metadata=void 0;var t=b(1);class a{constructor({parsedData:v,rawData:f}){ot(this,k,void 0);ot(this,F,void 0);yt(this,k,v),yt(this,F,f)}getRaw(){return I(this,F)}get(v){return I(this,k).get(v)??null}getAll(){return(0,t.objectFromMap)(I(this,k))}has(v){return I(this,k).has(v)}}k=new WeakMap,F=new WeakMap,n.Metadata=a},(_,n,b)=>{var T,v,f,R,N,w,de;Object.defineProperty(n,"__esModule",{value:!0}),n.OptionalContentConfig=void 0;var t=b(1);const a=Symbol("INTERNAL");class k{constructor(e,i){ot(this,T,!0);this.name=e,this.intent=i}get visible(){return I(this,T)}_setVisible(e,i){e!==a&&(0,t.unreachable)("Internal method `_setVisible` called."),yt(this,T,i)}}T=new WeakMap;class F{constructor(e){ot(this,w);ot(this,v,!0);ot(this,f,new Map);ot(this,R,null);ot(this,N,null);if(this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,yt(this,N,e.order);for(const i of e.groups)I(this,f).set(i.id,new k(i.name,i.intent));if(e.baseState==="OFF")for(const i of I(this,f).values())i._setVisible(a,!1);for(const i of e.on)I(this,f).get(i)._setVisible(a,!0);for(const i of e.off)I(this,f).get(i)._setVisible(a,!1);yt(this,R,new Map);for(const[i,c]of I(this,f))I(this,R).set(i,c.visible)}}isVisible(e){if(I(this,f).size===0)return!0;if(!e)return(0,t.warn)("Optional content group not defined."),!0;if(e.type==="OCG")return I(this,f).has(e.id)?I(this,f).get(e.id).visible:((0,t.warn)(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return ut(this,w,de).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const i of e.ids){if(!I(this,f).has(i))return(0,t.warn)(`Optional content group not found: ${i}`),!0;if(I(this,f).get(i).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const i of e.ids){if(!I(this,f).has(i))return(0,t.warn)(`Optional content group not found: ${i}`),!0;if(!I(this,f).get(i).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const i of e.ids){if(!I(this,f).has(i))return(0,t.warn)(`Optional content group not found: ${i}`),!0;if(!I(this,f).get(i).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const i of e.ids){if(!I(this,f).has(i))return(0,t.warn)(`Optional content group not found: ${i}`),!0;if(I(this,f).get(i).visible)return!1}return!0}return(0,t.warn)(`Unknown optional content policy ${e.policy}.`),!0}return(0,t.warn)(`Unknown group type ${e.type}.`),!0}setVisibility(e,i=!0){if(!I(this,f).has(e)){(0,t.warn)(`Optional content group not found: ${e}`);return}I(this,f).get(e)._setVisible(a,!!i),yt(this,v,null)}get hasInitialVisibility(){if(I(this,v)!==null)return I(this,v);for(const[e,i]of I(this,f)){const c=I(this,R).get(e);if(i.visible!==c)return yt(this,v,!1)}return yt(this,v,!0)}getOrder(){return I(this,f).size?I(this,N)?I(this,N).slice():[...I(this,f).keys()]:null}getGroups(){return I(this,f).size>0?(0,t.objectFromMap)(I(this,f)):null}getGroup(e){return I(this,f).get(e)||null}}v=new WeakMap,f=new WeakMap,R=new WeakMap,N=new WeakMap,w=new WeakSet,de=function(e){const i=e.length;if(i<2)return!0;const c=e[0];for(let S=1;S<i;S++){const E=e[S];let h;if(Array.isArray(E))h=ut(this,w,de).call(this,E);else if(I(this,f).has(E))h=I(this,f).get(E).visible;else return(0,t.warn)(`Optional content group not found: ${E}`),!0;switch(c){case"And":if(!h)return!1;break;case"Or":if(h)return!0;break;case"Not":return!h;default:return!0}}return c==="And"},n.OptionalContentConfig=F},(_,n,b)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFDataTransportStream=void 0;var t=b(1),a=b(8);class k{constructor(f,R){(0,t.assert)(R,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=f.progressiveDone||!1,this._contentDispositionFilename=f.contentDispositionFilename||null;const N=f.initialData;if((N==null?void 0:N.length)>0){const w=new Uint8Array(N).buffer;this._queuedChunks.push(w)}this._pdfDataRangeTransport=R,this._isStreamingSupported=!f.disableStream,this._isRangeSupported=!f.disableRange,this._contentLength=f.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((w,P)=>{this._onReceiveData({begin:w,chunk:P})}),this._pdfDataRangeTransport.addProgressListener((w,P)=>{this._onProgress({loaded:w,total:P})}),this._pdfDataRangeTransport.addProgressiveReadListener(w=>{this._onReceiveData({chunk:w})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(f){const R=new Uint8Array(f.chunk).buffer;if(f.begin===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(R):this._queuedChunks.push(R);else{const N=this._rangeReaders.some(function(w){return w._begin!==f.begin?!1:(w._enqueue(R),!0)});(0,t.assert)(N,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var f;return((f=this._fullRequestReader)==null?void 0:f._loaded)??0}_onProgress(f){if(f.total===void 0){const R=this._rangeReaders[0];R!=null&&R.onProgress&&R.onProgress({loaded:f.loaded})}else{const R=this._fullRequestReader;R!=null&&R.onProgress&&R.onProgress({loaded:f.loaded,total:f.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(f){const R=this._rangeReaders.indexOf(f);R>=0&&this._rangeReaders.splice(R,1)}getFullReader(){(0,t.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const f=this._queuedChunks;return this._queuedChunks=null,new F(this,f,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(f,R){if(R<=this._progressiveDataLength)return null;const N=new T(this,f,R);return this._pdfDataRangeTransport.requestDataRange(f,R),this._rangeReaders.push(N),N}cancelAllRequests(f){this._fullRequestReader&&this._fullRequestReader.cancel(f);for(const R of this._rangeReaders.slice(0))R.cancel(f);this._pdfDataRangeTransport.abort()}}n.PDFDataTransportStream=k;class F{constructor(f,R,N=!1,w=null){this._stream=f,this._done=N||!1,this._filename=(0,a.isPdfFile)(w)?w:null,this._queuedChunks=R||[],this._loaded=0;for(const P of this._queuedChunks)this._loaded+=P.byteLength;this._requests=[],this._headersReady=Promise.resolve(),f._fullRequestReader=this,this.onProgress=null}_enqueue(f){this._done||(this._requests.length>0?this._requests.shift().resolve({value:f,done:!1}):this._queuedChunks.push(f),this._loaded+=f.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const f=(0,t.createPromiseCapability)();return this._requests.push(f),f.promise}cancel(f){this._done=!0;for(const R of this._requests)R.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class T{constructor(f,R,N){this._stream=f,this._begin=R,this._end=N,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(f){if(!this._done){if(this._requests.length===0)this._queuedChunk=f;else{this._requests.shift().resolve({value:f,done:!1});for(const N of this._requests)N.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const R=this._queuedChunk;return this._queuedChunk=null,{value:R,done:!1}}if(this._done)return{value:void 0,done:!0};const f=(0,t.createPromiseCapability)();return this._requests.push(f),f.promise}cancel(f){this._done=!0;for(const R of this._requests)R.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(_,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.XfaText=void 0;class b{static textContent(a){const k=[],F={items:k,styles:Object.create(null)};function T(v){var N;if(!v)return;let f=null;const R=v.name;if(R==="#text")f=v.value;else if(b.shouldBuildText(R))(N=v==null?void 0:v.attributes)!=null&&N.textContent?f=v.attributes.textContent:v.value&&(f=v.value);else return;if(f!==null&&k.push({str:f}),!!v.children)for(const w of v.children)T(w)}return T(a),F}static shouldBuildText(a){return!(a==="textarea"||a==="input"||a==="option"||a==="select")}}n.XfaText=b},(_,n,b)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.NodeStandardFontDataFactory=n.NodeCanvasFactory=n.NodeCMapReaderFactory=void 0;var t=b(9);const a=function(v){return new Promise((f,R)=>{require$$5.readFile(v,(w,P)=>{if(w||!P){R(new Error(w));return}f(new Uint8Array(P))})})};class k extends t.BaseCanvasFactory{_createCanvas(f,R){return require$$5.createCanvas(f,R)}}n.NodeCanvasFactory=k;class F extends t.BaseCMapReaderFactory{_fetchData(f,R){return a(f).then(N=>({cMapData:N,compressionType:R}))}}n.NodeCMapReaderFactory=F;class T extends t.BaseStandardFontDataFactory{_fetchData(f){return a(f)}}n.NodeStandardFontDataFactory=T},(_,n,b)=>{var v,f,R,N,w,P,u,e,i,pe,S,ke,h,fe,o,Fe;Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationEditorLayer=void 0;var t=b(7),a=b(1),k=b(23),F=b(24);const M=class{constructor(y){ot(this,i);ot(this,S);ot(this,h);ot(this,o);ot(this,v,void 0);ot(this,f,!1);ot(this,R,this.pointerup.bind(this));ot(this,N,this.pointerdown.bind(this));ot(this,w,new Map);ot(this,P,!1);ot(this,u,!1);ot(this,e,void 0);M._initialized||(M._initialized=!0,k.FreeTextEditor.initialize(y.l10n),F.InkEditor.initialize(y.l10n),y.uiManager.registerEditorTypes([k.FreeTextEditor,F.InkEditor])),yt(this,e,y.uiManager),this.annotationStorage=y.annotationStorage,this.pageIndex=y.pageIndex,this.div=y.div,yt(this,v,y.accessibilityManager),I(this,e).addLayer(this)}updateToolbar(y){I(this,e).updateToolbar(y)}updateMode(y=I(this,e).getMode()){ut(this,o,Fe).call(this),y===a.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),I(this,e).unselectAll()}addInkEditorIfNeeded(y){if(!y&&I(this,e).getMode()!==a.AnnotationEditorType.INK)return;if(!y){for(const et of I(this,w).values())if(et.isEmpty()){et.setInBackground();return}}ut(this,h,fe).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(y){I(this,e).setEditingState(y)}addCommands(y){I(this,e).addCommands(y)}enable(){this.div.style.pointerEvents="auto";for(const y of I(this,w).values())y.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const y of I(this,w).values())y.disableEditing()}setActiveEditor(y){I(this,e).getActive()!==y&&I(this,e).setActiveEditor(y)}enableClick(){this.div.addEventListener("pointerdown",I(this,N)),this.div.addEventListener("pointerup",I(this,R))}disableClick(){this.div.removeEventListener("pointerdown",I(this,N)),this.div.removeEventListener("pointerup",I(this,R))}attach(y){I(this,w).set(y.id,y)}detach(y){var D;I(this,w).delete(y.id),(D=I(this,v))==null||D.removePointerInTextLayer(y.contentDiv)}remove(y){I(this,e).removeEditor(y),this.detach(y),this.annotationStorage.remove(y.id),y.div.style.display="none",setTimeout(()=>{y.div.style.display="",y.div.remove(),y.isAttachedToDOM=!1,document.activeElement===document.body&&I(this,e).focusMainContainer()},0),I(this,u)||this.addInkEditorIfNeeded(!1)}add(y){if(ut(this,i,pe).call(this,y),I(this,e).addEditor(y),this.attach(y),!y.isAttachedToDOM){const D=y.render();this.div.append(D),y.isAttachedToDOM=!0}this.moveEditorInDOM(y),y.onceAdded(),this.addToAnnotationStorage(y)}moveEditorInDOM(y){var D;(D=I(this,v))==null||D.moveElementInDOM(this.div,y.div,y.contentDiv,!0)}addToAnnotationStorage(y){!y.isEmpty()&&!this.annotationStorage.has(y.id)&&this.annotationStorage.setValue(y.id,y)}addOrRebuild(y){y.needsToBeRebuilt()?y.rebuild():this.add(y)}addANewEditor(y){const D=()=>{this.addOrRebuild(y)},et=()=>{y.remove()};this.addCommands({cmd:D,undo:et,mustExec:!0})}addUndoableEditor(y){const D=()=>{this.addOrRebuild(y)},et=()=>{y.remove()};this.addCommands({cmd:D,undo:et,mustExec:!1})}getNextId(){return I(this,e).getId()}deserialize(y){switch(y.annotationType){case a.AnnotationEditorType.FREETEXT:return k.FreeTextEditor.deserialize(y,this);case a.AnnotationEditorType.INK:return F.InkEditor.deserialize(y,this)}return null}setSelected(y){I(this,e).setSelected(y)}toggleSelected(y){I(this,e).toggleSelected(y)}isSelected(y){return I(this,e).isSelected(y)}unselect(y){I(this,e).unselect(y)}pointerup(y){const D=t.KeyboardManager.platform.isMac;if(!(y.button!==0||y.ctrlKey&&D)&&y.target===this.div&&I(this,P)){if(yt(this,P,!1),!I(this,f)){yt(this,f,!0);return}ut(this,h,fe).call(this,y)}}pointerdown(y){const D=t.KeyboardManager.platform.isMac;if(y.button!==0||y.ctrlKey&&D||y.target!==this.div)return;yt(this,P,!0);const et=I(this,e).getActive();yt(this,f,!et||et.isEmpty())}drop(y){const D=y.dataTransfer.getData("text/plain"),et=I(this,e).getEditor(D);if(!et)return;y.preventDefault(),y.dataTransfer.dropEffect="move",ut(this,i,pe).call(this,et);const it=this.div.getBoundingClientRect(),Z=y.clientX-it.x,J=y.clientY-it.y;et.translate(Z-et.startX,J-et.startY),this.moveEditorInDOM(et),et.div.focus()}dragover(y){y.preventDefault()}destroy(){var y,D;((y=I(this,e).getActive())==null?void 0:y.parent)===this&&I(this,e).setActiveEditor(null);for(const et of I(this,w).values())(D=I(this,v))==null||D.removePointerInTextLayer(et.contentDiv),et.isAttachedToDOM=!1,et.div.remove(),et.parent=null;this.div=null,I(this,w).clear(),I(this,e).removeLayer(this)}render(y){this.viewport=y.viewport,(0,t.bindEvents)(this,this.div,["dragover","drop"]),this.setDimensions();for(const D of I(this,e).getEditors(this.pageIndex))this.add(D);this.updateMode()}update(y){this.viewport=y.viewport,this.setDimensions(),this.updateMode()}get scaleFactor(){return this.viewport.scale}get pageDimensions(){const[y,D,et,it]=this.viewport.viewBox,Z=et-y,J=it-D;return[Z,J]}get viewportBaseDimensions(){const{width:y,height:D,rotation:et}=this.viewport;return et%180===0?[y,D]:[D,y]}setDimensions(){const{width:y,height:D,rotation:et}=this.viewport,it=et%180!==0,Z=Math.floor(y)+"px",J=Math.floor(D)+"px";this.div.style.width=it?J:Z,this.div.style.height=it?Z:J,this.div.setAttribute("data-main-rotation",et)}};let T=M;v=new WeakMap,f=new WeakMap,R=new WeakMap,N=new WeakMap,w=new WeakMap,P=new WeakMap,u=new WeakMap,e=new WeakMap,i=new WeakSet,pe=function(y){var D;y.parent!==this&&(this.attach(y),y.pageIndex=this.pageIndex,(D=y.parent)==null||D.detach(y),y.parent=this,y.div&&y.isAttachedToDOM&&(y.div.remove(),this.div.append(y.div)))},S=new WeakSet,ke=function(y){switch(I(this,e).getMode()){case a.AnnotationEditorType.FREETEXT:return new k.FreeTextEditor(y);case a.AnnotationEditorType.INK:return new F.InkEditor(y)}return null},h=new WeakSet,fe=function(y){const D=this.getNextId(),et=ut(this,S,ke).call(this,{parent:this,id:D,x:y.offsetX,y:y.offsetY});return et&&this.add(et),et},o=new WeakSet,Fe=function(){yt(this,u,!0);for(const y of I(this,w).values())y.isEmpty()&&y.remove();yt(this,u,!1)},Mt(T,"_initialized",!1),n.AnnotationEditorLayer=T},(_,n,b)=>{var T,v,f,R,N,w,P,u,Oe,i,Me,S,De,h,ge;Object.defineProperty(n,"__esModule",{value:!0}),n.FreeTextEditor=void 0;var t=b(1),a=b(7),k=b(6);const o=class extends k.AnnotationEditor{constructor(x){super({...x,name:"freeTextEditor"});ot(this,u);ot(this,i);ot(this,S);ot(this,h);ot(this,T,this.editorDivBlur.bind(this));ot(this,v,this.editorDivFocus.bind(this));ot(this,f,this.editorDivKeydown.bind(this));ot(this,R,void 0);ot(this,N,"");ot(this,w,!1);ot(this,P,void 0);yt(this,R,x.color||o._defaultColor||k.AnnotationEditor._defaultLineColor),yt(this,P,x.fontSize||o._defaultFontSize)}static initialize(x){this._l10nPromise=new Map(["free_text_default_content","editor_free_text_aria_label"].map(D=>[D,x.get(D)]));const y=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(y.getPropertyValue("--freetext-padding"))}static updateDefaultParams(x,y){switch(x){case t.AnnotationEditorParamsType.FREETEXT_SIZE:o._defaultFontSize=y;break;case t.AnnotationEditorParamsType.FREETEXT_COLOR:o._defaultColor=y;break}}updateParams(x,y){switch(x){case t.AnnotationEditorParamsType.FREETEXT_SIZE:ut(this,u,Oe).call(this,y);break;case t.AnnotationEditorParamsType.FREETEXT_COLOR:ut(this,i,Me).call(this,y);break}}static get defaultPropertiesToUpdate(){return[[t.AnnotationEditorParamsType.FREETEXT_SIZE,o._defaultFontSize],[t.AnnotationEditorParamsType.FREETEXT_COLOR,o._defaultColor||k.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[t.AnnotationEditorParamsType.FREETEXT_SIZE,I(this,P)],[t.AnnotationEditorParamsType.FREETEXT_COLOR,I(this,R)]]}getInitialTranslation(){return[-o._internalPadding*this.parent.scaleFactor,-(o._internalPadding+I(this,P))*this.parent.scaleFactor]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(t.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.enableEditing(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.editorDiv.addEventListener("keydown",I(this,f)),this.editorDiv.addEventListener("focus",I(this,v)),this.editorDiv.addEventListener("blur",I(this,T)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.disableEditing(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",I(this,f)),this.editorDiv.removeEventListener("focus",I(this,v)),this.editorDiv.removeEventListener("blur",I(this,T)),this.div.focus(),this.isEditing=!1)}focusin(x){super.focusin(x),x.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),super.remove()}commit(){super.commit(),I(this,w)||(yt(this,w,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),yt(this,N,ut(this,S,De).call(this).trimEnd()),ut(this,h,ge).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(x){this.enableEditMode(),this.editorDiv.focus()}keydown(x){x.target===this.div&&x.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(x){o._keyboardManager.exec(this,x)}editorDivFocus(x){this.isEditing=!0}editorDivBlur(x){this.isEditing=!1}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let x,y;this.width&&(x=this.x,y=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",`${this.id}-editor`),this.enableEditing(),o._l10nPromise.get("editor_free_text_aria_label").then(et=>{var it;return(it=this.editorDiv)==null?void 0:it.setAttribute("aria-label",et)}),o._l10nPromise.get("free_text_default_content").then(et=>{var it;return(it=this.editorDiv)==null?void 0:it.setAttribute("default-content",et)}),this.editorDiv.contentEditable=!0;const{style:D}=this.editorDiv;if(D.fontSize=`calc(${I(this,P)}px * var(--scale-factor))`,D.color=I(this,R),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,a.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[et,it]=this.parent.viewportBaseDimensions;this.setAt(x*et,y*it,this.width*et,this.height*it);for(const Z of I(this,N).split(`
`)){const J=document.createElement("div");J.append(Z?document.createTextNode(Z):document.createElement("br")),this.editorDiv.append(J)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(x,y){const D=super.deserialize(x,y);return yt(D,P,x.fontSize),yt(D,R,t.Util.makeHexColor(...x.color)),yt(D,N,x.value),D}serialize(){if(this.isEmpty())return null;const x=o._internalPadding*this.parent.scaleFactor,y=this.getRect(x,x),D=k.AnnotationEditor._colorManager.convert(getComputedStyle(this.editorDiv).color);return{annotationType:t.AnnotationEditorType.FREETEXT,color:D,fontSize:I(this,P),value:I(this,N),pageIndex:this.parent.pageIndex,rect:y,rotation:this.rotation}}};let F=o;T=new WeakMap,v=new WeakMap,f=new WeakMap,R=new WeakMap,N=new WeakMap,w=new WeakMap,P=new WeakMap,u=new WeakSet,Oe=function(x){const y=et=>{this.editorDiv.style.fontSize=`calc(${et}px * var(--scale-factor))`,this.translate(0,-(et-I(this,P))*this.parent.scaleFactor),yt(this,P,et),ut(this,h,ge).call(this)},D=I(this,P);this.parent.addCommands({cmd:()=>{y(x)},undo:()=>{y(D)},mustExec:!0,type:t.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},i=new WeakSet,Me=function(x){const y=I(this,R);this.parent.addCommands({cmd:()=>{yt(this,R,x),this.editorDiv.style.color=x},undo:()=>{yt(this,R,y),this.editorDiv.style.color=y},mustExec:!0,type:t.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},S=new WeakSet,De=function(){const x=this.editorDiv.getElementsByTagName("div");if(x.length===0)return this.editorDiv.innerText;const y=[];for(let D=0,et=x.length;D<et;D++){const Z=x[D].firstChild;(Z==null?void 0:Z.nodeName)==="#text"?y.push(Z.data):y.push("")}return y.join(`
`)},h=new WeakSet,ge=function(){const[x,y]=this.parent.viewportBaseDimensions,D=this.div.getBoundingClientRect();this.width=D.width/x,this.height=D.height/y},Mt(F,"_freeTextDefaultContent",""),Mt(F,"_l10nPromise"),Mt(F,"_internalPadding",0),Mt(F,"_defaultColor",null),Mt(F,"_defaultFontSize",10),Mt(F,"_keyboardManager",new a.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],o.prototype.commitOrRemove]])),Mt(F,"_type","freetext"),n.FreeTextEditor=F},(_,n,b)=>{var f,R,N,w,P,u,e,i,c,S,E,h,s,o,m,Ie,x,Le,D,Ne,it,je,J,me,V,Ue,rt,Be,bt,We,p,$t,O,ye,B,ne,K,re,l,Kt,A,_e,L,se,st,be,tt,qe,nt,He,ft,Ge,pt,ve,St,ie,Pt,Jt,Ft,Ae;Object.defineProperty(n,"__esModule",{value:!0}),n.InkEditor=void 0,Object.defineProperty(n,"fitCurve",{enumerable:!0,get:function(){return k.fitCurve}});var t=b(1),a=b(6),k=b(25),F=b(7);const T=16,Ct=class extends a.AnnotationEditor{constructor(at){super({...at,name:"inkEditor"});ot(this,m);ot(this,x);ot(this,D);ot(this,it);ot(this,J);ot(this,V);ot(this,rt);ot(this,bt);ot(this,p);ot(this,O);ot(this,B);ot(this,K);ot(this,l);ot(this,A);ot(this,L);ot(this,tt);ot(this,nt);ot(this,ft);ot(this,pt);ot(this,St);ot(this,Pt);ot(this,Ft);ot(this,f,0);ot(this,R,0);ot(this,N,0);ot(this,w,this.canvasPointermove.bind(this));ot(this,P,this.canvasPointerleave.bind(this));ot(this,u,this.canvasPointerup.bind(this));ot(this,e,this.canvasPointerdown.bind(this));ot(this,i,!1);ot(this,c,!1);ot(this,S,null);ot(this,E,null);ot(this,h,0);ot(this,s,0);ot(this,o,null);this.color=at.color||null,this.thickness=at.thickness||null,this.opacity=at.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(at){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink_aria_label"].map(gt=>[gt,at.get(gt)]))}static updateDefaultParams(at,gt){switch(at){case t.AnnotationEditorParamsType.INK_THICKNESS:Ct._defaultThickness=gt;break;case t.AnnotationEditorParamsType.INK_COLOR:Ct._defaultColor=gt;break;case t.AnnotationEditorParamsType.INK_OPACITY:Ct._defaultOpacity=gt/100;break}}updateParams(at,gt){switch(at){case t.AnnotationEditorParamsType.INK_THICKNESS:ut(this,m,Ie).call(this,gt);break;case t.AnnotationEditorParamsType.INK_COLOR:ut(this,x,Le).call(this,gt);break;case t.AnnotationEditorParamsType.INK_OPACITY:ut(this,D,Ne).call(this,gt);break}}static get defaultPropertiesToUpdate(){return[[t.AnnotationEditorParamsType.INK_THICKNESS,Ct._defaultThickness],[t.AnnotationEditorParamsType.INK_COLOR,Ct._defaultColor||a.AnnotationEditor._defaultLineColor],[t.AnnotationEditorParamsType.INK_OPACITY,Math.round(Ct._defaultOpacity*100)]]}get propertiesToUpdate(){return[[t.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Ct._defaultThickness],[t.AnnotationEditorParamsType.INK_COLOR,this.color||Ct._defaultColor||a.AnnotationEditor._defaultLineColor],[t.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??Ct._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(ut(this,B,ne).call(this),ut(this,K,re).call(this)),this.isAttachedToDOM||(this.parent.add(this),ut(this,l,Kt).call(this)),ut(this,Pt,Jt).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,I(this,E).disconnect(),yt(this,E,null),super.remove())}enableEditMode(){I(this,i)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",I(this,e)),this.canvas.addEventListener("pointerup",I(this,u)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",I(this,e)),this.canvas.removeEventListener("pointerup",I(this,u)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){I(this,i)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),yt(this,i,!0),this.div.classList.add("disabled"),ut(this,Pt,Jt).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus())}focusin(at){super.focusin(at),this.enableEditMode()}canvasPointerdown(at){at.button!==0||!this.isInEditMode()||I(this,i)||(this.setInForeground(),at.type!=="mouse"&&this.div.focus(),at.stopPropagation(),this.canvas.addEventListener("pointerleave",I(this,P)),this.canvas.addEventListener("pointermove",I(this,w)),ut(this,V,Ue).call(this,at.offsetX,at.offsetY))}canvasPointermove(at){at.stopPropagation(),ut(this,rt,Be).call(this,at.offsetX,at.offsetY)}canvasPointerup(at){at.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(at.stopPropagation(),ut(this,O,ye).call(this,at),this.setInBackground())}canvasPointerleave(at){ut(this,O,ye).call(this,at),this.setInBackground()}render(){if(this.div)return this.div;let at,gt;this.width&&(at=this.x,gt=this.y),super.render(),Ct._l10nPromise.get("editor_ink_aria_label").then(_t=>{var At;return(At=this.div)==null?void 0:At.setAttribute("aria-label",_t)});const[Q,$,z,mt]=ut(this,it,je).call(this);if(this.setAt(Q,$,0,0),this.setDims(z,mt),ut(this,B,ne).call(this),this.width){const[_t,At]=this.parent.viewportBaseDimensions;this.setAt(at*_t,gt*At,this.width*_t,this.height*At),yt(this,c,!0),ut(this,l,Kt).call(this),this.setDims(this.width*_t,this.height*At),ut(this,p,$t).call(this),ut(this,Ft,Ae).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return ut(this,K,re).call(this),this.div}setDimensions(at,gt){const Q=Math.round(at),$=Math.round(gt);if(I(this,h)===Q&&I(this,s)===$)return;yt(this,h,Q),yt(this,s,$),this.canvas.style.visibility="hidden",I(this,f)&&Math.abs(I(this,f)-at/gt)>.01&&(gt=Math.ceil(at/I(this,f)),this.setDims(at,gt));const[z,mt]=this.parent.viewportBaseDimensions;this.width=at/z,this.height=gt/mt,I(this,i)&&ut(this,A,_e).call(this,at,gt),ut(this,l,Kt).call(this),ut(this,p,$t).call(this),this.canvas.style.visibility="visible"}static deserialize(at,gt){var It,kt;const Q=super.deserialize(at,gt);Q.thickness=at.thickness,Q.color=t.Util.makeHexColor(...at.color),Q.opacity=at.opacity;const[$,z]=gt.pageDimensions,mt=Q.width*$,_t=Q.height*z,At=gt.scaleFactor,Et=at.thickness/2;yt(Q,f,mt/_t),yt(Q,i,!0),yt(Q,h,Math.round(mt)),yt(Q,s,Math.round(_t));for(const{bezier:xt}of at.paths){const Nt=[];Q.paths.push(Nt);let Lt=At*(xt[0]-Et),Bt=At*(_t-xt[1]-Et);for(let jt=2,qt=xt.length;jt<qt;jt+=6){const Vt=At*(xt[jt]-Et),Xt=At*(_t-xt[jt+1]-Et),Gt=At*(xt[jt+2]-Et),Ut=At*(_t-xt[jt+3]-Et),Ht=At*(xt[jt+4]-Et),Yt=At*(_t-xt[jt+5]-Et);Nt.push([[Lt,Bt],[Vt,Xt],[Gt,Ut],[Ht,Yt]]),Lt=Ht,Bt=Yt}const Rt=ut(this,st,be).call(this,Nt);Q.bezierPath2D.push(Rt)}const wt=ut(It=Q,pt,ve).call(It);return yt(Q,N,Math.max(T,wt[2]-wt[0])),yt(Q,R,Math.max(T,wt[3]-wt[1])),ut(kt=Q,A,_e).call(kt,mt,_t),Q}serialize(){if(this.isEmpty())return null;const at=this.getRect(0,0),gt=this.rotation%180===0?at[3]-at[1]:at[2]-at[0],Q=a.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:t.AnnotationEditorType.INK,color:Q,thickness:this.thickness,opacity:this.opacity,paths:ut(this,tt,qe).call(this,this.scaleFactor/this.parent.scaleFactor,this.translationX,this.translationY,gt),pageIndex:this.parent.pageIndex,rect:at,rotation:this.rotation}}};let v=Ct;f=new WeakMap,R=new WeakMap,N=new WeakMap,w=new WeakMap,P=new WeakMap,u=new WeakMap,e=new WeakMap,i=new WeakMap,c=new WeakMap,S=new WeakMap,E=new WeakMap,h=new WeakMap,s=new WeakMap,o=new WeakMap,m=new WeakSet,Ie=function(at){const gt=this.thickness;this.parent.addCommands({cmd:()=>{this.thickness=at,ut(this,Pt,Jt).call(this)},undo:()=>{this.thickness=gt,ut(this,Pt,Jt).call(this)},mustExec:!0,type:t.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},x=new WeakSet,Le=function(at){const gt=this.color;this.parent.addCommands({cmd:()=>{this.color=at,ut(this,p,$t).call(this)},undo:()=>{this.color=gt,ut(this,p,$t).call(this)},mustExec:!0,type:t.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},D=new WeakSet,Ne=function(at){at/=100;const gt=this.opacity;this.parent.addCommands({cmd:()=>{this.opacity=at,ut(this,p,$t).call(this)},undo:()=>{this.opacity=gt,ut(this,p,$t).call(this)},mustExec:!0,type:t.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},it=new WeakSet,je=function(){const{width:at,height:gt,rotation:Q}=this.parent.viewport;switch(Q){case 90:return[0,at,at,gt];case 180:return[at,gt,at,gt];case 270:return[gt,0,at,gt];default:return[0,0,at,gt]}},J=new WeakSet,me=function(){this.ctx.lineWidth=this.thickness*this.parent.scaleFactor/this.scaleFactor,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.miterLimit=10,this.ctx.strokeStyle=`${this.color}${(0,F.opacityToHex)(this.opacity)}`},V=new WeakSet,Ue=function(at,gt){this.isEditing=!0,I(this,c)||(yt(this,c,!0),ut(this,l,Kt).call(this),this.thickness||(this.thickness=Ct._defaultThickness),this.color||(this.color=Ct._defaultColor||a.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=Ct._defaultOpacity)),this.currentPath.push([at,gt]),yt(this,S,null),ut(this,J,me).call(this),this.ctx.beginPath(),this.ctx.moveTo(at,gt),yt(this,o,()=>{I(this,o)&&(I(this,S)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):ut(this,p,$t).call(this),this.ctx.lineTo(...I(this,S)),yt(this,S,null),this.ctx.stroke()),window.requestAnimationFrame(I(this,o)))}),window.requestAnimationFrame(I(this,o))},rt=new WeakSet,Be=function(at,gt){const[Q,$]=this.currentPath.at(-1);at===Q&&gt===$||(this.currentPath.push([at,gt]),yt(this,S,[at,gt]))},bt=new WeakSet,We=function(at,gt){var Et;this.ctx.closePath(),yt(this,o,null),at=Math.min(Math.max(at,0),this.canvas.width),gt=Math.min(Math.max(gt,0),this.canvas.height);const[Q,$]=this.currentPath.at(-1);(at!==Q||gt!==$)&&this.currentPath.push([at,gt]);let z;if(this.currentPath.length!==1)z=(0,k.fitCurve)(this.currentPath,30,null);else{const wt=[at,gt];z=[[wt,wt.slice(),wt.slice(),wt]]}const mt=ut(Et=Ct,st,be).call(Et,z);this.currentPath.length=0;const _t=()=>{this.paths.push(z),this.bezierPath2D.push(mt),this.rebuild()},At=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(ut(this,B,ne).call(this),ut(this,K,re).call(this)),ut(this,Pt,Jt).call(this))};this.parent.addCommands({cmd:_t,undo:At,mustExec:!0})},p=new WeakSet,$t=function(){if(this.isEmpty()){ut(this,L,se).call(this);return}ut(this,J,me).call(this);const{canvas:at,ctx:gt}=this;gt.setTransform(1,0,0,1,0,0),gt.clearRect(0,0,at.width,at.height),ut(this,L,se).call(this);for(const Q of this.bezierPath2D)gt.stroke(Q)},O=new WeakSet,ye=function(at){ut(this,bt,We).call(this,at.offsetX,at.offsetY),this.canvas.removeEventListener("pointerleave",I(this,P)),this.canvas.removeEventListener("pointermove",I(this,w)),this.parent.addToAnnotationStorage(this)},B=new WeakSet,ne=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",Ct._l10nPromise.get("editor_ink_canvas_aria_label").then(at=>{var gt;return(gt=this.canvas)==null?void 0:gt.setAttribute("aria-label",at)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},K=new WeakSet,re=function(){yt(this,E,new ResizeObserver(at=>{const gt=at[0].contentRect;gt.width&&gt.height&&this.setDimensions(gt.width,gt.height)})),I(this,E).observe(this.div)},l=new WeakSet,Kt=function(){if(!I(this,c))return;const[at,gt]=this.parent.viewportBaseDimensions;this.canvas.width=Math.ceil(this.width*at),this.canvas.height=Math.ceil(this.height*gt),ut(this,L,se).call(this)},A=new WeakSet,_e=function(at,gt){const Q=ut(this,St,ie).call(this),$=(at-Q)/I(this,N),z=(gt-Q)/I(this,R);this.scaleFactor=Math.min($,z)},L=new WeakSet,se=function(){const at=ut(this,St,ie).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+at,this.translationY*this.scaleFactor+at)},st=new WeakSet,be=function(at){const gt=new Path2D;for(let Q=0,$=at.length;Q<$;Q++){const[z,mt,_t,At]=at[Q];Q===0&&gt.moveTo(...z),gt.bezierCurveTo(mt[0],mt[1],_t[0],_t[1],At[0],At[1])}return gt},tt=new WeakSet,qe=function(at,gt,Q,$){const mt=[],_t=this.thickness/2;let At,Et;for(const wt of this.paths){At=[],Et=[];for(let It=0,kt=wt.length;It<kt;It++){const[xt,Nt,Lt,Bt]=wt[It],Rt=at*(xt[0]+gt)+_t,jt=$-at*(xt[1]+Q)-_t,qt=at*(Nt[0]+gt)+_t,Vt=$-at*(Nt[1]+Q)-_t,Xt=at*(Lt[0]+gt)+_t,Gt=$-at*(Lt[1]+Q)-_t,Ut=at*(Bt[0]+gt)+_t,Ht=$-at*(Bt[1]+Q)-_t;It===0&&(At.push(Rt,jt),Et.push(Rt,jt)),At.push(qt,Vt,Xt,Gt,Ut,Ht),ut(this,nt,He).call(this,Rt,jt,qt,Vt,Xt,Gt,Ut,Ht,4,Et)}mt.push({bezier:At,points:Et})}return mt},nt=new WeakSet,He=function(at,gt,Q,$,z,mt,_t,At,Et,wt){if(ut(this,ft,Ge).call(this,at,gt,Q,$,z,mt,_t,At)){wt.push(_t,At);return}for(let It=1;It<Et-1;It++){const kt=It/Et,xt=1-kt;let Nt=kt*at+xt*Q,Lt=kt*gt+xt*$,Bt=kt*Q+xt*z,Rt=kt*$+xt*mt;const jt=kt*z+xt*_t,qt=kt*mt+xt*At;Nt=kt*Nt+xt*Bt,Lt=kt*Lt+xt*Rt,Bt=kt*Bt+xt*jt,Rt=kt*Rt+xt*qt,Nt=kt*Nt+xt*Bt,Lt=kt*Lt+xt*Rt,wt.push(Nt,Lt)}wt.push(_t,At)},ft=new WeakSet,Ge=function(at,gt,Q,$,z,mt,_t,At){const wt=(3*Q-2*at-_t)**2,It=(3*$-2*gt-At)**2,kt=(3*z-at-2*_t)**2,xt=(3*mt-gt-2*At)**2;return Math.max(wt,kt)+Math.max(It,xt)<=10},pt=new WeakSet,ve=function(){let at=1/0,gt=-1/0,Q=1/0,$=-1/0;for(const z of this.paths)for(const[mt,_t,At,Et]of z){const wt=t.Util.bezierBoundingBox(...mt,..._t,...At,...Et);at=Math.min(at,wt[0]),Q=Math.min(Q,wt[1]),gt=Math.max(gt,wt[2]),$=Math.max($,wt[3])}return[at,Q,gt,$]},St=new WeakSet,ie=function(){return I(this,i)?Math.ceil(this.thickness*this.parent.scaleFactor):0},Pt=new WeakSet,Jt=function(at=!1){if(this.isEmpty())return;if(!I(this,i)){ut(this,p,$t).call(this);return}const gt=ut(this,pt,ve).call(this),Q=ut(this,St,ie).call(this);yt(this,N,Math.max(T,gt[2]-gt[0])),yt(this,R,Math.max(T,gt[3]-gt[1]));const $=Math.ceil(Q+I(this,N)*this.scaleFactor),z=Math.ceil(Q+I(this,R)*this.scaleFactor),[mt,_t]=this.parent.viewportBaseDimensions;this.width=$/mt,this.height=z/_t,yt(this,f,$/z),ut(this,Ft,Ae).call(this);const At=this.translationX,Et=this.translationY;this.translationX=-gt[0],this.translationY=-gt[1],ut(this,l,Kt).call(this),ut(this,p,$t).call(this),yt(this,h,$),yt(this,s,z),this.setDims($,z);const wt=at?Q/this.scaleFactor/2:0;this.translate(At-this.translationX-wt,Et-this.translationY-wt)},Ft=new WeakSet,Ae=function(){const{style:at}=this.div;I(this,f)>=1?(at.minHeight=`${T}px`,at.minWidth=`${Math.round(I(this,f)*T)}px`):(at.minWidth=`${T}px`,at.minHeight=`${Math.round(T/I(this,f))}px`)},ot(v,st),Mt(v,"_defaultColor",null),Mt(v,"_defaultOpacity",1),Mt(v,"_defaultThickness",1),Mt(v,"_l10nPromise"),Mt(v,"_type","ink"),n.InkEditor=v},(_,n,b)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.fitCurve=void 0;const t=b(26);n.fitCurve=t},_=>{function n(u,e,i){if(!Array.isArray(u))throw new TypeError("First argument should be an array");if(u.forEach(h=>{if(!Array.isArray(h)||h.some(s=>typeof s!="number")||h.length!==u[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),u=u.filter((h,s)=>s===0||!h.every((o,m)=>o===u[s-1][m])),u.length<2)return[];const c=u.length,S=N(u[1],u[0]),E=N(u[c-2],u[c-1]);return b(u,S,E,e,i)}function b(u,e,i,c,S){var h,s,o,m,M,x,y,D,et,it,Z,J,G;if(u.length===2)return J=w.vectorLen(w.subtract(u[0],u[1]))/3,h=[u[0],w.addArrays(u[0],w.mulItems(e,J)),w.addArrays(u[1],w.mulItems(i,J)),u[1]],[h];if(s=T(u),[h,m,x]=t(u,s,s,e,i,S),m===0||m<c)return[h];if(m<c*c)for(o=s,M=m,y=x,G=0;G<20;G++){if(o=k(h,u,o),[h,m,x]=t(u,s,o,e,i,S),m<c)return[h];if(x===y){let V=m/M;if(V>.9999&&V<1.0001)break}M=m,y=x}return Z=[],D=w.subtract(u[x-1],u[x+1]),D.every(V=>V===0)&&(D=w.subtract(u[x-1],u[x]),[D[0],D[1]]=[-D[1],D[0]]),et=w.normalize(D),it=w.mulItems(et,-1),Z=Z.concat(b(u.slice(0,x+1),e,et,c,S)),Z=Z.concat(b(u.slice(x),it,i,c,S)),Z}function t(u,e,i,c,S,E){var h,s,o;return h=a(u,i,c,S),[s,o]=v(u,h,e),E&&E({bez:h,points:u,params:e,maxErr:s,maxPoint:o}),[h,s,o]}function a(u,e,i,c){var S,E,h,s,o,m,M,x,y,D,et,it,Z,J,G,V,Y,rt=u[0],ct=u[u.length-1];for(S=[rt,null,null,ct],E=w.zeros_Xx2x2(e.length),Z=0,J=e.length;Z<J;Z++)V=e[Z],Y=1-V,h=E[Z],h[0]=w.mulItems(i,3*V*(Y*Y)),h[1]=w.mulItems(c,3*Y*(V*V));for(s=[[0,0],[0,0]],o=[0,0],Z=0,J=u.length;Z<J;Z++)V=e[Z],h=E[Z],s[0][0]+=w.dot(h[0],h[0]),s[0][1]+=w.dot(h[0],h[1]),s[1][0]+=w.dot(h[0],h[1]),s[1][1]+=w.dot(h[1],h[1]),G=w.subtract(u[Z],P.q([rt,rt,ct,ct],V)),o[0]+=w.dot(h[0],G),o[1]+=w.dot(h[1],G);return m=s[0][0]*s[1][1]-s[1][0]*s[0][1],M=s[0][0]*o[1]-s[1][0]*o[0],x=o[0]*s[1][1]-o[1]*s[0][1],y=m===0?0:x/m,D=m===0?0:M/m,it=w.vectorLen(w.subtract(rt,ct)),et=1e-6*it,y<et||D<et?(S[1]=w.addArrays(rt,w.mulItems(i,it/3)),S[2]=w.addArrays(ct,w.mulItems(c,it/3))):(S[1]=w.addArrays(rt,w.mulItems(i,y)),S[2]=w.addArrays(ct,w.mulItems(c,D))),S}function k(u,e,i){return i.map((c,S)=>F(u,e[S],c))}function F(u,e,i){var c=w.subtract(P.q(u,i),e),S=P.qprime(u,i),E=w.mulMatrix(c,S),h=w.sum(w.squareItems(S))+2*w.mulMatrix(c,P.qprimeprime(u,i));return h===0?i:i-E/h}function T(u){var e=[],i,c,S;return u.forEach((E,h)=>{i=h?c+w.vectorLen(w.subtract(E,S)):0,e.push(i),c=i,S=E}),e=e.map(E=>E/c),e}function v(u,e,i){var c,S,E,h,s,o,m,M;S=0,E=Math.floor(u.length/2);const x=f(e,10);for(s=0,o=u.length;s<o;s++)m=u[s],M=R(e,i[s],x,10),h=w.subtract(P.q(e,M),m),c=h[0]*h[0]+h[1]*h[1],c>S&&(S=c,E=s);return[S,E]}var f=function(u,e){for(var i,c=[0],S=u[0],E=0,h=1;h<=e;h++)i=P.q(u,h/e),E+=w.vectorLen(w.subtract(i,S)),c.push(E),S=i;return c=c.map(s=>s/E),c};function R(u,e,i,c){if(e<0)return 0;if(e>1)return 1;for(var S,E,h,s,o,m=1;m<=c;m++)if(e<=i[m]){s=(m-1)/c,h=m/c,E=i[m-1],S=i[m],o=(e-E)/(S-E)*(h-s)+s;break}return o}function N(u,e){return w.normalize(w.subtract(u,e))}class w{static zeros_Xx2x2(e){for(var i=[];e--;)i.push([0,0]);return i}static mulItems(e,i){return e.map(c=>c*i)}static mulMatrix(e,i){return e.reduce((c,S,E)=>c+S*i[E],0)}static subtract(e,i){return e.map((c,S)=>c-i[S])}static addArrays(e,i){return e.map((c,S)=>c+i[S])}static addItems(e,i){return e.map(c=>c+i)}static sum(e){return e.reduce((i,c)=>i+c)}static dot(e,i){return w.mulMatrix(e,i)}static vectorLen(e){return Math.hypot(...e)}static divItems(e,i){return e.map(c=>c/i)}static squareItems(e){return e.map(i=>i*i)}static normalize(e){return this.divItems(e,this.vectorLen(e))}}class P{static q(e,i){var c=1-i,S=w.mulItems(e[0],c*c*c),E=w.mulItems(e[1],3*c*c*i),h=w.mulItems(e[2],3*c*i*i),s=w.mulItems(e[3],i*i*i);return w.addArrays(w.addArrays(S,E),w.addArrays(h,s))}static qprime(e,i){var c=1-i,S=w.mulItems(w.subtract(e[1],e[0]),3*c*c),E=w.mulItems(w.subtract(e[2],e[1]),6*c*i),h=w.mulItems(w.subtract(e[3],e[2]),3*i*i);return w.addArrays(w.addArrays(S,E),h)}static qprimeprime(e,i){return w.addArrays(w.mulItems(w.addArrays(w.subtract(e[2],w.mulItems(e[1],2)),e[0]),6*(1-i)),w.mulItems(w.addArrays(w.subtract(e[3],w.mulItems(e[2],2)),e[1]),6*i))}}_.exports=n,_.exports.fitCubic=b,_.exports.createTangent=N},(_,n,b)=>{var p,Se,O,Ee,B,Te;Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationLayer=void 0;var t=b(1),a=b(8),k=b(5),F=b(28),T=b(29);const v=1e3,f=9,R=new WeakSet;function N(X){return{width:X[2]-X[0],height:X[3]-X[1]}}class w{static create(l){switch(l.data.annotationType){case t.AnnotationType.LINK:return new u(l);case t.AnnotationType.TEXT:return new e(l);case t.AnnotationType.WIDGET:switch(l.data.fieldType){case"Tx":return new c(l);case"Btn":return l.data.radioButton?new E(l):l.data.checkBox?new S(l):new h(l);case"Ch":return new s(l)}return new i(l);case t.AnnotationType.POPUP:return new o(l);case t.AnnotationType.FREETEXT:return new M(l);case t.AnnotationType.LINE:return new x(l);case t.AnnotationType.SQUARE:return new y(l);case t.AnnotationType.CIRCLE:return new D(l);case t.AnnotationType.POLYLINE:return new et(l);case t.AnnotationType.CARET:return new Z(l);case t.AnnotationType.INK:return new J(l);case t.AnnotationType.POLYGON:return new it(l);case t.AnnotationType.HIGHLIGHT:return new G(l);case t.AnnotationType.UNDERLINE:return new V(l);case t.AnnotationType.SQUIGGLY:return new Y(l);case t.AnnotationType.STRIKEOUT:return new rt(l);case t.AnnotationType.STAMP:return new ct(l);case t.AnnotationType.FILEATTACHMENT:return new bt(l);default:return new P(l)}}}class P{constructor(l,{isRenderable:g=!1,ignoreBorder:A=!1,createQuadrilaterals:C=!1}={}){this.isRenderable=g,this.data=l.data,this.layer=l.layer,this.page=l.page,this.viewport=l.viewport,this.linkService=l.linkService,this.downloadManager=l.downloadManager,this.imageResourcesPath=l.imageResourcesPath,this.renderForms=l.renderForms,this.svgFactory=l.svgFactory,this.annotationStorage=l.annotationStorage,this.enableScripting=l.enableScripting,this.hasJSActions=l.hasJSActions,this._fieldObjects=l.fieldObjects,this._mouseState=l.mouseState,g&&(this.container=this._createContainer(A)),C&&(this.quadrilaterals=this._createQuadrilaterals(A))}_createContainer(l=!1){const g=this.data,A=this.page,C=this.viewport,L=document.createElement("section"),{width:H,height:st}=N(g.rect),[dt,tt,lt,nt]=C.viewBox,ht=lt-dt,ft=nt-tt;L.setAttribute("data-annotation-id",g.id);const j=t.Util.normalizeRect([g.rect[0],A.view[3]-g.rect[1]+A.view[1],g.rect[2],A.view[3]-g.rect[3]+A.view[1]]);if(!l&&g.borderStyle.width>0){L.style.borderWidth=`${g.borderStyle.width}px`;const vt=g.borderStyle.horizontalCornerRadius,St=g.borderStyle.verticalCornerRadius;if(vt>0||St>0){const Pt=`calc(${vt}px * var(--scale-factor)) / calc(${St}px * var(--scale-factor))`;L.style.borderRadius=Pt}else if(this instanceof E){const Pt=`calc(${H}px * var(--scale-factor)) / calc(${st}px * var(--scale-factor))`;L.style.borderRadius=Pt}switch(g.borderStyle.style){case t.AnnotationBorderStyleType.SOLID:L.style.borderStyle="solid";break;case t.AnnotationBorderStyleType.DASHED:L.style.borderStyle="dashed";break;case t.AnnotationBorderStyleType.BEVELED:(0,t.warn)("Unimplemented border style: beveled");break;case t.AnnotationBorderStyleType.INSET:(0,t.warn)("Unimplemented border style: inset");break;case t.AnnotationBorderStyleType.UNDERLINE:L.style.borderBottomStyle="solid";break}const Tt=g.borderColor||null;Tt?L.style.borderColor=t.Util.makeHexColor(Tt[0]|0,Tt[1]|0,Tt[2]|0):L.style.borderWidth=0}L.style.left=`${100*(j[0]-dt)/ht}%`,L.style.top=`${100*(j[1]-tt)/ft}%`;const{rotation:pt}=g;return g.hasOwnCanvas||pt===0?(L.style.width=`${100*H/ht}%`,L.style.height=`${100*st/ft}%`):this.setRotation(pt,L),L}setRotation(l,g=this.container){const[A,C,L,H]=this.viewport.viewBox,st=L-A,dt=H-C,{width:tt,height:lt}=N(this.data.rect);let nt,ht;l%180===0?(nt=100*tt/st,ht=100*lt/dt):(nt=100*lt/st,ht=100*tt/dt),g.style.width=`${nt}%`,g.style.height=`${ht}%`,g.setAttribute("data-main-rotation",(360-l)%360)}get _commonActions(){const l=(g,A,C)=>{const L=C.detail[g];C.target.style[A]=F.ColorConverters[`${L[0]}_HTML`](L.slice(1))};return(0,t.shadow)(this,"_commonActions",{display:g=>{const A=g.detail.display%2===1;this.container.style.visibility=A?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:A,print:g.detail.display===0||g.detail.display===3})},print:g=>{this.annotationStorage.setValue(this.data.id,{print:g.detail.print})},hidden:g=>{this.container.style.visibility=g.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:g.detail.hidden})},focus:g=>{setTimeout(()=>g.target.focus({preventScroll:!1}),0)},userName:g=>{g.target.title=g.detail.userName},readonly:g=>{g.detail.readonly?g.target.setAttribute("readonly",""):g.target.removeAttribute("readonly")},required:g=>{this._setRequired(g.target,g.detail.required)},bgColor:g=>{l("bgColor","backgroundColor",g)},fillColor:g=>{l("fillColor","backgroundColor",g)},fgColor:g=>{l("fgColor","color",g)},textColor:g=>{l("textColor","color",g)},borderColor:g=>{l("borderColor","borderColor",g)},strokeColor:g=>{l("strokeColor","borderColor",g)},rotation:g=>{const A=g.detail.rotation;this.setRotation(A),this.annotationStorage.setValue(this.data.id,{rotation:A})}})}_dispatchEventFromSandbox(l,g){const A=this._commonActions;for(const C of Object.keys(g.detail)){const L=l[C]||A[C];L&&L(g)}}_setDefaultPropertiesFromJS(l){if(!this.enableScripting)return;const g=this.annotationStorage.getRawValue(this.data.id);if(!g)return;const A=this._commonActions;for(const[C,L]of Object.entries(g)){const H=A[C];if(H){const st={detail:{[C]:L},target:l};H(st),delete g[C]}}}_createQuadrilaterals(l=!1){if(!this.data.quadPoints)return null;const g=[],A=this.data.rect;for(const C of this.data.quadPoints)this.data.rect=[C[2].x,C[2].y,C[1].x,C[1].y],g.push(this._createContainer(l));return this.data.rect=A,g}_createPopup(l,g){let A=this.container;this.quadrilaterals&&(l=l||this.quadrilaterals,A=this.quadrilaterals[0]),l||(l=document.createElement("div"),l.className="popupTriggerArea",A.append(l));const L=new m({container:A,trigger:l,color:g.color,titleObj:g.titleObj,modificationDate:g.modificationDate,contentsObj:g.contentsObj,richText:g.richText,hideWrapper:!0}).render();L.style.left="100%",A.append(L)}_renderQuadrilaterals(l){for(const g of this.quadrilaterals)g.className=l;return this.quadrilaterals}render(){(0,t.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(l,g=null){const A=[];if(this._fieldObjects){const C=this._fieldObjects[l];if(C)for(const{page:L,id:H,exportValues:st}of C){if(L===-1||H===g)continue;const dt=typeof st=="string"?st:null,tt=document.querySelector(`[data-element-id="${H}"]`);if(tt&&!R.has(tt)){(0,t.warn)(`_getElementsByName - element not allowed: ${H}`);continue}A.push({id:H,exportValue:dt,domElement:tt})}return A}for(const C of document.getElementsByName(l)){const{id:L,exportValue:H}=C;L!==g&&R.has(C)&&A.push({id:L,exportValue:H,domElement:C})}return A}static get platform(){const l=typeof navigator<"u"?navigator.platform:"";return(0,t.shadow)(this,"platform",{isWin:l.includes("Win"),isMac:l.includes("Mac")})}}class u extends P{constructor(l,g=null){super(l,{isRenderable:!0,ignoreBorder:!!(g!=null&&g.ignoreBorder),createQuadrilaterals:!0}),this.isTooltipOnly=l.data.isTooltipOnly}render(){const{data:l,linkService:g}=this,A=document.createElement("a");A.setAttribute("data-element-id",l.id);let C=!1;return l.url?(g.addLinkAttributes(A,l.url,l.newWindow),C=!0):l.action?(this._bindNamedAction(A,l.action),C=!0):l.dest?(this._bindLink(A,l.dest),C=!0):(l.actions&&(l.actions.Action||l.actions["Mouse Up"]||l.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(A,l),C=!0),l.resetForm?(this._bindResetFormAction(A,l.resetForm),C=!0):this.isTooltipOnly&&!C&&(this._bindLink(A,""),C=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((L,H)=>{const st=H===0?A:A.cloneNode();return L.append(st),L}):(this.container.className="linkAnnotation",C&&this.container.append(A),this.container)}_bindLink(l,g){l.href=this.linkService.getDestinationHash(g),l.onclick=()=>(g&&this.linkService.goToDestination(g),!1),(g||g==="")&&(l.className="internalLink")}_bindNamedAction(l,g){l.href=this.linkService.getAnchorUrl(""),l.onclick=()=>(this.linkService.executeNamedAction(g),!1),l.className="internalLink"}_bindJSAction(l,g){l.href=this.linkService.getAnchorUrl("");const A=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const C of Object.keys(g.actions)){const L=A.get(C);L&&(l[L]=()=>{var H;return(H=this.linkService.eventBus)==null||H.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g.id,name:C}}),!1})}l.onclick||(l.onclick=()=>!1),l.className="internalLink"}_bindResetFormAction(l,g){const A=l.onclick;if(A||(l.href=this.linkService.getAnchorUrl("")),l.className="internalLink",!this._fieldObjects){(0,t.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),A||(l.onclick=()=>!1);return}l.onclick=()=>{var lt;A&&A();const{fields:C,refs:L,include:H}=g,st=[];if(C.length!==0||L.length!==0){const nt=new Set(L);for(const ht of C){const ft=this._fieldObjects[ht]||[];for(const{id:j}of ft)nt.add(j)}for(const ht of Object.values(this._fieldObjects))for(const ft of ht)nt.has(ft.id)===H&&st.push(ft)}else for(const nt of Object.values(this._fieldObjects))st.push(...nt);const dt=this.annotationStorage,tt=[];for(const nt of st){const{id:ht}=nt;switch(tt.push(ht),nt.type){case"text":{const j=nt.defaultValue||"";dt.setValue(ht,{value:j});break}case"checkbox":case"radiobutton":{const j=nt.defaultValue===nt.exportValues;dt.setValue(ht,{value:j});break}case"combobox":case"listbox":{const j=nt.defaultValue||"";dt.setValue(ht,{value:j});break}default:continue}const ft=document.querySelector(`[data-element-id="${ht}"]`);if(ft){if(!R.has(ft)){(0,t.warn)(`_bindResetFormAction - element not allowed: ${ht}`);continue}}else continue;ft.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((lt=this.linkService.eventBus)==null||lt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:tt,name:"ResetForm"}})),!1}}}class e extends P{constructor(l){var A,C,L;const g=!!(l.data.hasPopup||(A=l.data.titleObj)!=null&&A.str||(C=l.data.contentsObj)!=null&&C.str||(L=l.data.richText)!=null&&L.str);super(l,{isRenderable:g})}render(){this.container.className="textAnnotation";const l=document.createElement("img");return l.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",l.alt="[{{type}} Annotation]",l.dataset.l10nId="text_annotation_type",l.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(l,this.data),this.container.append(l),this.container}}class i extends P{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(l){const{isWin:g,isMac:A}=P.platform;return g&&l.ctrlKey||A&&l.metaKey}_setEventListener(l,g,A,C){g.includes("mouse")?l.addEventListener(g,L=>{var H;(H=this.linkService.eventBus)==null||H.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:A,value:C(L),shift:L.shiftKey,modifier:this._getKeyModifier(L)}})}):l.addEventListener(g,L=>{var H;(H=this.linkService.eventBus)==null||H.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:A,value:C(L)}})})}_setEventListeners(l,g,A){var C;for(const[L,H]of g)(H==="Action"||(C=this.data.actions)!=null&&C[H])&&this._setEventListener(l,L,H,A)}_setBackgroundColor(l){const g=this.data.backgroundColor||null;l.style.backgroundColor=g===null?"transparent":t.Util.makeHexColor(g[0],g[1],g[2])}_setTextStyle(l){const g=["left","center","right"],{fontColor:A}=this.data.defaultAppearanceData,C=this.data.defaultAppearanceData.fontSize||f,L=l.style;let H;if(this.data.multiLine){const st=Math.abs(this.data.rect[3]-this.data.rect[1]),dt=Math.round(st/(t.LINE_FACTOR*C))||1,tt=st/dt;H=Math.min(C,Math.round(tt/t.LINE_FACTOR))}else{const st=Math.abs(this.data.rect[3]-this.data.rect[1]);H=Math.min(C,Math.round(st/t.LINE_FACTOR))}L.fontSize=`calc(${H}px * var(--scale-factor))`,L.color=t.Util.makeHexColor(A[0],A[1],A[2]),this.data.textAlignment!==null&&(L.textAlign=g[this.data.textAlignment])}_setRequired(l,g){g?l.setAttribute("required",!0):l.removeAttribute("required"),l.setAttribute("aria-required",g)}}class c extends i{constructor(l){const g=l.renderForms||!l.data.hasAppearance&&!!l.data.fieldValue;super(l,{isRenderable:g})}setPropertyOnSiblings(l,g,A,C){const L=this.annotationStorage;for(const H of this._getElementsByName(l.name,l.id))H.domElement&&(H.domElement[g]=A),L.setValue(H.id,{[C]:A})}render(){var C;const l=this.annotationStorage,g=this.data.id;this.container.className="textWidgetAnnotation";let A=null;if(this.renderForms){const L=l.getValue(g,{value:this.data.fieldValue});let H=L.formattedValue||L.value||"";const st=l.getValue(g,{charLimit:this.data.maxLen}).charLimit;st&&H.length>st&&(H=H.slice(0,st));const dt={userValue:H,formattedValue:null,valueOnFocus:""};this.data.multiLine?(A=document.createElement("textarea"),A.textContent=H,this.data.doNotScroll&&(A.style.overflowY="hidden")):(A=document.createElement("input"),A.type="text",A.setAttribute("value",H),this.data.doNotScroll&&(A.style.overflowX="hidden")),R.add(A),A.setAttribute("data-element-id",g),A.disabled=this.data.readOnly,A.name=this.data.fieldName,A.tabIndex=v,this._setRequired(A,this.data.required),st&&(A.maxLength=st),A.addEventListener("input",lt=>{l.setValue(g,{value:lt.target.value}),this.setPropertyOnSiblings(A,"value",lt.target.value,"value")}),A.addEventListener("resetform",lt=>{const nt=this.data.defaultFieldValue??"";A.value=dt.userValue=nt,dt.formattedValue=null});let tt=lt=>{const{formattedValue:nt}=dt;nt!=null&&(lt.target.value=nt),lt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){A.addEventListener("focus",nt=>{dt.userValue&&(nt.target.value=dt.userValue),dt.valueOnFocus=nt.target.value}),A.addEventListener("updatefromsandbox",nt=>{const ht={value(ft){dt.userValue=ft.detail.value??"",l.setValue(g,{value:dt.userValue.toString()}),ft.target.value=dt.userValue},formattedValue(ft){const{formattedValue:j}=ft.detail;dt.formattedValue=j,j!=null&&ft.target!==document.activeElement&&(ft.target.value=j),l.setValue(g,{formattedValue:j})},selRange(ft){ft.target.setSelectionRange(...ft.detail.selRange)},charLimit:ft=>{var St;const{charLimit:j}=ft.detail,{target:pt}=ft;if(j===0){pt.removeAttribute("maxLength");return}pt.setAttribute("maxLength",j);let vt=dt.userValue;!vt||vt.length<=j||(vt=vt.slice(0,j),pt.value=dt.userValue=vt,l.setValue(g,{value:vt}),(St=this.linkService.eventBus)==null||St.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:vt,willCommit:!0,commitKey:1,selStart:pt.selectionStart,selEnd:pt.selectionEnd}}))}};this._dispatchEventFromSandbox(ht,nt)}),A.addEventListener("keydown",nt=>{var j;let ht=-1;if(nt.key==="Escape"?ht=0:nt.key==="Enter"?ht=2:nt.key==="Tab"&&(ht=3),ht===-1)return;const{value:ft}=nt.target;dt.valueOnFocus!==ft&&(dt.userValue=ft,(j=this.linkService.eventBus)==null||j.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:ft,willCommit:!0,commitKey:ht,selStart:nt.target.selectionStart,selEnd:nt.target.selectionEnd}}))});const lt=tt;tt=null,A.addEventListener("blur",nt=>{var ft;const{value:ht}=nt.target;dt.userValue=ht,this._mouseState.isDown&&dt.valueOnFocus!==ht&&((ft=this.linkService.eventBus)==null||ft.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:ht,willCommit:!0,commitKey:1,selStart:nt.target.selectionStart,selEnd:nt.target.selectionEnd}})),lt(nt)}),(C=this.data.actions)!=null&&C.Keystroke&&A.addEventListener("beforeinput",nt=>{var Pt;const{data:ht,target:ft}=nt,{value:j,selectionStart:pt,selectionEnd:vt}=ft;let St=pt,Tt=vt;switch(nt.inputType){case"deleteWordBackward":{const Ot=j.substring(0,pt).match(/\w*[^\w]*$/);Ot&&(St-=Ot[0].length);break}case"deleteWordForward":{const Ot=j.substring(pt).match(/^[^\w]*\w*/);Ot&&(Tt+=Ot[0].length);break}case"deleteContentBackward":pt===vt&&(St-=1);break;case"deleteContentForward":pt===vt&&(Tt+=1);break}nt.preventDefault(),(Pt=this.linkService.eventBus)==null||Pt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:j,change:ht||"",willCommit:!1,selStart:St,selEnd:Tt}})}),this._setEventListeners(A,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],nt=>nt.target.value)}if(tt&&A.addEventListener("blur",tt),this.data.comb){const nt=(this.data.rect[2]-this.data.rect[0])/st;A.classList.add("comb"),A.style.letterSpacing=`calc(${nt}px * var(--scale-factor) - 1ch)`}}else A=document.createElement("div"),A.textContent=this.data.fieldValue,A.style.verticalAlign="middle",A.style.display="table-cell";return this._setTextStyle(A),this._setBackgroundColor(A),this._setDefaultPropertiesFromJS(A),this.container.append(A),this.container}}class S extends i{constructor(l){super(l,{isRenderable:l.renderForms})}render(){const l=this.annotationStorage,g=this.data,A=g.id;let C=l.getValue(A,{value:g.exportValue===g.fieldValue}).value;typeof C=="string"&&(C=C!=="Off",l.setValue(A,{value:C})),this.container.className="buttonWidgetAnnotation checkBox";const L=document.createElement("input");return R.add(L),L.setAttribute("data-element-id",A),L.disabled=g.readOnly,this._setRequired(L,this.data.required),L.type="checkbox",L.name=g.fieldName,C&&L.setAttribute("checked",!0),L.setAttribute("exportValue",g.exportValue),L.tabIndex=v,L.addEventListener("change",H=>{const{name:st,checked:dt}=H.target;for(const tt of this._getElementsByName(st,A)){const lt=dt&&tt.exportValue===g.exportValue;tt.domElement&&(tt.domElement.checked=lt),l.setValue(tt.id,{value:lt})}l.setValue(A,{value:dt})}),L.addEventListener("resetform",H=>{const st=g.defaultFieldValue||"Off";H.target.checked=st===g.exportValue}),this.enableScripting&&this.hasJSActions&&(L.addEventListener("updatefromsandbox",H=>{const st={value(dt){dt.target.checked=dt.detail.value!=="Off",l.setValue(A,{value:dt.target.checked})}};this._dispatchEventFromSandbox(st,H)}),this._setEventListeners(L,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],H=>H.target.checked)),this._setBackgroundColor(L),this._setDefaultPropertiesFromJS(L),this.container.append(L),this.container}}class E extends i{constructor(l){super(l,{isRenderable:l.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const l=this.annotationStorage,g=this.data,A=g.id;let C=l.getValue(A,{value:g.fieldValue===g.buttonValue}).value;typeof C=="string"&&(C=C!==g.buttonValue,l.setValue(A,{value:C}));const L=document.createElement("input");if(R.add(L),L.setAttribute("data-element-id",A),L.disabled=g.readOnly,this._setRequired(L,this.data.required),L.type="radio",L.name=g.fieldName,C&&L.setAttribute("checked",!0),L.tabIndex=v,L.addEventListener("change",H=>{const{name:st,checked:dt}=H.target;for(const tt of this._getElementsByName(st,A))l.setValue(tt.id,{value:!1});l.setValue(A,{value:dt})}),L.addEventListener("resetform",H=>{const st=g.defaultFieldValue;H.target.checked=st!=null&&st===g.buttonValue}),this.enableScripting&&this.hasJSActions){const H=g.buttonValue;L.addEventListener("updatefromsandbox",st=>{const dt={value:tt=>{const lt=H===tt.detail.value;for(const nt of this._getElementsByName(tt.target.name)){const ht=lt&&nt.id===A;nt.domElement&&(nt.domElement.checked=ht),l.setValue(nt.id,{value:ht})}}};this._dispatchEventFromSandbox(dt,st)}),this._setEventListeners(L,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],st=>st.target.checked)}return this._setBackgroundColor(L),this._setDefaultPropertiesFromJS(L),this.container.append(L),this.container}}class h extends u{constructor(l){super(l,{ignoreBorder:l.data.hasAppearance})}render(){const l=super.render();l.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(l.title=this.data.alternativeText);const g=l.lastChild;return this.enableScripting&&this.hasJSActions&&g&&(this._setDefaultPropertiesFromJS(g),g.addEventListener("updatefromsandbox",A=>{this._dispatchEventFromSandbox({},A)})),l}}class s extends i{constructor(l){super(l,{isRenderable:l.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const l=this.annotationStorage,g=this.data.id,A=l.getValue(g,{value:this.data.fieldValue}),C=document.createElement("select");R.add(C),C.setAttribute("data-element-id",g),C.disabled=this.data.readOnly,this._setRequired(C,this.data.required),C.name=this.data.fieldName,C.tabIndex=v;let L=this.data.combo&&this.data.options.length>0;this.data.combo||(C.size=this.data.options.length,this.data.multiSelect&&(C.multiple=!0)),C.addEventListener("resetform",tt=>{const lt=this.data.defaultFieldValue;for(const nt of C.options)nt.selected=nt.value===lt});for(const tt of this.data.options){const lt=document.createElement("option");lt.textContent=tt.displayValue,lt.value=tt.exportValue,A.value.includes(tt.exportValue)&&(lt.setAttribute("selected",!0),L=!1),C.append(lt)}let H=null;if(L){const tt=document.createElement("option");tt.value=" ",tt.setAttribute("hidden",!0),tt.setAttribute("selected",!0),C.prepend(tt),H=()=>{tt.remove(),C.removeEventListener("input",H),H=null},C.addEventListener("input",H)}const st=(tt,lt)=>{const nt=lt?"value":"textContent",ht=tt.target.options;return tt.target.multiple?Array.prototype.filter.call(ht,ft=>ft.selected).map(ft=>ft[nt]):ht.selectedIndex===-1?null:ht[ht.selectedIndex][nt]},dt=tt=>{const lt=tt.target.options;return Array.prototype.map.call(lt,nt=>({displayValue:nt.textContent,exportValue:nt.value}))};return this.enableScripting&&this.hasJSActions?(C.addEventListener("updatefromsandbox",tt=>{const lt={value(nt){H==null||H();const ht=nt.detail.value,ft=new Set(Array.isArray(ht)?ht:[ht]);for(const j of C.options)j.selected=ft.has(j.value);l.setValue(g,{value:st(nt,!0)})},multipleSelection(nt){C.multiple=!0},remove(nt){const ht=C.options,ft=nt.detail.remove;ht[ft].selected=!1,C.remove(ft),ht.length>0&&Array.prototype.findIndex.call(ht,pt=>pt.selected)===-1&&(ht[0].selected=!0),l.setValue(g,{value:st(nt,!0),items:dt(nt)})},clear(nt){for(;C.length!==0;)C.remove(0);l.setValue(g,{value:null,items:[]})},insert(nt){const{index:ht,displayValue:ft,exportValue:j}=nt.detail.insert,pt=C.children[ht],vt=document.createElement("option");vt.textContent=ft,vt.value=j,pt?pt.before(vt):C.append(vt),l.setValue(g,{value:st(nt,!0),items:dt(nt)})},items(nt){const{items:ht}=nt.detail;for(;C.length!==0;)C.remove(0);for(const ft of ht){const{displayValue:j,exportValue:pt}=ft,vt=document.createElement("option");vt.textContent=j,vt.value=pt,C.append(vt)}C.options.length>0&&(C.options[0].selected=!0),l.setValue(g,{value:st(nt,!0),items:dt(nt)})},indices(nt){const ht=new Set(nt.detail.indices);for(const ft of nt.target.options)ft.selected=ht.has(ft.index);l.setValue(g,{value:st(nt,!0)})},editable(nt){nt.target.disabled=!nt.detail.editable}};this._dispatchEventFromSandbox(lt,tt)}),C.addEventListener("input",tt=>{var ht;const lt=st(tt,!0),nt=st(tt,!1);l.setValue(g,{value:lt}),(ht=this.linkService.eventBus)==null||ht.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:nt,changeEx:lt,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(C,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],tt=>tt.target.checked)):C.addEventListener("input",function(tt){l.setValue(g,{value:st(tt,!0)})}),this.data.combo&&this._setTextStyle(C),this._setBackgroundColor(C),this._setDefaultPropertiesFromJS(C),this.container.append(C),this.container}}class o extends P{constructor(l){var A,C,L;const g=!!((A=l.data.titleObj)!=null&&A.str||(C=l.data.contentsObj)!=null&&C.str||(L=l.data.richText)!=null&&L.str);super(l,{isRenderable:g})}render(){const l=["Line","Square","Circle","PolyLine","Polygon","Ink"];if(this.container.className="popupAnnotation",l.includes(this.data.parentType))return this.container;const g=`[data-annotation-id="${this.data.parentId}"]`,A=this.layer.querySelectorAll(g);if(A.length===0)return this.container;const C=new m({container:this.container,trigger:Array.from(A),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),L=this.page,H=t.Util.normalizeRect([this.data.parentRect[0],L.view[3]-this.data.parentRect[1]+L.view[1],this.data.parentRect[2],L.view[3]-this.data.parentRect[3]+L.view[1]]),st=H[0]+this.data.parentRect[2]-this.data.parentRect[0],dt=H[1],[tt,lt,nt,ht]=this.viewport.viewBox,ft=nt-tt,j=ht-lt;return this.container.style.left=`${100*(st-tt)/ft}%`,this.container.style.top=`${100*(dt-lt)/j}%`,this.container.append(C.render()),this.container}}class m{constructor(l){this.container=l.container,this.trigger=l.trigger,this.color=l.color,this.titleObj=l.titleObj,this.modificationDate=l.modificationDate,this.contentsObj=l.contentsObj,this.richText=l.richText,this.hideWrapper=l.hideWrapper||!1,this.pinned=!1}render(){var st,dt;const g=document.createElement("div");g.className="popupWrapper",this.hideElement=this.hideWrapper?g:this.container,this.hideElement.hidden=!0;const A=document.createElement("div");A.className="popup";const C=this.color;if(C){const tt=.7*(255-C[0])+C[0],lt=.7*(255-C[1])+C[1],nt=.7*(255-C[2])+C[2];A.style.backgroundColor=t.Util.makeHexColor(tt|0,lt|0,nt|0)}const L=document.createElement("h1");L.dir=this.titleObj.dir,L.textContent=this.titleObj.str,A.append(L);const H=a.PDFDateString.toDateObject(this.modificationDate);if(H){const tt=document.createElement("span");tt.className="popupDate",tt.textContent="{{date}}, {{time}}",tt.dataset.l10nId="annotation_date_string",tt.dataset.l10nArgs=JSON.stringify({date:H.toLocaleDateString(),time:H.toLocaleTimeString()}),A.append(tt)}if((st=this.richText)!=null&&st.str&&(!((dt=this.contentsObj)!=null&&dt.str)||this.contentsObj.str===this.richText.str))T.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:A}),A.lastChild.className="richText popupContent";else{const tt=this._formatContents(this.contentsObj);A.append(tt)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const tt of this.trigger)tt.addEventListener("click",this._toggle.bind(this)),tt.addEventListener("mouseover",this._show.bind(this,!1)),tt.addEventListener("mouseout",this._hide.bind(this,!1));return A.addEventListener("click",this._hide.bind(this,!0)),g.append(A),g}_formatContents({str:l,dir:g}){const A=document.createElement("p");A.className="popupContent",A.dir=g;const C=l.split(/(?:\r\n?|\n)/);for(let L=0,H=C.length;L<H;++L){const st=C[L];A.append(document.createTextNode(st)),L<H-1&&A.append(document.createElement("br"))}return A}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(l=!1){l&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(l=!0){l&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class M extends P{constructor(l){var A,C,L;const g=!!(l.data.hasPopup||(A=l.data.titleObj)!=null&&A.str||(C=l.data.contentsObj)!=null&&C.str||(L=l.data.richText)!=null&&L.str);super(l,{isRenderable:g,ignoreBorder:!0}),this.textContent=l.data.textContent}render(){if(this.container.className="freeTextAnnotation",this.textContent){const l=document.createElement("div");l.className="annotationTextContent",l.setAttribute("role","comment");for(const g of this.textContent){const A=document.createElement("span");A.textContent=g,l.append(A)}this.container.append(l)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class x extends P{constructor(l){var A,C,L;const g=!!(l.data.hasPopup||(A=l.data.titleObj)!=null&&A.str||(C=l.data.contentsObj)!=null&&C.str||(L=l.data.richText)!=null&&L.str);super(l,{isRenderable:g,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const l=this.data,{width:g,height:A}=N(l.rect),C=this.svgFactory.create(g,A,!0),L=this.svgFactory.createElement("svg:line");return L.setAttribute("x1",l.rect[2]-l.lineCoordinates[0]),L.setAttribute("y1",l.rect[3]-l.lineCoordinates[1]),L.setAttribute("x2",l.rect[2]-l.lineCoordinates[2]),L.setAttribute("y2",l.rect[3]-l.lineCoordinates[3]),L.setAttribute("stroke-width",l.borderStyle.width||1),L.setAttribute("stroke","transparent"),L.setAttribute("fill","transparent"),C.append(L),this.container.append(C),this._createPopup(L,l),this.container}}class y extends P{constructor(l){var A,C,L;const g=!!(l.data.hasPopup||(A=l.data.titleObj)!=null&&A.str||(C=l.data.contentsObj)!=null&&C.str||(L=l.data.richText)!=null&&L.str);super(l,{isRenderable:g,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const l=this.data,{width:g,height:A}=N(l.rect),C=this.svgFactory.create(g,A,!0),L=l.borderStyle.width,H=this.svgFactory.createElement("svg:rect");return H.setAttribute("x",L/2),H.setAttribute("y",L/2),H.setAttribute("width",g-L),H.setAttribute("height",A-L),H.setAttribute("stroke-width",L||1),H.setAttribute("stroke","transparent"),H.setAttribute("fill","transparent"),C.append(H),this.container.append(C),this._createPopup(H,l),this.container}}class D extends P{constructor(l){var A,C,L;const g=!!(l.data.hasPopup||(A=l.data.titleObj)!=null&&A.str||(C=l.data.contentsObj)!=null&&C.str||(L=l.data.richText)!=null&&L.str);super(l,{isRenderable:g,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const l=this.data,{width:g,height:A}=N(l.rect),C=this.svgFactory.create(g,A,!0),L=l.borderStyle.width,H=this.svgFactory.createElement("svg:ellipse");return H.setAttribute("cx",g/2),H.setAttribute("cy",A/2),H.setAttribute("rx",g/2-L/2),H.setAttribute("ry",A/2-L/2),H.setAttribute("stroke-width",L||1),H.setAttribute("stroke","transparent"),H.setAttribute("fill","transparent"),C.append(H),this.container.append(C),this._createPopup(H,l),this.container}}class et extends P{constructor(l){var A,C,L;const g=!!(l.data.hasPopup||(A=l.data.titleObj)!=null&&A.str||(C=l.data.contentsObj)!=null&&C.str||(L=l.data.richText)!=null&&L.str);super(l,{isRenderable:g,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const l=this.data,{width:g,height:A}=N(l.rect),C=this.svgFactory.create(g,A,!0);let L=[];for(const st of l.vertices){const dt=st.x-l.rect[0],tt=l.rect[3]-st.y;L.push(dt+","+tt)}L=L.join(" ");const H=this.svgFactory.createElement(this.svgElementName);return H.setAttribute("points",L),H.setAttribute("stroke-width",l.borderStyle.width||1),H.setAttribute("stroke","transparent"),H.setAttribute("fill","transparent"),C.append(H),this.container.append(C),this._createPopup(H,l),this.container}}class it extends et{constructor(l){super(l),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Z extends P{constructor(l){var A,C,L;const g=!!(l.data.hasPopup||(A=l.data.titleObj)!=null&&A.str||(C=l.data.contentsObj)!=null&&C.str||(L=l.data.richText)!=null&&L.str);super(l,{isRenderable:g,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class J extends P{constructor(l){var A,C,L;const g=!!(l.data.hasPopup||(A=l.data.titleObj)!=null&&A.str||(C=l.data.contentsObj)!=null&&C.str||(L=l.data.richText)!=null&&L.str);super(l,{isRenderable:g,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const l=this.data,{width:g,height:A}=N(l.rect),C=this.svgFactory.create(g,A,!0);for(const L of l.inkLists){let H=[];for(const dt of L){const tt=dt.x-l.rect[0],lt=l.rect[3]-dt.y;H.push(`${tt},${lt}`)}H=H.join(" ");const st=this.svgFactory.createElement(this.svgElementName);st.setAttribute("points",H),st.setAttribute("stroke-width",l.borderStyle.width||1),st.setAttribute("stroke","transparent"),st.setAttribute("fill","transparent"),this._createPopup(st,l),C.append(st)}return this.container.append(C),this.container}}class G extends P{constructor(l){var A,C,L;const g=!!(l.data.hasPopup||(A=l.data.titleObj)!=null&&A.str||(C=l.data.contentsObj)!=null&&C.str||(L=l.data.richText)!=null&&L.str);super(l,{isRenderable:g,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class V extends P{constructor(l){var A,C,L;const g=!!(l.data.hasPopup||(A=l.data.titleObj)!=null&&A.str||(C=l.data.contentsObj)!=null&&C.str||(L=l.data.richText)!=null&&L.str);super(l,{isRenderable:g,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class Y extends P{constructor(l){var A,C,L;const g=!!(l.data.hasPopup||(A=l.data.titleObj)!=null&&A.str||(C=l.data.contentsObj)!=null&&C.str||(L=l.data.richText)!=null&&L.str);super(l,{isRenderable:g,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class rt extends P{constructor(l){var A,C,L;const g=!!(l.data.hasPopup||(A=l.data.titleObj)!=null&&A.str||(C=l.data.contentsObj)!=null&&C.str||(L=l.data.richText)!=null&&L.str);super(l,{isRenderable:g,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class ct extends P{constructor(l){var A,C,L;const g=!!(l.data.hasPopup||(A=l.data.titleObj)!=null&&A.str||(C=l.data.contentsObj)!=null&&C.str||(L=l.data.richText)!=null&&L.str);super(l,{isRenderable:g,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class bt extends P{constructor(l){var C;super(l,{isRenderable:!0});const{filename:g,content:A}=this.data.file;this.filename=(0,a.getFilenameFromUrl)(g),this.content=A,(C=this.linkService.eventBus)==null||C.dispatch("fileattachmentannotation",{source:this,filename:g,content:A})}render(){var g,A;this.container.className="fileAttachmentAnnotation";const l=document.createElement("div");return l.className="popupTriggerArea",l.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&((g=this.data.titleObj)!=null&&g.str||(A=this.data.contentsObj)!=null&&A.str||this.data.richText)&&this._createPopup(l,this.data),this.container.append(l),this.container}_download(){var l;(l=this.downloadManager)==null||l.openOrDownloadData(this.container,this.content,this.filename)}}const K=class{static render(l){var st,dt;const{annotations:g,div:A,viewport:C,accessibilityManager:L}=l;ut(this,O,Ee).call(this,A,C);let H=0;for(const tt of g){if(tt.annotationType!==t.AnnotationType.POPUP){const{width:nt,height:ht}=N(tt.rect);if(nt<=0||ht<=0)continue}const lt=w.create({data:tt,layer:A,page:l.page,viewport:C,linkService:l.linkService,downloadManager:l.downloadManager,imageResourcesPath:l.imageResourcesPath||"",renderForms:l.renderForms!==!1,svgFactory:new a.DOMSVGFactory,annotationStorage:l.annotationStorage||new k.AnnotationStorage,enableScripting:l.enableScripting,hasJSActions:l.hasJSActions,fieldObjects:l.fieldObjects,mouseState:l.mouseState||{isDown:!1}});if(lt.isRenderable){const nt=lt.render();if(tt.hidden&&(nt.style.visibility="hidden"),Array.isArray(nt))for(const ht of nt)ht.style.zIndex=H++,ut(st=K,p,Se).call(st,ht,tt.id,A,L);else nt.style.zIndex=H++,lt instanceof o?A.prepend(nt):ut(dt=K,p,Se).call(dt,nt,tt.id,A,L)}}ut(this,B,Te).call(this,A,l.annotationCanvasMap)}static update(l){const{annotationCanvasMap:g,div:A,viewport:C}=l;ut(this,O,Ee).call(this,A,C),ut(this,B,Te).call(this,A,g),A.hidden=!1}};let W=K;p=new WeakSet,Se=function(l,g,A,C){const L=l.firstChild||l;L.id=`${a.AnnotationPrefix}${g}`,A.append(l),C==null||C.moveElementInDOM(A,l,L,!1)},O=new WeakSet,Ee=function(l,{width:g,height:A,rotation:C}){const{style:L}=l,H=C%180!==0,st=Math.floor(g)+"px",dt=Math.floor(A)+"px";L.width=H?dt:st,L.height=H?st:dt,l.setAttribute("data-main-rotation",C)},B=new WeakSet,Te=function(l,g){if(g){for(const[A,C]of g){const L=l.querySelector(`[data-annotation-id="${A}"]`);if(!L)continue;const{firstChild:H}=L;H?H.nodeName==="CANVAS"?H.replaceWith(C):H.before(C):L.append(C)}g.clear()}},ot(W,p),ot(W,O),ot(W,B),n.AnnotationLayer=W},(_,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ColorConverters=void 0;function b(a){return Math.floor(Math.max(0,Math.min(1,a))*255).toString(16).padStart(2,"0")}class t{static CMYK_G([k,F,T,v]){return["G",1-Math.min(1,.3*k+.59*T+.11*F+v)]}static G_CMYK([k]){return["CMYK",0,0,0,1-k]}static G_RGB([k]){return["RGB",k,k,k]}static G_HTML([k]){const F=b(k);return`#${F}${F}${F}`}static RGB_G([k,F,T]){return["G",.3*k+.59*F+.11*T]}static RGB_HTML([k,F,T]){const v=b(k),f=b(F),R=b(T);return`#${v}${f}${R}`}static T_HTML(){return"#00000000"}static CMYK_RGB([k,F,T,v]){return["RGB",1-Math.min(1,k+v),1-Math.min(1,T+v),1-Math.min(1,F+v)]}static CMYK_HTML(k){const F=this.CMYK_RGB(k).slice(1);return this.RGB_HTML(F)}static RGB_CMYK([k,F,T]){const v=1-k,f=1-F,R=1-T,N=Math.min(v,f,R);return["CMYK",v,f,R,N]}}n.ColorConverters=t},(_,n,b)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.XfaLayer=void 0;var t=b(20);class a{static setupStorage(F,T,v,f,R){const N=f.getValue(T,{value:null});switch(v.name){case"textarea":if(N.value!==null&&(F.textContent=N.value),R==="print")break;F.addEventListener("input",w=>{f.setValue(T,{value:w.target.value})});break;case"input":if(v.attributes.type==="radio"||v.attributes.type==="checkbox"){if(N.value===v.attributes.xfaOn?F.setAttribute("checked",!0):N.value===v.attributes.xfaOff&&F.removeAttribute("checked"),R==="print")break;F.addEventListener("change",w=>{f.setValue(T,{value:w.target.checked?w.target.getAttribute("xfaOn"):w.target.getAttribute("xfaOff")})})}else{if(N.value!==null&&F.setAttribute("value",N.value),R==="print")break;F.addEventListener("input",w=>{f.setValue(T,{value:w.target.value})})}break;case"select":if(N.value!==null)for(const w of v.children)w.attributes.value===N.value&&(w.attributes.selected=!0);F.addEventListener("input",w=>{const P=w.target.options,u=P.selectedIndex===-1?"":P[P.selectedIndex].value;f.setValue(T,{value:u})});break}}static setAttributes({html:F,element:T,storage:v=null,intent:f,linkService:R}){const{attributes:N}=T,w=F instanceof HTMLAnchorElement;N.type==="radio"&&(N.name=`${N.name}-${f}`);for(const[P,u]of Object.entries(N))if(u!=null)switch(P){case"class":u.length&&F.setAttribute(P,u.join(" "));break;case"dataId":break;case"id":F.setAttribute("data-element-id",u);break;case"style":Object.assign(F.style,u);break;case"textContent":F.textContent=u;break;default:(!w||P!=="href"&&P!=="newWindow")&&F.setAttribute(P,u)}w&&R.addLinkAttributes(F,N.href,N.newWindow),v&&N.dataId&&this.setupStorage(F,N.dataId,T,v)}static render(F){var e;const T=F.annotationStorage,v=F.linkService,f=F.xfaHtml,R=F.intent||"display",N=document.createElement(f.name);f.attributes&&this.setAttributes({html:N,element:f,intent:R,linkService:v});const w=[[f,-1,N]],P=F.div;if(P.append(N),F.viewport){const i=`matrix(${F.viewport.transform.join(",")})`;P.style.transform=i}R!=="richText"&&P.setAttribute("class","xfaLayer xfaFont");const u=[];for(;w.length>0;){const[i,c,S]=w.at(-1);if(c+1===i.children.length){w.pop();continue}const E=i.children[++w.at(-1)[1]];if(E===null)continue;const{name:h}=E;if(h==="#text"){const o=document.createTextNode(E.value);u.push(o),S.append(o);continue}let s;if((e=E==null?void 0:E.attributes)!=null&&e.xmlns?s=document.createElementNS(E.attributes.xmlns,h):s=document.createElement(h),S.append(s),E.attributes&&this.setAttributes({html:s,element:E,storage:T,intent:R,linkService:v}),E.children&&E.children.length>0)w.push([E,-1,s]);else if(E.value){const o=document.createTextNode(E.value);t.XfaText.shouldBuildText(h)&&u.push(o),s.append(o)}}for(const i of P.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))i.setAttribute("readOnly",!0);return{textDivs:u}}static update(F){const T=`matrix(${F.viewport.transform.join(",")})`;F.div.style.transform=T,F.div.hidden=!1}}n.XfaLayer=a},(_,n,b)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TextLayerRenderTask=void 0,n.renderTextLayer=S;var t=b(1),a=b(8);const k=1e5,F=30,T=.8,v=new Map,f=/^\s+$/g;function R(E,h){const s=v.get(E);if(s)return s;h.save(),h.font=`${F}px ${E}`;const o=h.measureText("");let m=o.fontBoundingBoxAscent,M=Math.abs(o.fontBoundingBoxDescent);if(m){h.restore();const y=m/(m+M);return v.set(E,y),y}h.strokeStyle="red",h.clearRect(0,0,F,F),h.strokeText("g",0,0);let x=h.getImageData(0,0,F,F).data;M=0;for(let y=x.length-1-3;y>=0;y-=4)if(x[y]>0){M=Math.ceil(y/4/F);break}h.clearRect(0,0,F,F),h.strokeText("A",0,F),x=h.getImageData(0,0,F,F).data,m=0;for(let y=0,D=x.length;y<D;y+=4)if(x[y]>0){m=F-Math.floor(y/4/F);break}if(h.restore(),m){const y=m/(m+M);return v.set(E,y),y}return v.set(E,T),T}function N(E,h,s,o){const m=document.createElement("span"),M=E._enhanceTextSelection?{angle:0,canvasWidth:0,hasText:h.str!=="",hasEOL:h.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1,fontSize:0}:{angle:0,canvasWidth:0,hasText:h.str!=="",hasEOL:h.hasEOL,fontSize:0};E._textDivs.push(m);const x=t.Util.transform(E._viewport.transform,h.transform);let y=Math.atan2(x[1],x[0]);const D=s[h.fontName];D.vertical&&(y+=Math.PI/2);const et=Math.hypot(x[2],x[3]),it=et*R(D.fontFamily,o);let Z,J;y===0?(Z=x[4],J=x[5]-it):(Z=x[4]+it*Math.sin(y),J=x[5]-it*Math.cos(y)),m.style.left=`${Z}px`,m.style.top=`${J}px`,m.style.fontSize=`${et}px`,m.style.fontFamily=D.fontFamily,M.fontSize=et,m.setAttribute("role","presentation"),m.textContent=h.str,m.dir=h.dir,E._fontInspectorEnabled&&(m.dataset.fontName=h.fontName),y!==0&&(M.angle=y*(180/Math.PI));let G=!1;if(h.str.length>1||E._enhanceTextSelection&&f.test(h.str))G=!0;else if(h.str!==" "&&h.transform[0]!==h.transform[3]){const V=Math.abs(h.transform[0]),Y=Math.abs(h.transform[3]);V!==Y&&Math.max(V,Y)/Math.min(V,Y)>1.5&&(G=!0)}if(G&&(D.vertical?M.canvasWidth=h.height*E._viewport.scale:M.canvasWidth=h.width*E._viewport.scale),E._textDivProperties.set(m,M),E._textContentStream&&E._layoutText(m),E._enhanceTextSelection&&M.hasText){let V=1,Y=0;y!==0&&(V=Math.cos(y),Y=Math.sin(y));const rt=(D.vertical?h.height:h.width)*E._viewport.scale,ct=et;let bt,W;y!==0?(bt=[V,Y,-Y,V,Z,J],W=t.Util.getAxialAlignedBoundingBox([0,0,rt,ct],bt)):W=[Z,J,Z+rt,J+ct],E._bounds.push({left:W[0],top:W[1],right:W[2],bottom:W[3],div:m,size:[rt,ct],m:bt})}}function w(E){if(E._canceled)return;const h=E._textDivs,s=E._capability,o=h.length;if(o>k){E._renderingDone=!0,s.resolve();return}if(!E._textContentStream)for(let m=0;m<o;m++)E._layoutText(h[m]);E._renderingDone=!0,s.resolve()}function P(E,h,s){let o=0;for(let m=0;m<s;m++){const M=E[h++];M>0&&(o=o?Math.min(M,o):M)}return o}function u(E){const h=E._bounds,s=E._viewport,o=e(s.width,s.height,h);for(let m=0;m<o.length;m++){const M=h[m].div,x=E._textDivProperties.get(M);if(x.angle===0){x.paddingLeft=h[m].left-o[m].left,x.paddingTop=h[m].top-o[m].top,x.paddingRight=o[m].right-h[m].right,x.paddingBottom=o[m].bottom-h[m].bottom,E._textDivProperties.set(M,x);continue}const y=o[m],D=h[m],et=D.m,it=et[0],Z=et[1],J=[[0,0],[0,D.size[1]],[D.size[0],0],D.size],G=new Float64Array(64);for(let Y=0,rt=J.length;Y<rt;Y++){const ct=t.Util.applyTransform(J[Y],et);G[Y+0]=it&&(y.left-ct[0])/it,G[Y+4]=Z&&(y.top-ct[1])/Z,G[Y+8]=it&&(y.right-ct[0])/it,G[Y+12]=Z&&(y.bottom-ct[1])/Z,G[Y+16]=Z&&(y.left-ct[0])/-Z,G[Y+20]=it&&(y.top-ct[1])/it,G[Y+24]=Z&&(y.right-ct[0])/-Z,G[Y+28]=it&&(y.bottom-ct[1])/it,G[Y+32]=it&&(y.left-ct[0])/-it,G[Y+36]=Z&&(y.top-ct[1])/-Z,G[Y+40]=it&&(y.right-ct[0])/-it,G[Y+44]=Z&&(y.bottom-ct[1])/-Z,G[Y+48]=Z&&(y.left-ct[0])/Z,G[Y+52]=it&&(y.top-ct[1])/-it,G[Y+56]=Z&&(y.right-ct[0])/Z,G[Y+60]=it&&(y.bottom-ct[1])/-it}const V=1+Math.min(Math.abs(it),Math.abs(Z));x.paddingLeft=P(G,32,16)/V,x.paddingTop=P(G,48,16)/V,x.paddingRight=P(G,0,16)/V,x.paddingBottom=P(G,16,16)/V,E._textDivProperties.set(M,x)}}function e(E,h,s){const o=s.map(function(M,x){return{x1:M.left,y1:M.top,x2:M.right,y2:M.bottom,index:x,x1New:void 0,x2New:void 0}});i(E,o);const m=new Array(s.length);for(const M of o){const x=M.index;m[x]={left:M.x1New,top:0,right:M.x2New,bottom:0}}s.map(function(M,x){const y=m[x],D=o[x];D.x1=M.top,D.y1=E-y.right,D.x2=M.bottom,D.y2=E-y.left,D.index=x,D.x1New=void 0,D.x2New=void 0}),i(h,o);for(const M of o){const x=M.index;m[x].top=M.x1New,m[x].bottom=M.x2New}return m}function i(E,h){h.sort(function(m,M){return m.x1-M.x1||m.index-M.index});const o=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];for(const m of h){let M=0;for(;M<o.length&&o[M].end<=m.y1;)M++;let x=o.length-1;for(;x>=0&&o[x].start>=m.y2;)x--;let y,D,et,it,Z=-1/0;for(et=M;et<=x;et++){y=o[et],D=y.boundary;let V;D.x2>m.x1?V=D.index>m.index?D.x1New:m.x1:D.x2New===void 0?V=(D.x2+m.x1)/2:V=D.x2New,V>Z&&(Z=V)}for(m.x1New=Z,et=M;et<=x;et++)y=o[et],D=y.boundary,D.x2New===void 0?D.x2>m.x1?D.index>m.index&&(D.x2New=D.x2):D.x2New=Z:D.x2New>Z&&(D.x2New=Math.max(Z,D.x2));const J=[];let G=null;for(et=M;et<=x;et++){y=o[et],D=y.boundary;const V=D.x2>m.x2?D:m;G===V?J.at(-1).end=y.end:(J.push({start:y.start,end:y.end,boundary:V}),G=V)}for(o[M].start<m.y1&&(J[0].start=m.y1,J.unshift({start:o[M].start,end:m.y1,boundary:o[M].boundary})),m.y2<o[x].end&&(J.at(-1).end=m.y2,J.push({start:m.y2,end:o[x].end,boundary:o[x].boundary})),et=M;et<=x;et++){if(y=o[et],D=y.boundary,D.x2New!==void 0)continue;let V=!1;for(it=M-1;!V&&it>=0&&o[it].start>=D.y1;it--)V=o[it].boundary===D;for(it=x+1;!V&&it<o.length&&o[it].end<=D.y2;it++)V=o[it].boundary===D;for(it=0;!V&&it<J.length;it++)V=J[it].boundary===D;V||(D.x2New=Z)}Array.prototype.splice.apply(o,[M,x-M+1,...J])}for(const m of o){const M=m.boundary;M.x2New===void 0&&(M.x2New=Math.max(E,M.x2))}}class c{constructor({textContent:h,textContentStream:s,container:o,viewport:m,textDivs:M,textContentItemsStr:x,enhanceTextSelection:y}){var D;y&&(0,a.deprecated)("The `enhanceTextSelection` functionality will be removed in the future."),this._textContent=h,this._textContentStream=s,this._container=o,this._document=o.ownerDocument,this._viewport=m,this._textDivs=M||[],this._textContentItemsStr=x||[],this._enhanceTextSelection=!!y,this._fontInspectorEnabled=!!((D=globalThis.FontInspector)!=null&&D.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,t.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._devicePixelRatio=globalThis.devicePixelRatio||1,this._capability.promise.finally(()=>{this._enhanceTextSelection||(this._textDivProperties=null),this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new t.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._renderTimer!==null&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(h,s){for(let o=0,m=h.length;o<m;o++){if(h[o].str===void 0){if(h[o].type==="beginMarkedContentProps"||h[o].type==="beginMarkedContent"){const M=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),h[o].id!==null&&this._container.setAttribute("id",`${h[o].id}`),M.append(this._container)}else h[o].type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(h[o].str),N(this,h[o],s,this._layoutTextCtx)}}_layoutText(h){const s=this._textDivProperties.get(h);let o="";if(s.canvasWidth!==0&&s.hasText){const{fontFamily:m}=h.style,{fontSize:M}=s;(M!==this._layoutTextLastFontSize||m!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${M*this._devicePixelRatio}px ${m}`,this._layoutTextLastFontSize=M,this._layoutTextLastFontFamily=m);const{width:x}=this._layoutTextCtx.measureText(h.textContent);if(x>0){const y=this._devicePixelRatio*s.canvasWidth/x;this._enhanceTextSelection&&(s.scale=y),o=`scaleX(${y})`}}if(s.angle!==0&&(o=`rotate(${s.angle}deg) ${o}`),o.length>0&&(this._enhanceTextSelection&&(s.originalTransform=o),h.style.transform=o),s.hasText&&this._container.append(h),s.hasEOL){const m=document.createElement("br");m.setAttribute("role","presentation"),this._container.append(m)}}_render(h=0){const s=(0,t.createPromiseCapability)();let o=Object.create(null);const m=this._document.createElement("canvas");if(m.height=m.width=F,this._layoutTextCtx=m.getContext("2d",{alpha:!1}),this._textContent){const M=this._textContent.items,x=this._textContent.styles;this._processItems(M,x),s.resolve()}else if(this._textContentStream){const M=()=>{this._reader.read().then(({value:x,done:y})=>{if(y){s.resolve();return}Object.assign(o,x.styles),this._processItems(x.items,o),M()},s.reject)};this._reader=this._textContentStream.getReader(),M()}else throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');s.promise.then(()=>{o=null,h?this._renderTimer=setTimeout(()=>{w(this),this._renderTimer=null},h):w(this)},this._capability.reject)}expandTextDivs(h=!1){if(!this._enhanceTextSelection||!this._renderingDone)return;this._bounds!==null&&(u(this),this._bounds=null);const s=[],o=[];for(let m=0,M=this._textDivs.length;m<M;m++){const x=this._textDivs[m],y=this._textDivProperties.get(x);y.hasText&&(h?(s.length=0,o.length=0,y.originalTransform&&s.push(y.originalTransform),y.paddingTop>0?(o.push(`${y.paddingTop}px`),s.push(`translateY(${-y.paddingTop}px)`)):o.push(0),y.paddingRight>0?o.push(`${y.paddingRight/y.scale}px`):o.push(0),y.paddingBottom>0?o.push(`${y.paddingBottom}px`):o.push(0),y.paddingLeft>0?(o.push(`${y.paddingLeft/y.scale}px`),s.push(`translateX(${-y.paddingLeft/y.scale}px)`)):o.push(0),x.style.padding=o.join(" "),s.length&&(x.style.transform=s.join(" "))):(x.style.padding=null,x.style.transform=y.originalTransform))}}}n.TextLayerRenderTask=c;function S(E){const h=new c({textContent:E.textContent,textContentStream:E.textContentStream,container:E.container,viewport:E.viewport,textDivs:E.textDivs,textContentItemsStr:E.textContentItemsStr,enhanceTextSelection:E.enhanceTextSelection});return h._render(E.timeout),h}},(_,n,b)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SVGGraphics=void 0;var t=b(8),a=b(1),k=b(3);let F=class{constructor(){(0,a.unreachable)("Not implemented: SVGGraphics")}};n.SVGGraphics=F;{let e=function(s){let o=[];const m=[];for(const M of s){if(M.fn==="save"){o.push({fnId:92,fn:"group",items:[]}),m.push(o),o=o.at(-1).items;continue}M.fn==="restore"?o=m.pop():o.push(M)}return o},i=function(s){if(Number.isInteger(s))return s.toString();const o=s.toFixed(10);let m=o.length-1;if(o[m]!=="0")return o;do m--;while(o[m]==="0");return o.substring(0,o[m]==="."?m:m+1)},c=function(s){if(s[4]===0&&s[5]===0){if(s[1]===0&&s[2]===0)return s[0]===1&&s[3]===1?"":`scale(${i(s[0])} ${i(s[3])})`;if(s[0]===s[3]&&s[1]===-s[2]){const o=Math.acos(s[0])*180/Math.PI;return`rotate(${i(o)})`}}else if(s[0]===1&&s[1]===0&&s[2]===0&&s[3]===1)return`translate(${i(s[4])} ${i(s[5])})`;return`matrix(${i(s[0])} ${i(s[1])} ${i(s[2])} ${i(s[3])} ${i(s[4])} ${i(s[5])})`};const T={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},v="http://www.w3.org/XML/1998/namespace",f="http://www.w3.org/1999/xlink",R=["butt","round","square"],N=["miter","round","bevel"],w=function(s,o="",m=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!m)return URL.createObjectURL(new Blob([s],{type:o}));const M="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let x=`data:${o};base64,`;for(let y=0,D=s.length;y<D;y+=3){const et=s[y]&255,it=s[y+1]&255,Z=s[y+2]&255,J=et>>2,G=(et&3)<<4|it>>4,V=y+1<D?(it&15)<<2|Z>>6:64,Y=y+2<D?Z&63:64;x+=M[J]+M[G]+M[V]+M[Y]}return x},P=function(){const s=new Uint8Array([137,80,78,71,13,10,26,10]),o=12,m=new Int32Array(256);for(let Z=0;Z<256;Z++){let J=Z;for(let G=0;G<8;G++)J&1?J=3988292384^J>>1&2147483647:J=J>>1&2147483647;m[Z]=J}function M(Z,J,G){let V=-1;for(let Y=J;Y<G;Y++){const rt=(V^Z[Y])&255,ct=m[rt];V=V>>>8^ct}return V^-1}function x(Z,J,G,V){let Y=V;const rt=J.length;G[Y]=rt>>24&255,G[Y+1]=rt>>16&255,G[Y+2]=rt>>8&255,G[Y+3]=rt&255,Y+=4,G[Y]=Z.charCodeAt(0)&255,G[Y+1]=Z.charCodeAt(1)&255,G[Y+2]=Z.charCodeAt(2)&255,G[Y+3]=Z.charCodeAt(3)&255,Y+=4,G.set(J,Y),Y+=J.length;const ct=M(G,V+4,Y);G[Y]=ct>>24&255,G[Y+1]=ct>>16&255,G[Y+2]=ct>>8&255,G[Y+3]=ct&255}function y(Z,J,G){let V=1,Y=0;for(let rt=J;rt<G;++rt)V=(V+(Z[rt]&255))%65521,Y=(Y+V)%65521;return Y<<16|V}function D(Z){if(!k.isNodeJS)return et(Z);try{let J;parseInt(process.versions.node)>=8?J=Z:J=Buffer.from(Z);const G=require$$5.deflateSync(J,{level:9});return G instanceof Uint8Array?G:new Uint8Array(G)}catch(J){(0,a.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+J)}return et(Z)}function et(Z){let J=Z.length;const G=65535,V=Math.ceil(J/G),Y=new Uint8Array(2+J+V*5+4);let rt=0;Y[rt++]=120,Y[rt++]=156;let ct=0;for(;J>G;)Y[rt++]=0,Y[rt++]=255,Y[rt++]=255,Y[rt++]=0,Y[rt++]=0,Y.set(Z.subarray(ct,ct+G),rt),rt+=G,ct+=G,J-=G;Y[rt++]=1,Y[rt++]=J&255,Y[rt++]=J>>8&255,Y[rt++]=~J&65535&255,Y[rt++]=(~J&65535)>>8&255,Y.set(Z.subarray(ct),rt),rt+=Z.length-ct;const bt=y(Z,0,Z.length);return Y[rt++]=bt>>24&255,Y[rt++]=bt>>16&255,Y[rt++]=bt>>8&255,Y[rt++]=bt&255,Y}function it(Z,J,G,V){const Y=Z.width,rt=Z.height;let ct,bt,W;const p=Z.data;switch(J){case a.ImageKind.GRAYSCALE_1BPP:bt=0,ct=1,W=Y+7>>3;break;case a.ImageKind.RGB_24BPP:bt=2,ct=8,W=Y*3;break;case a.ImageKind.RGBA_32BPP:bt=6,ct=8,W=Y*4;break;default:throw new Error("invalid format")}const d=new Uint8Array((1+W)*rt);let O=0,U=0;for(let g=0;g<rt;++g)d[O++]=0,d.set(p.subarray(U,U+W),O),U+=W,O+=W;if(J===a.ImageKind.GRAYSCALE_1BPP&&V){O=0;for(let g=0;g<rt;g++){O++;for(let A=0;A<W;A++)d[O++]^=255}}const B=new Uint8Array([Y>>24&255,Y>>16&255,Y>>8&255,Y&255,rt>>24&255,rt>>16&255,rt>>8&255,rt&255,ct,bt,0,0,0]),q=D(d),K=s.length+o*3+B.length+q.length,X=new Uint8Array(K);let l=0;return X.set(s,l),l+=s.length,x("IHDR",B,X,l),l+=o+B.length,x("IDATA",q,X,l),l+=o+q.length,x("IEND",new Uint8Array(0),X,l),w(X,"image/png",G)}return function(J,G,V){const Y=J.kind===void 0?a.ImageKind.GRAYSCALE_1BPP:J.kind;return it(J,Y,G,V)}}();class u{constructor(){this.fontSizeScale=1,this.fontWeight=T.fontWeight,this.fontSize=0,this.textMatrix=a.IDENTITY_MATRIX,this.fontMatrix=a.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=a.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=T.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(o,m){this.x=o,this.y=m}}let S=0,E=0,h=0;n.SVGGraphics=F=class{constructor(s,o,m=!1){(0,t.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new t.DOMSVGFactory,this.current=new u,this.transformMatrix=a.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=s,this.objs=o,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!m,this._operatorIdMapping=[];for(const M in a.OPS)this._operatorIdMapping[a.OPS[M]]=M}save(){this.transformStack.push(this.transformMatrix);const s=this.current;this.extraStack.push(s),this.current=s.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(s){this.save(),this.executeOpTree(s),this.restore()}loadDependencies(s){const o=s.fnArray,m=s.argsArray;for(let M=0,x=o.length;M<x;M++)if(o[M]===a.OPS.dependency)for(const y of m[M]){const D=y.startsWith("g_")?this.commonObjs:this.objs,et=new Promise(it=>{D.get(y,it)});this.current.dependencies.push(et)}return Promise.all(this.current.dependencies)}transform(s,o,m,M,x,y){const D=[s,o,m,M,x,y];this.transformMatrix=a.Util.transform(this.transformMatrix,D),this.tgrp=null}getSVG(s,o){this.viewport=o;const m=this._initialize(o);return this.loadDependencies(s).then(()=>(this.transformMatrix=a.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(s)),m))}convertOpList(s){const o=this._operatorIdMapping,m=s.argsArray,M=s.fnArray,x=[];for(let y=0,D=M.length;y<D;y++){const et=M[y];x.push({fnId:et,fn:o[et],args:m[y]})}return e(x)}executeOpTree(s){for(const o of s){const m=o.fn,M=o.fnId,x=o.args;switch(M|0){case a.OPS.beginText:this.beginText();break;case a.OPS.dependency:break;case a.OPS.setLeading:this.setLeading(x);break;case a.OPS.setLeadingMoveText:this.setLeadingMoveText(x[0],x[1]);break;case a.OPS.setFont:this.setFont(x);break;case a.OPS.showText:this.showText(x[0]);break;case a.OPS.showSpacedText:this.showText(x[0]);break;case a.OPS.endText:this.endText();break;case a.OPS.moveText:this.moveText(x[0],x[1]);break;case a.OPS.setCharSpacing:this.setCharSpacing(x[0]);break;case a.OPS.setWordSpacing:this.setWordSpacing(x[0]);break;case a.OPS.setHScale:this.setHScale(x[0]);break;case a.OPS.setTextMatrix:this.setTextMatrix(x[0],x[1],x[2],x[3],x[4],x[5]);break;case a.OPS.setTextRise:this.setTextRise(x[0]);break;case a.OPS.setTextRenderingMode:this.setTextRenderingMode(x[0]);break;case a.OPS.setLineWidth:this.setLineWidth(x[0]);break;case a.OPS.setLineJoin:this.setLineJoin(x[0]);break;case a.OPS.setLineCap:this.setLineCap(x[0]);break;case a.OPS.setMiterLimit:this.setMiterLimit(x[0]);break;case a.OPS.setFillRGBColor:this.setFillRGBColor(x[0],x[1],x[2]);break;case a.OPS.setStrokeRGBColor:this.setStrokeRGBColor(x[0],x[1],x[2]);break;case a.OPS.setStrokeColorN:this.setStrokeColorN(x);break;case a.OPS.setFillColorN:this.setFillColorN(x);break;case a.OPS.shadingFill:this.shadingFill(x[0]);break;case a.OPS.setDash:this.setDash(x[0],x[1]);break;case a.OPS.setRenderingIntent:this.setRenderingIntent(x[0]);break;case a.OPS.setFlatness:this.setFlatness(x[0]);break;case a.OPS.setGState:this.setGState(x[0]);break;case a.OPS.fill:this.fill();break;case a.OPS.eoFill:this.eoFill();break;case a.OPS.stroke:this.stroke();break;case a.OPS.fillStroke:this.fillStroke();break;case a.OPS.eoFillStroke:this.eoFillStroke();break;case a.OPS.clip:this.clip("nonzero");break;case a.OPS.eoClip:this.clip("evenodd");break;case a.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case a.OPS.paintImageXObject:this.paintImageXObject(x[0]);break;case a.OPS.paintInlineImageXObject:this.paintInlineImageXObject(x[0]);break;case a.OPS.paintImageMaskXObject:this.paintImageMaskXObject(x[0]);break;case a.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(x[0],x[1]);break;case a.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case a.OPS.closePath:this.closePath();break;case a.OPS.closeStroke:this.closeStroke();break;case a.OPS.closeFillStroke:this.closeFillStroke();break;case a.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case a.OPS.nextLine:this.nextLine();break;case a.OPS.transform:this.transform(x[0],x[1],x[2],x[3],x[4],x[5]);break;case a.OPS.constructPath:this.constructPath(x[0],x[1]);break;case a.OPS.endPath:this.endPath();break;case 92:this.group(o.items);break;default:(0,a.warn)(`Unimplemented operator ${m}`);break}}}setWordSpacing(s){this.current.wordSpacing=s}setCharSpacing(s){this.current.charSpacing=s}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(s,o,m,M,x,y){const D=this.current;D.textMatrix=D.lineMatrix=[s,o,m,M,x,y],D.textMatrixScale=Math.hypot(s,o),D.x=D.lineX=0,D.y=D.lineY=0,D.xcoords=[],D.ycoords=[],D.tspan=this.svgFactory.createElement("svg:tspan"),D.tspan.setAttributeNS(null,"font-family",D.fontFamily),D.tspan.setAttributeNS(null,"font-size",`${i(D.fontSize)}px`),D.tspan.setAttributeNS(null,"y",i(-D.y)),D.txtElement=this.svgFactory.createElement("svg:text"),D.txtElement.append(D.tspan)}beginText(){const s=this.current;s.x=s.lineX=0,s.y=s.lineY=0,s.textMatrix=a.IDENTITY_MATRIX,s.lineMatrix=a.IDENTITY_MATRIX,s.textMatrixScale=1,s.tspan=this.svgFactory.createElement("svg:tspan"),s.txtElement=this.svgFactory.createElement("svg:text"),s.txtgrp=this.svgFactory.createElement("svg:g"),s.xcoords=[],s.ycoords=[]}moveText(s,o){const m=this.current;m.x=m.lineX+=s,m.y=m.lineY+=o,m.xcoords=[],m.ycoords=[],m.tspan=this.svgFactory.createElement("svg:tspan"),m.tspan.setAttributeNS(null,"font-family",m.fontFamily),m.tspan.setAttributeNS(null,"font-size",`${i(m.fontSize)}px`),m.tspan.setAttributeNS(null,"y",i(-m.y))}showText(s){const o=this.current,m=o.font,M=o.fontSize;if(M===0)return;const x=o.fontSizeScale,y=o.charSpacing,D=o.wordSpacing,et=o.fontDirection,it=o.textHScale*et,Z=m.vertical,J=Z?1:-1,G=m.defaultVMetrics,V=M*o.fontMatrix[0];let Y=0;for(const bt of s){if(bt===null){Y+=et*D;continue}else if(typeof bt=="number"){Y+=J*bt*M/1e3;continue}const W=(bt.isSpace?D:0)+y,p=bt.fontChar;let d,O,U=bt.width;if(Z){let q;const K=bt.vmetric||G;q=bt.vmetric?K[1]:U*.5,q=-q*V;const X=K[2]*V;U=K?-K[0]:U,d=q/x,O=(Y+X)/x}else d=Y/x,O=0;(bt.isInFont||m.missingFile)&&(o.xcoords.push(o.x+d),Z&&o.ycoords.push(-o.y+O),o.tspan.textContent+=p);let B;Z?B=U*V-W*et:B=U*V+W*et,Y+=B}o.tspan.setAttributeNS(null,"x",o.xcoords.map(i).join(" ")),Z?o.tspan.setAttributeNS(null,"y",o.ycoords.map(i).join(" ")):o.tspan.setAttributeNS(null,"y",i(-o.y)),Z?o.y-=Y:o.x+=Y*it,o.tspan.setAttributeNS(null,"font-family",o.fontFamily),o.tspan.setAttributeNS(null,"font-size",`${i(o.fontSize)}px`),o.fontStyle!==T.fontStyle&&o.tspan.setAttributeNS(null,"font-style",o.fontStyle),o.fontWeight!==T.fontWeight&&o.tspan.setAttributeNS(null,"font-weight",o.fontWeight);const rt=o.textRenderingMode&a.TextRenderingMode.FILL_STROKE_MASK;if(rt===a.TextRenderingMode.FILL||rt===a.TextRenderingMode.FILL_STROKE?(o.fillColor!==T.fillColor&&o.tspan.setAttributeNS(null,"fill",o.fillColor),o.fillAlpha<1&&o.tspan.setAttributeNS(null,"fill-opacity",o.fillAlpha)):o.textRenderingMode===a.TextRenderingMode.ADD_TO_PATH?o.tspan.setAttributeNS(null,"fill","transparent"):o.tspan.setAttributeNS(null,"fill","none"),rt===a.TextRenderingMode.STROKE||rt===a.TextRenderingMode.FILL_STROKE){const bt=1/(o.textMatrixScale||1);this._setStrokeAttributes(o.tspan,bt)}let ct=o.textMatrix;o.textRise!==0&&(ct=ct.slice(),ct[5]+=o.textRise),o.txtElement.setAttributeNS(null,"transform",`${c(ct)} scale(${i(it)}, -1)`),o.txtElement.setAttributeNS(v,"xml:space","preserve"),o.txtElement.append(o.tspan),o.txtgrp.append(o.txtElement),this._ensureTransformGroup().append(o.txtElement)}setLeadingMoveText(s,o){this.setLeading(-o),this.moveText(s,o)}addFontStyle(s){if(!s.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const o=w(s.data,s.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${s.loadedName}"; src: url(${o}); }
`}setFont(s){const o=this.current,m=this.commonObjs.get(s[0]);let M=s[1];o.font=m,this.embedFonts&&!m.missingFile&&!this.embeddedFonts[m.loadedName]&&(this.addFontStyle(m),this.embeddedFonts[m.loadedName]=m),o.fontMatrix=m.fontMatrix||a.FONT_IDENTITY_MATRIX;let x="normal";m.black?x="900":m.bold&&(x="bold");const y=m.italic?"italic":"normal";M<0?(M=-M,o.fontDirection=-1):o.fontDirection=1,o.fontSize=M,o.fontFamily=m.loadedName,o.fontWeight=x,o.fontStyle=y,o.tspan=this.svgFactory.createElement("svg:tspan"),o.tspan.setAttributeNS(null,"y",i(-o.y)),o.xcoords=[],o.ycoords=[]}endText(){var o;const s=this.current;s.textRenderingMode&a.TextRenderingMode.ADD_TO_PATH_FLAG&&((o=s.txtElement)!=null&&o.hasChildNodes())&&(s.element=s.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(s){s>0&&(this.current.lineWidth=s)}setLineCap(s){this.current.lineCap=R[s]}setLineJoin(s){this.current.lineJoin=N[s]}setMiterLimit(s){this.current.miterLimit=s}setStrokeAlpha(s){this.current.strokeAlpha=s}setStrokeRGBColor(s,o,m){this.current.strokeColor=a.Util.makeHexColor(s,o,m)}setFillAlpha(s){this.current.fillAlpha=s}setFillRGBColor(s,o,m){this.current.fillColor=a.Util.makeHexColor(s,o,m),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(s){this.current.strokeColor=this._makeColorN_Pattern(s)}setFillColorN(s){this.current.fillColor=this._makeColorN_Pattern(s)}shadingFill(s){const o=this.viewport.width,m=this.viewport.height,M=a.Util.inverseTransform(this.transformMatrix),x=a.Util.applyTransform([0,0],M),y=a.Util.applyTransform([0,m],M),D=a.Util.applyTransform([o,0],M),et=a.Util.applyTransform([o,m],M),it=Math.min(x[0],y[0],D[0],et[0]),Z=Math.min(x[1],y[1],D[1],et[1]),J=Math.max(x[0],y[0],D[0],et[0]),G=Math.max(x[1],y[1],D[1],et[1]),V=this.svgFactory.createElement("svg:rect");V.setAttributeNS(null,"x",it),V.setAttributeNS(null,"y",Z),V.setAttributeNS(null,"width",J-it),V.setAttributeNS(null,"height",G-Z),V.setAttributeNS(null,"fill",this._makeShadingPattern(s)),this.current.fillAlpha<1&&V.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(V)}_makeColorN_Pattern(s){return s[0]==="TilingPattern"?this._makeTilingPattern(s):this._makeShadingPattern(s)}_makeTilingPattern(s){const o=s[1],m=s[2],M=s[3]||a.IDENTITY_MATRIX,[x,y,D,et]=s[4],it=s[5],Z=s[6],J=s[7],G=`shading${h++}`,[V,Y,rt,ct]=a.Util.normalizeRect([...a.Util.applyTransform([x,y],M),...a.Util.applyTransform([D,et],M)]),[bt,W]=a.Util.singularValueDecompose2dScale(M),p=it*bt,d=Z*W,O=this.svgFactory.createElement("svg:pattern");O.setAttributeNS(null,"id",G),O.setAttributeNS(null,"patternUnits","userSpaceOnUse"),O.setAttributeNS(null,"width",p),O.setAttributeNS(null,"height",d),O.setAttributeNS(null,"x",`${V}`),O.setAttributeNS(null,"y",`${Y}`);const U=this.svg,B=this.transformMatrix,q=this.current.fillColor,K=this.current.strokeColor,X=this.svgFactory.create(rt-V,ct-Y);if(this.svg=X,this.transformMatrix=M,J===2){const l=a.Util.makeHexColor(...o);this.current.fillColor=l,this.current.strokeColor=l}return this.executeOpTree(this.convertOpList(m)),this.svg=U,this.transformMatrix=B,this.current.fillColor=q,this.current.strokeColor=K,O.append(X.childNodes[0]),this.defs.append(O),`url(#${G})`}_makeShadingPattern(s){switch(typeof s=="string"&&(s=this.objs.get(s)),s[0]){case"RadialAxial":const o=`shading${h++}`,m=s[3];let M;switch(s[1]){case"axial":const x=s[4],y=s[5];M=this.svgFactory.createElement("svg:linearGradient"),M.setAttributeNS(null,"id",o),M.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),M.setAttributeNS(null,"x1",x[0]),M.setAttributeNS(null,"y1",x[1]),M.setAttributeNS(null,"x2",y[0]),M.setAttributeNS(null,"y2",y[1]);break;case"radial":const D=s[4],et=s[5],it=s[6],Z=s[7];M=this.svgFactory.createElement("svg:radialGradient"),M.setAttributeNS(null,"id",o),M.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),M.setAttributeNS(null,"cx",et[0]),M.setAttributeNS(null,"cy",et[1]),M.setAttributeNS(null,"r",Z),M.setAttributeNS(null,"fx",D[0]),M.setAttributeNS(null,"fy",D[1]),M.setAttributeNS(null,"fr",it);break;default:throw new Error(`Unknown RadialAxial type: ${s[1]}`)}for(const x of m){const y=this.svgFactory.createElement("svg:stop");y.setAttributeNS(null,"offset",x[0]),y.setAttributeNS(null,"stop-color",x[1]),M.append(y)}return this.defs.append(M),`url(#${o})`;case"Mesh":return(0,a.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${s[0]}`)}}setDash(s,o){this.current.dashArray=s,this.current.dashPhase=o}constructPath(s,o){const m=this.current;let M=m.x,x=m.y,y=[],D=0;for(const et of s)switch(et|0){case a.OPS.rectangle:M=o[D++],x=o[D++];const it=o[D++],Z=o[D++],J=M+it,G=x+Z;y.push("M",i(M),i(x),"L",i(J),i(x),"L",i(J),i(G),"L",i(M),i(G),"Z");break;case a.OPS.moveTo:M=o[D++],x=o[D++],y.push("M",i(M),i(x));break;case a.OPS.lineTo:M=o[D++],x=o[D++],y.push("L",i(M),i(x));break;case a.OPS.curveTo:M=o[D+4],x=o[D+5],y.push("C",i(o[D]),i(o[D+1]),i(o[D+2]),i(o[D+3]),i(M),i(x)),D+=6;break;case a.OPS.curveTo2:y.push("C",i(M),i(x),i(o[D]),i(o[D+1]),i(o[D+2]),i(o[D+3])),M=o[D+2],x=o[D+3],D+=4;break;case a.OPS.curveTo3:M=o[D+2],x=o[D+3],y.push("C",i(o[D]),i(o[D+1]),i(M),i(x),i(M),i(x)),D+=4;break;case a.OPS.closePath:y.push("Z");break}y=y.join(" "),m.path&&s.length>0&&s[0]!==a.OPS.rectangle&&s[0]!==a.OPS.moveTo?y=m.path.getAttributeNS(null,"d")+y:(m.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(m.path)),m.path.setAttributeNS(null,"d",y),m.path.setAttributeNS(null,"fill","none"),m.element=m.path,m.setCurrentPoint(M,x)}endPath(){const s=this.current;if(s.path=null,!this.pendingClip)return;if(!s.element){this.pendingClip=null;return}const o=`clippath${S++}`,m=this.svgFactory.createElement("svg:clipPath");m.setAttributeNS(null,"id",o),m.setAttributeNS(null,"transform",c(this.transformMatrix));const M=s.element.cloneNode(!0);if(this.pendingClip==="evenodd"?M.setAttributeNS(null,"clip-rule","evenodd"):M.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,m.append(M),this.defs.append(m),s.activeClipUrl){s.clipGroup=null;for(const x of this.extraStack)x.clipGroup=null;m.setAttributeNS(null,"clip-path",s.activeClipUrl)}s.activeClipUrl=`url(#${o})`,this.tgrp=null}clip(s){this.pendingClip=s}closePath(){const s=this.current;if(s.path){const o=`${s.path.getAttributeNS(null,"d")}Z`;s.path.setAttributeNS(null,"d",o)}}setLeading(s){this.current.leading=-s}setTextRise(s){this.current.textRise=s}setTextRenderingMode(s){this.current.textRenderingMode=s}setHScale(s){this.current.textHScale=s/100}setRenderingIntent(s){}setFlatness(s){}setGState(s){for(const[o,m]of s)switch(o){case"LW":this.setLineWidth(m);break;case"LC":this.setLineCap(m);break;case"LJ":this.setLineJoin(m);break;case"ML":this.setMiterLimit(m);break;case"D":this.setDash(m[0],m[1]);break;case"RI":this.setRenderingIntent(m);break;case"FL":this.setFlatness(m);break;case"Font":this.setFont(m);break;case"CA":this.setStrokeAlpha(m);break;case"ca":this.setFillAlpha(m);break;default:(0,a.warn)(`Unimplemented graphic state operator ${o}`);break}}fill(){const s=this.current;s.element&&(s.element.setAttributeNS(null,"fill",s.fillColor),s.element.setAttributeNS(null,"fill-opacity",s.fillAlpha),this.endPath())}stroke(){const s=this.current;s.element&&(this._setStrokeAttributes(s.element),s.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(s,o=1){const m=this.current;let M=m.dashArray;o!==1&&M.length>0&&(M=M.map(function(x){return o*x})),s.setAttributeNS(null,"stroke",m.strokeColor),s.setAttributeNS(null,"stroke-opacity",m.strokeAlpha),s.setAttributeNS(null,"stroke-miterlimit",i(m.miterLimit)),s.setAttributeNS(null,"stroke-linecap",m.lineCap),s.setAttributeNS(null,"stroke-linejoin",m.lineJoin),s.setAttributeNS(null,"stroke-width",i(o*m.lineWidth)+"px"),s.setAttributeNS(null,"stroke-dasharray",M.map(i).join(" ")),s.setAttributeNS(null,"stroke-dashoffset",i(o*m.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const s=this.svgFactory.createElement("svg:rect");s.setAttributeNS(null,"x","0"),s.setAttributeNS(null,"y","0"),s.setAttributeNS(null,"width","1px"),s.setAttributeNS(null,"height","1px"),s.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(s)}paintImageXObject(s){const o=s.startsWith("g_")?this.commonObjs.get(s):this.objs.get(s);if(!o){(0,a.warn)(`Dependent image with object ID ${s} is not ready yet`);return}this.paintInlineImageXObject(o)}paintInlineImageXObject(s,o){const m=s.width,M=s.height,x=P(s,this.forceDataSchema,!!o),y=this.svgFactory.createElement("svg:rect");y.setAttributeNS(null,"x","0"),y.setAttributeNS(null,"y","0"),y.setAttributeNS(null,"width",i(m)),y.setAttributeNS(null,"height",i(M)),this.current.element=y,this.clip("nonzero");const D=this.svgFactory.createElement("svg:image");D.setAttributeNS(f,"xlink:href",x),D.setAttributeNS(null,"x","0"),D.setAttributeNS(null,"y",i(-M)),D.setAttributeNS(null,"width",i(m)+"px"),D.setAttributeNS(null,"height",i(M)+"px"),D.setAttributeNS(null,"transform",`scale(${i(1/m)} ${i(-1/M)})`),o?o.append(D):this._ensureTransformGroup().append(D)}paintImageMaskXObject(s){const o=this.current,m=s.width,M=s.height,x=o.fillColor;o.maskId=`mask${E++}`;const y=this.svgFactory.createElement("svg:mask");y.setAttributeNS(null,"id",o.maskId);const D=this.svgFactory.createElement("svg:rect");D.setAttributeNS(null,"x","0"),D.setAttributeNS(null,"y","0"),D.setAttributeNS(null,"width",i(m)),D.setAttributeNS(null,"height",i(M)),D.setAttributeNS(null,"fill",x),D.setAttributeNS(null,"mask",`url(#${o.maskId})`),this.defs.append(y),this._ensureTransformGroup().append(D),this.paintInlineImageXObject(s,y)}paintFormXObjectBegin(s,o){if(Array.isArray(s)&&s.length===6&&this.transform(s[0],s[1],s[2],s[3],s[4],s[5]),o){const m=o[2]-o[0],M=o[3]-o[1],x=this.svgFactory.createElement("svg:rect");x.setAttributeNS(null,"x",o[0]),x.setAttributeNS(null,"y",o[1]),x.setAttributeNS(null,"width",i(m)),x.setAttributeNS(null,"height",i(M)),this.current.element=x,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(s){const o=this.svgFactory.create(s.width,s.height),m=this.svgFactory.createElement("svg:defs");o.append(m),this.defs=m;const M=this.svgFactory.createElement("svg:g");return M.setAttributeNS(null,"transform",c(s.transform)),o.append(M),this.svg=M,o}_ensureClipGroup(){if(!this.current.clipGroup){const s=this.svgFactory.createElement("svg:g");s.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(s),this.current.clipGroup=s}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",c(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}},(_,n,b)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFNodeStream=void 0;var t=b(1),a=b(33);const k=require$$5,F=require$$5,T=require$$5,v=require$$5,f=/^file:\/\/\/[a-zA-Z]:\//;function R(E){const h=v.parse(E);return h.protocol==="file:"||h.host?h:/^[a-z]:[/\\]/i.test(E)?v.parse(`file:///${E}`):(h.host||(h.protocol="file:"),h)}class N{constructor(h){this.source=h,this.url=R(h.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&h.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var h;return((h=this._fullRequestReader)==null?void 0:h._loaded)??0}getFullReader(){return(0,t.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new c(this):new e(this),this._fullRequestReader}getRangeReader(h,s){if(s<=this._progressiveDataLength)return null;const o=this.isFsUrl?new S(this,h,s):new i(this,h,s);return this._rangeRequestReaders.push(o),o}cancelAllRequests(h){this._fullRequestReader&&this._fullRequestReader.cancel(h);for(const s of this._rangeRequestReaders.slice(0))s.cancel(h)}}n.PDFNodeStream=N;class w{constructor(h){this._url=h.url,this._done=!1,this._storedError=null,this.onProgress=null;const s=h.source;this._contentLength=s.length,this._loaded=0,this._filename=null,this._disableRange=s.disableRange||!1,this._rangeChunkSize=s.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!s.disableStream,this._isRangeSupported=!s.disableRange,this._readableStream=null,this._readCapability=(0,t.createPromiseCapability)(),this._headersCapability=(0,t.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const h=this._readableStream.read();return h===null?(this._readCapability=(0,t.createPromiseCapability)(),this.read()):(this._loaded+=h.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(h).buffer,done:!1})}cancel(h){if(!this._readableStream){this._error(h);return}this._readableStream.destroy(h)}_error(h){this._storedError=h,this._readCapability.resolve()}_setReadableStream(h){this._readableStream=h,h.on("readable",()=>{this._readCapability.resolve()}),h.on("end",()=>{h.destroy(),this._done=!0,this._readCapability.resolve()}),h.on("error",s=>{this._error(s)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new t.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class P{constructor(h){this._url=h.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,t.createPromiseCapability)();const s=h.source;this._isStreamingSupported=!s.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const h=this._readableStream.read();return h===null?(this._readCapability=(0,t.createPromiseCapability)(),this.read()):(this._loaded+=h.length,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(h).buffer,done:!1})}cancel(h){if(!this._readableStream){this._error(h);return}this._readableStream.destroy(h)}_error(h){this._storedError=h,this._readCapability.resolve()}_setReadableStream(h){this._readableStream=h,h.on("readable",()=>{this._readCapability.resolve()}),h.on("end",()=>{h.destroy(),this._done=!0,this._readCapability.resolve()}),h.on("error",s=>{this._error(s)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function u(E,h){return{protocol:E.protocol,auth:E.auth,host:E.hostname,port:E.port,path:E.path,method:"GET",headers:h}}class e extends w{constructor(h){super(h);const s=o=>{if(o.statusCode===404){const y=new t.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=y,this._headersCapability.reject(y);return}this._headersCapability.resolve(),this._setReadableStream(o);const m=y=>this._readableStream.headers[y.toLowerCase()],{allowRangeRequests:M,suggestedLength:x}=(0,a.validateRangeRequestCapabilities)({getResponseHeader:m,isHttp:h.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=M,this._contentLength=x||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(m)};this._request=null,this._url.protocol==="http:"?this._request=F.request(u(this._url,h.httpHeaders),s):this._request=T.request(u(this._url,h.httpHeaders),s),this._request.on("error",o=>{this._storedError=o,this._headersCapability.reject(o)}),this._request.end()}}class i extends P{constructor(h,s,o){super(h),this._httpHeaders={};for(const M in h.httpHeaders){const x=h.httpHeaders[M];typeof x>"u"||(this._httpHeaders[M]=x)}this._httpHeaders.Range=`bytes=${s}-${o-1}`;const m=M=>{if(M.statusCode===404){const x=new t.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=x;return}this._setReadableStream(M)};this._request=null,this._url.protocol==="http:"?this._request=F.request(u(this._url,this._httpHeaders),m):this._request=T.request(u(this._url,this._httpHeaders),m),this._request.on("error",M=>{this._storedError=M}),this._request.end()}}class c extends w{constructor(h){super(h);let s=decodeURIComponent(this._url.path);f.test(this._url.href)&&(s=s.replace(/^\//,"")),k.lstat(s,(o,m)=>{if(o){o.code==="ENOENT"&&(o=new t.MissingPDFException(`Missing PDF "${s}".`)),this._storedError=o,this._headersCapability.reject(o);return}this._contentLength=m.size,this._setReadableStream(k.createReadStream(s)),this._headersCapability.resolve()})}}class S extends P{constructor(h,s,o){super(h);let m=decodeURIComponent(this._url.path);f.test(this._url.href)&&(m=m.replace(/^\//,"")),this._setReadableStream(k.createReadStream(m,{start:s,end:o-1}))}}},(_,n,b)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.createResponseStatusError=v,n.extractFilenameFromHeader=T,n.validateRangeRequestCapabilities=F,n.validateResponseStatus=f;var t=b(1),a=b(34),k=b(8);function F({getResponseHeader:R,isHttp:N,rangeChunkSize:w,disableRange:P}){const u={allowRangeRequests:!1,suggestedLength:void 0},e=parseInt(R("Content-Length"),10);return!Number.isInteger(e)||(u.suggestedLength=e,e<=2*w)||P||!N||R("Accept-Ranges")!=="bytes"||(R("Content-Encoding")||"identity")!=="identity"||(u.allowRangeRequests=!0),u}function T(R){const N=R("Content-Disposition");if(N){let w=(0,a.getFilenameFromContentDispositionHeader)(N);if(w.includes("%"))try{w=decodeURIComponent(w)}catch{}if((0,k.isPdfFile)(w))return w}return null}function v(R,N){return R===404||R===0&&N.startsWith("file:")?new t.MissingPDFException('Missing PDF "'+N+'".'):new t.UnexpectedResponseException(`Unexpected server response (${R}) while retrieving PDF "${N}".`,R)}function f(R){return R===200||R===206}},(_,n,b)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.getFilenameFromContentDispositionHeader=a;var t=b(1);function a(k){let F=!0,T=v("filename\\*","i").exec(k);if(T){T=T[1];let e=w(T);return e=unescape(e),e=P(e),e=u(e),R(e)}if(T=N(k),T){const e=u(T);return R(e)}if(T=v("filename","i").exec(k),T){T=T[1];let e=w(T);return e=u(e),R(e)}function v(e,i){return new RegExp("(?:^|;)\\s*"+e+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',i)}function f(e,i){if(e){if(!/^[\x00-\xFF]+$/.test(i))return i;try{const c=new TextDecoder(e,{fatal:!0}),S=(0,t.stringToBytes)(i);i=c.decode(S),F=!1}catch{}}return i}function R(e){return F&&/[\x80-\xff]/.test(e)&&(e=f("utf-8",e),F&&(e=f("iso-8859-1",e))),e}function N(e){const i=[];let c;const S=v("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(c=S.exec(e))!==null;){let[,h,s,o]=c;if(h=parseInt(h,10),h in i){if(h===0)break;continue}i[h]=[s,o]}const E=[];for(let h=0;h<i.length&&h in i;++h){let[s,o]=i[h];o=w(o),s&&(o=unescape(o),h===0&&(o=P(o))),E.push(o)}return E.join("")}function w(e){if(e.startsWith('"')){const i=e.slice(1).split('\\"');for(let c=0;c<i.length;++c){const S=i[c].indexOf('"');S!==-1&&(i[c]=i[c].slice(0,S),i.length=c+1),i[c]=i[c].replace(/\\(.)/g,"$1")}e=i.join('"')}return e}function P(e){const i=e.indexOf("'");if(i===-1)return e;const c=e.slice(0,i),E=e.slice(i+1).replace(/^[^']*'/,"");return f(c,E)}function u(e){return!e.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(e)?e:e.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(i,c,S,E){if(S==="q"||S==="Q")return E=E.replace(/_/g," "),E=E.replace(/=([0-9a-fA-F]{2})/g,function(h,s){return String.fromCharCode(parseInt(s,16))}),f(c,E);try{E=atob(E)}catch{}return f(c,E)})}return""}},(_,n,b)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFNetworkStream=void 0;var t=b(1),a=b(33);const k=200,F=206;function T(w){const P=w.response;return typeof P!="string"?P:(0,t.stringToBytes)(P).buffer}class v{constructor(P,u={}){this.url=P,this.isHttp=/^https?:/i.test(P),this.httpHeaders=this.isHttp&&u.httpHeaders||Object.create(null),this.withCredentials=u.withCredentials||!1,this.getXhr=u.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(P,u,e){const i={begin:P,end:u};for(const c in e)i[c]=e[c];return this.request(i)}requestFull(P){return this.request(P)}request(P){const u=this.getXhr(),e=this.currXhrId++,i=this.pendingRequests[e]={xhr:u};u.open("GET",this.url),u.withCredentials=this.withCredentials;for(const c in this.httpHeaders){const S=this.httpHeaders[c];typeof S>"u"||u.setRequestHeader(c,S)}return this.isHttp&&"begin"in P&&"end"in P?(u.setRequestHeader("Range",`bytes=${P.begin}-${P.end-1}`),i.expectedStatus=F):i.expectedStatus=k,u.responseType="arraybuffer",P.onError&&(u.onerror=function(c){P.onError(u.status)}),u.onreadystatechange=this.onStateChange.bind(this,e),u.onprogress=this.onProgress.bind(this,e),i.onHeadersReceived=P.onHeadersReceived,i.onDone=P.onDone,i.onError=P.onError,i.onProgress=P.onProgress,u.send(null),e}onProgress(P,u){var i;const e=this.pendingRequests[P];e&&((i=e.onProgress)==null||i.call(e,u))}onStateChange(P,u){var h,s,o;const e=this.pendingRequests[P];if(!e)return;const i=e.xhr;if(i.readyState>=2&&e.onHeadersReceived&&(e.onHeadersReceived(),delete e.onHeadersReceived),i.readyState!==4||!(P in this.pendingRequests))return;if(delete this.pendingRequests[P],i.status===0&&this.isHttp){(h=e.onError)==null||h.call(e,i.status);return}const c=i.status||k;if(!(c===k&&e.expectedStatus===F)&&c!==e.expectedStatus){(s=e.onError)==null||s.call(e,i.status);return}const E=T(i);if(c===F){const m=i.getResponseHeader("Content-Range"),M=/bytes (\d+)-(\d+)\/(\d+)/.exec(m);e.onDone({begin:parseInt(M[1],10),chunk:E})}else E?e.onDone({begin:0,chunk:E}):(o=e.onError)==null||o.call(e,i.status)}getRequestXhr(P){return this.pendingRequests[P].xhr}isPendingRequest(P){return P in this.pendingRequests}abortRequest(P){const u=this.pendingRequests[P].xhr;delete this.pendingRequests[P],u.abort()}}class f{constructor(P){this._source=P,this._manager=new v(P.url,{httpHeaders:P.httpHeaders,withCredentials:P.withCredentials}),this._rangeChunkSize=P.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(P){const u=this._rangeRequestReaders.indexOf(P);u>=0&&this._rangeRequestReaders.splice(u,1)}getFullReader(){return(0,t.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new R(this._manager,this._source),this._fullRequestReader}getRangeReader(P,u){const e=new N(this._manager,P,u);return e.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(e),e}cancelAllRequests(P){var u;(u=this._fullRequestReader)==null||u.cancel(P);for(const e of this._rangeRequestReaders.slice(0))e.cancel(P)}}n.PDFNetworkStream=f;class R{constructor(P,u){this._manager=P;const e={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=u.url,this._fullRequestId=P.requestFull(e),this._headersReceivedCapability=(0,t.createPromiseCapability)(),this._disableRange=u.disableRange||!1,this._contentLength=u.length,this._rangeChunkSize=u.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const P=this._fullRequestId,u=this._manager.getRequestXhr(P),e=S=>u.getResponseHeader(S),{allowRangeRequests:i,suggestedLength:c}=(0,a.validateRangeRequestCapabilities)({getResponseHeader:e,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=c||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(e),this._isRangeSupported&&this._manager.abortRequest(P),this._headersReceivedCapability.resolve()}_onDone(P){if(P&&(this._requests.length>0?this._requests.shift().resolve({value:P.chunk,done:!1}):this._cachedChunks.push(P.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(P){this._storedError=(0,a.createResponseStatusError)(P,this._url),this._headersReceivedCapability.reject(this._storedError);for(const u of this._requests)u.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(P){var u;(u=this.onProgress)==null||u.call(this,{loaded:P.loaded,total:P.lengthComputable?P.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const P=(0,t.createPromiseCapability)();return this._requests.push(P),P.promise}cancel(P){this._done=!0,this._headersReceivedCapability.reject(P);for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class N{constructor(P,u,e){this._manager=P;const i={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=P.url,this._requestId=P.requestRange(u,e,i),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var P;(P=this.onClosed)==null||P.call(this,this)}_onDone(P){const u=P.chunk;this._requests.length>0?this._requests.shift().resolve({value:u,done:!1}):this._queuedChunk=u,this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(P){this._storedError=(0,a.createResponseStatusError)(P,this._url);for(const u of this._requests)u.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(P){var u;this.isStreamingSupported||(u=this.onProgress)==null||u.call(this,{loaded:P.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const u=this._queuedChunk;return this._queuedChunk=null,{value:u,done:!1}}if(this._done)return{value:void 0,done:!0};const P=(0,t.createPromiseCapability)();return this._requests.push(P),P.promise}cancel(P){this._done=!0;for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(_,n,b)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFFetchStream=void 0;var t=b(1),a=b(33);function k(R,N,w){return{method:"GET",headers:R,signal:w.signal,mode:"cors",credentials:N?"include":"same-origin",redirect:"follow"}}function F(R){const N=new Headers;for(const w in R){const P=R[w];typeof P>"u"||N.append(w,P)}return N}class T{constructor(N){this.source=N,this.isHttp=/^https?:/i.test(N.url),this.httpHeaders=this.isHttp&&N.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var N;return((N=this._fullRequestReader)==null?void 0:N._loaded)??0}getFullReader(){return(0,t.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new v(this),this._fullRequestReader}getRangeReader(N,w){if(w<=this._progressiveDataLength)return null;const P=new f(this,N,w);return this._rangeRequestReaders.push(P),P}cancelAllRequests(N){this._fullRequestReader&&this._fullRequestReader.cancel(N);for(const w of this._rangeRequestReaders.slice(0))w.cancel(N)}}n.PDFFetchStream=T;class v{constructor(N){this._stream=N,this._reader=null,this._loaded=0,this._filename=null;const w=N.source;this._withCredentials=w.withCredentials||!1,this._contentLength=w.length,this._headersCapability=(0,t.createPromiseCapability)(),this._disableRange=w.disableRange||!1,this._rangeChunkSize=w.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!w.disableStream,this._isRangeSupported=!w.disableRange,this._headers=F(this._stream.httpHeaders);const P=w.url;fetch(P,k(this._headers,this._withCredentials,this._abortController)).then(u=>{if(!(0,a.validateResponseStatus)(u.status))throw(0,a.createResponseStatusError)(u.status,P);this._reader=u.body.getReader(),this._headersCapability.resolve();const e=S=>u.headers.get(S),{allowRangeRequests:i,suggestedLength:c}=(0,a.validateRangeRequestCapabilities)({getResponseHeader:e,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=i,this._contentLength=c||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(e),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new t.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:N,done:w}=await this._reader.read();return w?{value:N,done:w}:(this._loaded+=N.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(N).buffer,done:!1})}cancel(N){this._reader&&this._reader.cancel(N),this._abortController.abort()}}class f{constructor(N,w,P){this._stream=N,this._reader=null,this._loaded=0;const u=N.source;this._withCredentials=u.withCredentials||!1,this._readCapability=(0,t.createPromiseCapability)(),this._isStreamingSupported=!u.disableStream,this._abortController=new AbortController,this._headers=F(this._stream.httpHeaders),this._headers.append("Range",`bytes=${w}-${P-1}`);const e=u.url;fetch(e,k(this._headers,this._withCredentials,this._abortController)).then(i=>{if(!(0,a.validateResponseStatus)(i.status))throw(0,a.createResponseStatusError)(i.status,e);this._readCapability.resolve(),this._reader=i.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:N,done:w}=await this._reader.read();return w?{value:N,done:w}:(this._loaded+=N.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(N).buffer,done:!1})}cancel(N){this._reader&&this._reader.cancel(N),this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(_){var n=__webpack_module_cache__[_];if(n!==void 0)return n.exports;var b=__webpack_module_cache__[_]={exports:{}};return __webpack_modules__[_](b,b.exports,__w_pdfjs_require__),b.exports}var __webpack_exports__={};return(()=>{var _=__webpack_exports__;Object.defineProperty(_,"__esModule",{value:!0}),Object.defineProperty(_,"AnnotationEditorLayer",{enumerable:!0,get:function(){return a.AnnotationEditorLayer}}),Object.defineProperty(_,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return n.AnnotationEditorParamsType}}),Object.defineProperty(_,"AnnotationEditorType",{enumerable:!0,get:function(){return n.AnnotationEditorType}}),Object.defineProperty(_,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return k.AnnotationEditorUIManager}}),Object.defineProperty(_,"AnnotationLayer",{enumerable:!0,get:function(){return F.AnnotationLayer}}),Object.defineProperty(_,"AnnotationMode",{enumerable:!0,get:function(){return n.AnnotationMode}}),Object.defineProperty(_,"CMapCompressionType",{enumerable:!0,get:function(){return n.CMapCompressionType}}),Object.defineProperty(_,"GlobalWorkerOptions",{enumerable:!0,get:function(){return T.GlobalWorkerOptions}}),Object.defineProperty(_,"InvalidPDFException",{enumerable:!0,get:function(){return n.InvalidPDFException}}),Object.defineProperty(_,"LoopbackPort",{enumerable:!0,get:function(){return b.LoopbackPort}}),Object.defineProperty(_,"MissingPDFException",{enumerable:!0,get:function(){return n.MissingPDFException}}),Object.defineProperty(_,"OPS",{enumerable:!0,get:function(){return n.OPS}}),Object.defineProperty(_,"PDFDataRangeTransport",{enumerable:!0,get:function(){return b.PDFDataRangeTransport}}),Object.defineProperty(_,"PDFDateString",{enumerable:!0,get:function(){return t.PDFDateString}}),Object.defineProperty(_,"PDFWorker",{enumerable:!0,get:function(){return b.PDFWorker}}),Object.defineProperty(_,"PasswordResponses",{enumerable:!0,get:function(){return n.PasswordResponses}}),Object.defineProperty(_,"PermissionFlag",{enumerable:!0,get:function(){return n.PermissionFlag}}),Object.defineProperty(_,"PixelsPerInch",{enumerable:!0,get:function(){return t.PixelsPerInch}}),Object.defineProperty(_,"RenderingCancelledException",{enumerable:!0,get:function(){return t.RenderingCancelledException}}),Object.defineProperty(_,"SVGGraphics",{enumerable:!0,get:function(){return R.SVGGraphics}}),Object.defineProperty(_,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return n.UNSUPPORTED_FEATURES}}),Object.defineProperty(_,"UnexpectedResponseException",{enumerable:!0,get:function(){return n.UnexpectedResponseException}}),Object.defineProperty(_,"Util",{enumerable:!0,get:function(){return n.Util}}),Object.defineProperty(_,"VerbosityLevel",{enumerable:!0,get:function(){return n.VerbosityLevel}}),Object.defineProperty(_,"XfaLayer",{enumerable:!0,get:function(){return N.XfaLayer}}),Object.defineProperty(_,"build",{enumerable:!0,get:function(){return b.build}}),Object.defineProperty(_,"createPromiseCapability",{enumerable:!0,get:function(){return n.createPromiseCapability}}),Object.defineProperty(_,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return n.createValidAbsoluteUrl}}),Object.defineProperty(_,"getDocument",{enumerable:!0,get:function(){return b.getDocument}}),Object.defineProperty(_,"getFilenameFromUrl",{enumerable:!0,get:function(){return t.getFilenameFromUrl}}),Object.defineProperty(_,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return t.getPdfFilenameFromUrl}}),Object.defineProperty(_,"getXfaPageViewport",{enumerable:!0,get:function(){return t.getXfaPageViewport}}),Object.defineProperty(_,"isPdfFile",{enumerable:!0,get:function(){return t.isPdfFile}}),Object.defineProperty(_,"loadScript",{enumerable:!0,get:function(){return t.loadScript}}),Object.defineProperty(_,"renderTextLayer",{enumerable:!0,get:function(){return f.renderTextLayer}}),Object.defineProperty(_,"shadow",{enumerable:!0,get:function(){return n.shadow}}),Object.defineProperty(_,"version",{enumerable:!0,get:function(){return b.version}});var n=__w_pdfjs_require__(1),b=__w_pdfjs_require__(4),t=__w_pdfjs_require__(8),a=__w_pdfjs_require__(22),k=__w_pdfjs_require__(7),F=__w_pdfjs_require__(27),T=__w_pdfjs_require__(15),v=__w_pdfjs_require__(3),f=__w_pdfjs_require__(30),R=__w_pdfjs_require__(31),N=__w_pdfjs_require__(29);if(v.isNodeJS){const{PDFNodeStream:w}=__w_pdfjs_require__(32);(0,b.setPDFNetworkStreamFactory)(P=>new w(P))}else{const{PDFNetworkStream:w}=__w_pdfjs_require__(35),{PDFFetchStream:P}=__w_pdfjs_require__(36);(0,b.setPDFNetworkStreamFactory)(u=>(0,t.isValidFetchUrl)(u.url)?new P(u):new w(u))}})(),__webpack_exports__})())})(pdf);function _objectWithoutPropertiesLoose(_,n){if(_==null)return{};var b={},t=Object.keys(_),a,k;for(k=0;k<t.length;k++)a=t[k],!(n.indexOf(a)>=0)&&(b[a]=_[a]);return b}function _objectWithoutProperties(_,n){if(_==null)return{};var b=_objectWithoutPropertiesLoose(_,n),t,a;if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(_);for(a=0;a<k.length;a++)t=k[a],!(n.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(_,t)&&(b[t]=_[t])}return b}function _typeof(_){return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},_typeof(_)}function _classCallCheck(_,n){if(!(_ instanceof n))throw new TypeError("Cannot call a class as a function")}function _toPrimitive(_,n){if(_typeof(_)!=="object"||_===null)return _;var b=_[Symbol.toPrimitive];if(b!==void 0){var t=b.call(_,n||"default");if(_typeof(t)!=="object")return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(_)}function _toPropertyKey(_){var n=_toPrimitive(_,"string");return _typeof(n)==="symbol"?n:String(n)}function _defineProperties(_,n){for(var b=0;b<n.length;b++){var t=n[b];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(_,_toPropertyKey(t.key),t)}}function _createClass(_,n,b){return n&&_defineProperties(_.prototype,n),b&&_defineProperties(_,b),Object.defineProperty(_,"prototype",{writable:!1}),_}function _assertThisInitialized(_){if(_===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _}function _inherits(_,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");_.prototype=Object.create(n&&n.prototype,{constructor:{value:_,writable:!0,configurable:!0}}),Object.defineProperty(_,"prototype",{writable:!1}),n&&_setPrototypeOf(_,n)}function _possibleConstructorReturn(_,n){if(n&&(_typeof(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(_)}function _getPrototypeOf(_){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(b){return b.__proto__||Object.getPrototypeOf(b)},_getPrototypeOf(_)}function _defineProperty(_,n,b){return n=_toPropertyKey(n),n in _?Object.defineProperty(_,n,{value:b,enumerable:!0,configurable:!0,writable:!0}):_[n]=b,_}var propTypesExports={},propTypes={get exports(){return propTypesExports},set exports(_){propTypesExports=_}},ReactPropTypesSecret$1="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",ReactPropTypesSecret_1=ReactPropTypesSecret$1,ReactPropTypesSecret=ReactPropTypesSecret_1;function emptyFunction(){}function emptyFunctionWithReset(){}emptyFunctionWithReset.resetWarningCache=emptyFunction;var factoryWithThrowingShims=function(){function _(t,a,k,F,T,v){if(v!==ReactPropTypesSecret){var f=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw f.name="Invariant Violation",f}}_.isRequired=_;function n(){return _}var b={array:_,bigint:_,bool:_,func:_,number:_,object:_,string:_,symbol:_,any:_,arrayOf:n,element:_,elementType:_,instanceOf:n,node:_,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:emptyFunctionWithReset,resetWarningCache:emptyFunction};return b.PropTypes=b,b};propTypes.exports=factoryWithThrowingShims();var __spreadArray=globalThis&&globalThis.__spreadArray||function(_,n,b){if(b||arguments.length===2)for(var t=0,a=n.length,k;t<a;t++)(k||!(t in n))&&(k||(k=Array.prototype.slice.call(n,0,t)),k[t]=n[t]);return _.concat(k||Array.prototype.slice.call(n))},clipboardEvents=["onCopy","onCut","onPaste"],compositionEvents=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],focusEvents=["onFocus","onBlur"],formEvents=["onInput","onInvalid","onReset","onSubmit"],imageEvents=["onLoad","onError"],keyboardEvents=["onKeyDown","onKeyPress","onKeyUp"],mediaEvents=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],mouseEvents=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],dragEvents=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],selectionEvents=["onSelect"],touchEvents=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],pointerEvents=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],uiEvents=["onScroll"],wheelEvents=["onWheel"],animationEvents=["onAnimationStart","onAnimationEnd","onAnimationIteration"],transitionEvents=["onTransitionEnd"],otherEvents=["onToggle"],changeEvents=["onChange"],allEvents=__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([],clipboardEvents,!0),compositionEvents,!0),focusEvents,!0),formEvents,!0),imageEvents,!0),keyboardEvents,!0),mediaEvents,!0),mouseEvents,!0),dragEvents,!0),selectionEvents,!0),touchEvents,!0),pointerEvents,!0),uiEvents,!0),wheelEvents,!0),animationEvents,!0),transitionEvents,!0),changeEvents,!0),otherEvents,!0);function makeEventProps(_,n){var b={};return allEvents.forEach(function(t){var a=_[t];a&&(n?b[t]=function(k){return a(k,n(t))}:b[t]=a)}),b}function makeCancellablePromise(_){var n=!1,b=new Promise(function(t,a){_.then(function(k){return!n&&t(k)}).catch(function(k){return!n&&a(k)})});return{promise:b,cancel:function(){n=!0}}}function r(_){var n,b,t="";if(typeof _=="string"||typeof _=="number")t+=_;else if(typeof _=="object")if(Array.isArray(_))for(n=0;n<_.length;n++)_[n]&&(b=r(_[n]))&&(t&&(t+=" "),t+=b);else for(n in _)_[n]&&(t&&(t+=" "),t+=n);return t}function clsx(){for(var _,n,b=0,t="";b<arguments.length;)(_=arguments[b++])&&(n=r(_))&&(t&&(t+=" "),t+=n);return t}var isProduction$1=!0,prefix="Invariant failed";function invariant(_,n){if(!_){if(isProduction$1)throw new Error(prefix);var b=typeof n=="function"?n():n,t=b?"".concat(prefix,": ").concat(b):prefix;throw new Error(t)}}var isProduction=!0;function warning(_,n){if(!isProduction){if(_)return;var b="Warning: "+n;typeof console<"u"&&console.warn(b);try{throw Error(b)}catch{}}}const DocumentContext=reactExports.createContext(null);function Message(_){var n=_.children,b=_.type;return React.createElement("div",{className:"react-pdf__message react-pdf__message--".concat(b)},n)}Message.propTypes={children:propTypesExports.node,type:propTypesExports.oneOf(["error","loading","no-data"]).isRequired};var DEFAULT_LINK_REL="noopener noreferrer nofollow",LinkService=function(){function _(){_classCallCheck(this,_),this.externalLinkTarget=null,this.externalLinkRel=null}return _createClass(_,[{key:"setDocument",value:function(b){this.pdfDocument=b}},{key:"setViewer",value:function(b){this.pdfViewer=b}},{key:"setExternalLinkRel",value:function(b){this.externalLinkRel=b}},{key:"setExternalLinkTarget",value:function(b){this.externalLinkTarget=b}},{key:"setHistory",value:function(){}},{key:"pagesCount",get:function(){return this.pdfDocument?this.pdfDocument.numPages:0}},{key:"page",get:function(){return this.pdfViewer.currentPageNumber},set:function(b){this.pdfViewer.currentPageNumber=b}},{key:"rotation",get:function(){return 0},set:function(b){}},{key:"goToDestination",value:function(b){var t=this;new Promise(function(a){typeof b=="string"?t.pdfDocument.getDestination(b).then(a):Array.isArray(b)?a(b):b.then(a)}).then(function(a){invariant(Array.isArray(a),'"'.concat(a,'" is not a valid destination array.'));var k=a[0];new Promise(function(F){k instanceof Object?t.pdfDocument.getPageIndex(k).then(function(T){F(T)}).catch(function(){invariant(!1,'"'.concat(k,'" is not a valid page reference.'))}):typeof k=="number"?F(k):invariant(!1,'"'.concat(k,'" is not a valid destination reference.'))}).then(function(F){var T=F+1;invariant(T>=1&&T<=t.pagesCount,'"'.concat(T,'" is not a valid page number.')),t.pdfViewer.scrollPageIntoView({dest:b,pageIndex:F,pageNumber:T})})})}},{key:"navigateTo",value:function(b){this.goToDestination(b)}},{key:"goToPage",value:function(){}},{key:"addLinkAttributes",value:function(b,t,a){b.href=t,b.rel=this.externalLinkRel||DEFAULT_LINK_REL,b.target=a?"_blank":this.externalLinkTarget||""}},{key:"getDestinationHash",value:function(){return"#"}},{key:"getAnchorUrl",value:function(){return"#"}},{key:"setHash",value:function(){}},{key:"executeNamedAction",value:function(){}},{key:"cachePageRef",value:function(){}},{key:"isPageVisible",value:function(){return!0}},{key:"isPageCached",value:function(){return!0}}]),_}(),PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};function _arrayWithHoles(_){if(Array.isArray(_))return _}function _iterableToArrayLimit(_,n){var b=_==null?null:typeof Symbol<"u"&&_[Symbol.iterator]||_["@@iterator"];if(b!=null){var t,a,k,F,T=[],v=!0,f=!1;try{if(k=(b=b.call(_)).next,n===0){if(Object(b)!==b)return;v=!1}else for(;!(v=(t=k.call(b)).done)&&(T.push(t.value),T.length!==n);v=!0);}catch(R){f=!0,a=R}finally{try{if(!v&&b.return!=null&&(F=b.return(),Object(F)!==F))return}finally{if(f)throw a}}return T}}function _arrayLikeToArray(_,n){(n==null||n>_.length)&&(n=_.length);for(var b=0,t=new Array(n);b<n;b++)t[b]=_[b];return t}function _unsupportedIterableToArray(_,n){if(_){if(typeof _=="string")return _arrayLikeToArray(_,n);var b=Object.prototype.toString.call(_).slice(8,-1);if(b==="Object"&&_.constructor&&(b=_.constructor.name),b==="Map"||b==="Set")return Array.from(_);if(b==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return _arrayLikeToArray(_,n)}}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _slicedToArray(_,n){return _arrayWithHoles(_)||_iterableToArrayLimit(_,n)||_unsupportedIterableToArray(_,n)||_nonIterableRest()}var isBrowser=typeof document<"u",isLocalFileSystem=isBrowser&&window.location.protocol==="file:";function isDefined(_){return typeof _<"u"}function isProvided(_){return isDefined(_)&&_!==null}function isString(_){return typeof _=="string"}function isArrayBuffer(_){return _ instanceof ArrayBuffer}function isBlob(_){return invariant(isBrowser,"isBlob can only be used in a browser environment"),_ instanceof Blob}function isFile$1(_){return invariant(isBrowser,"isFile can only be used in a browser environment"),_ instanceof File}function isDataURI(_){return isString(_)&&/^data:/.test(_)}function dataURItoByteString(_){invariant(isDataURI(_),"Invalid data URI.");var n=_.split(","),b=_slicedToArray(n,2),t=b[0],a=b[1],k=t.split(";");return k.indexOf("base64")!==-1?atob(a):unescape(a)}function getDevicePixelRatio(){return isBrowser&&window.devicePixelRatio||1}var allowFileAccessFromFilesTip="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function displayCORSWarning(){warning(!isLocalFileSystem,"Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ".concat(allowFileAccessFromFilesTip))}function displayWorkerWarning(){warning(!isLocalFileSystem,"Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ".concat(allowFileAccessFromFilesTip))}function cancelRunningTask(_){_&&_.cancel&&_.cancel()}function makePageCallback(_,n){return Object.defineProperty(_,"width",{get:function(){return this.view[2]*n},configurable:!0}),Object.defineProperty(_,"height",{get:function(){return this.view[3]*n},configurable:!0}),Object.defineProperty(_,"originalWidth",{get:function(){return this.view[2]},configurable:!0}),Object.defineProperty(_,"originalHeight",{get:function(){return this.view[3]},configurable:!0}),_}function isCancelException(_){return _.name==="RenderingCancelledException"}function loadFromFile(_){return new Promise(function(n,b){var t=new FileReader;return t.onload=function(){return n(new Uint8Array(t.result))},t.onerror=function(a){switch(a.target.error.code){case a.target.error.NOT_FOUND_ERR:return b(new Error("Error while reading a file: File not found."));case a.target.error.NOT_READABLE_ERR:return b(new Error("Error while reading a file: File not readable."));case a.target.error.SECURITY_ERR:return b(new Error("Error while reading a file: Security error."));case a.target.error.ABORT_ERR:return b(new Error("Error while reading a file: Aborted."));default:return b(new Error("Error while reading a file."))}},t.readAsArrayBuffer(_),null})}function _arrayWithoutHoles(_){if(Array.isArray(_))return _arrayLikeToArray(_)}function _iterableToArray(_){if(typeof Symbol<"u"&&_[Symbol.iterator]!=null||_["@@iterator"]!=null)return Array.from(_)}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _toConsumableArray(_){return _arrayWithoutHoles(_)||_iterableToArray(_)||_unsupportedIterableToArray(_)||_nonIterableSpread()}var eventProps=function(){var _={};return[].concat(_toConsumableArray(mouseEvents),_toConsumableArray(touchEvents),_toConsumableArray(keyboardEvents)).forEach(function(n){_[n]=propTypesExports.func}),_}(),fileTypes=[propTypesExports.string,propTypesExports.instanceOf(ArrayBuffer),propTypesExports.shape({data:propTypesExports.oneOfType([propTypesExports.object,propTypesExports.string]),httpHeaders:propTypesExports.object,range:propTypesExports.object,url:propTypesExports.string,withCredentials:propTypesExports.bool})];typeof File<"u"&&fileTypes.push(propTypesExports.instanceOf(File));typeof Blob<"u"&&fileTypes.push(propTypesExports.instanceOf(Blob));var isClassName=propTypesExports.oneOfType([propTypesExports.string,propTypesExports.arrayOf(propTypesExports.string)]),isFile=propTypesExports.oneOfType(fileTypes),isLinkService=propTypesExports.instanceOf(LinkService);propTypesExports.oneOf(["_self","_blank","_parent","_top"]);var isPage=propTypesExports.shape({commonObjs:propTypesExports.shape({}).isRequired,getAnnotations:propTypesExports.func.isRequired,getTextContent:propTypesExports.func.isRequired,getViewport:propTypesExports.func.isRequired,render:propTypesExports.func.isRequired}),isPageIndex=function _(n,b,t){var a=n[b],k=n.pageNumber,F=n.pdf;if(!isDefined(F))return null;if(isDefined(a)){if(typeof a!="number")return new Error("`".concat(b,"` of type `").concat(_typeof(a),"` supplied to `").concat(t,"`, expected `number`."));if(a<0)return new Error("Expected `".concat(b,"` to be greater or equal to 0."));var T=F.numPages;if(a+1>T)return new Error("Expected `".concat(b,"` to be less or equal to ").concat(T-1,"."))}else if(!isDefined(k))return new Error("`".concat(b,"` not supplied. Either pageIndex or pageNumber must be supplied to `").concat(t,"`."));return null},isPageNumber=function _(n,b,t){var a=n[b],k=n.pageIndex,F=n.pdf;if(!isDefined(F))return null;if(isDefined(a)){if(typeof a!="number")return new Error("`".concat(b,"` of type `").concat(_typeof(a),"` supplied to `").concat(t,"`, expected `number`."));if(a<1)return new Error("Expected `".concat(b,"` to be greater or equal to 1."));var T=F.numPages;if(a>T)return new Error("Expected `".concat(b,"` to be less or equal to ").concat(T,"."))}else if(!isDefined(k))return new Error("`".concat(b,"` not supplied. Either pageIndex or pageNumber must be supplied to `").concat(t,"`."));return null},isPdf=propTypesExports.oneOfType([propTypesExports.shape({getDestination:propTypesExports.func.isRequired,getOutline:propTypesExports.func.isRequired,getPage:propTypesExports.func.isRequired,numPages:propTypesExports.number.isRequired}),propTypesExports.bool]),isRef=propTypesExports.oneOfType([propTypesExports.func,propTypesExports.shape({current:propTypesExports.any})]),isRenderMode=propTypesExports.oneOf(["canvas","none","svg"]),isRotate=propTypesExports.oneOf([0,90,180,270]),_excluded=["url"];function ownKeys$3(_,n){var b=Object.keys(_);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(_);n&&(t=t.filter(function(a){return Object.getOwnPropertyDescriptor(_,a).enumerable})),b.push.apply(b,t)}return b}function _objectSpread$3(_){for(var n=1;n<arguments.length;n++){var b=arguments[n]!=null?arguments[n]:{};n%2?ownKeys$3(Object(b),!0).forEach(function(t){_defineProperty(_,t,b[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_,Object.getOwnPropertyDescriptors(b)):ownKeys$3(Object(b)).forEach(function(t){Object.defineProperty(_,t,Object.getOwnPropertyDescriptor(b,t))})}return _}function _createSuper$5(_){var n=_isNativeReflectConstruct$5();return function(){var t=_getPrototypeOf(_),a;if(n){var k=_getPrototypeOf(this).constructor;a=Reflect.construct(t,arguments,k)}else a=t.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _isNativeReflectConstruct$5(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var PDFDataRangeTransport=pdfExports.PDFDataRangeTransport,Document=function(_){_inherits(b,_);var n=_createSuper$5(b);function b(){var t;_classCallCheck(this,b);for(var a=arguments.length,k=new Array(a),F=0;F<a;F++)k[F]=arguments[F];return t=n.call.apply(n,[this].concat(k)),_defineProperty(_assertThisInitialized(t),"state",{pdf:null}),_defineProperty(_assertThisInitialized(t),"viewer",{scrollPageIntoView:function(v){var f=v.dest,R=v.pageIndex,N=v.pageNumber,w=t.props.onItemClick;if(w){w({dest:f,pageIndex:R,pageNumber:N});return}var P=t.pages[R];if(P){P.scrollIntoView();return}warning(!1,"An internal link leading to page ".concat(N," was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>."))}}),_defineProperty(_assertThisInitialized(t),"linkService",new LinkService),_defineProperty(_assertThisInitialized(t),"loadDocument",function(){cancelRunningTask(t.runningTask),t.loadingTask&&t.loadingTask.destroy();var T=makeCancellablePromise(t.findDocumentSource());t.runningTask=T,T.promise.then(function(v){if(t.onSourceSuccess(),!!v){t.setState(function(u){return u.pdf?{pdf:null}:null});var f=t.props,R=f.options,N=f.onLoadProgress,w=f.onPassword,P=pdfExports.getDocument(_objectSpread$3(_objectSpread$3({},v),R));P.onPassword=w,N&&(P.onProgress=N),t.loadingTask=P,P.promise.then(function(u){t.setState(function(e){return e.pdf&&e.pdf.fingerprint===u.fingerprint?null:{pdf:u}},t.onLoadSuccess)}).catch(function(u){t.onLoadError(u)})}}).catch(function(v){t.onSourceError(v)})}),_defineProperty(_assertThisInitialized(t),"setupLinkService",function(){var T=t.props,v=T.externalLinkRel,f=T.externalLinkTarget;t.linkService.setViewer(t.viewer),t.linkService.setExternalLinkRel(v),t.linkService.setExternalLinkTarget(f)}),_defineProperty(_assertThisInitialized(t),"onSourceSuccess",function(){var T=t.props.onSourceSuccess;T&&T()}),_defineProperty(_assertThisInitialized(t),"onSourceError",function(T){warning(T);var v=t.props.onSourceError;v&&v(T)}),_defineProperty(_assertThisInitialized(t),"onLoadSuccess",function(){var T=t.props.onLoadSuccess,v=t.state.pdf;T&&T(v),t.pages=new Array(v.numPages),t.linkService.setDocument(v)}),_defineProperty(_assertThisInitialized(t),"onLoadError",function(T){t.setState({pdf:!1}),warning(T);var v=t.props.onLoadError;v&&v(T)}),_defineProperty(_assertThisInitialized(t),"findDocumentSource",function(){return new Promise(function(T){var v=t.props.file;if(v||T(null),typeof v=="string"){if(isDataURI(v)){var f=dataURItoByteString(v);T({data:f})}displayCORSWarning(),T({url:v})}if(v instanceof PDFDataRangeTransport&&T({range:v}),isArrayBuffer(v)&&T({data:v}),isBrowser&&(isBlob(v)||isFile$1(v))){loadFromFile(v).then(function(P){T({data:P})});return}if(invariant(_typeof(v)==="object","Invalid parameter in file, need either Uint8Array, string or a parameter object"),invariant(v.url||v.data||v.range,"Invalid parameter object: need either .data, .range or .url"),typeof v.url=="string"){if(isDataURI(v.url)){var R=v.url,N=_objectWithoutProperties(v,_excluded),w=dataURItoByteString(R);T(_objectSpread$3({data:w},N))}displayCORSWarning()}T(v)})}),_defineProperty(_assertThisInitialized(t),"registerPage",function(T,v){t.pages[T]=v}),_defineProperty(_assertThisInitialized(t),"unregisterPage",function(T){delete t.pages[T]}),t}return _createClass(b,[{key:"componentDidMount",value:function(){this.loadDocument(),this.setupLinkService()}},{key:"componentDidUpdate",value:function(a){var k=this.props.file;k!==a.file&&this.loadDocument()}},{key:"componentWillUnmount",value:function(){cancelRunningTask(this.runningTask),this.loadingTask&&this.loadingTask.destroy()}},{key:"childContext",get:function(){var a=this.linkService,k=this.registerPage,F=this.unregisterPage,T=this.props,v=T.imageResourcesPath,f=T.renderMode,R=T.rotate,N=this.state.pdf;return{imageResourcesPath:v,linkService:a,pdf:N,registerPage:k,renderMode:f,rotate:R,unregisterPage:F}}},{key:"eventProps",get:function(){var a=this;return makeEventProps(this.props,function(){return a.state.pdf})}},{key:"renderChildren",value:function(){var a=this.props.children;return React.createElement(DocumentContext.Provider,{value:this.childContext},a)}},{key:"renderContent",value:function(){var a=this.props.file,k=this.state.pdf;if(!a){var F=this.props.noData;return React.createElement(Message,{type:"no-data"},typeof F=="function"?F():F)}if(k===null){var T=this.props.loading;return React.createElement(Message,{type:"loading"},typeof T=="function"?T():T)}if(k===!1){var v=this.props.error;return React.createElement(Message,{type:"error"},typeof v=="function"?v():v)}return this.renderChildren()}},{key:"render",value:function(){var a=this.props,k=a.className,F=a.inputRef;return React.createElement("div",_extends({className:clsx("react-pdf__Document",k),ref:F},this.eventProps),this.renderContent())}}]),b}(reactExports.PureComponent);Document.defaultProps={error:"Failed to load PDF file.",loading:"Loading PDF…",noData:"No PDF file specified.",onPassword:function _(n,b){switch(b){case PasswordResponses.NEED_PASSWORD:{var t=prompt("Enter the password to open this PDF file.");n(t);break}case PasswordResponses.INCORRECT_PASSWORD:{var a=prompt("Invalid password. Please try again.");n(a);break}}}};var isFunctionOrNode$1=propTypesExports.oneOfType([propTypesExports.func,propTypesExports.node]);Document.propTypes=_objectSpread$3(_objectSpread$3({},eventProps),{},{children:propTypesExports.node,className:isClassName,error:isFunctionOrNode$1,externalLinkRel:propTypesExports.string,externalLinkTarget:propTypesExports.string,file:isFile,imageResourcesPath:propTypesExports.string,inputRef:isRef,loading:isFunctionOrNode$1,noData:isFunctionOrNode$1,onItemClick:propTypesExports.func,onLoadError:propTypesExports.func,onLoadProgress:propTypesExports.func,onLoadSuccess:propTypesExports.func,onPassword:propTypesExports.func,onSourceError:propTypesExports.func,onSourceSuccess:propTypesExports.func,rotate:propTypesExports.number});var isDestination=propTypesExports.oneOfType([propTypesExports.string,propTypesExports.arrayOf(propTypesExports.any)]);propTypesExports.shape({dest:isDestination,items:propTypesExports.arrayOf(propTypesExports.shape({dest:isDestination,title:propTypesExports.string})),title:propTypesExports.string}).isRequired,propTypesExports.func,isPdf.isRequired;function ownKeys$2(_,n){var b=Object.keys(_);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(_);n&&(t=t.filter(function(a){return Object.getOwnPropertyDescriptor(_,a).enumerable})),b.push.apply(b,t)}return b}function _objectSpread$2(_){for(var n=1;n<arguments.length;n++){var b=arguments[n]!=null?arguments[n]:{};n%2?ownKeys$2(Object(b),!0).forEach(function(t){_defineProperty(_,t,b[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_,Object.getOwnPropertyDescriptors(b)):ownKeys$2(Object(b)).forEach(function(t){Object.defineProperty(_,t,Object.getOwnPropertyDescriptor(b,t))})}return _}_objectSpread$2({className:isClassName,inputRef:isRef,onItemClick:propTypesExports.func,onLoadError:propTypesExports.func,onLoadSuccess:propTypesExports.func,pdf:isPdf},eventProps);function mergeRefs(){for(var _=[],n=0;n<arguments.length;n++)_[n]=arguments[n];var b=_.filter(Boolean);if(b.length<=1){var t=b[0];return t||null}return function(k){b.forEach(function(F){typeof F=="function"?F(k):F&&(F.current=k)})}}const PageContext=reactExports.createContext(null);function _createSuper$4(_){var n=_isNativeReflectConstruct$4();return function(){var t=_getPrototypeOf(_),a;if(n){var k=_getPrototypeOf(this).constructor;a=Reflect.construct(t,arguments,k)}else a=t.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _isNativeReflectConstruct$4(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ANNOTATION_MODE=pdfExports.AnnotationMode,PageCanvasInternal=function(_){_inherits(b,_);var n=_createSuper$4(b);function b(){var t;_classCallCheck(this,b);for(var a=arguments.length,k=new Array(a),F=0;F<a;F++)k[F]=arguments[F];return t=n.call.apply(n,[this].concat(k)),_defineProperty(_assertThisInitialized(t),"canvasElement",reactExports.createRef()),_defineProperty(_assertThisInitialized(t),"onRenderSuccess",function(){t.renderer=null;var T=t.props,v=T.onRenderSuccess,f=T.page,R=T.scale;v&&v(makePageCallback(f,R))}),_defineProperty(_assertThisInitialized(t),"onRenderError",function(T){if(!isCancelException(T)){warning(T);var v=t.props.onRenderError;v&&v(T)}}),_defineProperty(_assertThisInitialized(t),"drawPageOnCanvas",function(){var T=t.canvasElement.current;if(!T)return null;var v=_assertThisInitialized(t),f=v.renderViewport,R=v.viewport,N=t.props,w=N.canvasBackground,P=N.page,u=N.renderForms;T.width=f.width,T.height=f.height,T.style.width="".concat(Math.floor(R.width),"px"),T.style.height="".concat(Math.floor(R.height),"px");var e={annotationMode:u?ANNOTATION_MODE.ENABLE_FORMS:ANNOTATION_MODE.ENABLE,get canvasContext(){return T.getContext("2d",{alpha:!1})},viewport:f};w&&(e.background=w),t.cancelRenderingTask();var i=P.render(e);return t.renderer=i,i.promise.then(t.onRenderSuccess).catch(t.onRenderError)}),t}return _createClass(b,[{key:"componentDidMount",value:function(){this.drawPageOnCanvas()}},{key:"componentDidUpdate",value:function(a){var k=this.props,F=k.canvasBackground,T=k.devicePixelRatio,v=k.page,f=k.renderForms;(F!==a.canvasBackground||T!==a.devicePixelRatio||f!==a.renderForms)&&(v.cleanup(),this.drawPageOnCanvas())}},{key:"componentWillUnmount",value:function(){this.cancelRenderingTask();var a=this.canvasElement.current;a&&(a.width=0,a.height=0)}},{key:"cancelRenderingTask",value:function(){this.renderer&&(this.renderer.cancel(),this.renderer=null)}},{key:"devicePixelRatio",get:function(){var a=this.props.devicePixelRatio;return a||getDevicePixelRatio()}},{key:"renderViewport",get:function(){var a=this.devicePixelRatio,k=this.props,F=k.page,T=k.rotate,v=k.scale;return F.getViewport({scale:v*a,rotation:T})}},{key:"viewport",get:function(){var a=this.props,k=a.page,F=a.rotate,T=a.scale;return k.getViewport({scale:T,rotation:F})}},{key:"render",value:function(){var a=this.props.canvasRef;return React.createElement("canvas",{className:"react-pdf__Page__canvas",dir:"ltr",ref:mergeRefs(a,this.canvasElement),style:{display:"block",userSelect:"none"}})}}]),b}(reactExports.PureComponent);PageCanvasInternal.propTypes={canvasBackground:propTypesExports.string,canvasRef:isRef,devicePixelRatio:propTypesExports.number,onRenderError:propTypesExports.func,onRenderSuccess:propTypesExports.func,page:isPage.isRequired,renderForms:propTypesExports.bool,rotate:isRotate,scale:propTypesExports.number.isRequired};function PageCanvas(_){return React.createElement(PageContext.Consumer,null,function(n){return React.createElement(PageCanvasInternal,_extends({},n,_))})}function _createSuper$3(_){var n=_isNativeReflectConstruct$3();return function(){var t=_getPrototypeOf(_),a;if(n){var k=_getPrototypeOf(this).constructor;a=Reflect.construct(t,arguments,k)}else a=t.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _isNativeReflectConstruct$3(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var PageSVGInternal=function(_){_inherits(b,_);var n=_createSuper$3(b);function b(){var t;_classCallCheck(this,b);for(var a=arguments.length,k=new Array(a),F=0;F<a;F++)k[F]=arguments[F];return t=n.call.apply(n,[this].concat(k)),_defineProperty(_assertThisInitialized(t),"state",{svg:null}),_defineProperty(_assertThisInitialized(t),"onRenderSuccess",function(){t.renderer=null;var T=t.props,v=T.onRenderSuccess,f=T.page,R=T.scale;v&&v(makePageCallback(f,R))}),_defineProperty(_assertThisInitialized(t),"onRenderError",function(T){if(!isCancelException(T)){warning(T);var v=t.props.onRenderError;v&&v(T)}}),_defineProperty(_assertThisInitialized(t),"renderSVG",function(){var T=t.props.page;return t.renderer=T.getOperatorList(),t.renderer.then(function(v){var f=new pdfExports.SVGGraphics(T.commonObjs,T.objs);t.renderer=f.getSVG(v,t.viewport).then(function(R){t.setState({svg:R},t.onRenderSuccess)}).catch(t.onRenderError)}).catch(t.onRenderError)}),_defineProperty(_assertThisInitialized(t),"drawPageOnContainer",function(T){var v=t.state.svg;if(!(!T||!v)){T.firstElementChild||T.appendChild(v);var f=t.viewport,R=f.width,N=f.height;v.setAttribute("width",R),v.setAttribute("height",N)}}),t}return _createClass(b,[{key:"componentDidMount",value:function(){this.renderSVG()}},{key:"viewport",get:function(){var a=this.props,k=a.page,F=a.rotate,T=a.scale;return k.getViewport({scale:T,rotation:F})}},{key:"render",value:function(){var a=this,k=this.viewport,F=k.width,T=k.height;return React.createElement("div",{className:"react-pdf__Page__svg",ref:function(f){return a.drawPageOnContainer(f)},style:{display:"block",backgroundColor:"white",overflow:"hidden",width:F,height:T,userSelect:"none"}})}}]),b}(reactExports.PureComponent);PageSVGInternal.propTypes={onRenderError:propTypesExports.func,onRenderSuccess:propTypesExports.func,page:isPage.isRequired,rotate:isRotate,scale:propTypesExports.number.isRequired};function PageSVG(_){return React.createElement(PageContext.Consumer,null,function(n){return React.createElement(PageSVGInternal,_extends({},n,_))})}function ownKeys$1(_,n){var b=Object.keys(_);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(_);n&&(t=t.filter(function(a){return Object.getOwnPropertyDescriptor(_,a).enumerable})),b.push.apply(b,t)}return b}function _objectSpread$1(_){for(var n=1;n<arguments.length;n++){var b=arguments[n]!=null?arguments[n]:{};n%2?ownKeys$1(Object(b),!0).forEach(function(t){_defineProperty(_,t,b[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_,Object.getOwnPropertyDescriptors(b)):ownKeys$1(Object(b)).forEach(function(t){Object.defineProperty(_,t,Object.getOwnPropertyDescriptor(b,t))})}return _}function _createSuper$2(_){var n=_isNativeReflectConstruct$2();return function(){var t=_getPrototypeOf(_),a;if(n){var k=_getPrototypeOf(this).constructor;a=Reflect.construct(t,arguments,k)}else a=t.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _isNativeReflectConstruct$2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var TextLayerInternal=function(_){_inherits(b,_);var n=_createSuper$2(b);function b(){var t;_classCallCheck(this,b);for(var a=arguments.length,k=new Array(a),F=0;F<a;F++)k[F]=arguments[F];return t=n.call.apply(n,[this].concat(k)),_defineProperty(_assertThisInitialized(t),"state",{textContent:null}),_defineProperty(_assertThisInitialized(t),"layerElement",reactExports.createRef()),_defineProperty(_assertThisInitialized(t),"endElement",reactExports.createRef()),_defineProperty(_assertThisInitialized(t),"loadTextContent",function(){var T=t.props.page,v=makeCancellablePromise(T.getTextContent());t.runningTask=v,v.promise.then(function(f){t.setState({textContent:f},t.onLoadSuccess)}).catch(function(f){t.onLoadError(f)})}),_defineProperty(_assertThisInitialized(t),"onLoadSuccess",function(){var T=t.props.onGetTextSuccess,v=t.state.textContent;T&&T(v)}),_defineProperty(_assertThisInitialized(t),"onLoadError",function(T){t.setState({textItems:!1}),warning(T);var v=t.props.onGetTextError;v&&v(T)}),_defineProperty(_assertThisInitialized(t),"onRenderSuccess",function(){var T=t.props.onRenderTextLayerSuccess;T&&T()}),_defineProperty(_assertThisInitialized(t),"onRenderError",function(T){warning(T);var v=t.props.onRenderTextLayerError;v&&v(T)}),_defineProperty(_assertThisInitialized(t),"onMouseDown",function(){var T=t.endElement.current;T&&T.classList.add("active")}),_defineProperty(_assertThisInitialized(t),"onMouseUp",function(){var T=t.endElement.current;T&&T.classList.remove("active")}),t}return _createClass(b,[{key:"componentDidMount",value:function(){var a=this.props.page;invariant(a,"Attempted to load page text content, but no page was specified."),warning(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer"),this.loadTextContent()}},{key:"componentDidUpdate",value:function(a){var k=this.props.page;a.page&&k!==a.page&&this.loadTextContent()}},{key:"componentWillUnmount",value:function(){cancelRunningTask(this.runningTask)}},{key:"viewport",get:function(){var a=this.props,k=a.page,F=a.rotate,T=a.scale;return k.getViewport({scale:T,rotation:F})}},{key:"unrotatedViewport",get:function(){var a=this.props,k=a.page,F=a.scale;return k.getViewport({scale:F})}},{key:"rotate",get:function(){var a=this.props,k=a.page,F=a.rotate;return F-k.rotate}},{key:"renderTextLayer",value:function(){var a=this,k=this.state.textContent;if(!k)return null;var F=this.layerElement.current,T=this.viewport,v=this.props,f=v.customTextRenderer,R=v.pageIndex,N=v.pageNumber;cancelRunningTask(this.runningTask),F.innerHTML="";var w={container:F,textContent:k,viewport:T},P=pdfExports.renderTextLayer(w);this.runningTask=P,P.promise.then(function(){var u=document.createElement("div");if(u.className="endOfContent",F.append(u),a.endElement.current=u,f){var e=0;k.items.forEach(function(i,c){var S=a.layerElement.current.children[e],E=f(_objectSpread$1({pageIndex:R,pageNumber:N,itemIndex:c},i));S.innerHTML=E,e+=i.str&&i.hasEOL?2:1})}a.onRenderSuccess()}).catch(function(u){a.onRenderError(u)})}},{key:"render",value:function(){return React.createElement("div",{className:"react-pdf__Page__textContent textLayer",onMouseUp:this.onMouseUp,onMouseDown:this.onMouseDown,ref:this.layerElement},this.renderTextLayer())}}]),b}(reactExports.PureComponent);TextLayerInternal.propTypes={customTextRenderer:propTypesExports.func,onGetTextError:propTypesExports.func,onGetTextSuccess:propTypesExports.func,onRenderTextLayerError:propTypesExports.func,onRenderTextLayerSuccess:propTypesExports.func,page:isPage.isRequired,pageIndex:propTypesExports.number.isRequired,pageNumber:propTypesExports.number.isRequired,rotate:isRotate,scale:propTypesExports.number};function TextLayer$1(_){return React.createElement(PageContext.Consumer,null,function(n){return React.createElement(TextLayerInternal,_extends({},n,_))})}function _createSuper$1(_){var n=_isNativeReflectConstruct$1();return function(){var t=_getPrototypeOf(_),a;if(n){var k=_getPrototypeOf(this).constructor;a=Reflect.construct(t,arguments,k)}else a=t.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _isNativeReflectConstruct$1(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var AnnotationLayerInternal=function(_){_inherits(b,_);var n=_createSuper$1(b);function b(){var t;_classCallCheck(this,b);for(var a=arguments.length,k=new Array(a),F=0;F<a;F++)k[F]=arguments[F];return t=n.call.apply(n,[this].concat(k)),_defineProperty(_assertThisInitialized(t),"state",{annotations:null}),_defineProperty(_assertThisInitialized(t),"layerElement",reactExports.createRef()),_defineProperty(_assertThisInitialized(t),"loadAnnotations",function(){var T=t.props.page,v=makeCancellablePromise(T.getAnnotations());t.runningTask=v,v.promise.then(function(f){t.setState({annotations:f},t.onLoadSuccess)}).catch(function(f){t.onLoadError(f)})}),_defineProperty(_assertThisInitialized(t),"onLoadSuccess",function(){var T=t.props.onGetAnnotationsSuccess,v=t.state.annotations;T&&T(v)}),_defineProperty(_assertThisInitialized(t),"onLoadError",function(T){t.setState({annotations:!1}),warning(T);var v=t.props.onGetAnnotationsError;v&&v(T)}),_defineProperty(_assertThisInitialized(t),"onRenderSuccess",function(){var T=t.props.onRenderAnnotationLayerSuccess;T&&T()}),_defineProperty(_assertThisInitialized(t),"onRenderError",function(T){warning(T);var v=t.props.onRenderAnnotationLayerError;v&&v(T)}),t}return _createClass(b,[{key:"componentDidMount",value:function(){var a=this.props.page;invariant(a,"Attempted to load page annotations, but no page was specified."),warning(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations"),this.loadAnnotations()}},{key:"componentDidUpdate",value:function(a){var k=this.props,F=k.page,T=k.renderForms;(a.page&&F!==a.page||T!==a.renderForms)&&this.loadAnnotations()}},{key:"componentWillUnmount",value:function(){cancelRunningTask(this.runningTask)}},{key:"viewport",get:function(){var a=this.props,k=a.page,F=a.rotate,T=a.scale;return k.getViewport({scale:T,rotation:F})}},{key:"renderAnnotationLayer",value:function(){var a=this.state.annotations;if(a){var k=this.props,F=k.imageResourcesPath,T=k.linkService,v=k.page,f=k.renderForms,R=this.viewport.clone({dontFlip:!0}),N={annotations:a,div:this.layerElement.current,imageResourcesPath:F,linkService:T,page:v,renderForms:f,viewport:R};this.layerElement.current.innerHTML="";try{pdfExports.AnnotationLayer.render(N),this.onRenderSuccess()}catch(w){this.onRenderError(w)}}}},{key:"render",value:function(){return React.createElement("div",{className:"react-pdf__Page__annotations annotationLayer",ref:this.layerElement},this.renderAnnotationLayer())}}]),b}(reactExports.PureComponent);AnnotationLayerInternal.propTypes={imageResourcesPath:propTypesExports.string,linkService:isLinkService.isRequired,onGetAnnotationsError:propTypesExports.func,onGetAnnotationsSuccess:propTypesExports.func,onRenderAnnotationLayerError:propTypesExports.func,onRenderAnnotationLayerSuccess:propTypesExports.func,page:isPage,renderForms:propTypesExports.bool,rotate:isRotate,scale:propTypesExports.number};var AnnotationLayer$1=function _(n){return React.createElement(DocumentContext.Consumer,null,function(b){return React.createElement(PageContext.Consumer,null,function(t){return React.createElement(AnnotationLayerInternal,_extends({},b,t,n))})})};function ownKeys(_,n){var b=Object.keys(_);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(_);n&&(t=t.filter(function(a){return Object.getOwnPropertyDescriptor(_,a).enumerable})),b.push.apply(b,t)}return b}function _objectSpread(_){for(var n=1;n<arguments.length;n++){var b=arguments[n]!=null?arguments[n]:{};n%2?ownKeys(Object(b),!0).forEach(function(t){_defineProperty(_,t,b[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function(t){Object.defineProperty(_,t,Object.getOwnPropertyDescriptor(b,t))})}return _}function _createSuper(_){var n=_isNativeReflectConstruct();return function(){var t=_getPrototypeOf(_),a;if(n){var k=_getPrototypeOf(this).constructor;a=Reflect.construct(t,arguments,k)}else a=t.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _isNativeReflectConstruct(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var defaultScale=1,PageInternal=function(_){_inherits(b,_);var n=_createSuper(b);function b(){var t;_classCallCheck(this,b);for(var a=arguments.length,k=new Array(a),F=0;F<a;F++)k[F]=arguments[F];return t=n.call.apply(n,[this].concat(k)),_defineProperty(_assertThisInitialized(t),"state",{page:null}),_defineProperty(_assertThisInitialized(t),"pageElement",reactExports.createRef()),_defineProperty(_assertThisInitialized(t),"onLoadSuccess",function(){var T=t.props,v=T.onLoadSuccess,f=T.registerPage,R=t.state.page;v&&v(makePageCallback(R,t.scale)),f&&f(t.pageIndex,t.pageElement.current)}),_defineProperty(_assertThisInitialized(t),"onLoadError",function(T){t.setState({page:!1}),warning(T);var v=t.props.onLoadError;v&&v(T)}),_defineProperty(_assertThisInitialized(t),"loadPage",function(){var T=t.props.pdf,v=t.getPageNumber();if(v){t.setState(function(R){return R.page?{page:null}:null});var f=makeCancellablePromise(T.getPage(v));t.runningTask=f,f.promise.then(function(R){t.setState({page:R},t.onLoadSuccess)}).catch(function(R){t.onLoadError(R)})}}),t}return _createClass(b,[{key:"componentDidMount",value:function(){var a=this.props.pdf;invariant(a,"Attempted to load a page, but no document was specified."),this.loadPage()}},{key:"componentDidUpdate",value:function(a){var k=this.props.pdf;if(a.pdf&&k!==a.pdf||this.getPageNumber()!==this.getPageNumber(a)){var F=this.props.unregisterPage;F&&F(this.getPageIndex(a)),this.loadPage()}}},{key:"componentWillUnmount",value:function(){var a=this.props.unregisterPage;a&&a(this.pageIndex),cancelRunningTask(this.runningTask)}},{key:"childContext",get:function(){var a=this.pageIndex,k=this.pageNumber,F=this.state.page;if(!F)return{};var T=this.props,v=T.canvasBackground,f=T.customTextRenderer,R=T.devicePixelRatio,N=T.onGetAnnotationsError,w=T.onGetAnnotationsSuccess,P=T.onGetTextError,u=T.onGetTextSuccess,e=T.onRenderAnnotationLayerError,i=T.onRenderAnnotationLayerSuccess,c=T.onRenderError,S=T.onRenderSuccess,E=T.onRenderTextLayerError,h=T.onRenderTextLayerSuccess,s=T.renderForms,o=T.renderInteractiveForms;return{canvasBackground:v,customTextRenderer:f,devicePixelRatio:R,onGetAnnotationsError:N,onGetAnnotationsSuccess:w,onGetTextError:P,onGetTextSuccess:u,onRenderAnnotationLayerError:e,onRenderAnnotationLayerSuccess:i,onRenderError:c,onRenderSuccess:S,onRenderTextLayerError:E,onRenderTextLayerSuccess:h,page:F,pageIndex:a,pageNumber:k,renderForms:s??o,rotate:this.rotate,scale:this.scale}}},{key:"getPageIndex",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props;return isProvided(a.pageNumber)?a.pageNumber-1:isProvided(a.pageIndex)?a.pageIndex:null}},{key:"getPageNumber",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props;return isProvided(a.pageNumber)?a.pageNumber:isProvided(a.pageIndex)?a.pageIndex+1:null}},{key:"pageIndex",get:function(){return this.getPageIndex()}},{key:"pageNumber",get:function(){return this.getPageNumber()}},{key:"rotate",get:function(){var a=this.props.rotate;if(isProvided(a))return a;var k=this.state.page;return k?k.rotate:null}},{key:"scale",get:function(){var a=this.state.page;if(!a)return null;var k=this.props,F=k.scale,T=k.width,v=k.height,f=this.rotate,R=1,N=F===null?defaultScale:F;if(T||v){var w=a.getViewport({scale:1,rotation:f});R=T?T/w.width:v/w.height}return N*R}},{key:"eventProps",get:function(){var a=this;return makeEventProps(this.props,function(){var k=a.state.page;return k&&makePageCallback(k,a.scale)})}},{key:"pageKey",get:function(){return"".concat(this.pageIndex,"@").concat(this.scale,"/").concat(this.rotate)}},{key:"pageKeyNoScale",get:function(){return"".concat(this.pageIndex,"/").concat(this.rotate)}},{key:"renderMainLayer",value:function(){var a=this.props,k=a.canvasRef,F=a.renderMode;switch(F){case"none":return null;case"svg":return React.createElement(PageSVG,{key:"".concat(this.pageKeyNoScale,"_svg")});case"canvas":default:return React.createElement(PageCanvas,{key:"".concat(this.pageKey,"_canvas"),canvasRef:k})}}},{key:"renderTextLayer",value:function(){var a=this.props.renderTextLayer;return a?React.createElement(TextLayer$1,{key:"".concat(this.pageKey,"_text")}):null}},{key:"renderAnnotationLayer",value:function(){var a=this.props.renderAnnotationLayer;return a?React.createElement(AnnotationLayer$1,{key:"".concat(this.pageKey,"_annotations")}):null}},{key:"renderChildren",value:function(){var a=this.props.children;return React.createElement(PageContext.Provider,{value:this.childContext},this.renderMainLayer(),this.renderTextLayer(),this.renderAnnotationLayer(),a)}},{key:"renderContent",value:function(){var a=this.pageNumber,k=this.props.pdf,F=this.state.page;if(!a){var T=this.props.noData;return React.createElement(Message,{type:"no-data"},typeof T=="function"?T():T)}if(k===null||F===null){var v=this.props.loading;return React.createElement(Message,{type:"loading"},typeof v=="function"?v():v)}if(k===!1||F===!1){var f=this.props.error;return React.createElement(Message,{type:"error"},typeof f=="function"?f():f)}return this.renderChildren()}},{key:"render",value:function(){var a=this.pageNumber,k=this.props,F=k.className,T=k.inputRef;return React.createElement("div",_extends({className:clsx("react-pdf__Page",F),"data-page-number":a,ref:mergeRefs(T,this.pageElement),style:{position:"relative",minWidth:"min-content",minHeight:"min-content"}},this.eventProps),this.renderContent())}}]),b}(reactExports.PureComponent);PageInternal.defaultProps={error:"Failed to load the page.",loading:"Loading page…",noData:"No page specified.",renderAnnotationLayer:!0,renderMode:"canvas",renderTextLayer:!0,scale:defaultScale};var isFunctionOrNode=propTypesExports.oneOfType([propTypesExports.func,propTypesExports.node]);PageInternal.propTypes=_objectSpread(_objectSpread({},eventProps),{},{canvasBackground:propTypesExports.string,children:propTypesExports.node,className:isClassName,customTextRenderer:propTypesExports.func,devicePixelRatio:propTypesExports.number,error:isFunctionOrNode,height:propTypesExports.number,imageResourcesPath:propTypesExports.string,inputRef:isRef,loading:isFunctionOrNode,noData:isFunctionOrNode,onGetTextError:propTypesExports.func,onGetTextSuccess:propTypesExports.func,onLoadError:propTypesExports.func,onLoadSuccess:propTypesExports.func,onRenderError:propTypesExports.func,onRenderSuccess:propTypesExports.func,onRenderTextLayerError:propTypesExports.func,onRenderTextLayerSuccess:propTypesExports.func,pageIndex:isPageIndex,pageNumber:isPageNumber,pdf:isPdf,registerPage:propTypesExports.func,renderAnnotationLayer:propTypesExports.bool,renderForms:propTypesExports.bool,renderInteractiveForms:propTypesExports.bool,renderMode:isRenderMode,renderTextLayer:propTypesExports.bool,rotate:isRotate,scale:propTypesExports.number,unregisterPage:propTypesExports.func,width:propTypesExports.number});function Page(_,n){return React.createElement(DocumentContext.Consumer,null,function(b){return React.createElement(PageInternal,_extends({ref:n},b,_))})}const Page$1=React.forwardRef(Page);displayWorkerWarning();pdfExports.GlobalWorkerOptions.workerSrc=new URL("/assets/pdf.worker-6b078827.js",self.location);const AnnotationLayer="",TextLayer="";function PdfSupport(_){const[n,b]=reactExports.useState(),t=reactExports.createRef(),[a,k]=reactExports.useState(window.innerWidth);return reactExports.useEffect(()=>{const F=new AbortController;return window.addEventListener("resize",()=>{k(window.innerWidth)},{passive:!0,signal:F.signal}),()=>F.abort()}),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[!n&&jsxRuntimeExports.jsx("progress",{className:"w-full",value:0,max:_.size,ref:t}),jsxRuntimeExports.jsx(Document,{className:"max-w-[100vw] overflow-x-hidden",file:serverUrl(`/files/${_.path}`),externalLinkRel:"_blank",options:{withCredentials:!0,length:_.size},loading:Loading,onLoadProgress:({loaded:F})=>{t.current&&(t.current.value=F)},onLoadSuccess:F=>{b(F.numPages)},children:Array.from(new Array(n),(F,T)=>jsxRuntimeExports.jsx(Page$1,{className:"mx-auto w-fit max-w-[100px]",pageIndex:T,loading:Loading,width:Math.min(a,1e3)},T))})]})}export{PdfSupport as default};
