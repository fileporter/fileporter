import{u as m,a as x,r as i,s as v,b as y,S as E,t as S,n as k,j as g,c as C}from"./index-0292f0c3.js";function A(e){var p,w;const r=m(),[a]=x(),[o,c]=i.useState(!0),d=v(`/files/${e.path}`),u=y(["meta",e.parent],({signal:t})=>C.get(`/api/${e.parent}`,{signal:t}).then(s=>s.data),{staleTime:6e4}),n=i.useMemo(()=>{var t;return(t=u.data)==null?void 0:t.contents.filter(s=>{var b;return s.type==="file"&&((b=s.mime)==null?void 0:b.startsWith("image/"))}).sort(a===E.alphabetic?S:k)},[u.data]);function l(){return(n==null?void 0:n.findIndex(t=>t.path===e.path))??-1}function h(){const t=l(),s=t<=0||n==null?void 0:n.at(t-1);s&&r(`/~/${s.path}`)}function f(){const t=l(),s=t<0||n==null?void 0:n.at(t+1);s&&r(`/~/${s.path}`)}return j(h,f),I(h,f),g.jsx("div",{className:o?"fixed inset-0 w-screen h-screen bg-black":"my-auto",children:g.jsx("img",{className:"object-contain w-full h-full",width:(p=e.size)==null?void 0:p[0],height:(w=e.size)==null?void 0:w[1],src:d,alt:e.basename,onDoubleClick:()=>c(!o)})})}function j(e,r){i.useEffect(()=>{const a=new AbortController;return window.addEventListener("keydown",o=>{switch(o.key){case"ArrowLeft":e();break;case"ArrowRight":r();break}},{signal:a.signal}),()=>a.abort()},[e,r])}function I(e,r){const a=i.useRef();i.useEffect(()=>{const o=new AbortController;return window.addEventListener("touchstart",c=>{a.current=c.changedTouches[0].screenX},{signal:o.signal}),window.addEventListener("touchend",c=>{const u=c.changedTouches[0].screenX-a.current;Math.abs(u)>50&&(u>0?e():r()),a.current=void 0},{signal:o.signal}),()=>o.abort()},[e,r])}export{A as default};
