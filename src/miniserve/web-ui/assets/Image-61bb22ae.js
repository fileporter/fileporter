import{u as v,a as x,r as c,b as I,S as E,t as y,n as S,s as f,j as m,c as k}from"./index-61b9fb31.js";function M(n){var g,b;const r=v(),[o]=x(),[a,u]=c.useState(!0),d=I(["meta",n.parent],({signal:t})=>k.get(`/api/${n.parent}`,{signal:t}).then(s=>s.data),{staleTime:6e4}),e=c.useMemo(()=>{var t;return(t=d.data)==null?void 0:t.contents.filter(s=>{var i;return s.type==="file"&&((i=s.mime)==null?void 0:i.startsWith("image/"))}).sort(o===E.alphabetic?y:S)},[d.data]);function l(){return(e==null?void 0:e.findIndex(t=>t.path===n.path))??-1}function p(){const t=l(),s=t<=0||e==null?void 0:e.at(t-1);s&&r(`/~/${s.path}`)}function w(){const t=l(),s=t<0||e==null?void 0:e.at(t+1);s&&r(`/~/${s.path}`)}return C(p,w),$(p,w),c.useEffect(()=>{const t=l(),s=t<=0||e==null?void 0:e.at(t-1);if(s){const h=new Image;h.src=f(`/files/${s.path}`)}const i=t<0||e==null?void 0:e.at(t+1);if(i){const h=new Image;h.src=f(`/files/${i.path}`)}},[e]),m.jsx("div",{className:a?"fixed inset-0 w-screen h-screen bg-black":"my-auto",children:m.jsx("img",{className:"object-contain w-full h-full",width:(g=n.size)==null?void 0:g.width,height:(b=n.size)==null?void 0:b.height,src:f(`/files/${n.path}`),alt:n.basename,onDoubleClick:()=>u(!a)})})}function C(n,r){c.useEffect(()=>{const o=new AbortController;return window.addEventListener("keydown",a=>{switch(a.key){case"ArrowLeft":n();break;case"ArrowRight":r();break}},{signal:o.signal}),()=>o.abort()},[n,r])}function $(n,r){const o=c.useRef();c.useEffect(()=>{const a=new AbortController;return window.addEventListener("touchstart",u=>{o.current=u.changedTouches[0].screenX},{signal:a.signal}),window.addEventListener("touchend",u=>{const e=u.changedTouches[0].screenX-o.current;Math.abs(e)>50&&(e>0?n():r()),o.current=void 0},{signal:a.signal}),()=>a.abort()},[n,r])}export{M as default};
